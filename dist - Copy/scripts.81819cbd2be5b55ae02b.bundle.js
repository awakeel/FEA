webpackJsonp([2],{"/47B":function(t,e,n){n("KF6U")(n("ETvt"))},3:function(t,e,n){n("agXo"),n("/47B"),n("nzwu"),t.exports=n("Xoj/")},"755C":function(t,e){t.exports='/*!\n * jQuery JavaScript Library v2.2.0\n * http://jquery.com/\n *\n * Includes Sizzle.js\n * http://sizzlejs.com/\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license\n * http://jquery.org/license\n *\n * Date: 2016-01-08T20:02Z\n */\n\n(function( global, factory ) {\n\n\tif ( typeof module === "object" && typeof module.exports === "object" ) {\n\t\t// For CommonJS and CommonJS-like environments where a proper `window`\n\t\t// is present, execute the factory and get jQuery.\n\t\t// For environments that do not have a `window` with a `document`\n\t\t// (such as Node.js), expose a factory as module.exports.\n\t\t// This accentuates the need for the creation of a real `window`.\n\t\t// e.g. var jQuery = require("jquery")(window);\n\t\t// See ticket #14549 for more info.\n\t\tmodule.exports = global.document ?\n\t\t\tfactory( global, true ) :\n\t\t\tfunction( w ) {\n\t\t\t\tif ( !w.document ) {\n\t\t\t\t\tthrow new Error( "jQuery requires a window with a document" );\n\t\t\t\t}\n\t\t\t\treturn factory( w );\n\t\t\t};\n\t} else {\n\t\tfactory( global );\n\t}\n\n// Pass this if window is not defined yet\n}(typeof window !== "undefined" ? window : this, function( window, noGlobal ) {\n\n// Support: Firefox 18+\n// Can\'t be in strict mode, several libs including ASP.NET trace\n// the stack via arguments.caller.callee and Firefox dies if\n// you try to trace through "use strict" call chains. (#13335)\n//"use strict";\nvar arr = [];\n\nvar document = window.document;\n\nvar slice = arr.slice;\n\nvar concat = arr.concat;\n\nvar push = arr.push;\n\nvar indexOf = arr.indexOf;\n\nvar class2type = {};\n\nvar toString = class2type.toString;\n\nvar hasOwn = class2type.hasOwnProperty;\n\nvar support = {};\n\n\n\nvar\n\tversion = "2.2.0",\n\n\t// Define a local copy of jQuery\n\tjQuery = function( selector, context ) {\n\n\t\t// The jQuery object is actually just the init constructor \'enhanced\'\n\t\t// Need init if jQuery is called (just allow error to be thrown if not included)\n\t\treturn new jQuery.fn.init( selector, context );\n\t},\n\n\t// Support: Android<4.1\n\t// Make sure we trim BOM and NBSP\n\trtrim = /^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g,\n\n\t// Matches dashed string for camelizing\n\trmsPrefix = /^-ms-/,\n\trdashAlpha = /-([\\da-z])/gi,\n\n\t// Used by jQuery.camelCase as callback to replace()\n\tfcamelCase = function( all, letter ) {\n\t\treturn letter.toUpperCase();\n\t};\n\njQuery.fn = jQuery.prototype = {\n\n\t// The current version of jQuery being used\n\tjquery: version,\n\n\tconstructor: jQuery,\n\n\t// Start with an empty selector\n\tselector: "",\n\n\t// The default length of a jQuery object is 0\n\tlength: 0,\n\n\ttoArray: function() {\n\t\treturn slice.call( this );\n\t},\n\n\t// Get the Nth element in the matched element set OR\n\t// Get the whole matched element set as a clean array\n\tget: function( num ) {\n\t\treturn num != null ?\n\n\t\t\t// Return just the one element from the set\n\t\t\t( num < 0 ? this[ num + this.length ] : this[ num ] ) :\n\n\t\t\t// Return all the elements in a clean array\n\t\t\tslice.call( this );\n\t},\n\n\t// Take an array of elements and push it onto the stack\n\t// (returning the new matched element set)\n\tpushStack: function( elems ) {\n\n\t\t// Build a new jQuery matched element set\n\t\tvar ret = jQuery.merge( this.constructor(), elems );\n\n\t\t// Add the old object onto the stack (as a reference)\n\t\tret.prevObject = this;\n\t\tret.context = this.context;\n\n\t\t// Return the newly-formed element set\n\t\treturn ret;\n\t},\n\n\t// Execute a callback for every element in the matched set.\n\teach: function( callback ) {\n\t\treturn jQuery.each( this, callback );\n\t},\n\n\tmap: function( callback ) {\n\t\treturn this.pushStack( jQuery.map( this, function( elem, i ) {\n\t\t\treturn callback.call( elem, i, elem );\n\t\t} ) );\n\t},\n\n\tslice: function() {\n\t\treturn this.pushStack( slice.apply( this, arguments ) );\n\t},\n\n\tfirst: function() {\n\t\treturn this.eq( 0 );\n\t},\n\n\tlast: function() {\n\t\treturn this.eq( -1 );\n\t},\n\n\teq: function( i ) {\n\t\tvar len = this.length,\n\t\t\tj = +i + ( i < 0 ? len : 0 );\n\t\treturn this.pushStack( j >= 0 && j < len ? [ this[ j ] ] : [] );\n\t},\n\n\tend: function() {\n\t\treturn this.prevObject || this.constructor();\n\t},\n\n\t// For internal use only.\n\t// Behaves like an Array\'s method, not like a jQuery method.\n\tpush: push,\n\tsort: arr.sort,\n\tsplice: arr.splice\n};\n\njQuery.extend = jQuery.fn.extend = function() {\n\tvar options, name, src, copy, copyIsArray, clone,\n\t\ttarget = arguments[ 0 ] || {},\n\t\ti = 1,\n\t\tlength = arguments.length,\n\t\tdeep = false;\n\n\t// Handle a deep copy situation\n\tif ( typeof target === "boolean" ) {\n\t\tdeep = target;\n\n\t\t// Skip the boolean and the target\n\t\ttarget = arguments[ i ] || {};\n\t\ti++;\n\t}\n\n\t// Handle case when target is a string or something (possible in deep copy)\n\tif ( typeof target !== "object" && !jQuery.isFunction( target ) ) {\n\t\ttarget = {};\n\t}\n\n\t// Extend jQuery itself if only one argument is passed\n\tif ( i === length ) {\n\t\ttarget = this;\n\t\ti--;\n\t}\n\n\tfor ( ; i < length; i++ ) {\n\n\t\t// Only deal with non-null/undefined values\n\t\tif ( ( options = arguments[ i ] ) != null ) {\n\n\t\t\t// Extend the base object\n\t\t\tfor ( name in options ) {\n\t\t\t\tsrc = target[ name ];\n\t\t\t\tcopy = options[ name ];\n\n\t\t\t\t// Prevent never-ending loop\n\t\t\t\tif ( target === copy ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Recurse if we\'re merging plain objects or arrays\n\t\t\t\tif ( deep && copy && ( jQuery.isPlainObject( copy ) ||\n\t\t\t\t\t( copyIsArray = jQuery.isArray( copy ) ) ) ) {\n\n\t\t\t\t\tif ( copyIsArray ) {\n\t\t\t\t\t\tcopyIsArray = false;\n\t\t\t\t\t\tclone = src && jQuery.isArray( src ) ? src : [];\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tclone = src && jQuery.isPlainObject( src ) ? src : {};\n\t\t\t\t\t}\n\n\t\t\t\t\t// Never move original objects, clone them\n\t\t\t\t\ttarget[ name ] = jQuery.extend( deep, clone, copy );\n\n\t\t\t\t// Don\'t bring in undefined values\n\t\t\t\t} else if ( copy !== undefined ) {\n\t\t\t\t\ttarget[ name ] = copy;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Return the modified object\n\treturn target;\n};\n\njQuery.extend( {\n\n\t// Unique for each copy of jQuery on the page\n\texpando: "jQuery" + ( version + Math.random() ).replace( /\\D/g, "" ),\n\n\t// Assume jQuery is ready without the ready module\n\tisReady: true,\n\n\terror: function( msg ) {\n\t\tthrow new Error( msg );\n\t},\n\n\tnoop: function() {},\n\n\tisFunction: function( obj ) {\n\t\treturn jQuery.type( obj ) === "function";\n\t},\n\n\tisArray: Array.isArray,\n\n\tisWindow: function( obj ) {\n\t\treturn obj != null && obj === obj.window;\n\t},\n\n\tisNumeric: function( obj ) {\n\n\t\t// parseFloat NaNs numeric-cast false positives (null|true|false|"")\n\t\t// ...but misinterprets leading-number strings, particularly hex literals ("0x...")\n\t\t// subtraction forces infinities to NaN\n\t\t// adding 1 corrects loss of precision from parseFloat (#15100)\n\t\tvar realStringObj = obj && obj.toString();\n\t\treturn !jQuery.isArray( obj ) && ( realStringObj - parseFloat( realStringObj ) + 1 ) >= 0;\n\t},\n\n\tisPlainObject: function( obj ) {\n\n\t\t// Not plain objects:\n\t\t// - Any object or value whose internal [[Class]] property is not "[object Object]"\n\t\t// - DOM nodes\n\t\t// - window\n\t\tif ( jQuery.type( obj ) !== "object" || obj.nodeType || jQuery.isWindow( obj ) ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif ( obj.constructor &&\n\t\t\t\t!hasOwn.call( obj.constructor.prototype, "isPrototypeOf" ) ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// If the function hasn\'t returned already, we\'re confident that\n\t\t// |obj| is a plain object, created by {} or constructed with new Object\n\t\treturn true;\n\t},\n\n\tisEmptyObject: function( obj ) {\n\t\tvar name;\n\t\tfor ( name in obj ) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t},\n\n\ttype: function( obj ) {\n\t\tif ( obj == null ) {\n\t\t\treturn obj + "";\n\t\t}\n\n\t\t// Support: Android<4.0, iOS<6 (functionish RegExp)\n\t\treturn typeof obj === "object" || typeof obj === "function" ?\n\t\t\tclass2type[ toString.call( obj ) ] || "object" :\n\t\t\ttypeof obj;\n\t},\n\n\t// Evaluates a script in a global context\n\tglobalEval: function( code ) {\n\t\tvar script,\n\t\t\tindirect = eval;\n\n\t\tcode = jQuery.trim( code );\n\n\t\tif ( code ) {\n\n\t\t\t// If the code includes a valid, prologue position\n\t\t\t// strict mode pragma, execute code by injecting a\n\t\t\t// script tag into the document.\n\t\t\tif ( code.indexOf( "use strict" ) === 1 ) {\n\t\t\t\tscript = document.createElement( "script" );\n\t\t\t\tscript.text = code;\n\t\t\t\tdocument.head.appendChild( script ).parentNode.removeChild( script );\n\t\t\t} else {\n\n\t\t\t\t// Otherwise, avoid the DOM node creation, insertion\n\t\t\t\t// and removal by using an indirect global eval\n\n\t\t\t\tindirect( code );\n\t\t\t}\n\t\t}\n\t},\n\n\t// Convert dashed to camelCase; used by the css and data modules\n\t// Support: IE9-11+\n\t// Microsoft forgot to hump their vendor prefix (#9572)\n\tcamelCase: function( string ) {\n\t\treturn string.replace( rmsPrefix, "ms-" ).replace( rdashAlpha, fcamelCase );\n\t},\n\n\tnodeName: function( elem, name ) {\n\t\treturn elem.nodeName && elem.nodeName.toLowerCase() === name.toLowerCase();\n\t},\n\n\teach: function( obj, callback ) {\n\t\tvar length, i = 0;\n\n\t\tif ( isArrayLike( obj ) ) {\n\t\t\tlength = obj.length;\n\t\t\tfor ( ; i < length; i++ ) {\n\t\t\t\tif ( callback.call( obj[ i ], i, obj[ i ] ) === false ) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tfor ( i in obj ) {\n\t\t\t\tif ( callback.call( obj[ i ], i, obj[ i ] ) === false ) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn obj;\n\t},\n\n\t// Support: Android<4.1\n\ttrim: function( text ) {\n\t\treturn text == null ?\n\t\t\t"" :\n\t\t\t( text + "" ).replace( rtrim, "" );\n\t},\n\n\t// results is for internal usage only\n\tmakeArray: function( arr, results ) {\n\t\tvar ret = results || [];\n\n\t\tif ( arr != null ) {\n\t\t\tif ( isArrayLike( Object( arr ) ) ) {\n\t\t\t\tjQuery.merge( ret,\n\t\t\t\t\ttypeof arr === "string" ?\n\t\t\t\t\t[ arr ] : arr\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tpush.call( ret, arr );\n\t\t\t}\n\t\t}\n\n\t\treturn ret;\n\t},\n\n\tinArray: function( elem, arr, i ) {\n\t\treturn arr == null ? -1 : indexOf.call( arr, elem, i );\n\t},\n\n\tmerge: function( first, second ) {\n\t\tvar len = +second.length,\n\t\t\tj = 0,\n\t\t\ti = first.length;\n\n\t\tfor ( ; j < len; j++ ) {\n\t\t\tfirst[ i++ ] = second[ j ];\n\t\t}\n\n\t\tfirst.length = i;\n\n\t\treturn first;\n\t},\n\n\tgrep: function( elems, callback, invert ) {\n\t\tvar callbackInverse,\n\t\t\tmatches = [],\n\t\t\ti = 0,\n\t\t\tlength = elems.length,\n\t\t\tcallbackExpect = !invert;\n\n\t\t// Go through the array, only saving the items\n\t\t// that pass the validator function\n\t\tfor ( ; i < length; i++ ) {\n\t\t\tcallbackInverse = !callback( elems[ i ], i );\n\t\t\tif ( callbackInverse !== callbackExpect ) {\n\t\t\t\tmatches.push( elems[ i ] );\n\t\t\t}\n\t\t}\n\n\t\treturn matches;\n\t},\n\n\t// arg is for internal usage only\n\tmap: function( elems, callback, arg ) {\n\t\tvar length, value,\n\t\t\ti = 0,\n\t\t\tret = [];\n\n\t\t// Go through the array, translating each of the items to their new values\n\t\tif ( isArrayLike( elems ) ) {\n\t\t\tlength = elems.length;\n\t\t\tfor ( ; i < length; i++ ) {\n\t\t\t\tvalue = callback( elems[ i ], i, arg );\n\n\t\t\t\tif ( value != null ) {\n\t\t\t\t\tret.push( value );\n\t\t\t\t}\n\t\t\t}\n\n\t\t// Go through every key on the object,\n\t\t} else {\n\t\t\tfor ( i in elems ) {\n\t\t\t\tvalue = callback( elems[ i ], i, arg );\n\n\t\t\t\tif ( value != null ) {\n\t\t\t\t\tret.push( value );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Flatten any nested arrays\n\t\treturn concat.apply( [], ret );\n\t},\n\n\t// A global GUID counter for objects\n\tguid: 1,\n\n\t// Bind a function to a context, optionally partially applying any\n\t// arguments.\n\tproxy: function( fn, context ) {\n\t\tvar tmp, args, proxy;\n\n\t\tif ( typeof context === "string" ) {\n\t\t\ttmp = fn[ context ];\n\t\t\tcontext = fn;\n\t\t\tfn = tmp;\n\t\t}\n\n\t\t// Quick check to determine if target is callable, in the spec\n\t\t// this throws a TypeError, but we will just return undefined.\n\t\tif ( !jQuery.isFunction( fn ) ) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// Simulated bind\n\t\targs = slice.call( arguments, 2 );\n\t\tproxy = function() {\n\t\t\treturn fn.apply( context || this, args.concat( slice.call( arguments ) ) );\n\t\t};\n\n\t\t// Set the guid of unique handler to the same of original handler, so it can be removed\n\t\tproxy.guid = fn.guid = fn.guid || jQuery.guid++;\n\n\t\treturn proxy;\n\t},\n\n\tnow: Date.now,\n\n\t// jQuery.support is not used in Core but other projects attach their\n\t// properties to it so it needs to exist.\n\tsupport: support\n} );\n\n// JSHint would error on this code due to the Symbol not being defined in ES5.\n// Defining this global in .jshintrc would create a danger of using the global\n// unguarded in another place, it seems safer to just disable JSHint for these\n// three lines.\n/* jshint ignore: start */\nif ( typeof Symbol === "function" ) {\n\tjQuery.fn[ Symbol.iterator ] = arr[ Symbol.iterator ];\n}\n/* jshint ignore: end */\n\n// Populate the class2type map\njQuery.each( "Boolean Number String Function Array Date RegExp Object Error Symbol".split( " " ),\nfunction( i, name ) {\n\tclass2type[ "[object " + name + "]" ] = name.toLowerCase();\n} );\n\nfunction isArrayLike( obj ) {\n\n\t// Support: iOS 8.2 (not reproducible in simulator)\n\t// `in` check used to prevent JIT error (gh-2145)\n\t// hasOwn isn\'t used here due to false negatives\n\t// regarding Nodelist length in IE\n\tvar length = !!obj && "length" in obj && obj.length,\n\t\ttype = jQuery.type( obj );\n\n\tif ( type === "function" || jQuery.isWindow( obj ) ) {\n\t\treturn false;\n\t}\n\n\treturn type === "array" || length === 0 ||\n\t\ttypeof length === "number" && length > 0 && ( length - 1 ) in obj;\n}\nvar Sizzle =\n/*!\n * Sizzle CSS Selector Engine v2.2.1\n * http://sizzlejs.com/\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license\n * http://jquery.org/license\n *\n * Date: 2015-10-17\n */\n(function( window ) {\n\nvar i,\n\tsupport,\n\tExpr,\n\tgetText,\n\tisXML,\n\ttokenize,\n\tcompile,\n\tselect,\n\toutermostContext,\n\tsortInput,\n\thasDuplicate,\n\n\t// Local document vars\n\tsetDocument,\n\tdocument,\n\tdocElem,\n\tdocumentIsHTML,\n\trbuggyQSA,\n\trbuggyMatches,\n\tmatches,\n\tcontains,\n\n\t// Instance-specific data\n\texpando = "sizzle" + 1 * new Date(),\n\tpreferredDoc = window.document,\n\tdirruns = 0,\n\tdone = 0,\n\tclassCache = createCache(),\n\ttokenCache = createCache(),\n\tcompilerCache = createCache(),\n\tsortOrder = function( a, b ) {\n\t\tif ( a === b ) {\n\t\t\thasDuplicate = true;\n\t\t}\n\t\treturn 0;\n\t},\n\n\t// General-purpose constants\n\tMAX_NEGATIVE = 1 << 31,\n\n\t// Instance methods\n\thasOwn = ({}).hasOwnProperty,\n\tarr = [],\n\tpop = arr.pop,\n\tpush_native = arr.push,\n\tpush = arr.push,\n\tslice = arr.slice,\n\t// Use a stripped-down indexOf as it\'s faster than native\n\t// http://jsperf.com/thor-indexof-vs-for/5\n\tindexOf = function( list, elem ) {\n\t\tvar i = 0,\n\t\t\tlen = list.length;\n\t\tfor ( ; i < len; i++ ) {\n\t\t\tif ( list[i] === elem ) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t},\n\n\tbooleans = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",\n\n\t// Regular expressions\n\n\t// http://www.w3.org/TR/css3-selectors/#whitespace\n\twhitespace = "[\\\\x20\\\\t\\\\r\\\\n\\\\f]",\n\n\t// http://www.w3.org/TR/CSS21/syndata.html#value-def-identifier\n\tidentifier = "(?:\\\\\\\\.|[\\\\w-]|[^\\\\x00-\\\\xa0])+",\n\n\t// Attribute selectors: http://www.w3.org/TR/selectors/#attribute-selectors\n\tattributes = "\\\\[" + whitespace + "*(" + identifier + ")(?:" + whitespace +\n\t\t// Operator (capture 2)\n\t\t"*([*^$|!~]?=)" + whitespace +\n\t\t// "Attribute values must be CSS identifiers [capture 5] or strings [capture 3 or capture 4]"\n\t\t"*(?:\'((?:\\\\\\\\.|[^\\\\\\\\\'])*)\'|\\"((?:\\\\\\\\.|[^\\\\\\\\\\"])*)\\"|(" + identifier + "))|)" + whitespace +\n\t\t"*\\\\]",\n\n\tpseudos = ":(" + identifier + ")(?:\\\\((" +\n\t\t// To reduce the number of selectors needing tokenize in the preFilter, prefer arguments:\n\t\t// 1. quoted (capture 3; capture 4 or capture 5)\n\t\t"(\'((?:\\\\\\\\.|[^\\\\\\\\\'])*)\'|\\"((?:\\\\\\\\.|[^\\\\\\\\\\"])*)\\")|" +\n\t\t// 2. simple (capture 6)\n\t\t"((?:\\\\\\\\.|[^\\\\\\\\()[\\\\]]|" + attributes + ")*)|" +\n\t\t// 3. anything else (capture 2)\n\t\t".*" +\n\t\t")\\\\)|)",\n\n\t// Leading and non-escaped trailing whitespace, capturing some non-whitespace characters preceding the latter\n\trwhitespace = new RegExp( whitespace + "+", "g" ),\n\trtrim = new RegExp( "^" + whitespace + "+|((?:^|[^\\\\\\\\])(?:\\\\\\\\.)*)" + whitespace + "+$", "g" ),\n\n\trcomma = new RegExp( "^" + whitespace + "*," + whitespace + "*" ),\n\trcombinators = new RegExp( "^" + whitespace + "*([>+~]|" + whitespace + ")" + whitespace + "*" ),\n\n\trattributeQuotes = new RegExp( "=" + whitespace + "*([^\\\\]\'\\"]*?)" + whitespace + "*\\\\]", "g" ),\n\n\trpseudo = new RegExp( pseudos ),\n\tridentifier = new RegExp( "^" + identifier + "$" ),\n\n\tmatchExpr = {\n\t\t"ID": new RegExp( "^#(" + identifier + ")" ),\n\t\t"CLASS": new RegExp( "^\\\\.(" + identifier + ")" ),\n\t\t"TAG": new RegExp( "^(" + identifier + "|[*])" ),\n\t\t"ATTR": new RegExp( "^" + attributes ),\n\t\t"PSEUDO": new RegExp( "^" + pseudos ),\n\t\t"CHILD": new RegExp( "^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\\\(" + whitespace +\n\t\t\t"*(even|odd|(([+-]|)(\\\\d*)n|)" + whitespace + "*(?:([+-]|)" + whitespace +\n\t\t\t"*(\\\\d+)|))" + whitespace + "*\\\\)|)", "i" ),\n\t\t"bool": new RegExp( "^(?:" + booleans + ")$", "i" ),\n\t\t// For use in libraries implementing .is()\n\t\t// We use this for POS matching in `select`\n\t\t"needsContext": new RegExp( "^" + whitespace + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\\\(" +\n\t\t\twhitespace + "*((?:-\\\\d)?\\\\d*)" + whitespace + "*\\\\)|)(?=[^-]|$)", "i" )\n\t},\n\n\trinputs = /^(?:input|select|textarea|button)$/i,\n\trheader = /^h\\d$/i,\n\n\trnative = /^[^{]+\\{\\s*\\[native \\w/,\n\n\t// Easily-parseable/retrievable ID or TAG or CLASS selectors\n\trquickExpr = /^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/,\n\n\trsibling = /[+~]/,\n\trescape = /\'|\\\\/g,\n\n\t// CSS escapes http://www.w3.org/TR/CSS21/syndata.html#escaped-characters\n\trunescape = new RegExp( "\\\\\\\\([\\\\da-f]{1,6}" + whitespace + "?|(" + whitespace + ")|.)", "ig" ),\n\tfunescape = function( _, escaped, escapedWhitespace ) {\n\t\tvar high = "0x" + escaped - 0x10000;\n\t\t// NaN means non-codepoint\n\t\t// Support: Firefox<24\n\t\t// Workaround erroneous numeric interpretation of +"0x"\n\t\treturn high !== high || escapedWhitespace ?\n\t\t\tescaped :\n\t\t\thigh < 0 ?\n\t\t\t\t// BMP codepoint\n\t\t\t\tString.fromCharCode( high + 0x10000 ) :\n\t\t\t\t// Supplemental Plane codepoint (surrogate pair)\n\t\t\t\tString.fromCharCode( high >> 10 | 0xD800, high & 0x3FF | 0xDC00 );\n\t},\n\n\t// Used for iframes\n\t// See setDocument()\n\t// Removing the function wrapper causes a "Permission Denied"\n\t// error in IE\n\tunloadHandler = function() {\n\t\tsetDocument();\n\t};\n\n// Optimize for push.apply( _, NodeList )\ntry {\n\tpush.apply(\n\t\t(arr = slice.call( preferredDoc.childNodes )),\n\t\tpreferredDoc.childNodes\n\t);\n\t// Support: Android<4.0\n\t// Detect silently failing push.apply\n\tarr[ preferredDoc.childNodes.length ].nodeType;\n} catch ( e ) {\n\tpush = { apply: arr.length ?\n\n\t\t// Leverage slice if possible\n\t\tfunction( target, els ) {\n\t\t\tpush_native.apply( target, slice.call(els) );\n\t\t} :\n\n\t\t// Support: IE<9\n\t\t// Otherwise append directly\n\t\tfunction( target, els ) {\n\t\t\tvar j = target.length,\n\t\t\t\ti = 0;\n\t\t\t// Can\'t trust NodeList.length\n\t\t\twhile ( (target[j++] = els[i++]) ) {}\n\t\t\ttarget.length = j - 1;\n\t\t}\n\t};\n}\n\nfunction Sizzle( selector, context, results, seed ) {\n\tvar m, i, elem, nid, nidselect, match, groups, newSelector,\n\t\tnewContext = context && context.ownerDocument,\n\n\t\t// nodeType defaults to 9, since context defaults to document\n\t\tnodeType = context ? context.nodeType : 9;\n\n\tresults = results || [];\n\n\t// Return early from calls with invalid selector or context\n\tif ( typeof selector !== "string" || !selector ||\n\t\tnodeType !== 1 && nodeType !== 9 && nodeType !== 11 ) {\n\n\t\treturn results;\n\t}\n\n\t// Try to shortcut find operations (as opposed to filters) in HTML documents\n\tif ( !seed ) {\n\n\t\tif ( ( context ? context.ownerDocument || context : preferredDoc ) !== document ) {\n\t\t\tsetDocument( context );\n\t\t}\n\t\tcontext = context || document;\n\n\t\tif ( documentIsHTML ) {\n\n\t\t\t// If the selector is sufficiently simple, try using a "get*By*" DOM method\n\t\t\t// (excepting DocumentFragment context, where the methods don\'t exist)\n\t\t\tif ( nodeType !== 11 && (match = rquickExpr.exec( selector )) ) {\n\n\t\t\t\t// ID selector\n\t\t\t\tif ( (m = match[1]) ) {\n\n\t\t\t\t\t// Document context\n\t\t\t\t\tif ( nodeType === 9 ) {\n\t\t\t\t\t\tif ( (elem = context.getElementById( m )) ) {\n\n\t\t\t\t\t\t\t// Support: IE, Opera, Webkit\n\t\t\t\t\t\t\t// TODO: identify versions\n\t\t\t\t\t\t\t// getElementById can match elements by name instead of ID\n\t\t\t\t\t\t\tif ( elem.id === m ) {\n\t\t\t\t\t\t\t\tresults.push( elem );\n\t\t\t\t\t\t\t\treturn results;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn results;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t// Element context\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// Support: IE, Opera, Webkit\n\t\t\t\t\t\t// TODO: identify versions\n\t\t\t\t\t\t// getElementById can match elements by name instead of ID\n\t\t\t\t\t\tif ( newContext && (elem = newContext.getElementById( m )) &&\n\t\t\t\t\t\t\tcontains( context, elem ) &&\n\t\t\t\t\t\t\telem.id === m ) {\n\n\t\t\t\t\t\t\tresults.push( elem );\n\t\t\t\t\t\t\treturn results;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t// Type selector\n\t\t\t\t} else if ( match[2] ) {\n\t\t\t\t\tpush.apply( results, context.getElementsByTagName( selector ) );\n\t\t\t\t\treturn results;\n\n\t\t\t\t// Class selector\n\t\t\t\t} else if ( (m = match[3]) && support.getElementsByClassName &&\n\t\t\t\t\tcontext.getElementsByClassName ) {\n\n\t\t\t\t\tpush.apply( results, context.getElementsByClassName( m ) );\n\t\t\t\t\treturn results;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Take advantage of querySelectorAll\n\t\t\tif ( support.qsa &&\n\t\t\t\t!compilerCache[ selector + " " ] &&\n\t\t\t\t(!rbuggyQSA || !rbuggyQSA.test( selector )) ) {\n\n\t\t\t\tif ( nodeType !== 1 ) {\n\t\t\t\t\tnewContext = context;\n\t\t\t\t\tnewSelector = selector;\n\n\t\t\t\t// qSA looks outside Element context, which is not what we want\n\t\t\t\t// Thanks to Andrew Dupont for this workaround technique\n\t\t\t\t// Support: IE <=8\n\t\t\t\t// Exclude object elements\n\t\t\t\t} else if ( context.nodeName.toLowerCase() !== "object" ) {\n\n\t\t\t\t\t// Capture the context ID, setting it first if necessary\n\t\t\t\t\tif ( (nid = context.getAttribute( "id" )) ) {\n\t\t\t\t\t\tnid = nid.replace( rescape, "\\\\$&" );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontext.setAttribute( "id", (nid = expando) );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Prefix every selector in the list\n\t\t\t\t\tgroups = tokenize( selector );\n\t\t\t\t\ti = groups.length;\n\t\t\t\t\tnidselect = ridentifier.test( nid ) ? "#" + nid : "[id=\'" + nid + "\']";\n\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\tgroups[i] = nidselect + " " + toSelector( groups[i] );\n\t\t\t\t\t}\n\t\t\t\t\tnewSelector = groups.join( "," );\n\n\t\t\t\t\t// Expand context for sibling selectors\n\t\t\t\t\tnewContext = rsibling.test( selector ) && testContext( context.parentNode ) ||\n\t\t\t\t\t\tcontext;\n\t\t\t\t}\n\n\t\t\t\tif ( newSelector ) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tpush.apply( results,\n\t\t\t\t\t\t\tnewContext.querySelectorAll( newSelector )\n\t\t\t\t\t\t);\n\t\t\t\t\t\treturn results;\n\t\t\t\t\t} catch ( qsaError ) {\n\t\t\t\t\t} finally {\n\t\t\t\t\t\tif ( nid === expando ) {\n\t\t\t\t\t\t\tcontext.removeAttribute( "id" );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// All others\n\treturn select( selector.replace( rtrim, "$1" ), context, results, seed );\n}\n\n/**\n * Create key-value caches of limited size\n * @returns {function(string, object)} Returns the Object data after storing it on itself with\n *\tproperty name the (space-suffixed) string and (if the cache is larger than Expr.cacheLength)\n *\tdeleting the oldest entry\n */\nfunction createCache() {\n\tvar keys = [];\n\n\tfunction cache( key, value ) {\n\t\t// Use (key + " ") to avoid collision with native prototype properties (see Issue #157)\n\t\tif ( keys.push( key + " " ) > Expr.cacheLength ) {\n\t\t\t// Only keep the most recent entries\n\t\t\tdelete cache[ keys.shift() ];\n\t\t}\n\t\treturn (cache[ key + " " ] = value);\n\t}\n\treturn cache;\n}\n\n/**\n * Mark a function for special use by Sizzle\n * @param {Function} fn The function to mark\n */\nfunction markFunction( fn ) {\n\tfn[ expando ] = true;\n\treturn fn;\n}\n\n/**\n * Support testing using an element\n * @param {Function} fn Passed the created div and expects a boolean result\n */\nfunction assert( fn ) {\n\tvar div = document.createElement("div");\n\n\ttry {\n\t\treturn !!fn( div );\n\t} catch (e) {\n\t\treturn false;\n\t} finally {\n\t\t// Remove from its parent by default\n\t\tif ( div.parentNode ) {\n\t\t\tdiv.parentNode.removeChild( div );\n\t\t}\n\t\t// release memory in IE\n\t\tdiv = null;\n\t}\n}\n\n/**\n * Adds the same handler for all of the specified attrs\n * @param {String} attrs Pipe-separated list of attributes\n * @param {Function} handler The method that will be applied\n */\nfunction addHandle( attrs, handler ) {\n\tvar arr = attrs.split("|"),\n\t\ti = arr.length;\n\n\twhile ( i-- ) {\n\t\tExpr.attrHandle[ arr[i] ] = handler;\n\t}\n}\n\n/**\n * Checks document order of two siblings\n * @param {Element} a\n * @param {Element} b\n * @returns {Number} Returns less than 0 if a precedes b, greater than 0 if a follows b\n */\nfunction siblingCheck( a, b ) {\n\tvar cur = b && a,\n\t\tdiff = cur && a.nodeType === 1 && b.nodeType === 1 &&\n\t\t\t( ~b.sourceIndex || MAX_NEGATIVE ) -\n\t\t\t( ~a.sourceIndex || MAX_NEGATIVE );\n\n\t// Use IE sourceIndex if available on both nodes\n\tif ( diff ) {\n\t\treturn diff;\n\t}\n\n\t// Check if b follows a\n\tif ( cur ) {\n\t\twhile ( (cur = cur.nextSibling) ) {\n\t\t\tif ( cur === b ) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn a ? 1 : -1;\n}\n\n/**\n * Returns a function to use in pseudos for input types\n * @param {String} type\n */\nfunction createInputPseudo( type ) {\n\treturn function( elem ) {\n\t\tvar name = elem.nodeName.toLowerCase();\n\t\treturn name === "input" && elem.type === type;\n\t};\n}\n\n/**\n * Returns a function to use in pseudos for buttons\n * @param {String} type\n */\nfunction createButtonPseudo( type ) {\n\treturn function( elem ) {\n\t\tvar name = elem.nodeName.toLowerCase();\n\t\treturn (name === "input" || name === "button") && elem.type === type;\n\t};\n}\n\n/**\n * Returns a function to use in pseudos for positionals\n * @param {Function} fn\n */\nfunction createPositionalPseudo( fn ) {\n\treturn markFunction(function( argument ) {\n\t\targument = +argument;\n\t\treturn markFunction(function( seed, matches ) {\n\t\t\tvar j,\n\t\t\t\tmatchIndexes = fn( [], seed.length, argument ),\n\t\t\t\ti = matchIndexes.length;\n\n\t\t\t// Match elements found at the specified indexes\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( seed[ (j = matchIndexes[i]) ] ) {\n\t\t\t\t\tseed[j] = !(matches[j] = seed[j]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n}\n\n/**\n * Checks a node for validity as a Sizzle context\n * @param {Element|Object=} context\n * @returns {Element|Object|Boolean} The input node if acceptable, otherwise a falsy value\n */\nfunction testContext( context ) {\n\treturn context && typeof context.getElementsByTagName !== "undefined" && context;\n}\n\n// Expose support vars for convenience\nsupport = Sizzle.support = {};\n\n/**\n * Detects XML nodes\n * @param {Element|Object} elem An element or a document\n * @returns {Boolean} True iff elem is a non-HTML XML node\n */\nisXML = Sizzle.isXML = function( elem ) {\n\t// documentElement is verified for cases where it doesn\'t yet exist\n\t// (such as loading iframes in IE - #4833)\n\tvar documentElement = elem && (elem.ownerDocument || elem).documentElement;\n\treturn documentElement ? documentElement.nodeName !== "HTML" : false;\n};\n\n/**\n * Sets document-related variables once based on the current document\n * @param {Element|Object} [doc] An element or document object to use to set the document\n * @returns {Object} Returns the current document\n */\nsetDocument = Sizzle.setDocument = function( node ) {\n\tvar hasCompare, parent,\n\t\tdoc = node ? node.ownerDocument || node : preferredDoc;\n\n\t// Return early if doc is invalid or already selected\n\tif ( doc === document || doc.nodeType !== 9 || !doc.documentElement ) {\n\t\treturn document;\n\t}\n\n\t// Update global variables\n\tdocument = doc;\n\tdocElem = document.documentElement;\n\tdocumentIsHTML = !isXML( document );\n\n\t// Support: IE 9-11, Edge\n\t// Accessing iframe documents after unload throws "permission denied" errors (jQuery #13936)\n\tif ( (parent = document.defaultView) && parent.top !== parent ) {\n\t\t// Support: IE 11\n\t\tif ( parent.addEventListener ) {\n\t\t\tparent.addEventListener( "unload", unloadHandler, false );\n\n\t\t// Support: IE 9 - 10 only\n\t\t} else if ( parent.attachEvent ) {\n\t\t\tparent.attachEvent( "onunload", unloadHandler );\n\t\t}\n\t}\n\n\t/* Attributes\n\t---------------------------------------------------------------------- */\n\n\t// Support: IE<8\n\t// Verify that getAttribute really returns attributes and not properties\n\t// (excepting IE8 booleans)\n\tsupport.attributes = assert(function( div ) {\n\t\tdiv.className = "i";\n\t\treturn !div.getAttribute("className");\n\t});\n\n\t/* getElement(s)By*\n\t---------------------------------------------------------------------- */\n\n\t// Check if getElementsByTagName("*") returns only elements\n\tsupport.getElementsByTagName = assert(function( div ) {\n\t\tdiv.appendChild( document.createComment("") );\n\t\treturn !div.getElementsByTagName("*").length;\n\t});\n\n\t// Support: IE<9\n\tsupport.getElementsByClassName = rnative.test( document.getElementsByClassName );\n\n\t// Support: IE<10\n\t// Check if getElementById returns elements by name\n\t// The broken getElementById methods don\'t pick up programatically-set names,\n\t// so use a roundabout getElementsByName test\n\tsupport.getById = assert(function( div ) {\n\t\tdocElem.appendChild( div ).id = expando;\n\t\treturn !document.getElementsByName || !document.getElementsByName( expando ).length;\n\t});\n\n\t// ID find and filter\n\tif ( support.getById ) {\n\t\tExpr.find["ID"] = function( id, context ) {\n\t\t\tif ( typeof context.getElementById !== "undefined" && documentIsHTML ) {\n\t\t\t\tvar m = context.getElementById( id );\n\t\t\t\treturn m ? [ m ] : [];\n\t\t\t}\n\t\t};\n\t\tExpr.filter["ID"] = function( id ) {\n\t\t\tvar attrId = id.replace( runescape, funescape );\n\t\t\treturn function( elem ) {\n\t\t\t\treturn elem.getAttribute("id") === attrId;\n\t\t\t};\n\t\t};\n\t} else {\n\t\t// Support: IE6/7\n\t\t// getElementById is not reliable as a find shortcut\n\t\tdelete Expr.find["ID"];\n\n\t\tExpr.filter["ID"] =  function( id ) {\n\t\t\tvar attrId = id.replace( runescape, funescape );\n\t\t\treturn function( elem ) {\n\t\t\t\tvar node = typeof elem.getAttributeNode !== "undefined" &&\n\t\t\t\t\telem.getAttributeNode("id");\n\t\t\t\treturn node && node.value === attrId;\n\t\t\t};\n\t\t};\n\t}\n\n\t// Tag\n\tExpr.find["TAG"] = support.getElementsByTagName ?\n\t\tfunction( tag, context ) {\n\t\t\tif ( typeof context.getElementsByTagName !== "undefined" ) {\n\t\t\t\treturn context.getElementsByTagName( tag );\n\n\t\t\t// DocumentFragment nodes don\'t have gEBTN\n\t\t\t} else if ( support.qsa ) {\n\t\t\t\treturn context.querySelectorAll( tag );\n\t\t\t}\n\t\t} :\n\n\t\tfunction( tag, context ) {\n\t\t\tvar elem,\n\t\t\t\ttmp = [],\n\t\t\t\ti = 0,\n\t\t\t\t// By happy coincidence, a (broken) gEBTN appears on DocumentFragment nodes too\n\t\t\t\tresults = context.getElementsByTagName( tag );\n\n\t\t\t// Filter out possible comments\n\t\t\tif ( tag === "*" ) {\n\t\t\t\twhile ( (elem = results[i++]) ) {\n\t\t\t\t\tif ( elem.nodeType === 1 ) {\n\t\t\t\t\t\ttmp.push( elem );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn tmp;\n\t\t\t}\n\t\t\treturn results;\n\t\t};\n\n\t// Class\n\tExpr.find["CLASS"] = support.getElementsByClassName && function( className, context ) {\n\t\tif ( typeof context.getElementsByClassName !== "undefined" && documentIsHTML ) {\n\t\t\treturn context.getElementsByClassName( className );\n\t\t}\n\t};\n\n\t/* QSA/matchesSelector\n\t---------------------------------------------------------------------- */\n\n\t// QSA and matchesSelector support\n\n\t// matchesSelector(:active) reports false when true (IE9/Opera 11.5)\n\trbuggyMatches = [];\n\n\t// qSa(:focus) reports false when true (Chrome 21)\n\t// We allow this because of a bug in IE8/9 that throws an error\n\t// whenever `document.activeElement` is accessed on an iframe\n\t// So, we allow :focus to pass through QSA all the time to avoid the IE error\n\t// See http://bugs.jquery.com/ticket/13378\n\trbuggyQSA = [];\n\n\tif ( (support.qsa = rnative.test( document.querySelectorAll )) ) {\n\t\t// Build QSA regex\n\t\t// Regex strategy adopted from Diego Perini\n\t\tassert(function( div ) {\n\t\t\t// Select is set to empty string on purpose\n\t\t\t// This is to test IE\'s treatment of not explicitly\n\t\t\t// setting a boolean content attribute,\n\t\t\t// since its presence should be enough\n\t\t\t// http://bugs.jquery.com/ticket/12359\n\t\t\tdocElem.appendChild( div ).innerHTML = "<a id=\'" + expando + "\'></a>" +\n\t\t\t\t"<select id=\'" + expando + "-\\r\\\\\' msallowcapture=\'\'>" +\n\t\t\t\t"<option selected=\'\'></option></select>";\n\n\t\t\t// Support: IE8, Opera 11-12.16\n\t\t\t// Nothing should be selected when empty strings follow ^= or $= or *=\n\t\t\t// The test attribute must be unknown in Opera but "safe" for WinRT\n\t\t\t// http://msdn.microsoft.com/en-us/library/ie/hh465388.aspx#attribute_section\n\t\t\tif ( div.querySelectorAll("[msallowcapture^=\'\']").length ) {\n\t\t\t\trbuggyQSA.push( "[*^$]=" + whitespace + "*(?:\'\'|\\"\\")" );\n\t\t\t}\n\n\t\t\t// Support: IE8\n\t\t\t// Boolean attributes and "value" are not treated correctly\n\t\t\tif ( !div.querySelectorAll("[selected]").length ) {\n\t\t\t\trbuggyQSA.push( "\\\\[" + whitespace + "*(?:value|" + booleans + ")" );\n\t\t\t}\n\n\t\t\t// Support: Chrome<29, Android<4.4, Safari<7.0+, iOS<7.0+, PhantomJS<1.9.8+\n\t\t\tif ( !div.querySelectorAll( "[id~=" + expando + "-]" ).length ) {\n\t\t\t\trbuggyQSA.push("~=");\n\t\t\t}\n\n\t\t\t// Webkit/Opera - :checked should return selected option elements\n\t\t\t// http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked\n\t\t\t// IE8 throws error here and will not see later tests\n\t\t\tif ( !div.querySelectorAll(":checked").length ) {\n\t\t\t\trbuggyQSA.push(":checked");\n\t\t\t}\n\n\t\t\t// Support: Safari 8+, iOS 8+\n\t\t\t// https://bugs.webkit.org/show_bug.cgi?id=136851\n\t\t\t// In-page `selector#id sibing-combinator selector` fails\n\t\t\tif ( !div.querySelectorAll( "a#" + expando + "+*" ).length ) {\n\t\t\t\trbuggyQSA.push(".#.+[+~]");\n\t\t\t}\n\t\t});\n\n\t\tassert(function( div ) {\n\t\t\t// Support: Windows 8 Native Apps\n\t\t\t// The type and name attributes are restricted during .innerHTML assignment\n\t\t\tvar input = document.createElement("input");\n\t\t\tinput.setAttribute( "type", "hidden" );\n\t\t\tdiv.appendChild( input ).setAttribute( "name", "D" );\n\n\t\t\t// Support: IE8\n\t\t\t// Enforce case-sensitivity of name attribute\n\t\t\tif ( div.querySelectorAll("[name=d]").length ) {\n\t\t\t\trbuggyQSA.push( "name" + whitespace + "*[*^$|!~]?=" );\n\t\t\t}\n\n\t\t\t// FF 3.5 - :enabled/:disabled and hidden elements (hidden elements are still enabled)\n\t\t\t// IE8 throws error here and will not see later tests\n\t\t\tif ( !div.querySelectorAll(":enabled").length ) {\n\t\t\t\trbuggyQSA.push( ":enabled", ":disabled" );\n\t\t\t}\n\n\t\t\t// Opera 10-11 does not throw on post-comma invalid pseudos\n\t\t\tdiv.querySelectorAll("*,:x");\n\t\t\trbuggyQSA.push(",.*:");\n\t\t});\n\t}\n\n\tif ( (support.matchesSelector = rnative.test( (matches = docElem.matches ||\n\t\tdocElem.webkitMatchesSelector ||\n\t\tdocElem.mozMatchesSelector ||\n\t\tdocElem.oMatchesSelector ||\n\t\tdocElem.msMatchesSelector) )) ) {\n\n\t\tassert(function( div ) {\n\t\t\t// Check to see if it\'s possible to do matchesSelector\n\t\t\t// on a disconnected node (IE 9)\n\t\t\tsupport.disconnectedMatch = matches.call( div, "div" );\n\n\t\t\t// This should fail with an exception\n\t\t\t// Gecko does not error, returns false instead\n\t\t\tmatches.call( div, "[s!=\'\']:x" );\n\t\t\trbuggyMatches.push( "!=", pseudos );\n\t\t});\n\t}\n\n\trbuggyQSA = rbuggyQSA.length && new RegExp( rbuggyQSA.join("|") );\n\trbuggyMatches = rbuggyMatches.length && new RegExp( rbuggyMatches.join("|") );\n\n\t/* Contains\n\t---------------------------------------------------------------------- */\n\thasCompare = rnative.test( docElem.compareDocumentPosition );\n\n\t// Element contains another\n\t// Purposefully self-exclusive\n\t// As in, an element does not contain itself\n\tcontains = hasCompare || rnative.test( docElem.contains ) ?\n\t\tfunction( a, b ) {\n\t\t\tvar adown = a.nodeType === 9 ? a.documentElement : a,\n\t\t\t\tbup = b && b.parentNode;\n\t\t\treturn a === bup || !!( bup && bup.nodeType === 1 && (\n\t\t\t\tadown.contains ?\n\t\t\t\t\tadown.contains( bup ) :\n\t\t\t\t\ta.compareDocumentPosition && a.compareDocumentPosition( bup ) & 16\n\t\t\t));\n\t\t} :\n\t\tfunction( a, b ) {\n\t\t\tif ( b ) {\n\t\t\t\twhile ( (b = b.parentNode) ) {\n\t\t\t\t\tif ( b === a ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\n\t/* Sorting\n\t---------------------------------------------------------------------- */\n\n\t// Document order sorting\n\tsortOrder = hasCompare ?\n\tfunction( a, b ) {\n\n\t\t// Flag for duplicate removal\n\t\tif ( a === b ) {\n\t\t\thasDuplicate = true;\n\t\t\treturn 0;\n\t\t}\n\n\t\t// Sort on method existence if only one input has compareDocumentPosition\n\t\tvar compare = !a.compareDocumentPosition - !b.compareDocumentPosition;\n\t\tif ( compare ) {\n\t\t\treturn compare;\n\t\t}\n\n\t\t// Calculate position if both inputs belong to the same document\n\t\tcompare = ( a.ownerDocument || a ) === ( b.ownerDocument || b ) ?\n\t\t\ta.compareDocumentPosition( b ) :\n\n\t\t\t// Otherwise we know they are disconnected\n\t\t\t1;\n\n\t\t// Disconnected nodes\n\t\tif ( compare & 1 ||\n\t\t\t(!support.sortDetached && b.compareDocumentPosition( a ) === compare) ) {\n\n\t\t\t// Choose the first element that is related to our preferred document\n\t\t\tif ( a === document || a.ownerDocument === preferredDoc && contains(preferredDoc, a) ) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tif ( b === document || b.ownerDocument === preferredDoc && contains(preferredDoc, b) ) {\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\t// Maintain original order\n\t\t\treturn sortInput ?\n\t\t\t\t( indexOf( sortInput, a ) - indexOf( sortInput, b ) ) :\n\t\t\t\t0;\n\t\t}\n\n\t\treturn compare & 4 ? -1 : 1;\n\t} :\n\tfunction( a, b ) {\n\t\t// Exit early if the nodes are identical\n\t\tif ( a === b ) {\n\t\t\thasDuplicate = true;\n\t\t\treturn 0;\n\t\t}\n\n\t\tvar cur,\n\t\t\ti = 0,\n\t\t\taup = a.parentNode,\n\t\t\tbup = b.parentNode,\n\t\t\tap = [ a ],\n\t\t\tbp = [ b ];\n\n\t\t// Parentless nodes are either documents or disconnected\n\t\tif ( !aup || !bup ) {\n\t\t\treturn a === document ? -1 :\n\t\t\t\tb === document ? 1 :\n\t\t\t\taup ? -1 :\n\t\t\t\tbup ? 1 :\n\t\t\t\tsortInput ?\n\t\t\t\t( indexOf( sortInput, a ) - indexOf( sortInput, b ) ) :\n\t\t\t\t0;\n\n\t\t// If the nodes are siblings, we can do a quick check\n\t\t} else if ( aup === bup ) {\n\t\t\treturn siblingCheck( a, b );\n\t\t}\n\n\t\t// Otherwise we need full lists of their ancestors for comparison\n\t\tcur = a;\n\t\twhile ( (cur = cur.parentNode) ) {\n\t\t\tap.unshift( cur );\n\t\t}\n\t\tcur = b;\n\t\twhile ( (cur = cur.parentNode) ) {\n\t\t\tbp.unshift( cur );\n\t\t}\n\n\t\t// Walk down the tree looking for a discrepancy\n\t\twhile ( ap[i] === bp[i] ) {\n\t\t\ti++;\n\t\t}\n\n\t\treturn i ?\n\t\t\t// Do a sibling check if the nodes have a common ancestor\n\t\t\tsiblingCheck( ap[i], bp[i] ) :\n\n\t\t\t// Otherwise nodes in our document sort first\n\t\t\tap[i] === preferredDoc ? -1 :\n\t\t\tbp[i] === preferredDoc ? 1 :\n\t\t\t0;\n\t};\n\n\treturn document;\n};\n\nSizzle.matches = function( expr, elements ) {\n\treturn Sizzle( expr, null, null, elements );\n};\n\nSizzle.matchesSelector = function( elem, expr ) {\n\t// Set document vars if needed\n\tif ( ( elem.ownerDocument || elem ) !== document ) {\n\t\tsetDocument( elem );\n\t}\n\n\t// Make sure that attribute selectors are quoted\n\texpr = expr.replace( rattributeQuotes, "=\'$1\']" );\n\n\tif ( support.matchesSelector && documentIsHTML &&\n\t\t!compilerCache[ expr + " " ] &&\n\t\t( !rbuggyMatches || !rbuggyMatches.test( expr ) ) &&\n\t\t( !rbuggyQSA     || !rbuggyQSA.test( expr ) ) ) {\n\n\t\ttry {\n\t\t\tvar ret = matches.call( elem, expr );\n\n\t\t\t// IE 9\'s matchesSelector returns false on disconnected nodes\n\t\t\tif ( ret || support.disconnectedMatch ||\n\t\t\t\t\t// As well, disconnected nodes are said to be in a document\n\t\t\t\t\t// fragment in IE 9\n\t\t\t\t\telem.document && elem.document.nodeType !== 11 ) {\n\t\t\t\treturn ret;\n\t\t\t}\n\t\t} catch (e) {}\n\t}\n\n\treturn Sizzle( expr, document, null, [ elem ] ).length > 0;\n};\n\nSizzle.contains = function( context, elem ) {\n\t// Set document vars if needed\n\tif ( ( context.ownerDocument || context ) !== document ) {\n\t\tsetDocument( context );\n\t}\n\treturn contains( context, elem );\n};\n\nSizzle.attr = function( elem, name ) {\n\t// Set document vars if needed\n\tif ( ( elem.ownerDocument || elem ) !== document ) {\n\t\tsetDocument( elem );\n\t}\n\n\tvar fn = Expr.attrHandle[ name.toLowerCase() ],\n\t\t// Don\'t get fooled by Object.prototype properties (jQuery #13807)\n\t\tval = fn && hasOwn.call( Expr.attrHandle, name.toLowerCase() ) ?\n\t\t\tfn( elem, name, !documentIsHTML ) :\n\t\t\tundefined;\n\n\treturn val !== undefined ?\n\t\tval :\n\t\tsupport.attributes || !documentIsHTML ?\n\t\t\telem.getAttribute( name ) :\n\t\t\t(val = elem.getAttributeNode(name)) && val.specified ?\n\t\t\t\tval.value :\n\t\t\t\tnull;\n};\n\nSizzle.error = function( msg ) {\n\tthrow new Error( "Syntax error, unrecognized expression: " + msg );\n};\n\n/**\n * Document sorting and removing duplicates\n * @param {ArrayLike} results\n */\nSizzle.uniqueSort = function( results ) {\n\tvar elem,\n\t\tduplicates = [],\n\t\tj = 0,\n\t\ti = 0;\n\n\t// Unless we *know* we can detect duplicates, assume their presence\n\thasDuplicate = !support.detectDuplicates;\n\tsortInput = !support.sortStable && results.slice( 0 );\n\tresults.sort( sortOrder );\n\n\tif ( hasDuplicate ) {\n\t\twhile ( (elem = results[i++]) ) {\n\t\t\tif ( elem === results[ i ] ) {\n\t\t\t\tj = duplicates.push( i );\n\t\t\t}\n\t\t}\n\t\twhile ( j-- ) {\n\t\t\tresults.splice( duplicates[ j ], 1 );\n\t\t}\n\t}\n\n\t// Clear input after sorting to release objects\n\t// See https://github.com/jquery/sizzle/pull/225\n\tsortInput = null;\n\n\treturn results;\n};\n\n/**\n * Utility function for retrieving the text value of an array of DOM nodes\n * @param {Array|Element} elem\n */\ngetText = Sizzle.getText = function( elem ) {\n\tvar node,\n\t\tret = "",\n\t\ti = 0,\n\t\tnodeType = elem.nodeType;\n\n\tif ( !nodeType ) {\n\t\t// If no nodeType, this is expected to be an array\n\t\twhile ( (node = elem[i++]) ) {\n\t\t\t// Do not traverse comment nodes\n\t\t\tret += getText( node );\n\t\t}\n\t} else if ( nodeType === 1 || nodeType === 9 || nodeType === 11 ) {\n\t\t// Use textContent for elements\n\t\t// innerText usage removed for consistency of new lines (jQuery #11153)\n\t\tif ( typeof elem.textContent === "string" ) {\n\t\t\treturn elem.textContent;\n\t\t} else {\n\t\t\t// Traverse its children\n\t\t\tfor ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {\n\t\t\t\tret += getText( elem );\n\t\t\t}\n\t\t}\n\t} else if ( nodeType === 3 || nodeType === 4 ) {\n\t\treturn elem.nodeValue;\n\t}\n\t// Do not include comment or processing instruction nodes\n\n\treturn ret;\n};\n\nExpr = Sizzle.selectors = {\n\n\t// Can be adjusted by the user\n\tcacheLength: 50,\n\n\tcreatePseudo: markFunction,\n\n\tmatch: matchExpr,\n\n\tattrHandle: {},\n\n\tfind: {},\n\n\trelative: {\n\t\t">": { dir: "parentNode", first: true },\n\t\t" ": { dir: "parentNode" },\n\t\t"+": { dir: "previousSibling", first: true },\n\t\t"~": { dir: "previousSibling" }\n\t},\n\n\tpreFilter: {\n\t\t"ATTR": function( match ) {\n\t\t\tmatch[1] = match[1].replace( runescape, funescape );\n\n\t\t\t// Move the given value to match[3] whether quoted or unquoted\n\t\t\tmatch[3] = ( match[3] || match[4] || match[5] || "" ).replace( runescape, funescape );\n\n\t\t\tif ( match[2] === "~=" ) {\n\t\t\t\tmatch[3] = " " + match[3] + " ";\n\t\t\t}\n\n\t\t\treturn match.slice( 0, 4 );\n\t\t},\n\n\t\t"CHILD": function( match ) {\n\t\t\t/* matches from matchExpr["CHILD"]\n\t\t\t\t1 type (only|nth|...)\n\t\t\t\t2 what (child|of-type)\n\t\t\t\t3 argument (even|odd|\\d*|\\d*n([+-]\\d+)?|...)\n\t\t\t\t4 xn-component of xn+y argument ([+-]?\\d*n|)\n\t\t\t\t5 sign of xn-component\n\t\t\t\t6 x of xn-component\n\t\t\t\t7 sign of y-component\n\t\t\t\t8 y of y-component\n\t\t\t*/\n\t\t\tmatch[1] = match[1].toLowerCase();\n\n\t\t\tif ( match[1].slice( 0, 3 ) === "nth" ) {\n\t\t\t\t// nth-* requires argument\n\t\t\t\tif ( !match[3] ) {\n\t\t\t\t\tSizzle.error( match[0] );\n\t\t\t\t}\n\n\t\t\t\t// numeric x and y parameters for Expr.filter.CHILD\n\t\t\t\t// remember that false/true cast respectively to 0/1\n\t\t\t\tmatch[4] = +( match[4] ? match[5] + (match[6] || 1) : 2 * ( match[3] === "even" || match[3] === "odd" ) );\n\t\t\t\tmatch[5] = +( ( match[7] + match[8] ) || match[3] === "odd" );\n\n\t\t\t// other types prohibit arguments\n\t\t\t} else if ( match[3] ) {\n\t\t\t\tSizzle.error( match[0] );\n\t\t\t}\n\n\t\t\treturn match;\n\t\t},\n\n\t\t"PSEUDO": function( match ) {\n\t\t\tvar excess,\n\t\t\t\tunquoted = !match[6] && match[2];\n\n\t\t\tif ( matchExpr["CHILD"].test( match[0] ) ) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\t// Accept quoted arguments as-is\n\t\t\tif ( match[3] ) {\n\t\t\t\tmatch[2] = match[4] || match[5] || "";\n\n\t\t\t// Strip excess characters from unquoted arguments\n\t\t\t} else if ( unquoted && rpseudo.test( unquoted ) &&\n\t\t\t\t// Get excess from tokenize (recursively)\n\t\t\t\t(excess = tokenize( unquoted, true )) &&\n\t\t\t\t// advance to the next closing parenthesis\n\t\t\t\t(excess = unquoted.indexOf( ")", unquoted.length - excess ) - unquoted.length) ) {\n\n\t\t\t\t// excess is a negative index\n\t\t\t\tmatch[0] = match[0].slice( 0, excess );\n\t\t\t\tmatch[2] = unquoted.slice( 0, excess );\n\t\t\t}\n\n\t\t\t// Return only captures needed by the pseudo filter method (type and argument)\n\t\t\treturn match.slice( 0, 3 );\n\t\t}\n\t},\n\n\tfilter: {\n\n\t\t"TAG": function( nodeNameSelector ) {\n\t\t\tvar nodeName = nodeNameSelector.replace( runescape, funescape ).toLowerCase();\n\t\t\treturn nodeNameSelector === "*" ?\n\t\t\t\tfunction() { return true; } :\n\t\t\t\tfunction( elem ) {\n\t\t\t\t\treturn elem.nodeName && elem.nodeName.toLowerCase() === nodeName;\n\t\t\t\t};\n\t\t},\n\n\t\t"CLASS": function( className ) {\n\t\t\tvar pattern = classCache[ className + " " ];\n\n\t\t\treturn pattern ||\n\t\t\t\t(pattern = new RegExp( "(^|" + whitespace + ")" + className + "(" + whitespace + "|$)" )) &&\n\t\t\t\tclassCache( className, function( elem ) {\n\t\t\t\t\treturn pattern.test( typeof elem.className === "string" && elem.className || typeof elem.getAttribute !== "undefined" && elem.getAttribute("class") || "" );\n\t\t\t\t});\n\t\t},\n\n\t\t"ATTR": function( name, operator, check ) {\n\t\t\treturn function( elem ) {\n\t\t\t\tvar result = Sizzle.attr( elem, name );\n\n\t\t\t\tif ( result == null ) {\n\t\t\t\t\treturn operator === "!=";\n\t\t\t\t}\n\t\t\t\tif ( !operator ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tresult += "";\n\n\t\t\t\treturn operator === "=" ? result === check :\n\t\t\t\t\toperator === "!=" ? result !== check :\n\t\t\t\t\toperator === "^=" ? check && result.indexOf( check ) === 0 :\n\t\t\t\t\toperator === "*=" ? check && result.indexOf( check ) > -1 :\n\t\t\t\t\toperator === "$=" ? check && result.slice( -check.length ) === check :\n\t\t\t\t\toperator === "~=" ? ( " " + result.replace( rwhitespace, " " ) + " " ).indexOf( check ) > -1 :\n\t\t\t\t\toperator === "|=" ? result === check || result.slice( 0, check.length + 1 ) === check + "-" :\n\t\t\t\t\tfalse;\n\t\t\t};\n\t\t},\n\n\t\t"CHILD": function( type, what, argument, first, last ) {\n\t\t\tvar simple = type.slice( 0, 3 ) !== "nth",\n\t\t\t\tforward = type.slice( -4 ) !== "last",\n\t\t\t\tofType = what === "of-type";\n\n\t\t\treturn first === 1 && last === 0 ?\n\n\t\t\t\t// Shortcut for :nth-*(n)\n\t\t\t\tfunction( elem ) {\n\t\t\t\t\treturn !!elem.parentNode;\n\t\t\t\t} :\n\n\t\t\t\tfunction( elem, context, xml ) {\n\t\t\t\t\tvar cache, uniqueCache, outerCache, node, nodeIndex, start,\n\t\t\t\t\t\tdir = simple !== forward ? "nextSibling" : "previousSibling",\n\t\t\t\t\t\tparent = elem.parentNode,\n\t\t\t\t\t\tname = ofType && elem.nodeName.toLowerCase(),\n\t\t\t\t\t\tuseCache = !xml && !ofType,\n\t\t\t\t\t\tdiff = false;\n\n\t\t\t\t\tif ( parent ) {\n\n\t\t\t\t\t\t// :(first|last|only)-(child|of-type)\n\t\t\t\t\t\tif ( simple ) {\n\t\t\t\t\t\t\twhile ( dir ) {\n\t\t\t\t\t\t\t\tnode = elem;\n\t\t\t\t\t\t\t\twhile ( (node = node[ dir ]) ) {\n\t\t\t\t\t\t\t\t\tif ( ofType ?\n\t\t\t\t\t\t\t\t\t\tnode.nodeName.toLowerCase() === name :\n\t\t\t\t\t\t\t\t\t\tnode.nodeType === 1 ) {\n\n\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// Reverse direction for :only-* (if we haven\'t yet done so)\n\t\t\t\t\t\t\t\tstart = dir = type === "only" && !start && "nextSibling";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstart = [ forward ? parent.firstChild : parent.lastChild ];\n\n\t\t\t\t\t\t// non-xml :nth-child(...) stores cache data on `parent`\n\t\t\t\t\t\tif ( forward && useCache ) {\n\n\t\t\t\t\t\t\t// Seek `elem` from a previously-cached index\n\n\t\t\t\t\t\t\t// ...in a gzip-friendly way\n\t\t\t\t\t\t\tnode = parent;\n\t\t\t\t\t\t\touterCache = node[ expando ] || (node[ expando ] = {});\n\n\t\t\t\t\t\t\t// Support: IE <9 only\n\t\t\t\t\t\t\t// Defend against cloned attroperties (jQuery gh-1709)\n\t\t\t\t\t\t\tuniqueCache = outerCache[ node.uniqueID ] ||\n\t\t\t\t\t\t\t\t(outerCache[ node.uniqueID ] = {});\n\n\t\t\t\t\t\t\tcache = uniqueCache[ type ] || [];\n\t\t\t\t\t\t\tnodeIndex = cache[ 0 ] === dirruns && cache[ 1 ];\n\t\t\t\t\t\t\tdiff = nodeIndex && cache[ 2 ];\n\t\t\t\t\t\t\tnode = nodeIndex && parent.childNodes[ nodeIndex ];\n\n\t\t\t\t\t\t\twhile ( (node = ++nodeIndex && node && node[ dir ] ||\n\n\t\t\t\t\t\t\t\t// Fallback to seeking `elem` from the start\n\t\t\t\t\t\t\t\t(diff = nodeIndex = 0) || start.pop()) ) {\n\n\t\t\t\t\t\t\t\t// When found, cache indexes on `parent` and break\n\t\t\t\t\t\t\t\tif ( node.nodeType === 1 && ++diff && node === elem ) {\n\t\t\t\t\t\t\t\t\tuniqueCache[ type ] = [ dirruns, nodeIndex, diff ];\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Use previously-cached element index if available\n\t\t\t\t\t\t\tif ( useCache ) {\n\t\t\t\t\t\t\t\t// ...in a gzip-friendly way\n\t\t\t\t\t\t\t\tnode = elem;\n\t\t\t\t\t\t\t\touterCache = node[ expando ] || (node[ expando ] = {});\n\n\t\t\t\t\t\t\t\t// Support: IE <9 only\n\t\t\t\t\t\t\t\t// Defend against cloned attroperties (jQuery gh-1709)\n\t\t\t\t\t\t\t\tuniqueCache = outerCache[ node.uniqueID ] ||\n\t\t\t\t\t\t\t\t\t(outerCache[ node.uniqueID ] = {});\n\n\t\t\t\t\t\t\t\tcache = uniqueCache[ type ] || [];\n\t\t\t\t\t\t\t\tnodeIndex = cache[ 0 ] === dirruns && cache[ 1 ];\n\t\t\t\t\t\t\t\tdiff = nodeIndex;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// xml :nth-child(...)\n\t\t\t\t\t\t\t// or :nth-last-child(...) or :nth(-last)?-of-type(...)\n\t\t\t\t\t\t\tif ( diff === false ) {\n\t\t\t\t\t\t\t\t// Use the same loop as above to seek `elem` from the start\n\t\t\t\t\t\t\t\twhile ( (node = ++nodeIndex && node && node[ dir ] ||\n\t\t\t\t\t\t\t\t\t(diff = nodeIndex = 0) || start.pop()) ) {\n\n\t\t\t\t\t\t\t\t\tif ( ( ofType ?\n\t\t\t\t\t\t\t\t\t\tnode.nodeName.toLowerCase() === name :\n\t\t\t\t\t\t\t\t\t\tnode.nodeType === 1 ) &&\n\t\t\t\t\t\t\t\t\t\t++diff ) {\n\n\t\t\t\t\t\t\t\t\t\t// Cache the index of each encountered element\n\t\t\t\t\t\t\t\t\t\tif ( useCache ) {\n\t\t\t\t\t\t\t\t\t\t\touterCache = node[ expando ] || (node[ expando ] = {});\n\n\t\t\t\t\t\t\t\t\t\t\t// Support: IE <9 only\n\t\t\t\t\t\t\t\t\t\t\t// Defend against cloned attroperties (jQuery gh-1709)\n\t\t\t\t\t\t\t\t\t\t\tuniqueCache = outerCache[ node.uniqueID ] ||\n\t\t\t\t\t\t\t\t\t\t\t\t(outerCache[ node.uniqueID ] = {});\n\n\t\t\t\t\t\t\t\t\t\t\tuniqueCache[ type ] = [ dirruns, diff ];\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tif ( node === elem ) {\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Incorporate the offset, then check against cycle size\n\t\t\t\t\t\tdiff -= last;\n\t\t\t\t\t\treturn diff === first || ( diff % first === 0 && diff / first >= 0 );\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t},\n\n\t\t"PSEUDO": function( pseudo, argument ) {\n\t\t\t// pseudo-class names are case-insensitive\n\t\t\t// http://www.w3.org/TR/selectors/#pseudo-classes\n\t\t\t// Prioritize by case sensitivity in case custom pseudos are added with uppercase letters\n\t\t\t// Remember that setFilters inherits from pseudos\n\t\t\tvar args,\n\t\t\t\tfn = Expr.pseudos[ pseudo ] || Expr.setFilters[ pseudo.toLowerCase() ] ||\n\t\t\t\t\tSizzle.error( "unsupported pseudo: " + pseudo );\n\n\t\t\t// The user may use createPseudo to indicate that\n\t\t\t// arguments are needed to create the filter function\n\t\t\t// just as Sizzle does\n\t\t\tif ( fn[ expando ] ) {\n\t\t\t\treturn fn( argument );\n\t\t\t}\n\n\t\t\t// But maintain support for old signatures\n\t\t\tif ( fn.length > 1 ) {\n\t\t\t\targs = [ pseudo, pseudo, "", argument ];\n\t\t\t\treturn Expr.setFilters.hasOwnProperty( pseudo.toLowerCase() ) ?\n\t\t\t\t\tmarkFunction(function( seed, matches ) {\n\t\t\t\t\t\tvar idx,\n\t\t\t\t\t\t\tmatched = fn( seed, argument ),\n\t\t\t\t\t\t\ti = matched.length;\n\t\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\t\tidx = indexOf( seed, matched[i] );\n\t\t\t\t\t\t\tseed[ idx ] = !( matches[ idx ] = matched[i] );\n\t\t\t\t\t\t}\n\t\t\t\t\t}) :\n\t\t\t\t\tfunction( elem ) {\n\t\t\t\t\t\treturn fn( elem, 0, args );\n\t\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn fn;\n\t\t}\n\t},\n\n\tpseudos: {\n\t\t// Potentially complex pseudos\n\t\t"not": markFunction(function( selector ) {\n\t\t\t// Trim the selector passed to compile\n\t\t\t// to avoid treating leading and trailing\n\t\t\t// spaces as combinators\n\t\t\tvar input = [],\n\t\t\t\tresults = [],\n\t\t\t\tmatcher = compile( selector.replace( rtrim, "$1" ) );\n\n\t\t\treturn matcher[ expando ] ?\n\t\t\t\tmarkFunction(function( seed, matches, context, xml ) {\n\t\t\t\t\tvar elem,\n\t\t\t\t\t\tunmatched = matcher( seed, null, xml, [] ),\n\t\t\t\t\t\ti = seed.length;\n\n\t\t\t\t\t// Match elements unmatched by `matcher`\n\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\tif ( (elem = unmatched[i]) ) {\n\t\t\t\t\t\t\tseed[i] = !(matches[i] = elem);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}) :\n\t\t\t\tfunction( elem, context, xml ) {\n\t\t\t\t\tinput[0] = elem;\n\t\t\t\t\tmatcher( input, null, xml, results );\n\t\t\t\t\t// Don\'t keep the element (issue #299)\n\t\t\t\t\tinput[0] = null;\n\t\t\t\t\treturn !results.pop();\n\t\t\t\t};\n\t\t}),\n\n\t\t"has": markFunction(function( selector ) {\n\t\t\treturn function( elem ) {\n\t\t\t\treturn Sizzle( selector, elem ).length > 0;\n\t\t\t};\n\t\t}),\n\n\t\t"contains": markFunction(function( text ) {\n\t\t\ttext = text.replace( runescape, funescape );\n\t\t\treturn function( elem ) {\n\t\t\t\treturn ( elem.textContent || elem.innerText || getText( elem ) ).indexOf( text ) > -1;\n\t\t\t};\n\t\t}),\n\n\t\t// "Whether an element is represented by a :lang() selector\n\t\t// is based solely on the element\'s language value\n\t\t// being equal to the identifier C,\n\t\t// or beginning with the identifier C immediately followed by "-".\n\t\t// The matching of C against the element\'s language value is performed case-insensitively.\n\t\t// The identifier C does not have to be a valid language name."\n\t\t// http://www.w3.org/TR/selectors/#lang-pseudo\n\t\t"lang": markFunction( function( lang ) {\n\t\t\t// lang value must be a valid identifier\n\t\t\tif ( !ridentifier.test(lang || "") ) {\n\t\t\t\tSizzle.error( "unsupported lang: " + lang );\n\t\t\t}\n\t\t\tlang = lang.replace( runescape, funescape ).toLowerCase();\n\t\t\treturn function( elem ) {\n\t\t\t\tvar elemLang;\n\t\t\t\tdo {\n\t\t\t\t\tif ( (elemLang = documentIsHTML ?\n\t\t\t\t\t\telem.lang :\n\t\t\t\t\t\telem.getAttribute("xml:lang") || elem.getAttribute("lang")) ) {\n\n\t\t\t\t\t\telemLang = elemLang.toLowerCase();\n\t\t\t\t\t\treturn elemLang === lang || elemLang.indexOf( lang + "-" ) === 0;\n\t\t\t\t\t}\n\t\t\t\t} while ( (elem = elem.parentNode) && elem.nodeType === 1 );\n\t\t\t\treturn false;\n\t\t\t};\n\t\t}),\n\n\t\t// Miscellaneous\n\t\t"target": function( elem ) {\n\t\t\tvar hash = window.location && window.location.hash;\n\t\t\treturn hash && hash.slice( 1 ) === elem.id;\n\t\t},\n\n\t\t"root": function( elem ) {\n\t\t\treturn elem === docElem;\n\t\t},\n\n\t\t"focus": function( elem ) {\n\t\t\treturn elem === document.activeElement && (!document.hasFocus || document.hasFocus()) && !!(elem.type || elem.href || ~elem.tabIndex);\n\t\t},\n\n\t\t// Boolean properties\n\t\t"enabled": function( elem ) {\n\t\t\treturn elem.disabled === false;\n\t\t},\n\n\t\t"disabled": function( elem ) {\n\t\t\treturn elem.disabled === true;\n\t\t},\n\n\t\t"checked": function( elem ) {\n\t\t\t// In CSS3, :checked should return both checked and selected elements\n\t\t\t// http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked\n\t\t\tvar nodeName = elem.nodeName.toLowerCase();\n\t\t\treturn (nodeName === "input" && !!elem.checked) || (nodeName === "option" && !!elem.selected);\n\t\t},\n\n\t\t"selected": function( elem ) {\n\t\t\t// Accessing this property makes selected-by-default\n\t\t\t// options in Safari work properly\n\t\t\tif ( elem.parentNode ) {\n\t\t\t\telem.parentNode.selectedIndex;\n\t\t\t}\n\n\t\t\treturn elem.selected === true;\n\t\t},\n\n\t\t// Contents\n\t\t"empty": function( elem ) {\n\t\t\t// http://www.w3.org/TR/selectors/#empty-pseudo\n\t\t\t// :empty is negated by element (1) or content nodes (text: 3; cdata: 4; entity ref: 5),\n\t\t\t//   but not by others (comment: 8; processing instruction: 7; etc.)\n\t\t\t// nodeType < 6 works because attributes (2) do not appear as children\n\t\t\tfor ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {\n\t\t\t\tif ( elem.nodeType < 6 ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\n\t\t"parent": function( elem ) {\n\t\t\treturn !Expr.pseudos["empty"]( elem );\n\t\t},\n\n\t\t// Element/input types\n\t\t"header": function( elem ) {\n\t\t\treturn rheader.test( elem.nodeName );\n\t\t},\n\n\t\t"input": function( elem ) {\n\t\t\treturn rinputs.test( elem.nodeName );\n\t\t},\n\n\t\t"button": function( elem ) {\n\t\t\tvar name = elem.nodeName.toLowerCase();\n\t\t\treturn name === "input" && elem.type === "button" || name === "button";\n\t\t},\n\n\t\t"text": function( elem ) {\n\t\t\tvar attr;\n\t\t\treturn elem.nodeName.toLowerCase() === "input" &&\n\t\t\t\telem.type === "text" &&\n\n\t\t\t\t// Support: IE<8\n\t\t\t\t// New HTML5 attribute values (e.g., "search") appear with elem.type === "text"\n\t\t\t\t( (attr = elem.getAttribute("type")) == null || attr.toLowerCase() === "text" );\n\t\t},\n\n\t\t// Position-in-collection\n\t\t"first": createPositionalPseudo(function() {\n\t\t\treturn [ 0 ];\n\t\t}),\n\n\t\t"last": createPositionalPseudo(function( matchIndexes, length ) {\n\t\t\treturn [ length - 1 ];\n\t\t}),\n\n\t\t"eq": createPositionalPseudo(function( matchIndexes, length, argument ) {\n\t\t\treturn [ argument < 0 ? argument + length : argument ];\n\t\t}),\n\n\t\t"even": createPositionalPseudo(function( matchIndexes, length ) {\n\t\t\tvar i = 0;\n\t\t\tfor ( ; i < length; i += 2 ) {\n\t\t\t\tmatchIndexes.push( i );\n\t\t\t}\n\t\t\treturn matchIndexes;\n\t\t}),\n\n\t\t"odd": createPositionalPseudo(function( matchIndexes, length ) {\n\t\t\tvar i = 1;\n\t\t\tfor ( ; i < length; i += 2 ) {\n\t\t\t\tmatchIndexes.push( i );\n\t\t\t}\n\t\t\treturn matchIndexes;\n\t\t}),\n\n\t\t"lt": createPositionalPseudo(function( matchIndexes, length, argument ) {\n\t\t\tvar i = argument < 0 ? argument + length : argument;\n\t\t\tfor ( ; --i >= 0; ) {\n\t\t\t\tmatchIndexes.push( i );\n\t\t\t}\n\t\t\treturn matchIndexes;\n\t\t}),\n\n\t\t"gt": createPositionalPseudo(function( matchIndexes, length, argument ) {\n\t\t\tvar i = argument < 0 ? argument + length : argument;\n\t\t\tfor ( ; ++i < length; ) {\n\t\t\t\tmatchIndexes.push( i );\n\t\t\t}\n\t\t\treturn matchIndexes;\n\t\t})\n\t}\n};\n\nExpr.pseudos["nth"] = Expr.pseudos["eq"];\n\n// Add button/input type pseudos\nfor ( i in { radio: true, checkbox: true, file: true, password: true, image: true } ) {\n\tExpr.pseudos[ i ] = createInputPseudo( i );\n}\nfor ( i in { submit: true, reset: true } ) {\n\tExpr.pseudos[ i ] = createButtonPseudo( i );\n}\n\n// Easy API for creating new setFilters\nfunction setFilters() {}\nsetFilters.prototype = Expr.filters = Expr.pseudos;\nExpr.setFilters = new setFilters();\n\ntokenize = Sizzle.tokenize = function( selector, parseOnly ) {\n\tvar matched, match, tokens, type,\n\t\tsoFar, groups, preFilters,\n\t\tcached = tokenCache[ selector + " " ];\n\n\tif ( cached ) {\n\t\treturn parseOnly ? 0 : cached.slice( 0 );\n\t}\n\n\tsoFar = selector;\n\tgroups = [];\n\tpreFilters = Expr.preFilter;\n\n\twhile ( soFar ) {\n\n\t\t// Comma and first run\n\t\tif ( !matched || (match = rcomma.exec( soFar )) ) {\n\t\t\tif ( match ) {\n\t\t\t\t// Don\'t consume trailing commas as valid\n\t\t\t\tsoFar = soFar.slice( match[0].length ) || soFar;\n\t\t\t}\n\t\t\tgroups.push( (tokens = []) );\n\t\t}\n\n\t\tmatched = false;\n\n\t\t// Combinators\n\t\tif ( (match = rcombinators.exec( soFar )) ) {\n\t\t\tmatched = match.shift();\n\t\t\ttokens.push({\n\t\t\t\tvalue: matched,\n\t\t\t\t// Cast descendant combinators to space\n\t\t\t\ttype: match[0].replace( rtrim, " " )\n\t\t\t});\n\t\t\tsoFar = soFar.slice( matched.length );\n\t\t}\n\n\t\t// Filters\n\t\tfor ( type in Expr.filter ) {\n\t\t\tif ( (match = matchExpr[ type ].exec( soFar )) && (!preFilters[ type ] ||\n\t\t\t\t(match = preFilters[ type ]( match ))) ) {\n\t\t\t\tmatched = match.shift();\n\t\t\t\ttokens.push({\n\t\t\t\t\tvalue: matched,\n\t\t\t\t\ttype: type,\n\t\t\t\t\tmatches: match\n\t\t\t\t});\n\t\t\t\tsoFar = soFar.slice( matched.length );\n\t\t\t}\n\t\t}\n\n\t\tif ( !matched ) {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t// Return the length of the invalid excess\n\t// if we\'re just parsing\n\t// Otherwise, throw an error or return tokens\n\treturn parseOnly ?\n\t\tsoFar.length :\n\t\tsoFar ?\n\t\t\tSizzle.error( selector ) :\n\t\t\t// Cache the tokens\n\t\t\ttokenCache( selector, groups ).slice( 0 );\n};\n\nfunction toSelector( tokens ) {\n\tvar i = 0,\n\t\tlen = tokens.length,\n\t\tselector = "";\n\tfor ( ; i < len; i++ ) {\n\t\tselector += tokens[i].value;\n\t}\n\treturn selector;\n}\n\nfunction addCombinator( matcher, combinator, base ) {\n\tvar dir = combinator.dir,\n\t\tcheckNonElements = base && dir === "parentNode",\n\t\tdoneName = done++;\n\n\treturn combinator.first ?\n\t\t// Check against closest ancestor/preceding element\n\t\tfunction( elem, context, xml ) {\n\t\t\twhile ( (elem = elem[ dir ]) ) {\n\t\t\t\tif ( elem.nodeType === 1 || checkNonElements ) {\n\t\t\t\t\treturn matcher( elem, context, xml );\n\t\t\t\t}\n\t\t\t}\n\t\t} :\n\n\t\t// Check against all ancestor/preceding elements\n\t\tfunction( elem, context, xml ) {\n\t\t\tvar oldCache, uniqueCache, outerCache,\n\t\t\t\tnewCache = [ dirruns, doneName ];\n\n\t\t\t// We can\'t set arbitrary data on XML nodes, so they don\'t benefit from combinator caching\n\t\t\tif ( xml ) {\n\t\t\t\twhile ( (elem = elem[ dir ]) ) {\n\t\t\t\t\tif ( elem.nodeType === 1 || checkNonElements ) {\n\t\t\t\t\t\tif ( matcher( elem, context, xml ) ) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\twhile ( (elem = elem[ dir ]) ) {\n\t\t\t\t\tif ( elem.nodeType === 1 || checkNonElements ) {\n\t\t\t\t\t\touterCache = elem[ expando ] || (elem[ expando ] = {});\n\n\t\t\t\t\t\t// Support: IE <9 only\n\t\t\t\t\t\t// Defend against cloned attroperties (jQuery gh-1709)\n\t\t\t\t\t\tuniqueCache = outerCache[ elem.uniqueID ] || (outerCache[ elem.uniqueID ] = {});\n\n\t\t\t\t\t\tif ( (oldCache = uniqueCache[ dir ]) &&\n\t\t\t\t\t\t\toldCache[ 0 ] === dirruns && oldCache[ 1 ] === doneName ) {\n\n\t\t\t\t\t\t\t// Assign to newCache so results back-propagate to previous elements\n\t\t\t\t\t\t\treturn (newCache[ 2 ] = oldCache[ 2 ]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Reuse newcache so results back-propagate to previous elements\n\t\t\t\t\t\t\tuniqueCache[ dir ] = newCache;\n\n\t\t\t\t\t\t\t// A match means we\'re done; a fail means we have to keep checking\n\t\t\t\t\t\t\tif ( (newCache[ 2 ] = matcher( elem, context, xml )) ) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n}\n\nfunction elementMatcher( matchers ) {\n\treturn matchers.length > 1 ?\n\t\tfunction( elem, context, xml ) {\n\t\t\tvar i = matchers.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( !matchers[i]( elem, context, xml ) ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t} :\n\t\tmatchers[0];\n}\n\nfunction multipleContexts( selector, contexts, results ) {\n\tvar i = 0,\n\t\tlen = contexts.length;\n\tfor ( ; i < len; i++ ) {\n\t\tSizzle( selector, contexts[i], results );\n\t}\n\treturn results;\n}\n\nfunction condense( unmatched, map, filter, context, xml ) {\n\tvar elem,\n\t\tnewUnmatched = [],\n\t\ti = 0,\n\t\tlen = unmatched.length,\n\t\tmapped = map != null;\n\n\tfor ( ; i < len; i++ ) {\n\t\tif ( (elem = unmatched[i]) ) {\n\t\t\tif ( !filter || filter( elem, context, xml ) ) {\n\t\t\t\tnewUnmatched.push( elem );\n\t\t\t\tif ( mapped ) {\n\t\t\t\t\tmap.push( i );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn newUnmatched;\n}\n\nfunction setMatcher( preFilter, selector, matcher, postFilter, postFinder, postSelector ) {\n\tif ( postFilter && !postFilter[ expando ] ) {\n\t\tpostFilter = setMatcher( postFilter );\n\t}\n\tif ( postFinder && !postFinder[ expando ] ) {\n\t\tpostFinder = setMatcher( postFinder, postSelector );\n\t}\n\treturn markFunction(function( seed, results, context, xml ) {\n\t\tvar temp, i, elem,\n\t\t\tpreMap = [],\n\t\t\tpostMap = [],\n\t\t\tpreexisting = results.length,\n\n\t\t\t// Get initial elements from seed or context\n\t\t\telems = seed || multipleContexts( selector || "*", context.nodeType ? [ context ] : context, [] ),\n\n\t\t\t// Prefilter to get matcher input, preserving a map for seed-results synchronization\n\t\t\tmatcherIn = preFilter && ( seed || !selector ) ?\n\t\t\t\tcondense( elems, preMap, preFilter, context, xml ) :\n\t\t\t\telems,\n\n\t\t\tmatcherOut = matcher ?\n\t\t\t\t// If we have a postFinder, or filtered seed, or non-seed postFilter or preexisting results,\n\t\t\t\tpostFinder || ( seed ? preFilter : preexisting || postFilter ) ?\n\n\t\t\t\t\t// ...intermediate processing is necessary\n\t\t\t\t\t[] :\n\n\t\t\t\t\t// ...otherwise use results directly\n\t\t\t\t\tresults :\n\t\t\t\tmatcherIn;\n\n\t\t// Find primary matches\n\t\tif ( matcher ) {\n\t\t\tmatcher( matcherIn, matcherOut, context, xml );\n\t\t}\n\n\t\t// Apply postFilter\n\t\tif ( postFilter ) {\n\t\t\ttemp = condense( matcherOut, postMap );\n\t\t\tpostFilter( temp, [], context, xml );\n\n\t\t\t// Un-match failing elements by moving them back to matcherIn\n\t\t\ti = temp.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( (elem = temp[i]) ) {\n\t\t\t\t\tmatcherOut[ postMap[i] ] = !(matcherIn[ postMap[i] ] = elem);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ( seed ) {\n\t\t\tif ( postFinder || preFilter ) {\n\t\t\t\tif ( postFinder ) {\n\t\t\t\t\t// Get the final matcherOut by condensing this intermediate into postFinder contexts\n\t\t\t\t\ttemp = [];\n\t\t\t\t\ti = matcherOut.length;\n\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\tif ( (elem = matcherOut[i]) ) {\n\t\t\t\t\t\t\t// Restore matcherIn since elem is not yet a final match\n\t\t\t\t\t\t\ttemp.push( (matcherIn[i] = elem) );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tpostFinder( null, (matcherOut = []), temp, xml );\n\t\t\t\t}\n\n\t\t\t\t// Move matched elements from seed to results to keep them synchronized\n\t\t\t\ti = matcherOut.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tif ( (elem = matcherOut[i]) &&\n\t\t\t\t\t\t(temp = postFinder ? indexOf( seed, elem ) : preMap[i]) > -1 ) {\n\n\t\t\t\t\t\tseed[temp] = !(results[temp] = elem);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t// Add elements to results, through postFinder if defined\n\t\t} else {\n\t\t\tmatcherOut = condense(\n\t\t\t\tmatcherOut === results ?\n\t\t\t\t\tmatcherOut.splice( preexisting, matcherOut.length ) :\n\t\t\t\t\tmatcherOut\n\t\t\t);\n\t\t\tif ( postFinder ) {\n\t\t\t\tpostFinder( null, results, matcherOut, xml );\n\t\t\t} else {\n\t\t\t\tpush.apply( results, matcherOut );\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction matcherFromTokens( tokens ) {\n\tvar checkContext, matcher, j,\n\t\tlen = tokens.length,\n\t\tleadingRelative = Expr.relative[ tokens[0].type ],\n\t\timplicitRelative = leadingRelative || Expr.relative[" "],\n\t\ti = leadingRelative ? 1 : 0,\n\n\t\t// The foundational matcher ensures that elements are reachable from top-level context(s)\n\t\tmatchContext = addCombinator( function( elem ) {\n\t\t\treturn elem === checkContext;\n\t\t}, implicitRelative, true ),\n\t\tmatchAnyContext = addCombinator( function( elem ) {\n\t\t\treturn indexOf( checkContext, elem ) > -1;\n\t\t}, implicitRelative, true ),\n\t\tmatchers = [ function( elem, context, xml ) {\n\t\t\tvar ret = ( !leadingRelative && ( xml || context !== outermostContext ) ) || (\n\t\t\t\t(checkContext = context).nodeType ?\n\t\t\t\t\tmatchContext( elem, context, xml ) :\n\t\t\t\t\tmatchAnyContext( elem, context, xml ) );\n\t\t\t// Avoid hanging onto element (issue #299)\n\t\t\tcheckContext = null;\n\t\t\treturn ret;\n\t\t} ];\n\n\tfor ( ; i < len; i++ ) {\n\t\tif ( (matcher = Expr.relative[ tokens[i].type ]) ) {\n\t\t\tmatchers = [ addCombinator(elementMatcher( matchers ), matcher) ];\n\t\t} else {\n\t\t\tmatcher = Expr.filter[ tokens[i].type ].apply( null, tokens[i].matches );\n\n\t\t\t// Return special upon seeing a positional matcher\n\t\t\tif ( matcher[ expando ] ) {\n\t\t\t\t// Find the next relative operator (if any) for proper handling\n\t\t\t\tj = ++i;\n\t\t\t\tfor ( ; j < len; j++ ) {\n\t\t\t\t\tif ( Expr.relative[ tokens[j].type ] ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn setMatcher(\n\t\t\t\t\ti > 1 && elementMatcher( matchers ),\n\t\t\t\t\ti > 1 && toSelector(\n\t\t\t\t\t\t// If the preceding token was a descendant combinator, insert an implicit any-element `*`\n\t\t\t\t\t\ttokens.slice( 0, i - 1 ).concat({ value: tokens[ i - 2 ].type === " " ? "*" : "" })\n\t\t\t\t\t).replace( rtrim, "$1" ),\n\t\t\t\t\tmatcher,\n\t\t\t\t\ti < j && matcherFromTokens( tokens.slice( i, j ) ),\n\t\t\t\t\tj < len && matcherFromTokens( (tokens = tokens.slice( j )) ),\n\t\t\t\t\tj < len && toSelector( tokens )\n\t\t\t\t);\n\t\t\t}\n\t\t\tmatchers.push( matcher );\n\t\t}\n\t}\n\n\treturn elementMatcher( matchers );\n}\n\nfunction matcherFromGroupMatchers( elementMatchers, setMatchers ) {\n\tvar bySet = setMatchers.length > 0,\n\t\tbyElement = elementMatchers.length > 0,\n\t\tsuperMatcher = function( seed, context, xml, results, outermost ) {\n\t\t\tvar elem, j, matcher,\n\t\t\t\tmatchedCount = 0,\n\t\t\t\ti = "0",\n\t\t\t\tunmatched = seed && [],\n\t\t\t\tsetMatched = [],\n\t\t\t\tcontextBackup = outermostContext,\n\t\t\t\t// We must always have either seed elements or outermost context\n\t\t\t\telems = seed || byElement && Expr.find["TAG"]( "*", outermost ),\n\t\t\t\t// Use integer dirruns iff this is the outermost matcher\n\t\t\t\tdirrunsUnique = (dirruns += contextBackup == null ? 1 : Math.random() || 0.1),\n\t\t\t\tlen = elems.length;\n\n\t\t\tif ( outermost ) {\n\t\t\t\toutermostContext = context === document || context || outermost;\n\t\t\t}\n\n\t\t\t// Add elements passing elementMatchers directly to results\n\t\t\t// Support: IE<9, Safari\n\t\t\t// Tolerate NodeList properties (IE: "length"; Safari: <number>) matching elements by id\n\t\t\tfor ( ; i !== len && (elem = elems[i]) != null; i++ ) {\n\t\t\t\tif ( byElement && elem ) {\n\t\t\t\t\tj = 0;\n\t\t\t\t\tif ( !context && elem.ownerDocument !== document ) {\n\t\t\t\t\t\tsetDocument( elem );\n\t\t\t\t\t\txml = !documentIsHTML;\n\t\t\t\t\t}\n\t\t\t\t\twhile ( (matcher = elementMatchers[j++]) ) {\n\t\t\t\t\t\tif ( matcher( elem, context || document, xml) ) {\n\t\t\t\t\t\t\tresults.push( elem );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif ( outermost ) {\n\t\t\t\t\t\tdirruns = dirrunsUnique;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Track unmatched elements for set filters\n\t\t\t\tif ( bySet ) {\n\t\t\t\t\t// They will have gone through all possible matchers\n\t\t\t\t\tif ( (elem = !matcher && elem) ) {\n\t\t\t\t\t\tmatchedCount--;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Lengthen the array for every element, matched or not\n\t\t\t\t\tif ( seed ) {\n\t\t\t\t\t\tunmatched.push( elem );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// `i` is now the count of elements visited above, and adding it to `matchedCount`\n\t\t\t// makes the latter nonnegative.\n\t\t\tmatchedCount += i;\n\n\t\t\t// Apply set filters to unmatched elements\n\t\t\t// NOTE: This can be skipped if there are no unmatched elements (i.e., `matchedCount`\n\t\t\t// equals `i`), unless we didn\'t visit _any_ elements in the above loop because we have\n\t\t\t// no element matchers and no seed.\n\t\t\t// Incrementing an initially-string "0" `i` allows `i` to remain a string only in that\n\t\t\t// case, which will result in a "00" `matchedCount` that differs from `i` but is also\n\t\t\t// numerically zero.\n\t\t\tif ( bySet && i !== matchedCount ) {\n\t\t\t\tj = 0;\n\t\t\t\twhile ( (matcher = setMatchers[j++]) ) {\n\t\t\t\t\tmatcher( unmatched, setMatched, context, xml );\n\t\t\t\t}\n\n\t\t\t\tif ( seed ) {\n\t\t\t\t\t// Reintegrate element matches to eliminate the need for sorting\n\t\t\t\t\tif ( matchedCount > 0 ) {\n\t\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\t\tif ( !(unmatched[i] || setMatched[i]) ) {\n\t\t\t\t\t\t\t\tsetMatched[i] = pop.call( results );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Discard index placeholder values to get only actual matches\n\t\t\t\t\tsetMatched = condense( setMatched );\n\t\t\t\t}\n\n\t\t\t\t// Add matches to results\n\t\t\t\tpush.apply( results, setMatched );\n\n\t\t\t\t// Seedless set matches succeeding multiple successful matchers stipulate sorting\n\t\t\t\tif ( outermost && !seed && setMatched.length > 0 &&\n\t\t\t\t\t( matchedCount + setMatchers.length ) > 1 ) {\n\n\t\t\t\t\tSizzle.uniqueSort( results );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Override manipulation of globals by nested matchers\n\t\t\tif ( outermost ) {\n\t\t\t\tdirruns = dirrunsUnique;\n\t\t\t\toutermostContext = contextBackup;\n\t\t\t}\n\n\t\t\treturn unmatched;\n\t\t};\n\n\treturn bySet ?\n\t\tmarkFunction( superMatcher ) :\n\t\tsuperMatcher;\n}\n\ncompile = Sizzle.compile = function( selector, match /* Internal Use Only */ ) {\n\tvar i,\n\t\tsetMatchers = [],\n\t\telementMatchers = [],\n\t\tcached = compilerCache[ selector + " " ];\n\n\tif ( !cached ) {\n\t\t// Generate a function of recursive functions that can be used to check each element\n\t\tif ( !match ) {\n\t\t\tmatch = tokenize( selector );\n\t\t}\n\t\ti = match.length;\n\t\twhile ( i-- ) {\n\t\t\tcached = matcherFromTokens( match[i] );\n\t\t\tif ( cached[ expando ] ) {\n\t\t\t\tsetMatchers.push( cached );\n\t\t\t} else {\n\t\t\t\telementMatchers.push( cached );\n\t\t\t}\n\t\t}\n\n\t\t// Cache the compiled function\n\t\tcached = compilerCache( selector, matcherFromGroupMatchers( elementMatchers, setMatchers ) );\n\n\t\t// Save selector and tokenization\n\t\tcached.selector = selector;\n\t}\n\treturn cached;\n};\n\n/**\n * A low-level selection function that works with Sizzle\'s compiled\n *  selector functions\n * @param {String|Function} selector A selector or a pre-compiled\n *  selector function built with Sizzle.compile\n * @param {Element} context\n * @param {Array} [results]\n * @param {Array} [seed] A set of elements to match against\n */\nselect = Sizzle.select = function( selector, context, results, seed ) {\n\tvar i, tokens, token, type, find,\n\t\tcompiled = typeof selector === "function" && selector,\n\t\tmatch = !seed && tokenize( (selector = compiled.selector || selector) );\n\n\tresults = results || [];\n\n\t// Try to minimize operations if there is only one selector in the list and no seed\n\t// (the latter of which guarantees us context)\n\tif ( match.length === 1 ) {\n\n\t\t// Reduce context if the leading compound selector is an ID\n\t\ttokens = match[0] = match[0].slice( 0 );\n\t\tif ( tokens.length > 2 && (token = tokens[0]).type === "ID" &&\n\t\t\t\tsupport.getById && context.nodeType === 9 && documentIsHTML &&\n\t\t\t\tExpr.relative[ tokens[1].type ] ) {\n\n\t\t\tcontext = ( Expr.find["ID"]( token.matches[0].replace(runescape, funescape), context ) || [] )[0];\n\t\t\tif ( !context ) {\n\t\t\t\treturn results;\n\n\t\t\t// Precompiled matchers will still verify ancestry, so step up a level\n\t\t\t} else if ( compiled ) {\n\t\t\t\tcontext = context.parentNode;\n\t\t\t}\n\n\t\t\tselector = selector.slice( tokens.shift().value.length );\n\t\t}\n\n\t\t// Fetch a seed set for right-to-left matching\n\t\ti = matchExpr["needsContext"].test( selector ) ? 0 : tokens.length;\n\t\twhile ( i-- ) {\n\t\t\ttoken = tokens[i];\n\n\t\t\t// Abort if we hit a combinator\n\t\t\tif ( Expr.relative[ (type = token.type) ] ) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif ( (find = Expr.find[ type ]) ) {\n\t\t\t\t// Search, expanding context for leading sibling combinators\n\t\t\t\tif ( (seed = find(\n\t\t\t\t\ttoken.matches[0].replace( runescape, funescape ),\n\t\t\t\t\trsibling.test( tokens[0].type ) && testContext( context.parentNode ) || context\n\t\t\t\t)) ) {\n\n\t\t\t\t\t// If seed is empty or no tokens remain, we can return early\n\t\t\t\t\ttokens.splice( i, 1 );\n\t\t\t\t\tselector = seed.length && toSelector( tokens );\n\t\t\t\t\tif ( !selector ) {\n\t\t\t\t\t\tpush.apply( results, seed );\n\t\t\t\t\t\treturn results;\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Compile and execute a filtering function if one is not provided\n\t// Provide `match` to avoid retokenization if we modified the selector above\n\t( compiled || compile( selector, match ) )(\n\t\tseed,\n\t\tcontext,\n\t\t!documentIsHTML,\n\t\tresults,\n\t\t!context || rsibling.test( selector ) && testContext( context.parentNode ) || context\n\t);\n\treturn results;\n};\n\n// One-time assignments\n\n// Sort stability\nsupport.sortStable = expando.split("").sort( sortOrder ).join("") === expando;\n\n// Support: Chrome 14-35+\n// Always assume duplicates if they aren\'t passed to the comparison function\nsupport.detectDuplicates = !!hasDuplicate;\n\n// Initialize against the default document\nsetDocument();\n\n// Support: Webkit<537.32 - Safari 6.0.3/Chrome 25 (fixed in Chrome 27)\n// Detached nodes confoundingly follow *each other*\nsupport.sortDetached = assert(function( div1 ) {\n\t// Should return 1, but returns 4 (following)\n\treturn div1.compareDocumentPosition( document.createElement("div") ) & 1;\n});\n\n// Support: IE<8\n// Prevent attribute/property "interpolation"\n// http://msdn.microsoft.com/en-us/library/ms536429%28VS.85%29.aspx\nif ( !assert(function( div ) {\n\tdiv.innerHTML = "<a href=\'#\'></a>";\n\treturn div.firstChild.getAttribute("href") === "#" ;\n}) ) {\n\taddHandle( "type|href|height|width", function( elem, name, isXML ) {\n\t\tif ( !isXML ) {\n\t\t\treturn elem.getAttribute( name, name.toLowerCase() === "type" ? 1 : 2 );\n\t\t}\n\t});\n}\n\n// Support: IE<9\n// Use defaultValue in place of getAttribute("value")\nif ( !support.attributes || !assert(function( div ) {\n\tdiv.innerHTML = "<input/>";\n\tdiv.firstChild.setAttribute( "value", "" );\n\treturn div.firstChild.getAttribute( "value" ) === "";\n}) ) {\n\taddHandle( "value", function( elem, name, isXML ) {\n\t\tif ( !isXML && elem.nodeName.toLowerCase() === "input" ) {\n\t\t\treturn elem.defaultValue;\n\t\t}\n\t});\n}\n\n// Support: IE<9\n// Use getAttributeNode to fetch booleans when getAttribute lies\nif ( !assert(function( div ) {\n\treturn div.getAttribute("disabled") == null;\n}) ) {\n\taddHandle( booleans, function( elem, name, isXML ) {\n\t\tvar val;\n\t\tif ( !isXML ) {\n\t\t\treturn elem[ name ] === true ? name.toLowerCase() :\n\t\t\t\t\t(val = elem.getAttributeNode( name )) && val.specified ?\n\t\t\t\t\tval.value :\n\t\t\t\tnull;\n\t\t}\n\t});\n}\n\nreturn Sizzle;\n\n})( window );\n\n\n\njQuery.find = Sizzle;\njQuery.expr = Sizzle.selectors;\njQuery.expr[ ":" ] = jQuery.expr.pseudos;\njQuery.uniqueSort = jQuery.unique = Sizzle.uniqueSort;\njQuery.text = Sizzle.getText;\njQuery.isXMLDoc = Sizzle.isXML;\njQuery.contains = Sizzle.contains;\n\n\n\nvar dir = function( elem, dir, until ) {\n\tvar matched = [],\n\t\ttruncate = until !== undefined;\n\n\twhile ( ( elem = elem[ dir ] ) && elem.nodeType !== 9 ) {\n\t\tif ( elem.nodeType === 1 ) {\n\t\t\tif ( truncate && jQuery( elem ).is( until ) ) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tmatched.push( elem );\n\t\t}\n\t}\n\treturn matched;\n};\n\n\nvar siblings = function( n, elem ) {\n\tvar matched = [];\n\n\tfor ( ; n; n = n.nextSibling ) {\n\t\tif ( n.nodeType === 1 && n !== elem ) {\n\t\t\tmatched.push( n );\n\t\t}\n\t}\n\n\treturn matched;\n};\n\n\nvar rneedsContext = jQuery.expr.match.needsContext;\n\nvar rsingleTag = ( /^<([\\w-]+)\\s*\\/?>(?:<\\/\\1>|)$/ );\n\n\n\nvar risSimple = /^.[^:#\\[\\.,]*$/;\n\n// Implement the identical functionality for filter and not\nfunction winnow( elements, qualifier, not ) {\n\tif ( jQuery.isFunction( qualifier ) ) {\n\t\treturn jQuery.grep( elements, function( elem, i ) {\n\t\t\t/* jshint -W018 */\n\t\t\treturn !!qualifier.call( elem, i, elem ) !== not;\n\t\t} );\n\n\t}\n\n\tif ( qualifier.nodeType ) {\n\t\treturn jQuery.grep( elements, function( elem ) {\n\t\t\treturn ( elem === qualifier ) !== not;\n\t\t} );\n\n\t}\n\n\tif ( typeof qualifier === "string" ) {\n\t\tif ( risSimple.test( qualifier ) ) {\n\t\t\treturn jQuery.filter( qualifier, elements, not );\n\t\t}\n\n\t\tqualifier = jQuery.filter( qualifier, elements );\n\t}\n\n\treturn jQuery.grep( elements, function( elem ) {\n\t\treturn ( indexOf.call( qualifier, elem ) > -1 ) !== not;\n\t} );\n}\n\njQuery.filter = function( expr, elems, not ) {\n\tvar elem = elems[ 0 ];\n\n\tif ( not ) {\n\t\texpr = ":not(" + expr + ")";\n\t}\n\n\treturn elems.length === 1 && elem.nodeType === 1 ?\n\t\tjQuery.find.matchesSelector( elem, expr ) ? [ elem ] : [] :\n\t\tjQuery.find.matches( expr, jQuery.grep( elems, function( elem ) {\n\t\t\treturn elem.nodeType === 1;\n\t\t} ) );\n};\n\njQuery.fn.extend( {\n\tfind: function( selector ) {\n\t\tvar i,\n\t\t\tlen = this.length,\n\t\t\tret = [],\n\t\t\tself = this;\n\n\t\tif ( typeof selector !== "string" ) {\n\t\t\treturn this.pushStack( jQuery( selector ).filter( function() {\n\t\t\t\tfor ( i = 0; i < len; i++ ) {\n\t\t\t\t\tif ( jQuery.contains( self[ i ], this ) ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} ) );\n\t\t}\n\n\t\tfor ( i = 0; i < len; i++ ) {\n\t\t\tjQuery.find( selector, self[ i ], ret );\n\t\t}\n\n\t\t// Needed because $( selector, context ) becomes $( context ).find( selector )\n\t\tret = this.pushStack( len > 1 ? jQuery.unique( ret ) : ret );\n\t\tret.selector = this.selector ? this.selector + " " + selector : selector;\n\t\treturn ret;\n\t},\n\tfilter: function( selector ) {\n\t\treturn this.pushStack( winnow( this, selector || [], false ) );\n\t},\n\tnot: function( selector ) {\n\t\treturn this.pushStack( winnow( this, selector || [], true ) );\n\t},\n\tis: function( selector ) {\n\t\treturn !!winnow(\n\t\t\tthis,\n\n\t\t\t// If this is a positional/relative selector, check membership in the returned set\n\t\t\t// so $("p:first").is("p:last") won\'t return true for a doc with two "p".\n\t\t\ttypeof selector === "string" && rneedsContext.test( selector ) ?\n\t\t\t\tjQuery( selector ) :\n\t\t\t\tselector || [],\n\t\t\tfalse\n\t\t).length;\n\t}\n} );\n\n\n// Initialize a jQuery object\n\n\n// A central reference to the root jQuery(document)\nvar rootjQuery,\n\n\t// A simple way to check for HTML strings\n\t// Prioritize #id over <tag> to avoid XSS via location.hash (#9521)\n\t// Strict HTML recognition (#11290: must start with <)\n\trquickExpr = /^(?:\\s*(<[\\w\\W]+>)[^>]*|#([\\w-]*))$/,\n\n\tinit = jQuery.fn.init = function( selector, context, root ) {\n\t\tvar match, elem;\n\n\t\t// HANDLE: $(""), $(null), $(undefined), $(false)\n\t\tif ( !selector ) {\n\t\t\treturn this;\n\t\t}\n\n\t\t// Method init() accepts an alternate rootjQuery\n\t\t// so migrate can support jQuery.sub (gh-2101)\n\t\troot = root || rootjQuery;\n\n\t\t// Handle HTML strings\n\t\tif ( typeof selector === "string" ) {\n\t\t\tif ( selector[ 0 ] === "<" &&\n\t\t\t\tselector[ selector.length - 1 ] === ">" &&\n\t\t\t\tselector.length >= 3 ) {\n\n\t\t\t\t// Assume that strings that start and end with <> are HTML and skip the regex check\n\t\t\t\tmatch = [ null, selector, null ];\n\n\t\t\t} else {\n\t\t\t\tmatch = rquickExpr.exec( selector );\n\t\t\t}\n\n\t\t\t// Match html or make sure no context is specified for #id\n\t\t\tif ( match && ( match[ 1 ] || !context ) ) {\n\n\t\t\t\t// HANDLE: $(html) -> $(array)\n\t\t\t\tif ( match[ 1 ] ) {\n\t\t\t\t\tcontext = context instanceof jQuery ? context[ 0 ] : context;\n\n\t\t\t\t\t// Option to run scripts is true for back-compat\n\t\t\t\t\t// Intentionally let the error be thrown if parseHTML is not present\n\t\t\t\t\tjQuery.merge( this, jQuery.parseHTML(\n\t\t\t\t\t\tmatch[ 1 ],\n\t\t\t\t\t\tcontext && context.nodeType ? context.ownerDocument || context : document,\n\t\t\t\t\t\ttrue\n\t\t\t\t\t) );\n\n\t\t\t\t\t// HANDLE: $(html, props)\n\t\t\t\t\tif ( rsingleTag.test( match[ 1 ] ) && jQuery.isPlainObject( context ) ) {\n\t\t\t\t\t\tfor ( match in context ) {\n\n\t\t\t\t\t\t\t// Properties of context are called as methods if possible\n\t\t\t\t\t\t\tif ( jQuery.isFunction( this[ match ] ) ) {\n\t\t\t\t\t\t\t\tthis[ match ]( context[ match ] );\n\n\t\t\t\t\t\t\t// ...and otherwise set as attributes\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.attr( match, context[ match ] );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn this;\n\n\t\t\t\t// HANDLE: $(#id)\n\t\t\t\t} else {\n\t\t\t\t\telem = document.getElementById( match[ 2 ] );\n\n\t\t\t\t\t// Support: Blackberry 4.6\n\t\t\t\t\t// gEBID returns nodes no longer in the document (#6963)\n\t\t\t\t\tif ( elem && elem.parentNode ) {\n\n\t\t\t\t\t\t// Inject the element directly into the jQuery object\n\t\t\t\t\t\tthis.length = 1;\n\t\t\t\t\t\tthis[ 0 ] = elem;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.context = document;\n\t\t\t\t\tthis.selector = selector;\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\n\t\t\t// HANDLE: $(expr, $(...))\n\t\t\t} else if ( !context || context.jquery ) {\n\t\t\t\treturn ( context || root ).find( selector );\n\n\t\t\t// HANDLE: $(expr, context)\n\t\t\t// (which is just equivalent to: $(context).find(expr)\n\t\t\t} else {\n\t\t\t\treturn this.constructor( context ).find( selector );\n\t\t\t}\n\n\t\t// HANDLE: $(DOMElement)\n\t\t} else if ( selector.nodeType ) {\n\t\t\tthis.context = this[ 0 ] = selector;\n\t\t\tthis.length = 1;\n\t\t\treturn this;\n\n\t\t// HANDLE: $(function)\n\t\t// Shortcut for document ready\n\t\t} else if ( jQuery.isFunction( selector ) ) {\n\t\t\treturn root.ready !== undefined ?\n\t\t\t\troot.ready( selector ) :\n\n\t\t\t\t// Execute immediately if ready is not present\n\t\t\t\tselector( jQuery );\n\t\t}\n\n\t\tif ( selector.selector !== undefined ) {\n\t\t\tthis.selector = selector.selector;\n\t\t\tthis.context = selector.context;\n\t\t}\n\n\t\treturn jQuery.makeArray( selector, this );\n\t};\n\n// Give the init function the jQuery prototype for later instantiation\ninit.prototype = jQuery.fn;\n\n// Initialize central reference\nrootjQuery = jQuery( document );\n\n\nvar rparentsprev = /^(?:parents|prev(?:Until|All))/,\n\n\t// Methods guaranteed to produce a unique set when starting from a unique set\n\tguaranteedUnique = {\n\t\tchildren: true,\n\t\tcontents: true,\n\t\tnext: true,\n\t\tprev: true\n\t};\n\njQuery.fn.extend( {\n\thas: function( target ) {\n\t\tvar targets = jQuery( target, this ),\n\t\t\tl = targets.length;\n\n\t\treturn this.filter( function() {\n\t\t\tvar i = 0;\n\t\t\tfor ( ; i < l; i++ ) {\n\t\t\t\tif ( jQuery.contains( this, targets[ i ] ) ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t},\n\n\tclosest: function( selectors, context ) {\n\t\tvar cur,\n\t\t\ti = 0,\n\t\t\tl = this.length,\n\t\t\tmatched = [],\n\t\t\tpos = rneedsContext.test( selectors ) || typeof selectors !== "string" ?\n\t\t\t\tjQuery( selectors, context || this.context ) :\n\t\t\t\t0;\n\n\t\tfor ( ; i < l; i++ ) {\n\t\t\tfor ( cur = this[ i ]; cur && cur !== context; cur = cur.parentNode ) {\n\n\t\t\t\t// Always skip document fragments\n\t\t\t\tif ( cur.nodeType < 11 && ( pos ?\n\t\t\t\t\tpos.index( cur ) > -1 :\n\n\t\t\t\t\t// Don\'t pass non-elements to Sizzle\n\t\t\t\t\tcur.nodeType === 1 &&\n\t\t\t\t\t\tjQuery.find.matchesSelector( cur, selectors ) ) ) {\n\n\t\t\t\t\tmatched.push( cur );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this.pushStack( matched.length > 1 ? jQuery.uniqueSort( matched ) : matched );\n\t},\n\n\t// Determine the position of an element within the set\n\tindex: function( elem ) {\n\n\t\t// No argument, return index in parent\n\t\tif ( !elem ) {\n\t\t\treturn ( this[ 0 ] && this[ 0 ].parentNode ) ? this.first().prevAll().length : -1;\n\t\t}\n\n\t\t// Index in selector\n\t\tif ( typeof elem === "string" ) {\n\t\t\treturn indexOf.call( jQuery( elem ), this[ 0 ] );\n\t\t}\n\n\t\t// Locate the position of the desired element\n\t\treturn indexOf.call( this,\n\n\t\t\t// If it receives a jQuery object, the first element is used\n\t\t\telem.jquery ? elem[ 0 ] : elem\n\t\t);\n\t},\n\n\tadd: function( selector, context ) {\n\t\treturn this.pushStack(\n\t\t\tjQuery.uniqueSort(\n\t\t\t\tjQuery.merge( this.get(), jQuery( selector, context ) )\n\t\t\t)\n\t\t);\n\t},\n\n\taddBack: function( selector ) {\n\t\treturn this.add( selector == null ?\n\t\t\tthis.prevObject : this.prevObject.filter( selector )\n\t\t);\n\t}\n} );\n\nfunction sibling( cur, dir ) {\n\twhile ( ( cur = cur[ dir ] ) && cur.nodeType !== 1 ) {}\n\treturn cur;\n}\n\njQuery.each( {\n\tparent: function( elem ) {\n\t\tvar parent = elem.parentNode;\n\t\treturn parent && parent.nodeType !== 11 ? parent : null;\n\t},\n\tparents: function( elem ) {\n\t\treturn dir( elem, "parentNode" );\n\t},\n\tparentsUntil: function( elem, i, until ) {\n\t\treturn dir( elem, "parentNode", until );\n\t},\n\tnext: function( elem ) {\n\t\treturn sibling( elem, "nextSibling" );\n\t},\n\tprev: function( elem ) {\n\t\treturn sibling( elem, "previousSibling" );\n\t},\n\tnextAll: function( elem ) {\n\t\treturn dir( elem, "nextSibling" );\n\t},\n\tprevAll: function( elem ) {\n\t\treturn dir( elem, "previousSibling" );\n\t},\n\tnextUntil: function( elem, i, until ) {\n\t\treturn dir( elem, "nextSibling", until );\n\t},\n\tprevUntil: function( elem, i, until ) {\n\t\treturn dir( elem, "previousSibling", until );\n\t},\n\tsiblings: function( elem ) {\n\t\treturn siblings( ( elem.parentNode || {} ).firstChild, elem );\n\t},\n\tchildren: function( elem ) {\n\t\treturn siblings( elem.firstChild );\n\t},\n\tcontents: function( elem ) {\n\t\treturn elem.contentDocument || jQuery.merge( [], elem.childNodes );\n\t}\n}, function( name, fn ) {\n\tjQuery.fn[ name ] = function( until, selector ) {\n\t\tvar matched = jQuery.map( this, fn, until );\n\n\t\tif ( name.slice( -5 ) !== "Until" ) {\n\t\t\tselector = until;\n\t\t}\n\n\t\tif ( selector && typeof selector === "string" ) {\n\t\t\tmatched = jQuery.filter( selector, matched );\n\t\t}\n\n\t\tif ( this.length > 1 ) {\n\n\t\t\t// Remove duplicates\n\t\t\tif ( !guaranteedUnique[ name ] ) {\n\t\t\t\tjQuery.uniqueSort( matched );\n\t\t\t}\n\n\t\t\t// Reverse order for parents* and prev-derivatives\n\t\t\tif ( rparentsprev.test( name ) ) {\n\t\t\t\tmatched.reverse();\n\t\t\t}\n\t\t}\n\n\t\treturn this.pushStack( matched );\n\t};\n} );\nvar rnotwhite = ( /\\S+/g );\n\n\n\n// Convert String-formatted options into Object-formatted ones\nfunction createOptions( options ) {\n\tvar object = {};\n\tjQuery.each( options.match( rnotwhite ) || [], function( _, flag ) {\n\t\tobject[ flag ] = true;\n\t} );\n\treturn object;\n}\n\n/*\n * Create a callback list using the following parameters:\n *\n *\toptions: an optional list of space-separated options that will change how\n *\t\t\tthe callback list behaves or a more traditional option object\n *\n * By default a callback list will act like an event callback list and can be\n * "fired" multiple times.\n *\n * Possible options:\n *\n *\tonce:\t\t\twill ensure the callback list can only be fired once (like a Deferred)\n *\n *\tmemory:\t\t\twill keep track of previous values and will call any callback added\n *\t\t\t\t\tafter the list has been fired right away with the latest "memorized"\n *\t\t\t\t\tvalues (like a Deferred)\n *\n *\tunique:\t\t\twill ensure a callback can only be added once (no duplicate in the list)\n *\n *\tstopOnFalse:\tinterrupt callings when a callback returns false\n *\n */\njQuery.Callbacks = function( options ) {\n\n\t// Convert options from String-formatted to Object-formatted if needed\n\t// (we check in cache first)\n\toptions = typeof options === "string" ?\n\t\tcreateOptions( options ) :\n\t\tjQuery.extend( {}, options );\n\n\tvar // Flag to know if list is currently firing\n\t\tfiring,\n\n\t\t// Last fire value for non-forgettable lists\n\t\tmemory,\n\n\t\t// Flag to know if list was already fired\n\t\tfired,\n\n\t\t// Flag to prevent firing\n\t\tlocked,\n\n\t\t// Actual callback list\n\t\tlist = [],\n\n\t\t// Queue of execution data for repeatable lists\n\t\tqueue = [],\n\n\t\t// Index of currently firing callback (modified by add/remove as needed)\n\t\tfiringIndex = -1,\n\n\t\t// Fire callbacks\n\t\tfire = function() {\n\n\t\t\t// Enforce single-firing\n\t\t\tlocked = options.once;\n\n\t\t\t// Execute callbacks for all pending executions,\n\t\t\t// respecting firingIndex overrides and runtime changes\n\t\t\tfired = firing = true;\n\t\t\tfor ( ; queue.length; firingIndex = -1 ) {\n\t\t\t\tmemory = queue.shift();\n\t\t\t\twhile ( ++firingIndex < list.length ) {\n\n\t\t\t\t\t// Run callback and check for early termination\n\t\t\t\t\tif ( list[ firingIndex ].apply( memory[ 0 ], memory[ 1 ] ) === false &&\n\t\t\t\t\t\toptions.stopOnFalse ) {\n\n\t\t\t\t\t\t// Jump to end and forget the data so .add doesn\'t re-fire\n\t\t\t\t\t\tfiringIndex = list.length;\n\t\t\t\t\t\tmemory = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Forget the data if we\'re done with it\n\t\t\tif ( !options.memory ) {\n\t\t\t\tmemory = false;\n\t\t\t}\n\n\t\t\tfiring = false;\n\n\t\t\t// Clean up if we\'re done firing for good\n\t\t\tif ( locked ) {\n\n\t\t\t\t// Keep an empty list if we have data for future add calls\n\t\t\t\tif ( memory ) {\n\t\t\t\t\tlist = [];\n\n\t\t\t\t// Otherwise, this object is spent\n\t\t\t\t} else {\n\t\t\t\t\tlist = "";\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t// Actual Callbacks object\n\t\tself = {\n\n\t\t\t// Add a callback or a collection of callbacks to the list\n\t\t\tadd: function() {\n\t\t\t\tif ( list ) {\n\n\t\t\t\t\t// If we have memory from a past run, we should fire after adding\n\t\t\t\t\tif ( memory && !firing ) {\n\t\t\t\t\t\tfiringIndex = list.length - 1;\n\t\t\t\t\t\tqueue.push( memory );\n\t\t\t\t\t}\n\n\t\t\t\t\t( function add( args ) {\n\t\t\t\t\t\tjQuery.each( args, function( _, arg ) {\n\t\t\t\t\t\t\tif ( jQuery.isFunction( arg ) ) {\n\t\t\t\t\t\t\t\tif ( !options.unique || !self.has( arg ) ) {\n\t\t\t\t\t\t\t\t\tlist.push( arg );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else if ( arg && arg.length && jQuery.type( arg ) !== "string" ) {\n\n\t\t\t\t\t\t\t\t// Inspect recursively\n\t\t\t\t\t\t\t\tadd( arg );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t} )( arguments );\n\n\t\t\t\t\tif ( memory && !firing ) {\n\t\t\t\t\t\tfire();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t// Remove a callback from the list\n\t\t\tremove: function() {\n\t\t\t\tjQuery.each( arguments, function( _, arg ) {\n\t\t\t\t\tvar index;\n\t\t\t\t\twhile ( ( index = jQuery.inArray( arg, list, index ) ) > -1 ) {\n\t\t\t\t\t\tlist.splice( index, 1 );\n\n\t\t\t\t\t\t// Handle firing indexes\n\t\t\t\t\t\tif ( index <= firingIndex ) {\n\t\t\t\t\t\t\tfiringIndex--;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t// Check if a given callback is in the list.\n\t\t\t// If no argument is given, return whether or not list has callbacks attached.\n\t\t\thas: function( fn ) {\n\t\t\t\treturn fn ?\n\t\t\t\t\tjQuery.inArray( fn, list ) > -1 :\n\t\t\t\t\tlist.length > 0;\n\t\t\t},\n\n\t\t\t// Remove all callbacks from the list\n\t\t\tempty: function() {\n\t\t\t\tif ( list ) {\n\t\t\t\t\tlist = [];\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t// Disable .fire and .add\n\t\t\t// Abort any current/pending executions\n\t\t\t// Clear all callbacks and values\n\t\t\tdisable: function() {\n\t\t\t\tlocked = queue = [];\n\t\t\t\tlist = memory = "";\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tdisabled: function() {\n\t\t\t\treturn !list;\n\t\t\t},\n\n\t\t\t// Disable .fire\n\t\t\t// Also disable .add unless we have memory (since it would have no effect)\n\t\t\t// Abort any pending executions\n\t\t\tlock: function() {\n\t\t\t\tlocked = queue = [];\n\t\t\t\tif ( !memory ) {\n\t\t\t\t\tlist = memory = "";\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tlocked: function() {\n\t\t\t\treturn !!locked;\n\t\t\t},\n\n\t\t\t// Call all callbacks with the given context and arguments\n\t\t\tfireWith: function( context, args ) {\n\t\t\t\tif ( !locked ) {\n\t\t\t\t\targs = args || [];\n\t\t\t\t\targs = [ context, args.slice ? args.slice() : args ];\n\t\t\t\t\tqueue.push( args );\n\t\t\t\t\tif ( !firing ) {\n\t\t\t\t\t\tfire();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t// Call all the callbacks with the given arguments\n\t\t\tfire: function() {\n\t\t\t\tself.fireWith( this, arguments );\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t// To know if the callbacks have already been called at least once\n\t\t\tfired: function() {\n\t\t\t\treturn !!fired;\n\t\t\t}\n\t\t};\n\n\treturn self;\n};\n\n\njQuery.extend( {\n\n\tDeferred: function( func ) {\n\t\tvar tuples = [\n\n\t\t\t\t// action, add listener, listener list, final state\n\t\t\t\t[ "resolve", "done", jQuery.Callbacks( "once memory" ), "resolved" ],\n\t\t\t\t[ "reject", "fail", jQuery.Callbacks( "once memory" ), "rejected" ],\n\t\t\t\t[ "notify", "progress", jQuery.Callbacks( "memory" ) ]\n\t\t\t],\n\t\t\tstate = "pending",\n\t\t\tpromise = {\n\t\t\t\tstate: function() {\n\t\t\t\t\treturn state;\n\t\t\t\t},\n\t\t\t\talways: function() {\n\t\t\t\t\tdeferred.done( arguments ).fail( arguments );\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\t\t\t\tthen: function( /* fnDone, fnFail, fnProgress */ ) {\n\t\t\t\t\tvar fns = arguments;\n\t\t\t\t\treturn jQuery.Deferred( function( newDefer ) {\n\t\t\t\t\t\tjQuery.each( tuples, function( i, tuple ) {\n\t\t\t\t\t\t\tvar fn = jQuery.isFunction( fns[ i ] ) && fns[ i ];\n\n\t\t\t\t\t\t\t// deferred[ done | fail | progress ] for forwarding actions to newDefer\n\t\t\t\t\t\t\tdeferred[ tuple[ 1 ] ]( function() {\n\t\t\t\t\t\t\t\tvar returned = fn && fn.apply( this, arguments );\n\t\t\t\t\t\t\t\tif ( returned && jQuery.isFunction( returned.promise ) ) {\n\t\t\t\t\t\t\t\t\treturned.promise()\n\t\t\t\t\t\t\t\t\t\t.progress( newDefer.notify )\n\t\t\t\t\t\t\t\t\t\t.done( newDefer.resolve )\n\t\t\t\t\t\t\t\t\t\t.fail( newDefer.reject );\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tnewDefer[ tuple[ 0 ] + "With" ](\n\t\t\t\t\t\t\t\t\t\tthis === promise ? newDefer.promise() : this,\n\t\t\t\t\t\t\t\t\t\tfn ? [ returned ] : arguments\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t} );\n\t\t\t\t\t\tfns = null;\n\t\t\t\t\t} ).promise();\n\t\t\t\t},\n\n\t\t\t\t// Get a promise for this deferred\n\t\t\t\t// If obj is provided, the promise aspect is added to the object\n\t\t\t\tpromise: function( obj ) {\n\t\t\t\t\treturn obj != null ? jQuery.extend( obj, promise ) : promise;\n\t\t\t\t}\n\t\t\t},\n\t\t\tdeferred = {};\n\n\t\t// Keep pipe for back-compat\n\t\tpromise.pipe = promise.then;\n\n\t\t// Add list-specific methods\n\t\tjQuery.each( tuples, function( i, tuple ) {\n\t\t\tvar list = tuple[ 2 ],\n\t\t\t\tstateString = tuple[ 3 ];\n\n\t\t\t// promise[ done | fail | progress ] = list.add\n\t\t\tpromise[ tuple[ 1 ] ] = list.add;\n\n\t\t\t// Handle state\n\t\t\tif ( stateString ) {\n\t\t\t\tlist.add( function() {\n\n\t\t\t\t\t// state = [ resolved | rejected ]\n\t\t\t\t\tstate = stateString;\n\n\t\t\t\t// [ reject_list | resolve_list ].disable; progress_list.lock\n\t\t\t\t}, tuples[ i ^ 1 ][ 2 ].disable, tuples[ 2 ][ 2 ].lock );\n\t\t\t}\n\n\t\t\t// deferred[ resolve | reject | notify ]\n\t\t\tdeferred[ tuple[ 0 ] ] = function() {\n\t\t\t\tdeferred[ tuple[ 0 ] + "With" ]( this === deferred ? promise : this, arguments );\n\t\t\t\treturn this;\n\t\t\t};\n\t\t\tdeferred[ tuple[ 0 ] + "With" ] = list.fireWith;\n\t\t} );\n\n\t\t// Make the deferred a promise\n\t\tpromise.promise( deferred );\n\n\t\t// Call given func if any\n\t\tif ( func ) {\n\t\t\tfunc.call( deferred, deferred );\n\t\t}\n\n\t\t// All done!\n\t\treturn deferred;\n\t},\n\n\t// Deferred helper\n\twhen: function( subordinate /* , ..., subordinateN */ ) {\n\t\tvar i = 0,\n\t\t\tresolveValues = slice.call( arguments ),\n\t\t\tlength = resolveValues.length,\n\n\t\t\t// the count of uncompleted subordinates\n\t\t\tremaining = length !== 1 ||\n\t\t\t\t( subordinate && jQuery.isFunction( subordinate.promise ) ) ? length : 0,\n\n\t\t\t// the master Deferred.\n\t\t\t// If resolveValues consist of only a single Deferred, just use that.\n\t\t\tdeferred = remaining === 1 ? subordinate : jQuery.Deferred(),\n\n\t\t\t// Update function for both resolve and progress values\n\t\t\tupdateFunc = function( i, contexts, values ) {\n\t\t\t\treturn function( value ) {\n\t\t\t\t\tcontexts[ i ] = this;\n\t\t\t\t\tvalues[ i ] = arguments.length > 1 ? slice.call( arguments ) : value;\n\t\t\t\t\tif ( values === progressValues ) {\n\t\t\t\t\t\tdeferred.notifyWith( contexts, values );\n\t\t\t\t\t} else if ( !( --remaining ) ) {\n\t\t\t\t\t\tdeferred.resolveWith( contexts, values );\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t},\n\n\t\t\tprogressValues, progressContexts, resolveContexts;\n\n\t\t// Add listeners to Deferred subordinates; treat others as resolved\n\t\tif ( length > 1 ) {\n\t\t\tprogressValues = new Array( length );\n\t\t\tprogressContexts = new Array( length );\n\t\t\tresolveContexts = new Array( length );\n\t\t\tfor ( ; i < length; i++ ) {\n\t\t\t\tif ( resolveValues[ i ] && jQuery.isFunction( resolveValues[ i ].promise ) ) {\n\t\t\t\t\tresolveValues[ i ].promise()\n\t\t\t\t\t\t.progress( updateFunc( i, progressContexts, progressValues ) )\n\t\t\t\t\t\t.done( updateFunc( i, resolveContexts, resolveValues ) )\n\t\t\t\t\t\t.fail( deferred.reject );\n\t\t\t\t} else {\n\t\t\t\t\t--remaining;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// If we\'re not waiting on anything, resolve the master\n\t\tif ( !remaining ) {\n\t\t\tdeferred.resolveWith( resolveContexts, resolveValues );\n\t\t}\n\n\t\treturn deferred.promise();\n\t}\n} );\n\n\n// The deferred used on DOM ready\nvar readyList;\n\njQuery.fn.ready = function( fn ) {\n\n\t// Add the callback\n\tjQuery.ready.promise().done( fn );\n\n\treturn this;\n};\n\njQuery.extend( {\n\n\t// Is the DOM ready to be used? Set to true once it occurs.\n\tisReady: false,\n\n\t// A counter to track how many items to wait for before\n\t// the ready event fires. See #6781\n\treadyWait: 1,\n\n\t// Hold (or release) the ready event\n\tholdReady: function( hold ) {\n\t\tif ( hold ) {\n\t\t\tjQuery.readyWait++;\n\t\t} else {\n\t\t\tjQuery.ready( true );\n\t\t}\n\t},\n\n\t// Handle when the DOM is ready\n\tready: function( wait ) {\n\n\t\t// Abort if there are pending holds or we\'re already ready\n\t\tif ( wait === true ? --jQuery.readyWait : jQuery.isReady ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Remember that the DOM is ready\n\t\tjQuery.isReady = true;\n\n\t\t// If a normal DOM Ready event fired, decrement, and wait if need be\n\t\tif ( wait !== true && --jQuery.readyWait > 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// If there are functions bound, to execute\n\t\treadyList.resolveWith( document, [ jQuery ] );\n\n\t\t// Trigger any bound ready events\n\t\tif ( jQuery.fn.triggerHandler ) {\n\t\t\tjQuery( document ).triggerHandler( "ready" );\n\t\t\tjQuery( document ).off( "ready" );\n\t\t}\n\t}\n} );\n\n/**\n * The ready event handler and self cleanup method\n */\nfunction completed() {\n\tdocument.removeEventListener( "DOMContentLoaded", completed );\n\twindow.removeEventListener( "load", completed );\n\tjQuery.ready();\n}\n\njQuery.ready.promise = function( obj ) {\n\tif ( !readyList ) {\n\n\t\treadyList = jQuery.Deferred();\n\n\t\t// Catch cases where $(document).ready() is called\n\t\t// after the browser event has already occurred.\n\t\t// Support: IE9-10 only\n\t\t// Older IE sometimes signals "interactive" too soon\n\t\tif ( document.readyState === "complete" ||\n\t\t\t( document.readyState !== "loading" && !document.documentElement.doScroll ) ) {\n\n\t\t\t// Handle it asynchronously to allow scripts the opportunity to delay ready\n\t\t\twindow.setTimeout( jQuery.ready );\n\n\t\t} else {\n\n\t\t\t// Use the handy event callback\n\t\t\tdocument.addEventListener( "DOMContentLoaded", completed );\n\n\t\t\t// A fallback to window.onload, that will always work\n\t\t\twindow.addEventListener( "load", completed );\n\t\t}\n\t}\n\treturn readyList.promise( obj );\n};\n\n// Kick off the DOM ready check even if the user does not\njQuery.ready.promise();\n\n\n\n\n// Multifunctional method to get and set values of a collection\n// The value/s can optionally be executed if it\'s a function\nvar access = function( elems, fn, key, value, chainable, emptyGet, raw ) {\n\tvar i = 0,\n\t\tlen = elems.length,\n\t\tbulk = key == null;\n\n\t// Sets many values\n\tif ( jQuery.type( key ) === "object" ) {\n\t\tchainable = true;\n\t\tfor ( i in key ) {\n\t\t\taccess( elems, fn, i, key[ i ], true, emptyGet, raw );\n\t\t}\n\n\t// Sets one value\n\t} else if ( value !== undefined ) {\n\t\tchainable = true;\n\n\t\tif ( !jQuery.isFunction( value ) ) {\n\t\t\traw = true;\n\t\t}\n\n\t\tif ( bulk ) {\n\n\t\t\t// Bulk operations run against the entire set\n\t\t\tif ( raw ) {\n\t\t\t\tfn.call( elems, value );\n\t\t\t\tfn = null;\n\n\t\t\t// ...except when executing function values\n\t\t\t} else {\n\t\t\t\tbulk = fn;\n\t\t\t\tfn = function( elem, key, value ) {\n\t\t\t\t\treturn bulk.call( jQuery( elem ), value );\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tif ( fn ) {\n\t\t\tfor ( ; i < len; i++ ) {\n\t\t\t\tfn(\n\t\t\t\t\telems[ i ], key, raw ?\n\t\t\t\t\tvalue :\n\t\t\t\t\tvalue.call( elems[ i ], i, fn( elems[ i ], key ) )\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn chainable ?\n\t\telems :\n\n\t\t// Gets\n\t\tbulk ?\n\t\t\tfn.call( elems ) :\n\t\t\tlen ? fn( elems[ 0 ], key ) : emptyGet;\n};\nvar acceptData = function( owner ) {\n\n\t// Accepts only:\n\t//  - Node\n\t//    - Node.ELEMENT_NODE\n\t//    - Node.DOCUMENT_NODE\n\t//  - Object\n\t//    - Any\n\t/* jshint -W018 */\n\treturn owner.nodeType === 1 || owner.nodeType === 9 || !( +owner.nodeType );\n};\n\n\n\n\nfunction Data() {\n\tthis.expando = jQuery.expando + Data.uid++;\n}\n\nData.uid = 1;\n\nData.prototype = {\n\n\tregister: function( owner, initial ) {\n\t\tvar value = initial || {};\n\n\t\t// If it is a node unlikely to be stringify-ed or looped over\n\t\t// use plain assignment\n\t\tif ( owner.nodeType ) {\n\t\t\towner[ this.expando ] = value;\n\n\t\t// Otherwise secure it in a non-enumerable, non-writable property\n\t\t// configurability must be true to allow the property to be\n\t\t// deleted with the delete operator\n\t\t} else {\n\t\t\tObject.defineProperty( owner, this.expando, {\n\t\t\t\tvalue: value,\n\t\t\t\twritable: true,\n\t\t\t\tconfigurable: true\n\t\t\t} );\n\t\t}\n\t\treturn owner[ this.expando ];\n\t},\n\tcache: function( owner ) {\n\n\t\t// We can accept data for non-element nodes in modern browsers,\n\t\t// but we should not, see #8335.\n\t\t// Always return an empty object.\n\t\tif ( !acceptData( owner ) ) {\n\t\t\treturn {};\n\t\t}\n\n\t\t// Check if the owner object already has a cache\n\t\tvar value = owner[ this.expando ];\n\n\t\t// If not, create one\n\t\tif ( !value ) {\n\t\t\tvalue = {};\n\n\t\t\t// We can accept data for non-element nodes in modern browsers,\n\t\t\t// but we should not, see #8335.\n\t\t\t// Always return an empty object.\n\t\t\tif ( acceptData( owner ) ) {\n\n\t\t\t\t// If it is a node unlikely to be stringify-ed or looped over\n\t\t\t\t// use plain assignment\n\t\t\t\tif ( owner.nodeType ) {\n\t\t\t\t\towner[ this.expando ] = value;\n\n\t\t\t\t// Otherwise secure it in a non-enumerable property\n\t\t\t\t// configurable must be true to allow the property to be\n\t\t\t\t// deleted when data is removed\n\t\t\t\t} else {\n\t\t\t\t\tObject.defineProperty( owner, this.expando, {\n\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\tconfigurable: true\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn value;\n\t},\n\tset: function( owner, data, value ) {\n\t\tvar prop,\n\t\t\tcache = this.cache( owner );\n\n\t\t// Handle: [ owner, key, value ] args\n\t\tif ( typeof data === "string" ) {\n\t\t\tcache[ data ] = value;\n\n\t\t// Handle: [ owner, { properties } ] args\n\t\t} else {\n\n\t\t\t// Copy the properties one-by-one to the cache object\n\t\t\tfor ( prop in data ) {\n\t\t\t\tcache[ prop ] = data[ prop ];\n\t\t\t}\n\t\t}\n\t\treturn cache;\n\t},\n\tget: function( owner, key ) {\n\t\treturn key === undefined ?\n\t\t\tthis.cache( owner ) :\n\t\t\towner[ this.expando ] && owner[ this.expando ][ key ];\n\t},\n\taccess: function( owner, key, value ) {\n\t\tvar stored;\n\n\t\t// In cases where either:\n\t\t//\n\t\t//   1. No key was specified\n\t\t//   2. A string key was specified, but no value provided\n\t\t//\n\t\t// Take the "read" path and allow the get method to determine\n\t\t// which value to return, respectively either:\n\t\t//\n\t\t//   1. The entire cache object\n\t\t//   2. The data stored at the key\n\t\t//\n\t\tif ( key === undefined ||\n\t\t\t\t( ( key && typeof key === "string" ) && value === undefined ) ) {\n\n\t\t\tstored = this.get( owner, key );\n\n\t\t\treturn stored !== undefined ?\n\t\t\t\tstored : this.get( owner, jQuery.camelCase( key ) );\n\t\t}\n\n\t\t// When the key is not a string, or both a key and value\n\t\t// are specified, set or extend (existing objects) with either:\n\t\t//\n\t\t//   1. An object of properties\n\t\t//   2. A key and value\n\t\t//\n\t\tthis.set( owner, key, value );\n\n\t\t// Since the "set" path can have two possible entry points\n\t\t// return the expected data based on which path was taken[*]\n\t\treturn value !== undefined ? value : key;\n\t},\n\tremove: function( owner, key ) {\n\t\tvar i, name, camel,\n\t\t\tcache = owner[ this.expando ];\n\n\t\tif ( cache === undefined ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( key === undefined ) {\n\t\t\tthis.register( owner );\n\n\t\t} else {\n\n\t\t\t// Support array or space separated string of keys\n\t\t\tif ( jQuery.isArray( key ) ) {\n\n\t\t\t\t// If "name" is an array of keys...\n\t\t\t\t// When data is initially created, via ("key", "val") signature,\n\t\t\t\t// keys will be converted to camelCase.\n\t\t\t\t// Since there is no way to tell _how_ a key was added, remove\n\t\t\t\t// both plain key and camelCase key. #12786\n\t\t\t\t// This will only penalize the array argument path.\n\t\t\t\tname = key.concat( key.map( jQuery.camelCase ) );\n\t\t\t} else {\n\t\t\t\tcamel = jQuery.camelCase( key );\n\n\t\t\t\t// Try the string as a key before any manipulation\n\t\t\t\tif ( key in cache ) {\n\t\t\t\t\tname = [ key, camel ];\n\t\t\t\t} else {\n\n\t\t\t\t\t// If a key with the spaces exists, use it.\n\t\t\t\t\t// Otherwise, create an array by matching non-whitespace\n\t\t\t\t\tname = camel;\n\t\t\t\t\tname = name in cache ?\n\t\t\t\t\t\t[ name ] : ( name.match( rnotwhite ) || [] );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ti = name.length;\n\n\t\t\twhile ( i-- ) {\n\t\t\t\tdelete cache[ name[ i ] ];\n\t\t\t}\n\t\t}\n\n\t\t// Remove the expando if there\'s no more data\n\t\tif ( key === undefined || jQuery.isEmptyObject( cache ) ) {\n\n\t\t\t// Support: Chrome <= 35-45+\n\t\t\t// Webkit & Blink performance suffers when deleting properties\n\t\t\t// from DOM nodes, so set to undefined instead\n\t\t\t// https://code.google.com/p/chromium/issues/detail?id=378607\n\t\t\tif ( owner.nodeType ) {\n\t\t\t\towner[ this.expando ] = undefined;\n\t\t\t} else {\n\t\t\t\tdelete owner[ this.expando ];\n\t\t\t}\n\t\t}\n\t},\n\thasData: function( owner ) {\n\t\tvar cache = owner[ this.expando ];\n\t\treturn cache !== undefined && !jQuery.isEmptyObject( cache );\n\t}\n};\nvar dataPriv = new Data();\n\nvar dataUser = new Data();\n\n\n\n//\tImplementation Summary\n//\n//\t1. Enforce API surface and semantic compatibility with 1.9.x branch\n//\t2. Improve the module\'s maintainability by reducing the storage\n//\t\tpaths to a single mechanism.\n//\t3. Use the same single mechanism to support "private" and "user" data.\n//\t4. _Never_ expose "private" data to user code (TODO: Drop _data, _removeData)\n//\t5. Avoid exposing implementation details on user objects (eg. expando properties)\n//\t6. Provide a clear path for implementation upgrade to WeakMap in 2014\n\nvar rbrace = /^(?:\\{[\\w\\W]*\\}|\\[[\\w\\W]*\\])$/,\n\trmultiDash = /[A-Z]/g;\n\nfunction dataAttr( elem, key, data ) {\n\tvar name;\n\n\t// If nothing was found internally, try to fetch any\n\t// data from the HTML5 data-* attribute\n\tif ( data === undefined && elem.nodeType === 1 ) {\n\t\tname = "data-" + key.replace( rmultiDash, "-$&" ).toLowerCase();\n\t\tdata = elem.getAttribute( name );\n\n\t\tif ( typeof data === "string" ) {\n\t\t\ttry {\n\t\t\t\tdata = data === "true" ? true :\n\t\t\t\t\tdata === "false" ? false :\n\t\t\t\t\tdata === "null" ? null :\n\n\t\t\t\t\t// Only convert to a number if it doesn\'t change the string\n\t\t\t\t\t+data + "" === data ? +data :\n\t\t\t\t\trbrace.test( data ) ? jQuery.parseJSON( data ) :\n\t\t\t\t\tdata;\n\t\t\t} catch ( e ) {}\n\n\t\t\t// Make sure we set the data so it isn\'t changed later\n\t\t\tdataUser.set( elem, key, data );\n\t\t} else {\n\t\t\tdata = undefined;\n\t\t}\n\t}\n\treturn data;\n}\n\njQuery.extend( {\n\thasData: function( elem ) {\n\t\treturn dataUser.hasData( elem ) || dataPriv.hasData( elem );\n\t},\n\n\tdata: function( elem, name, data ) {\n\t\treturn dataUser.access( elem, name, data );\n\t},\n\n\tremoveData: function( elem, name ) {\n\t\tdataUser.remove( elem, name );\n\t},\n\n\t// TODO: Now that all calls to _data and _removeData have been replaced\n\t// with direct calls to dataPriv methods, these can be deprecated.\n\t_data: function( elem, name, data ) {\n\t\treturn dataPriv.access( elem, name, data );\n\t},\n\n\t_removeData: function( elem, name ) {\n\t\tdataPriv.remove( elem, name );\n\t}\n} );\n\njQuery.fn.extend( {\n\tdata: function( key, value ) {\n\t\tvar i, name, data,\n\t\t\telem = this[ 0 ],\n\t\t\tattrs = elem && elem.attributes;\n\n\t\t// Gets all values\n\t\tif ( key === undefined ) {\n\t\t\tif ( this.length ) {\n\t\t\t\tdata = dataUser.get( elem );\n\n\t\t\t\tif ( elem.nodeType === 1 && !dataPriv.get( elem, "hasDataAttrs" ) ) {\n\t\t\t\t\ti = attrs.length;\n\t\t\t\t\twhile ( i-- ) {\n\n\t\t\t\t\t\t// Support: IE11+\n\t\t\t\t\t\t// The attrs elements can be null (#14894)\n\t\t\t\t\t\tif ( attrs[ i ] ) {\n\t\t\t\t\t\t\tname = attrs[ i ].name;\n\t\t\t\t\t\t\tif ( name.indexOf( "data-" ) === 0 ) {\n\t\t\t\t\t\t\t\tname = jQuery.camelCase( name.slice( 5 ) );\n\t\t\t\t\t\t\t\tdataAttr( elem, name, data[ name ] );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tdataPriv.set( elem, "hasDataAttrs", true );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn data;\n\t\t}\n\n\t\t// Sets multiple values\n\t\tif ( typeof key === "object" ) {\n\t\t\treturn this.each( function() {\n\t\t\t\tdataUser.set( this, key );\n\t\t\t} );\n\t\t}\n\n\t\treturn access( this, function( value ) {\n\t\t\tvar data, camelKey;\n\n\t\t\t// The calling jQuery object (element matches) is not empty\n\t\t\t// (and therefore has an element appears at this[ 0 ]) and the\n\t\t\t// `value` parameter was not undefined. An empty jQuery object\n\t\t\t// will result in `undefined` for elem = this[ 0 ] which will\n\t\t\t// throw an exception if an attempt to read a data cache is made.\n\t\t\tif ( elem && value === undefined ) {\n\n\t\t\t\t// Attempt to get data from the cache\n\t\t\t\t// with the key as-is\n\t\t\t\tdata = dataUser.get( elem, key ) ||\n\n\t\t\t\t\t// Try to find dashed key if it exists (gh-2779)\n\t\t\t\t\t// This is for 2.2.x only\n\t\t\t\t\tdataUser.get( elem, key.replace( rmultiDash, "-$&" ).toLowerCase() );\n\n\t\t\t\tif ( data !== undefined ) {\n\t\t\t\t\treturn data;\n\t\t\t\t}\n\n\t\t\t\tcamelKey = jQuery.camelCase( key );\n\n\t\t\t\t// Attempt to get data from the cache\n\t\t\t\t// with the key camelized\n\t\t\t\tdata = dataUser.get( elem, camelKey );\n\t\t\t\tif ( data !== undefined ) {\n\t\t\t\t\treturn data;\n\t\t\t\t}\n\n\t\t\t\t// Attempt to "discover" the data in\n\t\t\t\t// HTML5 custom data-* attrs\n\t\t\t\tdata = dataAttr( elem, camelKey, undefined );\n\t\t\t\tif ( data !== undefined ) {\n\t\t\t\t\treturn data;\n\t\t\t\t}\n\n\t\t\t\t// We tried really hard, but the data doesn\'t exist.\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Set the data...\n\t\t\tcamelKey = jQuery.camelCase( key );\n\t\t\tthis.each( function() {\n\n\t\t\t\t// First, attempt to store a copy or reference of any\n\t\t\t\t// data that might\'ve been store with a camelCased key.\n\t\t\t\tvar data = dataUser.get( this, camelKey );\n\n\t\t\t\t// For HTML5 data-* attribute interop, we have to\n\t\t\t\t// store property names with dashes in a camelCase form.\n\t\t\t\t// This might not apply to all properties...*\n\t\t\t\tdataUser.set( this, camelKey, value );\n\n\t\t\t\t// *... In the case of properties that might _actually_\n\t\t\t\t// have dashes, we need to also store a copy of that\n\t\t\t\t// unchanged property.\n\t\t\t\tif ( key.indexOf( "-" ) > -1 && data !== undefined ) {\n\t\t\t\t\tdataUser.set( this, key, value );\n\t\t\t\t}\n\t\t\t} );\n\t\t}, null, value, arguments.length > 1, null, true );\n\t},\n\n\tremoveData: function( key ) {\n\t\treturn this.each( function() {\n\t\t\tdataUser.remove( this, key );\n\t\t} );\n\t}\n} );\n\n\njQuery.extend( {\n\tqueue: function( elem, type, data ) {\n\t\tvar queue;\n\n\t\tif ( elem ) {\n\t\t\ttype = ( type || "fx" ) + "queue";\n\t\t\tqueue = dataPriv.get( elem, type );\n\n\t\t\t// Speed up dequeue by getting out quickly if this is just a lookup\n\t\t\tif ( data ) {\n\t\t\t\tif ( !queue || jQuery.isArray( data ) ) {\n\t\t\t\t\tqueue = dataPriv.access( elem, type, jQuery.makeArray( data ) );\n\t\t\t\t} else {\n\t\t\t\t\tqueue.push( data );\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn queue || [];\n\t\t}\n\t},\n\n\tdequeue: function( elem, type ) {\n\t\ttype = type || "fx";\n\n\t\tvar queue = jQuery.queue( elem, type ),\n\t\t\tstartLength = queue.length,\n\t\t\tfn = queue.shift(),\n\t\t\thooks = jQuery._queueHooks( elem, type ),\n\t\t\tnext = function() {\n\t\t\t\tjQuery.dequeue( elem, type );\n\t\t\t};\n\n\t\t// If the fx queue is dequeued, always remove the progress sentinel\n\t\tif ( fn === "inprogress" ) {\n\t\t\tfn = queue.shift();\n\t\t\tstartLength--;\n\t\t}\n\n\t\tif ( fn ) {\n\n\t\t\t// Add a progress sentinel to prevent the fx queue from being\n\t\t\t// automatically dequeued\n\t\t\tif ( type === "fx" ) {\n\t\t\t\tqueue.unshift( "inprogress" );\n\t\t\t}\n\n\t\t\t// Clear up the last queue stop function\n\t\t\tdelete hooks.stop;\n\t\t\tfn.call( elem, next, hooks );\n\t\t}\n\n\t\tif ( !startLength && hooks ) {\n\t\t\thooks.empty.fire();\n\t\t}\n\t},\n\n\t// Not public - generate a queueHooks object, or return the current one\n\t_queueHooks: function( elem, type ) {\n\t\tvar key = type + "queueHooks";\n\t\treturn dataPriv.get( elem, key ) || dataPriv.access( elem, key, {\n\t\t\tempty: jQuery.Callbacks( "once memory" ).add( function() {\n\t\t\t\tdataPriv.remove( elem, [ type + "queue", key ] );\n\t\t\t} )\n\t\t} );\n\t}\n} );\n\njQuery.fn.extend( {\n\tqueue: function( type, data ) {\n\t\tvar setter = 2;\n\n\t\tif ( typeof type !== "string" ) {\n\t\t\tdata = type;\n\t\t\ttype = "fx";\n\t\t\tsetter--;\n\t\t}\n\n\t\tif ( arguments.length < setter ) {\n\t\t\treturn jQuery.queue( this[ 0 ], type );\n\t\t}\n\n\t\treturn data === undefined ?\n\t\t\tthis :\n\t\t\tthis.each( function() {\n\t\t\t\tvar queue = jQuery.queue( this, type, data );\n\n\t\t\t\t// Ensure a hooks for this queue\n\t\t\t\tjQuery._queueHooks( this, type );\n\n\t\t\t\tif ( type === "fx" && queue[ 0 ] !== "inprogress" ) {\n\t\t\t\t\tjQuery.dequeue( this, type );\n\t\t\t\t}\n\t\t\t} );\n\t},\n\tdequeue: function( type ) {\n\t\treturn this.each( function() {\n\t\t\tjQuery.dequeue( this, type );\n\t\t} );\n\t},\n\tclearQueue: function( type ) {\n\t\treturn this.queue( type || "fx", [] );\n\t},\n\n\t// Get a promise resolved when queues of a certain type\n\t// are emptied (fx is the type by default)\n\tpromise: function( type, obj ) {\n\t\tvar tmp,\n\t\t\tcount = 1,\n\t\t\tdefer = jQuery.Deferred(),\n\t\t\telements = this,\n\t\t\ti = this.length,\n\t\t\tresolve = function() {\n\t\t\t\tif ( !( --count ) ) {\n\t\t\t\t\tdefer.resolveWith( elements, [ elements ] );\n\t\t\t\t}\n\t\t\t};\n\n\t\tif ( typeof type !== "string" ) {\n\t\t\tobj = type;\n\t\t\ttype = undefined;\n\t\t}\n\t\ttype = type || "fx";\n\n\t\twhile ( i-- ) {\n\t\t\ttmp = dataPriv.get( elements[ i ], type + "queueHooks" );\n\t\t\tif ( tmp && tmp.empty ) {\n\t\t\t\tcount++;\n\t\t\t\ttmp.empty.add( resolve );\n\t\t\t}\n\t\t}\n\t\tresolve();\n\t\treturn defer.promise( obj );\n\t}\n} );\nvar pnum = ( /[+-]?(?:\\d*\\.|)\\d+(?:[eE][+-]?\\d+|)/ ).source;\n\nvar rcssNum = new RegExp( "^(?:([+-])=|)(" + pnum + ")([a-z%]*)$", "i" );\n\n\nvar cssExpand = [ "Top", "Right", "Bottom", "Left" ];\n\nvar isHidden = function( elem, el ) {\n\n\t\t// isHidden might be called from jQuery#filter function;\n\t\t// in that case, element will be second argument\n\t\telem = el || elem;\n\t\treturn jQuery.css( elem, "display" ) === "none" ||\n\t\t\t!jQuery.contains( elem.ownerDocument, elem );\n\t};\n\n\n\nfunction adjustCSS( elem, prop, valueParts, tween ) {\n\tvar adjusted,\n\t\tscale = 1,\n\t\tmaxIterations = 20,\n\t\tcurrentValue = tween ?\n\t\t\tfunction() { return tween.cur(); } :\n\t\t\tfunction() { return jQuery.css( elem, prop, "" ); },\n\t\tinitial = currentValue(),\n\t\tunit = valueParts && valueParts[ 3 ] || ( jQuery.cssNumber[ prop ] ? "" : "px" ),\n\n\t\t// Starting value computation is required for potential unit mismatches\n\t\tinitialInUnit = ( jQuery.cssNumber[ prop ] || unit !== "px" && +initial ) &&\n\t\t\trcssNum.exec( jQuery.css( elem, prop ) );\n\n\tif ( initialInUnit && initialInUnit[ 3 ] !== unit ) {\n\n\t\t// Trust units reported by jQuery.css\n\t\tunit = unit || initialInUnit[ 3 ];\n\n\t\t// Make sure we update the tween properties later on\n\t\tvalueParts = valueParts || [];\n\n\t\t// Iteratively approximate from a nonzero starting point\n\t\tinitialInUnit = +initial || 1;\n\n\t\tdo {\n\n\t\t\t// If previous iteration zeroed out, double until we get *something*.\n\t\t\t// Use string for doubling so we don\'t accidentally see scale as unchanged below\n\t\t\tscale = scale || ".5";\n\n\t\t\t// Adjust and apply\n\t\t\tinitialInUnit = initialInUnit / scale;\n\t\t\tjQuery.style( elem, prop, initialInUnit + unit );\n\n\t\t// Update scale, tolerating zero or NaN from tween.cur()\n\t\t// Break the loop if scale is unchanged or perfect, or if we\'ve just had enough.\n\t\t} while (\n\t\t\tscale !== ( scale = currentValue() / initial ) && scale !== 1 && --maxIterations\n\t\t);\n\t}\n\n\tif ( valueParts ) {\n\t\tinitialInUnit = +initialInUnit || +initial || 0;\n\n\t\t// Apply relative offset (+=/-=) if specified\n\t\tadjusted = valueParts[ 1 ] ?\n\t\t\tinitialInUnit + ( valueParts[ 1 ] + 1 ) * valueParts[ 2 ] :\n\t\t\t+valueParts[ 2 ];\n\t\tif ( tween ) {\n\t\t\ttween.unit = unit;\n\t\t\ttween.start = initialInUnit;\n\t\t\ttween.end = adjusted;\n\t\t}\n\t}\n\treturn adjusted;\n}\nvar rcheckableType = ( /^(?:checkbox|radio)$/i );\n\nvar rtagName = ( /<([\\w:-]+)/ );\n\nvar rscriptType = ( /^$|\\/(?:java|ecma)script/i );\n\n\n\n// We have to close these tags to support XHTML (#13200)\nvar wrapMap = {\n\n\t// Support: IE9\n\toption: [ 1, "<select multiple=\'multiple\'>", "</select>" ],\n\n\t// XHTML parsers do not magically insert elements in the\n\t// same way that tag soup parsers do. So we cannot shorten\n\t// this by omitting <tbody> or other required elements.\n\tthead: [ 1, "<table>", "</table>" ],\n\tcol: [ 2, "<table><colgroup>", "</colgroup></table>" ],\n\ttr: [ 2, "<table><tbody>", "</tbody></table>" ],\n\ttd: [ 3, "<table><tbody><tr>", "</tr></tbody></table>" ],\n\n\t_default: [ 0, "", "" ]\n};\n\n// Support: IE9\nwrapMap.optgroup = wrapMap.option;\n\nwrapMap.tbody = wrapMap.tfoot = wrapMap.colgroup = wrapMap.caption = wrapMap.thead;\nwrapMap.th = wrapMap.td;\n\n\nfunction getAll( context, tag ) {\n\n\t// Support: IE9-11+\n\t// Use typeof to avoid zero-argument method invocation on host objects (#15151)\n\tvar ret = typeof context.getElementsByTagName !== "undefined" ?\n\t\t\tcontext.getElementsByTagName( tag || "*" ) :\n\t\t\ttypeof context.querySelectorAll !== "undefined" ?\n\t\t\t\tcontext.querySelectorAll( tag || "*" ) :\n\t\t\t[];\n\n\treturn tag === undefined || tag && jQuery.nodeName( context, tag ) ?\n\t\tjQuery.merge( [ context ], ret ) :\n\t\tret;\n}\n\n\n// Mark scripts as having already been evaluated\nfunction setGlobalEval( elems, refElements ) {\n\tvar i = 0,\n\t\tl = elems.length;\n\n\tfor ( ; i < l; i++ ) {\n\t\tdataPriv.set(\n\t\t\telems[ i ],\n\t\t\t"globalEval",\n\t\t\t!refElements || dataPriv.get( refElements[ i ], "globalEval" )\n\t\t);\n\t}\n}\n\n\nvar rhtml = /<|&#?\\w+;/;\n\nfunction buildFragment( elems, context, scripts, selection, ignored ) {\n\tvar elem, tmp, tag, wrap, contains, j,\n\t\tfragment = context.createDocumentFragment(),\n\t\tnodes = [],\n\t\ti = 0,\n\t\tl = elems.length;\n\n\tfor ( ; i < l; i++ ) {\n\t\telem = elems[ i ];\n\n\t\tif ( elem || elem === 0 ) {\n\n\t\t\t// Add nodes directly\n\t\t\tif ( jQuery.type( elem ) === "object" ) {\n\n\t\t\t\t// Support: Android<4.1, PhantomJS<2\n\t\t\t\t// push.apply(_, arraylike) throws on ancient WebKit\n\t\t\t\tjQuery.merge( nodes, elem.nodeType ? [ elem ] : elem );\n\n\t\t\t// Convert non-html into a text node\n\t\t\t} else if ( !rhtml.test( elem ) ) {\n\t\t\t\tnodes.push( context.createTextNode( elem ) );\n\n\t\t\t// Convert html into DOM nodes\n\t\t\t} else {\n\t\t\t\ttmp = tmp || fragment.appendChild( context.createElement( "div" ) );\n\n\t\t\t\t// Deserialize a standard representation\n\t\t\t\ttag = ( rtagName.exec( elem ) || [ "", "" ] )[ 1 ].toLowerCase();\n\t\t\t\twrap = wrapMap[ tag ] || wrapMap._default;\n\t\t\t\ttmp.innerHTML = wrap[ 1 ] + jQuery.htmlPrefilter( elem ) + wrap[ 2 ];\n\n\t\t\t\t// Descend through wrappers to the right content\n\t\t\t\tj = wrap[ 0 ];\n\t\t\t\twhile ( j-- ) {\n\t\t\t\t\ttmp = tmp.lastChild;\n\t\t\t\t}\n\n\t\t\t\t// Support: Android<4.1, PhantomJS<2\n\t\t\t\t// push.apply(_, arraylike) throws on ancient WebKit\n\t\t\t\tjQuery.merge( nodes, tmp.childNodes );\n\n\t\t\t\t// Remember the top-level container\n\t\t\t\ttmp = fragment.firstChild;\n\n\t\t\t\t// Ensure the created nodes are orphaned (#12392)\n\t\t\t\ttmp.textContent = "";\n\t\t\t}\n\t\t}\n\t}\n\n\t// Remove wrapper from fragment\n\tfragment.textContent = "";\n\n\ti = 0;\n\twhile ( ( elem = nodes[ i++ ] ) ) {\n\n\t\t// Skip elements already in the context collection (trac-4087)\n\t\tif ( selection && jQuery.inArray( elem, selection ) > -1 ) {\n\t\t\tif ( ignored ) {\n\t\t\t\tignored.push( elem );\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\n\t\tcontains = jQuery.contains( elem.ownerDocument, elem );\n\n\t\t// Append to fragment\n\t\ttmp = getAll( fragment.appendChild( elem ), "script" );\n\n\t\t// Preserve script evaluation history\n\t\tif ( contains ) {\n\t\t\tsetGlobalEval( tmp );\n\t\t}\n\n\t\t// Capture executables\n\t\tif ( scripts ) {\n\t\t\tj = 0;\n\t\t\twhile ( ( elem = tmp[ j++ ] ) ) {\n\t\t\t\tif ( rscriptType.test( elem.type || "" ) ) {\n\t\t\t\t\tscripts.push( elem );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn fragment;\n}\n\n\n( function() {\n\tvar fragment = document.createDocumentFragment(),\n\t\tdiv = fragment.appendChild( document.createElement( "div" ) ),\n\t\tinput = document.createElement( "input" );\n\n\t// Support: Android 4.0-4.3, Safari<=5.1\n\t// Check state lost if the name is set (#11217)\n\t// Support: Windows Web Apps (WWA)\n\t// `name` and `type` must use .setAttribute for WWA (#14901)\n\tinput.setAttribute( "type", "radio" );\n\tinput.setAttribute( "checked", "checked" );\n\tinput.setAttribute( "name", "t" );\n\n\tdiv.appendChild( input );\n\n\t// Support: Safari<=5.1, Android<4.2\n\t// Older WebKit doesn\'t clone checked state correctly in fragments\n\tsupport.checkClone = div.cloneNode( true ).cloneNode( true ).lastChild.checked;\n\n\t// Support: IE<=11+\n\t// Make sure textarea (and checkbox) defaultValue is properly cloned\n\tdiv.innerHTML = "<textarea>x</textarea>";\n\tsupport.noCloneChecked = !!div.cloneNode( true ).lastChild.defaultValue;\n} )();\n\n\nvar\n\trkeyEvent = /^key/,\n\trmouseEvent = /^(?:mouse|pointer|contextmenu|drag|drop)|click/,\n\trtypenamespace = /^([^.]*)(?:\\.(.+)|)/;\n\nfunction returnTrue() {\n\treturn true;\n}\n\nfunction returnFalse() {\n\treturn false;\n}\n\n// Support: IE9\n// See #13393 for more info\nfunction safeActiveElement() {\n\ttry {\n\t\treturn document.activeElement;\n\t} catch ( err ) { }\n}\n\nfunction on( elem, types, selector, data, fn, one ) {\n\tvar origFn, type;\n\n\t// Types can be a map of types/handlers\n\tif ( typeof types === "object" ) {\n\n\t\t// ( types-Object, selector, data )\n\t\tif ( typeof selector !== "string" ) {\n\n\t\t\t// ( types-Object, data )\n\t\t\tdata = data || selector;\n\t\t\tselector = undefined;\n\t\t}\n\t\tfor ( type in types ) {\n\t\t\ton( elem, type, selector, data, types[ type ], one );\n\t\t}\n\t\treturn elem;\n\t}\n\n\tif ( data == null && fn == null ) {\n\n\t\t// ( types, fn )\n\t\tfn = selector;\n\t\tdata = selector = undefined;\n\t} else if ( fn == null ) {\n\t\tif ( typeof selector === "string" ) {\n\n\t\t\t// ( types, selector, fn )\n\t\t\tfn = data;\n\t\t\tdata = undefined;\n\t\t} else {\n\n\t\t\t// ( types, data, fn )\n\t\t\tfn = data;\n\t\t\tdata = selector;\n\t\t\tselector = undefined;\n\t\t}\n\t}\n\tif ( fn === false ) {\n\t\tfn = returnFalse;\n\t} else if ( !fn ) {\n\t\treturn this;\n\t}\n\n\tif ( one === 1 ) {\n\t\torigFn = fn;\n\t\tfn = function( event ) {\n\n\t\t\t// Can use an empty set, since event contains the info\n\t\t\tjQuery().off( event );\n\t\t\treturn origFn.apply( this, arguments );\n\t\t};\n\n\t\t// Use same guid so caller can remove using origFn\n\t\tfn.guid = origFn.guid || ( origFn.guid = jQuery.guid++ );\n\t}\n\treturn elem.each( function() {\n\t\tjQuery.event.add( this, types, fn, data, selector );\n\t} );\n}\n\n/*\n * Helper functions for managing events -- not part of the public interface.\n * Props to Dean Edwards\' addEvent library for many of the ideas.\n */\njQuery.event = {\n\n\tglobal: {},\n\n\tadd: function( elem, types, handler, data, selector ) {\n\n\t\tvar handleObjIn, eventHandle, tmp,\n\t\t\tevents, t, handleObj,\n\t\t\tspecial, handlers, type, namespaces, origType,\n\t\t\telemData = dataPriv.get( elem );\n\n\t\t// Don\'t attach events to noData or text/comment nodes (but allow plain objects)\n\t\tif ( !elemData ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Caller can pass in an object of custom data in lieu of the handler\n\t\tif ( handler.handler ) {\n\t\t\thandleObjIn = handler;\n\t\t\thandler = handleObjIn.handler;\n\t\t\tselector = handleObjIn.selector;\n\t\t}\n\n\t\t// Make sure that the handler has a unique ID, used to find/remove it later\n\t\tif ( !handler.guid ) {\n\t\t\thandler.guid = jQuery.guid++;\n\t\t}\n\n\t\t// Init the element\'s event structure and main handler, if this is the first\n\t\tif ( !( events = elemData.events ) ) {\n\t\t\tevents = elemData.events = {};\n\t\t}\n\t\tif ( !( eventHandle = elemData.handle ) ) {\n\t\t\teventHandle = elemData.handle = function( e ) {\n\n\t\t\t\t// Discard the second event of a jQuery.event.trigger() and\n\t\t\t\t// when an event is called after a page has unloaded\n\t\t\t\treturn typeof jQuery !== "undefined" && jQuery.event.triggered !== e.type ?\n\t\t\t\t\tjQuery.event.dispatch.apply( elem, arguments ) : undefined;\n\t\t\t};\n\t\t}\n\n\t\t// Handle multiple events separated by a space\n\t\ttypes = ( types || "" ).match( rnotwhite ) || [ "" ];\n\t\tt = types.length;\n\t\twhile ( t-- ) {\n\t\t\ttmp = rtypenamespace.exec( types[ t ] ) || [];\n\t\t\ttype = origType = tmp[ 1 ];\n\t\t\tnamespaces = ( tmp[ 2 ] || "" ).split( "." ).sort();\n\n\t\t\t// There *must* be a type, no attaching namespace-only handlers\n\t\t\tif ( !type ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// If event changes its type, use the special event handlers for the changed type\n\t\t\tspecial = jQuery.event.special[ type ] || {};\n\n\t\t\t// If selector defined, determine special event api type, otherwise given type\n\t\t\ttype = ( selector ? special.delegateType : special.bindType ) || type;\n\n\t\t\t// Update special based on newly reset type\n\t\t\tspecial = jQuery.event.special[ type ] || {};\n\n\t\t\t// handleObj is passed to all event handlers\n\t\t\thandleObj = jQuery.extend( {\n\t\t\t\ttype: type,\n\t\t\t\torigType: origType,\n\t\t\t\tdata: data,\n\t\t\t\thandler: handler,\n\t\t\t\tguid: handler.guid,\n\t\t\t\tselector: selector,\n\t\t\t\tneedsContext: selector && jQuery.expr.match.needsContext.test( selector ),\n\t\t\t\tnamespace: namespaces.join( "." )\n\t\t\t}, handleObjIn );\n\n\t\t\t// Init the event handler queue if we\'re the first\n\t\t\tif ( !( handlers = events[ type ] ) ) {\n\t\t\t\thandlers = events[ type ] = [];\n\t\t\t\thandlers.delegateCount = 0;\n\n\t\t\t\t// Only use addEventListener if the special events handler returns false\n\t\t\t\tif ( !special.setup ||\n\t\t\t\t\tspecial.setup.call( elem, data, namespaces, eventHandle ) === false ) {\n\n\t\t\t\t\tif ( elem.addEventListener ) {\n\t\t\t\t\t\telem.addEventListener( type, eventHandle );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( special.add ) {\n\t\t\t\tspecial.add.call( elem, handleObj );\n\n\t\t\t\tif ( !handleObj.handler.guid ) {\n\t\t\t\t\thandleObj.handler.guid = handler.guid;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Add to the element\'s handler list, delegates in front\n\t\t\tif ( selector ) {\n\t\t\t\thandlers.splice( handlers.delegateCount++, 0, handleObj );\n\t\t\t} else {\n\t\t\t\thandlers.push( handleObj );\n\t\t\t}\n\n\t\t\t// Keep track of which events have ever been used, for event optimization\n\t\t\tjQuery.event.global[ type ] = true;\n\t\t}\n\n\t},\n\n\t// Detach an event or set of events from an element\n\tremove: function( elem, types, handler, selector, mappedTypes ) {\n\n\t\tvar j, origCount, tmp,\n\t\t\tevents, t, handleObj,\n\t\t\tspecial, handlers, type, namespaces, origType,\n\t\t\telemData = dataPriv.hasData( elem ) && dataPriv.get( elem );\n\n\t\tif ( !elemData || !( events = elemData.events ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Once for each type.namespace in types; type may be omitted\n\t\ttypes = ( types || "" ).match( rnotwhite ) || [ "" ];\n\t\tt = types.length;\n\t\twhile ( t-- ) {\n\t\t\ttmp = rtypenamespace.exec( types[ t ] ) || [];\n\t\t\ttype = origType = tmp[ 1 ];\n\t\t\tnamespaces = ( tmp[ 2 ] || "" ).split( "." ).sort();\n\n\t\t\t// Unbind all events (on this namespace, if provided) for the element\n\t\t\tif ( !type ) {\n\t\t\t\tfor ( type in events ) {\n\t\t\t\t\tjQuery.event.remove( elem, type + types[ t ], handler, selector, true );\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tspecial = jQuery.event.special[ type ] || {};\n\t\t\ttype = ( selector ? special.delegateType : special.bindType ) || type;\n\t\t\thandlers = events[ type ] || [];\n\t\t\ttmp = tmp[ 2 ] &&\n\t\t\t\tnew RegExp( "(^|\\\\.)" + namespaces.join( "\\\\.(?:.*\\\\.|)" ) + "(\\\\.|$)" );\n\n\t\t\t// Remove matching events\n\t\t\torigCount = j = handlers.length;\n\t\t\twhile ( j-- ) {\n\t\t\t\thandleObj = handlers[ j ];\n\n\t\t\t\tif ( ( mappedTypes || origType === handleObj.origType ) &&\n\t\t\t\t\t( !handler || handler.guid === handleObj.guid ) &&\n\t\t\t\t\t( !tmp || tmp.test( handleObj.namespace ) ) &&\n\t\t\t\t\t( !selector || selector === handleObj.selector ||\n\t\t\t\t\t\tselector === "**" && handleObj.selector ) ) {\n\t\t\t\t\thandlers.splice( j, 1 );\n\n\t\t\t\t\tif ( handleObj.selector ) {\n\t\t\t\t\t\thandlers.delegateCount--;\n\t\t\t\t\t}\n\t\t\t\t\tif ( special.remove ) {\n\t\t\t\t\t\tspecial.remove.call( elem, handleObj );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Remove generic event handler if we removed something and no more handlers exist\n\t\t\t// (avoids potential for endless recursion during removal of special event handlers)\n\t\t\tif ( origCount && !handlers.length ) {\n\t\t\t\tif ( !special.teardown ||\n\t\t\t\t\tspecial.teardown.call( elem, namespaces, elemData.handle ) === false ) {\n\n\t\t\t\t\tjQuery.removeEvent( elem, type, elemData.handle );\n\t\t\t\t}\n\n\t\t\t\tdelete events[ type ];\n\t\t\t}\n\t\t}\n\n\t\t// Remove data and the expando if it\'s no longer used\n\t\tif ( jQuery.isEmptyObject( events ) ) {\n\t\t\tdataPriv.remove( elem, "handle events" );\n\t\t}\n\t},\n\n\tdispatch: function( event ) {\n\n\t\t// Make a writable jQuery.Event from the native event object\n\t\tevent = jQuery.event.fix( event );\n\n\t\tvar i, j, ret, matched, handleObj,\n\t\t\thandlerQueue = [],\n\t\t\targs = slice.call( arguments ),\n\t\t\thandlers = ( dataPriv.get( this, "events" ) || {} )[ event.type ] || [],\n\t\t\tspecial = jQuery.event.special[ event.type ] || {};\n\n\t\t// Use the fix-ed jQuery.Event rather than the (read-only) native event\n\t\targs[ 0 ] = event;\n\t\tevent.delegateTarget = this;\n\n\t\t// Call the preDispatch hook for the mapped type, and let it bail if desired\n\t\tif ( special.preDispatch && special.preDispatch.call( this, event ) === false ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Determine handlers\n\t\thandlerQueue = jQuery.event.handlers.call( this, event, handlers );\n\n\t\t// Run delegates first; they may want to stop propagation beneath us\n\t\ti = 0;\n\t\twhile ( ( matched = handlerQueue[ i++ ] ) && !event.isPropagationStopped() ) {\n\t\t\tevent.currentTarget = matched.elem;\n\n\t\t\tj = 0;\n\t\t\twhile ( ( handleObj = matched.handlers[ j++ ] ) &&\n\t\t\t\t!event.isImmediatePropagationStopped() ) {\n\n\t\t\t\t// Triggered event must either 1) have no namespace, or 2) have namespace(s)\n\t\t\t\t// a subset or equal to those in the bound event (both can have no namespace).\n\t\t\t\tif ( !event.rnamespace || event.rnamespace.test( handleObj.namespace ) ) {\n\n\t\t\t\t\tevent.handleObj = handleObj;\n\t\t\t\t\tevent.data = handleObj.data;\n\n\t\t\t\t\tret = ( ( jQuery.event.special[ handleObj.origType ] || {} ).handle ||\n\t\t\t\t\t\thandleObj.handler ).apply( matched.elem, args );\n\n\t\t\t\t\tif ( ret !== undefined ) {\n\t\t\t\t\t\tif ( ( event.result = ret ) === false ) {\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Call the postDispatch hook for the mapped type\n\t\tif ( special.postDispatch ) {\n\t\t\tspecial.postDispatch.call( this, event );\n\t\t}\n\n\t\treturn event.result;\n\t},\n\n\thandlers: function( event, handlers ) {\n\t\tvar i, matches, sel, handleObj,\n\t\t\thandlerQueue = [],\n\t\t\tdelegateCount = handlers.delegateCount,\n\t\t\tcur = event.target;\n\n\t\t// Support (at least): Chrome, IE9\n\t\t// Find delegate handlers\n\t\t// Black-hole SVG <use> instance trees (#13180)\n\t\t//\n\t\t// Support: Firefox<=42+\n\t\t// Avoid non-left-click in FF but don\'t block IE radio events (#3861, gh-2343)\n\t\tif ( delegateCount && cur.nodeType &&\n\t\t\t( event.type !== "click" || isNaN( event.button ) || event.button < 1 ) ) {\n\n\t\t\tfor ( ; cur !== this; cur = cur.parentNode || this ) {\n\n\t\t\t\t// Don\'t check non-elements (#13208)\n\t\t\t\t// Don\'t process clicks on disabled elements (#6911, #8165, #11382, #11764)\n\t\t\t\tif ( cur.nodeType === 1 && ( cur.disabled !== true || event.type !== "click" ) ) {\n\t\t\t\t\tmatches = [];\n\t\t\t\t\tfor ( i = 0; i < delegateCount; i++ ) {\n\t\t\t\t\t\thandleObj = handlers[ i ];\n\n\t\t\t\t\t\t// Don\'t conflict with Object.prototype properties (#13203)\n\t\t\t\t\t\tsel = handleObj.selector + " ";\n\n\t\t\t\t\t\tif ( matches[ sel ] === undefined ) {\n\t\t\t\t\t\t\tmatches[ sel ] = handleObj.needsContext ?\n\t\t\t\t\t\t\t\tjQuery( sel, this ).index( cur ) > -1 :\n\t\t\t\t\t\t\t\tjQuery.find( sel, this, null, [ cur ] ).length;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( matches[ sel ] ) {\n\t\t\t\t\t\t\tmatches.push( handleObj );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif ( matches.length ) {\n\t\t\t\t\t\thandlerQueue.push( { elem: cur, handlers: matches } );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Add the remaining (directly-bound) handlers\n\t\tif ( delegateCount < handlers.length ) {\n\t\t\thandlerQueue.push( { elem: this, handlers: handlers.slice( delegateCount ) } );\n\t\t}\n\n\t\treturn handlerQueue;\n\t},\n\n\t// Includes some event props shared by KeyEvent and MouseEvent\n\tprops: ( "altKey bubbles cancelable ctrlKey currentTarget detail eventPhase " +\n\t\t"metaKey relatedTarget shiftKey target timeStamp view which" ).split( " " ),\n\n\tfixHooks: {},\n\n\tkeyHooks: {\n\t\tprops: "char charCode key keyCode".split( " " ),\n\t\tfilter: function( event, original ) {\n\n\t\t\t// Add which for key events\n\t\t\tif ( event.which == null ) {\n\t\t\t\tevent.which = original.charCode != null ? original.charCode : original.keyCode;\n\t\t\t}\n\n\t\t\treturn event;\n\t\t}\n\t},\n\n\tmouseHooks: {\n\t\tprops: ( "button buttons clientX clientY offsetX offsetY pageX pageY " +\n\t\t\t"screenX screenY toElement" ).split( " " ),\n\t\tfilter: function( event, original ) {\n\t\t\tvar eventDoc, doc, body,\n\t\t\t\tbutton = original.button;\n\n\t\t\t// Calculate pageX/Y if missing and clientX/Y available\n\t\t\tif ( event.pageX == null && original.clientX != null ) {\n\t\t\t\teventDoc = event.target.ownerDocument || document;\n\t\t\t\tdoc = eventDoc.documentElement;\n\t\t\t\tbody = eventDoc.body;\n\n\t\t\t\tevent.pageX = original.clientX +\n\t\t\t\t\t( doc && doc.scrollLeft || body && body.scrollLeft || 0 ) -\n\t\t\t\t\t( doc && doc.clientLeft || body && body.clientLeft || 0 );\n\t\t\t\tevent.pageY = original.clientY +\n\t\t\t\t\t( doc && doc.scrollTop  || body && body.scrollTop  || 0 ) -\n\t\t\t\t\t( doc && doc.clientTop  || body && body.clientTop  || 0 );\n\t\t\t}\n\n\t\t\t// Add which for click: 1 === left; 2 === middle; 3 === right\n\t\t\t// Note: button is not normalized, so don\'t use it\n\t\t\tif ( !event.which && button !== undefined ) {\n\t\t\t\tevent.which = ( button & 1 ? 1 : ( button & 2 ? 3 : ( button & 4 ? 2 : 0 ) ) );\n\t\t\t}\n\n\t\t\treturn event;\n\t\t}\n\t},\n\n\tfix: function( event ) {\n\t\tif ( event[ jQuery.expando ] ) {\n\t\t\treturn event;\n\t\t}\n\n\t\t// Create a writable copy of the event object and normalize some properties\n\t\tvar i, prop, copy,\n\t\t\ttype = event.type,\n\t\t\toriginalEvent = event,\n\t\t\tfixHook = this.fixHooks[ type ];\n\n\t\tif ( !fixHook ) {\n\t\t\tthis.fixHooks[ type ] = fixHook =\n\t\t\t\trmouseEvent.test( type ) ? this.mouseHooks :\n\t\t\t\trkeyEvent.test( type ) ? this.keyHooks :\n\t\t\t\t{};\n\t\t}\n\t\tcopy = fixHook.props ? this.props.concat( fixHook.props ) : this.props;\n\n\t\tevent = new jQuery.Event( originalEvent );\n\n\t\ti = copy.length;\n\t\twhile ( i-- ) {\n\t\t\tprop = copy[ i ];\n\t\t\tevent[ prop ] = originalEvent[ prop ];\n\t\t}\n\n\t\t// Support: Cordova 2.5 (WebKit) (#13255)\n\t\t// All events should have a target; Cordova deviceready doesn\'t\n\t\tif ( !event.target ) {\n\t\t\tevent.target = document;\n\t\t}\n\n\t\t// Support: Safari 6.0+, Chrome<28\n\t\t// Target should not be a text node (#504, #13143)\n\t\tif ( event.target.nodeType === 3 ) {\n\t\t\tevent.target = event.target.parentNode;\n\t\t}\n\n\t\treturn fixHook.filter ? fixHook.filter( event, originalEvent ) : event;\n\t},\n\n\tspecial: {\n\t\tload: {\n\n\t\t\t// Prevent triggered image.load events from bubbling to window.load\n\t\t\tnoBubble: true\n\t\t},\n\t\tfocus: {\n\n\t\t\t// Fire native event if possible so blur/focus sequence is correct\n\t\t\ttrigger: function() {\n\t\t\t\tif ( this !== safeActiveElement() && this.focus ) {\n\t\t\t\t\tthis.focus();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t},\n\t\t\tdelegateType: "focusin"\n\t\t},\n\t\tblur: {\n\t\t\ttrigger: function() {\n\t\t\t\tif ( this === safeActiveElement() && this.blur ) {\n\t\t\t\t\tthis.blur();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t},\n\t\t\tdelegateType: "focusout"\n\t\t},\n\t\tclick: {\n\n\t\t\t// For checkbox, fire native event so checked state will be right\n\t\t\ttrigger: function() {\n\t\t\t\tif ( this.type === "checkbox" && this.click && jQuery.nodeName( this, "input" ) ) {\n\t\t\t\t\tthis.click();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// For cross-browser consistency, don\'t fire native .click() on links\n\t\t\t_default: function( event ) {\n\t\t\t\treturn jQuery.nodeName( event.target, "a" );\n\t\t\t}\n\t\t},\n\n\t\tbeforeunload: {\n\t\t\tpostDispatch: function( event ) {\n\n\t\t\t\t// Support: Firefox 20+\n\t\t\t\t// Firefox doesn\'t alert if the returnValue field is not set.\n\t\t\t\tif ( event.result !== undefined && event.originalEvent ) {\n\t\t\t\t\tevent.originalEvent.returnValue = event.result;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n};\n\njQuery.removeEvent = function( elem, type, handle ) {\n\n\t// This "if" is needed for plain objects\n\tif ( elem.removeEventListener ) {\n\t\telem.removeEventListener( type, handle );\n\t}\n};\n\njQuery.Event = function( src, props ) {\n\n\t// Allow instantiation without the \'new\' keyword\n\tif ( !( this instanceof jQuery.Event ) ) {\n\t\treturn new jQuery.Event( src, props );\n\t}\n\n\t// Event object\n\tif ( src && src.type ) {\n\t\tthis.originalEvent = src;\n\t\tthis.type = src.type;\n\n\t\t// Events bubbling up the document may have been marked as prevented\n\t\t// by a handler lower down the tree; reflect the correct value.\n\t\tthis.isDefaultPrevented = src.defaultPrevented ||\n\t\t\t\tsrc.defaultPrevented === undefined &&\n\n\t\t\t\t// Support: Android<4.0\n\t\t\t\tsrc.returnValue === false ?\n\t\t\treturnTrue :\n\t\t\treturnFalse;\n\n\t// Event type\n\t} else {\n\t\tthis.type = src;\n\t}\n\n\t// Put explicitly provided properties onto the event object\n\tif ( props ) {\n\t\tjQuery.extend( this, props );\n\t}\n\n\t// Create a timestamp if incoming event doesn\'t have one\n\tthis.timeStamp = src && src.timeStamp || jQuery.now();\n\n\t// Mark it as fixed\n\tthis[ jQuery.expando ] = true;\n};\n\n// jQuery.Event is based on DOM3 Events as specified by the ECMAScript Language Binding\n// http://www.w3.org/TR/2003/WD-DOM-Level-3-Events-20030331/ecma-script-binding.html\njQuery.Event.prototype = {\n\tconstructor: jQuery.Event,\n\tisDefaultPrevented: returnFalse,\n\tisPropagationStopped: returnFalse,\n\tisImmediatePropagationStopped: returnFalse,\n\n\tpreventDefault: function() {\n\t\tvar e = this.originalEvent;\n\n\t\tthis.isDefaultPrevented = returnTrue;\n\n\t\tif ( e ) {\n\t\t\te.preventDefault();\n\t\t}\n\t},\n\tstopPropagation: function() {\n\t\tvar e = this.originalEvent;\n\n\t\tthis.isPropagationStopped = returnTrue;\n\n\t\tif ( e ) {\n\t\t\te.stopPropagation();\n\t\t}\n\t},\n\tstopImmediatePropagation: function() {\n\t\tvar e = this.originalEvent;\n\n\t\tthis.isImmediatePropagationStopped = returnTrue;\n\n\t\tif ( e ) {\n\t\t\te.stopImmediatePropagation();\n\t\t}\n\n\t\tthis.stopPropagation();\n\t}\n};\n\n// Create mouseenter/leave events using mouseover/out and event-time checks\n// so that event delegation works in jQuery.\n// Do the same for pointerenter/pointerleave and pointerover/pointerout\n//\n// Support: Safari 7 only\n// Safari sends mouseenter too often; see:\n// https://code.google.com/p/chromium/issues/detail?id=470258\n// for the description of the bug (it existed in older Chrome versions as well).\njQuery.each( {\n\tmouseenter: "mouseover",\n\tmouseleave: "mouseout",\n\tpointerenter: "pointerover",\n\tpointerleave: "pointerout"\n}, function( orig, fix ) {\n\tjQuery.event.special[ orig ] = {\n\t\tdelegateType: fix,\n\t\tbindType: fix,\n\n\t\thandle: function( event ) {\n\t\t\tvar ret,\n\t\t\t\ttarget = this,\n\t\t\t\trelated = event.relatedTarget,\n\t\t\t\thandleObj = event.handleObj;\n\n\t\t\t// For mouseenter/leave call the handler if related is outside the target.\n\t\t\t// NB: No relatedTarget if the mouse left/entered the browser window\n\t\t\tif ( !related || ( related !== target && !jQuery.contains( target, related ) ) ) {\n\t\t\t\tevent.type = handleObj.origType;\n\t\t\t\tret = handleObj.handler.apply( this, arguments );\n\t\t\t\tevent.type = fix;\n\t\t\t}\n\t\t\treturn ret;\n\t\t}\n\t};\n} );\n\njQuery.fn.extend( {\n\ton: function( types, selector, data, fn ) {\n\t\treturn on( this, types, selector, data, fn );\n\t},\n\tone: function( types, selector, data, fn ) {\n\t\treturn on( this, types, selector, data, fn, 1 );\n\t},\n\toff: function( types, selector, fn ) {\n\t\tvar handleObj, type;\n\t\tif ( types && types.preventDefault && types.handleObj ) {\n\n\t\t\t// ( event )  dispatched jQuery.Event\n\t\t\thandleObj = types.handleObj;\n\t\t\tjQuery( types.delegateTarget ).off(\n\t\t\t\thandleObj.namespace ?\n\t\t\t\t\thandleObj.origType + "." + handleObj.namespace :\n\t\t\t\t\thandleObj.origType,\n\t\t\t\thandleObj.selector,\n\t\t\t\thandleObj.handler\n\t\t\t);\n\t\t\treturn this;\n\t\t}\n\t\tif ( typeof types === "object" ) {\n\n\t\t\t// ( types-object [, selector] )\n\t\t\tfor ( type in types ) {\n\t\t\t\tthis.off( type, selector, types[ type ] );\n\t\t\t}\n\t\t\treturn this;\n\t\t}\n\t\tif ( selector === false || typeof selector === "function" ) {\n\n\t\t\t// ( types [, fn] )\n\t\t\tfn = selector;\n\t\t\tselector = undefined;\n\t\t}\n\t\tif ( fn === false ) {\n\t\t\tfn = returnFalse;\n\t\t}\n\t\treturn this.each( function() {\n\t\t\tjQuery.event.remove( this, types, fn, selector );\n\t\t} );\n\t}\n} );\n\n\nvar\n\trxhtmlTag = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:-]+)[^>]*)\\/>/gi,\n\n\t// Support: IE 10-11, Edge 10240+\n\t// In IE/Edge using regex groups here causes severe slowdowns.\n\t// See https://connect.microsoft.com/IE/feedback/details/1736512/\n\trnoInnerhtml = /<script|<style|<link/i,\n\n\t// checked="checked" or checked\n\trchecked = /checked\\s*(?:[^=]|=\\s*.checked.)/i,\n\trscriptTypeMasked = /^true\\/(.*)/,\n\trcleanScript = /^\\s*<!(?:\\[CDATA\\[|--)|(?:\\]\\]|--)>\\s*$/g;\n\nfunction manipulationTarget( elem, content ) {\n\tif ( jQuery.nodeName( elem, "table" ) &&\n\t\tjQuery.nodeName( content.nodeType !== 11 ? content : content.firstChild, "tr" ) ) {\n\n\t\treturn elem.getElementsByTagName( "tbody" )[ 0 ] || elem;\n\t}\n\n\treturn elem;\n}\n\n// Replace/restore the type attribute of script elements for safe DOM manipulation\nfunction disableScript( elem ) {\n\telem.type = ( elem.getAttribute( "type" ) !== null ) + "/" + elem.type;\n\treturn elem;\n}\nfunction restoreScript( elem ) {\n\tvar match = rscriptTypeMasked.exec( elem.type );\n\n\tif ( match ) {\n\t\telem.type = match[ 1 ];\n\t} else {\n\t\telem.removeAttribute( "type" );\n\t}\n\n\treturn elem;\n}\n\nfunction cloneCopyEvent( src, dest ) {\n\tvar i, l, type, pdataOld, pdataCur, udataOld, udataCur, events;\n\n\tif ( dest.nodeType !== 1 ) {\n\t\treturn;\n\t}\n\n\t// 1. Copy private data: events, handlers, etc.\n\tif ( dataPriv.hasData( src ) ) {\n\t\tpdataOld = dataPriv.access( src );\n\t\tpdataCur = dataPriv.set( dest, pdataOld );\n\t\tevents = pdataOld.events;\n\n\t\tif ( events ) {\n\t\t\tdelete pdataCur.handle;\n\t\t\tpdataCur.events = {};\n\n\t\t\tfor ( type in events ) {\n\t\t\t\tfor ( i = 0, l = events[ type ].length; i < l; i++ ) {\n\t\t\t\t\tjQuery.event.add( dest, type, events[ type ][ i ] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// 2. Copy user data\n\tif ( dataUser.hasData( src ) ) {\n\t\tudataOld = dataUser.access( src );\n\t\tudataCur = jQuery.extend( {}, udataOld );\n\n\t\tdataUser.set( dest, udataCur );\n\t}\n}\n\n// Fix IE bugs, see support tests\nfunction fixInput( src, dest ) {\n\tvar nodeName = dest.nodeName.toLowerCase();\n\n\t// Fails to persist the checked state of a cloned checkbox or radio button.\n\tif ( nodeName === "input" && rcheckableType.test( src.type ) ) {\n\t\tdest.checked = src.checked;\n\n\t// Fails to return the selected option to the default selected state when cloning options\n\t} else if ( nodeName === "input" || nodeName === "textarea" ) {\n\t\tdest.defaultValue = src.defaultValue;\n\t}\n}\n\nfunction domManip( collection, args, callback, ignored ) {\n\n\t// Flatten any nested arrays\n\targs = concat.apply( [], args );\n\n\tvar fragment, first, scripts, hasScripts, node, doc,\n\t\ti = 0,\n\t\tl = collection.length,\n\t\tiNoClone = l - 1,\n\t\tvalue = args[ 0 ],\n\t\tisFunction = jQuery.isFunction( value );\n\n\t// We can\'t cloneNode fragments that contain checked, in WebKit\n\tif ( isFunction ||\n\t\t\t( l > 1 && typeof value === "string" &&\n\t\t\t\t!support.checkClone && rchecked.test( value ) ) ) {\n\t\treturn collection.each( function( index ) {\n\t\t\tvar self = collection.eq( index );\n\t\t\tif ( isFunction ) {\n\t\t\t\targs[ 0 ] = value.call( this, index, self.html() );\n\t\t\t}\n\t\t\tdomManip( self, args, callback, ignored );\n\t\t} );\n\t}\n\n\tif ( l ) {\n\t\tfragment = buildFragment( args, collection[ 0 ].ownerDocument, false, collection, ignored );\n\t\tfirst = fragment.firstChild;\n\n\t\tif ( fragment.childNodes.length === 1 ) {\n\t\t\tfragment = first;\n\t\t}\n\n\t\t// Require either new content or an interest in ignored elements to invoke the callback\n\t\tif ( first || ignored ) {\n\t\t\tscripts = jQuery.map( getAll( fragment, "script" ), disableScript );\n\t\t\thasScripts = scripts.length;\n\n\t\t\t// Use the original fragment for the last item\n\t\t\t// instead of the first because it can end up\n\t\t\t// being emptied incorrectly in certain situations (#8070).\n\t\t\tfor ( ; i < l; i++ ) {\n\t\t\t\tnode = fragment;\n\n\t\t\t\tif ( i !== iNoClone ) {\n\t\t\t\t\tnode = jQuery.clone( node, true, true );\n\n\t\t\t\t\t// Keep references to cloned scripts for later restoration\n\t\t\t\t\tif ( hasScripts ) {\n\n\t\t\t\t\t\t// Support: Android<4.1, PhantomJS<2\n\t\t\t\t\t\t// push.apply(_, arraylike) throws on ancient WebKit\n\t\t\t\t\t\tjQuery.merge( scripts, getAll( node, "script" ) );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tcallback.call( collection[ i ], node, i );\n\t\t\t}\n\n\t\t\tif ( hasScripts ) {\n\t\t\t\tdoc = scripts[ scripts.length - 1 ].ownerDocument;\n\n\t\t\t\t// Reenable scripts\n\t\t\t\tjQuery.map( scripts, restoreScript );\n\n\t\t\t\t// Evaluate executable scripts on first document insertion\n\t\t\t\tfor ( i = 0; i < hasScripts; i++ ) {\n\t\t\t\t\tnode = scripts[ i ];\n\t\t\t\t\tif ( rscriptType.test( node.type || "" ) &&\n\t\t\t\t\t\t!dataPriv.access( node, "globalEval" ) &&\n\t\t\t\t\t\tjQuery.contains( doc, node ) ) {\n\n\t\t\t\t\t\tif ( node.src ) {\n\n\t\t\t\t\t\t\t// Optional AJAX dependency, but won\'t run scripts if not present\n\t\t\t\t\t\t\tif ( jQuery._evalUrl ) {\n\t\t\t\t\t\t\t\tjQuery._evalUrl( node.src );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tjQuery.globalEval( node.textContent.replace( rcleanScript, "" ) );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn collection;\n}\n\nfunction remove( elem, selector, keepData ) {\n\tvar node,\n\t\tnodes = selector ? jQuery.filter( selector, elem ) : elem,\n\t\ti = 0;\n\n\tfor ( ; ( node = nodes[ i ] ) != null; i++ ) {\n\t\tif ( !keepData && node.nodeType === 1 ) {\n\t\t\tjQuery.cleanData( getAll( node ) );\n\t\t}\n\n\t\tif ( node.parentNode ) {\n\t\t\tif ( keepData && jQuery.contains( node.ownerDocument, node ) ) {\n\t\t\t\tsetGlobalEval( getAll( node, "script" ) );\n\t\t\t}\n\t\t\tnode.parentNode.removeChild( node );\n\t\t}\n\t}\n\n\treturn elem;\n}\n\njQuery.extend( {\n\thtmlPrefilter: function( html ) {\n\t\treturn html.replace( rxhtmlTag, "<$1></$2>" );\n\t},\n\n\tclone: function( elem, dataAndEvents, deepDataAndEvents ) {\n\t\tvar i, l, srcElements, destElements,\n\t\t\tclone = elem.cloneNode( true ),\n\t\t\tinPage = jQuery.contains( elem.ownerDocument, elem );\n\n\t\t// Fix IE cloning issues\n\t\tif ( !support.noCloneChecked && ( elem.nodeType === 1 || elem.nodeType === 11 ) &&\n\t\t\t\t!jQuery.isXMLDoc( elem ) ) {\n\n\t\t\t// We eschew Sizzle here for performance reasons: http://jsperf.com/getall-vs-sizzle/2\n\t\t\tdestElements = getAll( clone );\n\t\t\tsrcElements = getAll( elem );\n\n\t\t\tfor ( i = 0, l = srcElements.length; i < l; i++ ) {\n\t\t\t\tfixInput( srcElements[ i ], destElements[ i ] );\n\t\t\t}\n\t\t}\n\n\t\t// Copy the events from the original to the clone\n\t\tif ( dataAndEvents ) {\n\t\t\tif ( deepDataAndEvents ) {\n\t\t\t\tsrcElements = srcElements || getAll( elem );\n\t\t\t\tdestElements = destElements || getAll( clone );\n\n\t\t\t\tfor ( i = 0, l = srcElements.length; i < l; i++ ) {\n\t\t\t\t\tcloneCopyEvent( srcElements[ i ], destElements[ i ] );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcloneCopyEvent( elem, clone );\n\t\t\t}\n\t\t}\n\n\t\t// Preserve script evaluation history\n\t\tdestElements = getAll( clone, "script" );\n\t\tif ( destElements.length > 0 ) {\n\t\t\tsetGlobalEval( destElements, !inPage && getAll( elem, "script" ) );\n\t\t}\n\n\t\t// Return the cloned set\n\t\treturn clone;\n\t},\n\n\tcleanData: function( elems ) {\n\t\tvar data, elem, type,\n\t\t\tspecial = jQuery.event.special,\n\t\t\ti = 0;\n\n\t\tfor ( ; ( elem = elems[ i ] ) !== undefined; i++ ) {\n\t\t\tif ( acceptData( elem ) ) {\n\t\t\t\tif ( ( data = elem[ dataPriv.expando ] ) ) {\n\t\t\t\t\tif ( data.events ) {\n\t\t\t\t\t\tfor ( type in data.events ) {\n\t\t\t\t\t\t\tif ( special[ type ] ) {\n\t\t\t\t\t\t\t\tjQuery.event.remove( elem, type );\n\n\t\t\t\t\t\t\t// This is a shortcut to avoid jQuery.event.remove\'s overhead\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tjQuery.removeEvent( elem, type, data.handle );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Support: Chrome <= 35-45+\n\t\t\t\t\t// Assign undefined instead of using delete, see Data#remove\n\t\t\t\t\telem[ dataPriv.expando ] = undefined;\n\t\t\t\t}\n\t\t\t\tif ( elem[ dataUser.expando ] ) {\n\n\t\t\t\t\t// Support: Chrome <= 35-45+\n\t\t\t\t\t// Assign undefined instead of using delete, see Data#remove\n\t\t\t\t\telem[ dataUser.expando ] = undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n} );\n\njQuery.fn.extend( {\n\n\t// Keep domManip exposed until 3.0 (gh-2225)\n\tdomManip: domManip,\n\n\tdetach: function( selector ) {\n\t\treturn remove( this, selector, true );\n\t},\n\n\tremove: function( selector ) {\n\t\treturn remove( this, selector );\n\t},\n\n\ttext: function( value ) {\n\t\treturn access( this, function( value ) {\n\t\t\treturn value === undefined ?\n\t\t\t\tjQuery.text( this ) :\n\t\t\t\tthis.empty().each( function() {\n\t\t\t\t\tif ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {\n\t\t\t\t\t\tthis.textContent = value;\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t}, null, value, arguments.length );\n\t},\n\n\tappend: function() {\n\t\treturn domManip( this, arguments, function( elem ) {\n\t\t\tif ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {\n\t\t\t\tvar target = manipulationTarget( this, elem );\n\t\t\t\ttarget.appendChild( elem );\n\t\t\t}\n\t\t} );\n\t},\n\n\tprepend: function() {\n\t\treturn domManip( this, arguments, function( elem ) {\n\t\t\tif ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {\n\t\t\t\tvar target = manipulationTarget( this, elem );\n\t\t\t\ttarget.insertBefore( elem, target.firstChild );\n\t\t\t}\n\t\t} );\n\t},\n\n\tbefore: function() {\n\t\treturn domManip( this, arguments, function( elem ) {\n\t\t\tif ( this.parentNode ) {\n\t\t\t\tthis.parentNode.insertBefore( elem, this );\n\t\t\t}\n\t\t} );\n\t},\n\n\tafter: function() {\n\t\treturn domManip( this, arguments, function( elem ) {\n\t\t\tif ( this.parentNode ) {\n\t\t\t\tthis.parentNode.insertBefore( elem, this.nextSibling );\n\t\t\t}\n\t\t} );\n\t},\n\n\tempty: function() {\n\t\tvar elem,\n\t\t\ti = 0;\n\n\t\tfor ( ; ( elem = this[ i ] ) != null; i++ ) {\n\t\t\tif ( elem.nodeType === 1 ) {\n\n\t\t\t\t// Prevent memory leaks\n\t\t\t\tjQuery.cleanData( getAll( elem, false ) );\n\n\t\t\t\t// Remove any remaining nodes\n\t\t\t\telem.textContent = "";\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tclone: function( dataAndEvents, deepDataAndEvents ) {\n\t\tdataAndEvents = dataAndEvents == null ? false : dataAndEvents;\n\t\tdeepDataAndEvents = deepDataAndEvents == null ? dataAndEvents : deepDataAndEvents;\n\n\t\treturn this.map( function() {\n\t\t\treturn jQuery.clone( this, dataAndEvents, deepDataAndEvents );\n\t\t} );\n\t},\n\n\thtml: function( value ) {\n\t\treturn access( this, function( value ) {\n\t\t\tvar elem = this[ 0 ] || {},\n\t\t\t\ti = 0,\n\t\t\t\tl = this.length;\n\n\t\t\tif ( value === undefined && elem.nodeType === 1 ) {\n\t\t\t\treturn elem.innerHTML;\n\t\t\t}\n\n\t\t\t// See if we can take a shortcut and just use innerHTML\n\t\t\tif ( typeof value === "string" && !rnoInnerhtml.test( value ) &&\n\t\t\t\t!wrapMap[ ( rtagName.exec( value ) || [ "", "" ] )[ 1 ].toLowerCase() ] ) {\n\n\t\t\t\tvalue = jQuery.htmlPrefilter( value );\n\n\t\t\t\ttry {\n\t\t\t\t\tfor ( ; i < l; i++ ) {\n\t\t\t\t\t\telem = this[ i ] || {};\n\n\t\t\t\t\t\t// Remove element nodes and prevent memory leaks\n\t\t\t\t\t\tif ( elem.nodeType === 1 ) {\n\t\t\t\t\t\t\tjQuery.cleanData( getAll( elem, false ) );\n\t\t\t\t\t\t\telem.innerHTML = value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\telem = 0;\n\n\t\t\t\t// If using innerHTML throws an exception, use the fallback method\n\t\t\t\t} catch ( e ) {}\n\t\t\t}\n\n\t\t\tif ( elem ) {\n\t\t\t\tthis.empty().append( value );\n\t\t\t}\n\t\t}, null, value, arguments.length );\n\t},\n\n\treplaceWith: function() {\n\t\tvar ignored = [];\n\n\t\t// Make the changes, replacing each non-ignored context element with the new content\n\t\treturn domManip( this, arguments, function( elem ) {\n\t\t\tvar parent = this.parentNode;\n\n\t\t\tif ( jQuery.inArray( this, ignored ) < 0 ) {\n\t\t\t\tjQuery.cleanData( getAll( this ) );\n\t\t\t\tif ( parent ) {\n\t\t\t\t\tparent.replaceChild( elem, this );\n\t\t\t\t}\n\t\t\t}\n\n\t\t// Force callback invocation\n\t\t}, ignored );\n\t}\n} );\n\njQuery.each( {\n\tappendTo: "append",\n\tprependTo: "prepend",\n\tinsertBefore: "before",\n\tinsertAfter: "after",\n\treplaceAll: "replaceWith"\n}, function( name, original ) {\n\tjQuery.fn[ name ] = function( selector ) {\n\t\tvar elems,\n\t\t\tret = [],\n\t\t\tinsert = jQuery( selector ),\n\t\t\tlast = insert.length - 1,\n\t\t\ti = 0;\n\n\t\tfor ( ; i <= last; i++ ) {\n\t\t\telems = i === last ? this : this.clone( true );\n\t\t\tjQuery( insert[ i ] )[ original ]( elems );\n\n\t\t\t// Support: QtWebKit\n\t\t\t// .get() because push.apply(_, arraylike) throws\n\t\t\tpush.apply( ret, elems.get() );\n\t\t}\n\n\t\treturn this.pushStack( ret );\n\t};\n} );\n\n\nvar iframe,\n\telemdisplay = {\n\n\t\t// Support: Firefox\n\t\t// We have to pre-define these values for FF (#10227)\n\t\tHTML: "block",\n\t\tBODY: "block"\n\t};\n\n/**\n * Retrieve the actual display of a element\n * @param {String} name nodeName of the element\n * @param {Object} doc Document object\n */\n\n// Called only from within defaultDisplay\nfunction actualDisplay( name, doc ) {\n\tvar elem = jQuery( doc.createElement( name ) ).appendTo( doc.body ),\n\n\t\tdisplay = jQuery.css( elem[ 0 ], "display" );\n\n\t// We don\'t have any data stored on the element,\n\t// so use "detach" method as fast way to get rid of the element\n\telem.detach();\n\n\treturn display;\n}\n\n/**\n * Try to determine the default display value of an element\n * @param {String} nodeName\n */\nfunction defaultDisplay( nodeName ) {\n\tvar doc = document,\n\t\tdisplay = elemdisplay[ nodeName ];\n\n\tif ( !display ) {\n\t\tdisplay = actualDisplay( nodeName, doc );\n\n\t\t// If the simple way fails, read from inside an iframe\n\t\tif ( display === "none" || !display ) {\n\n\t\t\t// Use the already-created iframe if possible\n\t\t\tiframe = ( iframe || jQuery( "<iframe frameborder=\'0\' width=\'0\' height=\'0\'/>" ) )\n\t\t\t\t.appendTo( doc.documentElement );\n\n\t\t\t// Always write a new HTML skeleton so Webkit and Firefox don\'t choke on reuse\n\t\t\tdoc = iframe[ 0 ].contentDocument;\n\n\t\t\t// Support: IE\n\t\t\tdoc.write();\n\t\t\tdoc.close();\n\n\t\t\tdisplay = actualDisplay( nodeName, doc );\n\t\t\tiframe.detach();\n\t\t}\n\n\t\t// Store the correct default display\n\t\telemdisplay[ nodeName ] = display;\n\t}\n\n\treturn display;\n}\nvar rmargin = ( /^margin/ );\n\nvar rnumnonpx = new RegExp( "^(" + pnum + ")(?!px)[a-z%]+$", "i" );\n\nvar getStyles = function( elem ) {\n\n\t\t// Support: IE<=11+, Firefox<=30+ (#15098, #14150)\n\t\t// IE throws on elements created in popups\n\t\t// FF meanwhile throws on frame elements through "defaultView.getComputedStyle"\n\t\tvar view = elem.ownerDocument.defaultView;\n\n\t\tif ( !view.opener ) {\n\t\t\tview = window;\n\t\t}\n\n\t\treturn view.getComputedStyle( elem );\n\t};\n\nvar swap = function( elem, options, callback, args ) {\n\tvar ret, name,\n\t\told = {};\n\n\t// Remember the old values, and insert the new ones\n\tfor ( name in options ) {\n\t\told[ name ] = elem.style[ name ];\n\t\telem.style[ name ] = options[ name ];\n\t}\n\n\tret = callback.apply( elem, args || [] );\n\n\t// Revert the old values\n\tfor ( name in options ) {\n\t\telem.style[ name ] = old[ name ];\n\t}\n\n\treturn ret;\n};\n\n\nvar documentElement = document.documentElement;\n\n\n\n( function() {\n\tvar pixelPositionVal, boxSizingReliableVal, pixelMarginRightVal, reliableMarginLeftVal,\n\t\tcontainer = document.createElement( "div" ),\n\t\tdiv = document.createElement( "div" );\n\n\t// Finish early in limited (non-browser) environments\n\tif ( !div.style ) {\n\t\treturn;\n\t}\n\n\t// Support: IE9-11+\n\t// Style of cloned element affects source element cloned (#8908)\n\tdiv.style.backgroundClip = "content-box";\n\tdiv.cloneNode( true ).style.backgroundClip = "";\n\tsupport.clearCloneStyle = div.style.backgroundClip === "content-box";\n\n\tcontainer.style.cssText = "border:0;width:8px;height:0;top:0;left:-9999px;" +\n\t\t"padding:0;margin-top:1px;position:absolute";\n\tcontainer.appendChild( div );\n\n\t// Executing both pixelPosition & boxSizingReliable tests require only one layout\n\t// so they\'re executed at the same time to save the second computation.\n\tfunction computeStyleTests() {\n\t\tdiv.style.cssText =\n\n\t\t\t// Support: Firefox<29, Android 2.3\n\t\t\t// Vendor-prefix box-sizing\n\t\t\t"-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;" +\n\t\t\t"position:relative;display:block;" +\n\t\t\t"margin:auto;border:1px;padding:1px;" +\n\t\t\t"top:1%;width:50%";\n\t\tdiv.innerHTML = "";\n\t\tdocumentElement.appendChild( container );\n\n\t\tvar divStyle = window.getComputedStyle( div );\n\t\tpixelPositionVal = divStyle.top !== "1%";\n\t\treliableMarginLeftVal = divStyle.marginLeft === "2px";\n\t\tboxSizingReliableVal = divStyle.width === "4px";\n\n\t\t// Support: Android 4.0 - 4.3 only\n\t\t// Some styles come back with percentage values, even though they shouldn\'t\n\t\tdiv.style.marginRight = "50%";\n\t\tpixelMarginRightVal = divStyle.marginRight === "4px";\n\n\t\tdocumentElement.removeChild( container );\n\t}\n\n\tjQuery.extend( support, {\n\t\tpixelPosition: function() {\n\n\t\t\t// This test is executed only once but we still do memoizing\n\t\t\t// since we can use the boxSizingReliable pre-computing.\n\t\t\t// No need to check if the test was already performed, though.\n\t\t\tcomputeStyleTests();\n\t\t\treturn pixelPositionVal;\n\t\t},\n\t\tboxSizingReliable: function() {\n\t\t\tif ( boxSizingReliableVal == null ) {\n\t\t\t\tcomputeStyleTests();\n\t\t\t}\n\t\t\treturn boxSizingReliableVal;\n\t\t},\n\t\tpixelMarginRight: function() {\n\n\t\t\t// Support: Android 4.0-4.3\n\t\t\t// We\'re checking for boxSizingReliableVal here instead of pixelMarginRightVal\n\t\t\t// since that compresses better and they\'re computed together anyway.\n\t\t\tif ( boxSizingReliableVal == null ) {\n\t\t\t\tcomputeStyleTests();\n\t\t\t}\n\t\t\treturn pixelMarginRightVal;\n\t\t},\n\t\treliableMarginLeft: function() {\n\n\t\t\t// Support: IE <=8 only, Android 4.0 - 4.3 only, Firefox <=3 - 37\n\t\t\tif ( boxSizingReliableVal == null ) {\n\t\t\t\tcomputeStyleTests();\n\t\t\t}\n\t\t\treturn reliableMarginLeftVal;\n\t\t},\n\t\treliableMarginRight: function() {\n\n\t\t\t// Support: Android 2.3\n\t\t\t// Check if div with explicit width and no margin-right incorrectly\n\t\t\t// gets computed margin-right based on width of container. (#3333)\n\t\t\t// WebKit Bug 13343 - getComputedStyle returns wrong value for margin-right\n\t\t\t// This support function is only executed once so no memoizing is needed.\n\t\t\tvar ret,\n\t\t\t\tmarginDiv = div.appendChild( document.createElement( "div" ) );\n\n\t\t\t// Reset CSS: box-sizing; display; margin; border; padding\n\t\t\tmarginDiv.style.cssText = div.style.cssText =\n\n\t\t\t\t// Support: Android 2.3\n\t\t\t\t// Vendor-prefix box-sizing\n\t\t\t\t"-webkit-box-sizing:content-box;box-sizing:content-box;" +\n\t\t\t\t"display:block;margin:0;border:0;padding:0";\n\t\t\tmarginDiv.style.marginRight = marginDiv.style.width = "0";\n\t\t\tdiv.style.width = "1px";\n\t\t\tdocumentElement.appendChild( container );\n\n\t\t\tret = !parseFloat( window.getComputedStyle( marginDiv ).marginRight );\n\n\t\t\tdocumentElement.removeChild( container );\n\t\t\tdiv.removeChild( marginDiv );\n\n\t\t\treturn ret;\n\t\t}\n\t} );\n} )();\n\n\nfunction curCSS( elem, name, computed ) {\n\tvar width, minWidth, maxWidth, ret,\n\t\tstyle = elem.style;\n\n\tcomputed = computed || getStyles( elem );\n\n\t// Support: IE9\n\t// getPropertyValue is only needed for .css(\'filter\') (#12537)\n\tif ( computed ) {\n\t\tret = computed.getPropertyValue( name ) || computed[ name ];\n\n\t\tif ( ret === "" && !jQuery.contains( elem.ownerDocument, elem ) ) {\n\t\t\tret = jQuery.style( elem, name );\n\t\t}\n\n\t\t// A tribute to the "awesome hack by Dean Edwards"\n\t\t// Android Browser returns percentage for some values,\n\t\t// but width seems to be reliably pixels.\n\t\t// This is against the CSSOM draft spec:\n\t\t// http://dev.w3.org/csswg/cssom/#resolved-values\n\t\tif ( !support.pixelMarginRight() && rnumnonpx.test( ret ) && rmargin.test( name ) ) {\n\n\t\t\t// Remember the original values\n\t\t\twidth = style.width;\n\t\t\tminWidth = style.minWidth;\n\t\t\tmaxWidth = style.maxWidth;\n\n\t\t\t// Put in the new values to get a computed value out\n\t\t\tstyle.minWidth = style.maxWidth = style.width = ret;\n\t\t\tret = computed.width;\n\n\t\t\t// Revert the changed values\n\t\t\tstyle.width = width;\n\t\t\tstyle.minWidth = minWidth;\n\t\t\tstyle.maxWidth = maxWidth;\n\t\t}\n\t}\n\n\treturn ret !== undefined ?\n\n\t\t// Support: IE9-11+\n\t\t// IE returns zIndex value as an integer.\n\t\tret + "" :\n\t\tret;\n}\n\n\nfunction addGetHookIf( conditionFn, hookFn ) {\n\n\t// Define the hook, we\'ll check on the first run if it\'s really needed.\n\treturn {\n\t\tget: function() {\n\t\t\tif ( conditionFn() ) {\n\n\t\t\t\t// Hook not needed (or it\'s not possible to use it due\n\t\t\t\t// to missing dependency), remove it.\n\t\t\t\tdelete this.get;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Hook needed; redefine it so that the support test is not executed again.\n\t\t\treturn ( this.get = hookFn ).apply( this, arguments );\n\t\t}\n\t};\n}\n\n\nvar\n\n\t// Swappable if display is none or starts with table\n\t// except "table", "table-cell", or "table-caption"\n\t// See here for display values: https://developer.mozilla.org/en-US/docs/CSS/display\n\trdisplayswap = /^(none|table(?!-c[ea]).+)/,\n\n\tcssShow = { position: "absolute", visibility: "hidden", display: "block" },\n\tcssNormalTransform = {\n\t\tletterSpacing: "0",\n\t\tfontWeight: "400"\n\t},\n\n\tcssPrefixes = [ "Webkit", "O", "Moz", "ms" ],\n\temptyStyle = document.createElement( "div" ).style;\n\n// Return a css property mapped to a potentially vendor prefixed property\nfunction vendorPropName( name ) {\n\n\t// Shortcut for names that are not vendor prefixed\n\tif ( name in emptyStyle ) {\n\t\treturn name;\n\t}\n\n\t// Check for vendor prefixed names\n\tvar capName = name[ 0 ].toUpperCase() + name.slice( 1 ),\n\t\ti = cssPrefixes.length;\n\n\twhile ( i-- ) {\n\t\tname = cssPrefixes[ i ] + capName;\n\t\tif ( name in emptyStyle ) {\n\t\t\treturn name;\n\t\t}\n\t}\n}\n\nfunction setPositiveNumber( elem, value, subtract ) {\n\n\t// Any relative (+/-) values have already been\n\t// normalized at this point\n\tvar matches = rcssNum.exec( value );\n\treturn matches ?\n\n\t\t// Guard against undefined "subtract", e.g., when used as in cssHooks\n\t\tMath.max( 0, matches[ 2 ] - ( subtract || 0 ) ) + ( matches[ 3 ] || "px" ) :\n\t\tvalue;\n}\n\nfunction augmentWidthOrHeight( elem, name, extra, isBorderBox, styles ) {\n\tvar i = extra === ( isBorderBox ? "border" : "content" ) ?\n\n\t\t// If we already have the right measurement, avoid augmentation\n\t\t4 :\n\n\t\t// Otherwise initialize for horizontal or vertical properties\n\t\tname === "width" ? 1 : 0,\n\n\t\tval = 0;\n\n\tfor ( ; i < 4; i += 2 ) {\n\n\t\t// Both box models exclude margin, so add it if we want it\n\t\tif ( extra === "margin" ) {\n\t\t\tval += jQuery.css( elem, extra + cssExpand[ i ], true, styles );\n\t\t}\n\n\t\tif ( isBorderBox ) {\n\n\t\t\t// border-box includes padding, so remove it if we want content\n\t\t\tif ( extra === "content" ) {\n\t\t\t\tval -= jQuery.css( elem, "padding" + cssExpand[ i ], true, styles );\n\t\t\t}\n\n\t\t\t// At this point, extra isn\'t border nor margin, so remove border\n\t\t\tif ( extra !== "margin" ) {\n\t\t\t\tval -= jQuery.css( elem, "border" + cssExpand[ i ] + "Width", true, styles );\n\t\t\t}\n\t\t} else {\n\n\t\t\t// At this point, extra isn\'t content, so add padding\n\t\t\tval += jQuery.css( elem, "padding" + cssExpand[ i ], true, styles );\n\n\t\t\t// At this point, extra isn\'t content nor padding, so add border\n\t\t\tif ( extra !== "padding" ) {\n\t\t\t\tval += jQuery.css( elem, "border" + cssExpand[ i ] + "Width", true, styles );\n\t\t\t}\n\t\t}\n\t}\n\n\treturn val;\n}\n\nfunction getWidthOrHeight( elem, name, extra ) {\n\n\t// Start with offset property, which is equivalent to the border-box value\n\tvar valueIsBorderBox = true,\n\t\tval = name === "width" ? elem.offsetWidth : elem.offsetHeight,\n\t\tstyles = getStyles( elem ),\n\t\tisBorderBox = jQuery.css( elem, "boxSizing", false, styles ) === "border-box";\n\n\t// Support: IE11 only\n\t// In IE 11 fullscreen elements inside of an iframe have\n\t// 100x too small dimensions (gh-1764).\n\tif ( document.msFullscreenElement && window.top !== window ) {\n\n\t\t// Support: IE11 only\n\t\t// Running getBoundingClientRect on a disconnected node\n\t\t// in IE throws an error.\n\t\tif ( elem.getClientRects().length ) {\n\t\t\tval = Math.round( elem.getBoundingClientRect()[ name ] * 100 );\n\t\t}\n\t}\n\n\t// Some non-html elements return undefined for offsetWidth, so check for null/undefined\n\t// svg - https://bugzilla.mozilla.org/show_bug.cgi?id=649285\n\t// MathML - https://bugzilla.mozilla.org/show_bug.cgi?id=491668\n\tif ( val <= 0 || val == null ) {\n\n\t\t// Fall back to computed then uncomputed css if necessary\n\t\tval = curCSS( elem, name, styles );\n\t\tif ( val < 0 || val == null ) {\n\t\t\tval = elem.style[ name ];\n\t\t}\n\n\t\t// Computed unit is not pixels. Stop here and return.\n\t\tif ( rnumnonpx.test( val ) ) {\n\t\t\treturn val;\n\t\t}\n\n\t\t// Check for style in case a browser which returns unreliable values\n\t\t// for getComputedStyle silently falls back to the reliable elem.style\n\t\tvalueIsBorderBox = isBorderBox &&\n\t\t\t( support.boxSizingReliable() || val === elem.style[ name ] );\n\n\t\t// Normalize "", auto, and prepare for extra\n\t\tval = parseFloat( val ) || 0;\n\t}\n\n\t// Use the active box-sizing model to add/subtract irrelevant styles\n\treturn ( val +\n\t\taugmentWidthOrHeight(\n\t\t\telem,\n\t\t\tname,\n\t\t\textra || ( isBorderBox ? "border" : "content" ),\n\t\t\tvalueIsBorderBox,\n\t\t\tstyles\n\t\t)\n\t) + "px";\n}\n\nfunction showHide( elements, show ) {\n\tvar display, elem, hidden,\n\t\tvalues = [],\n\t\tindex = 0,\n\t\tlength = elements.length;\n\n\tfor ( ; index < length; index++ ) {\n\t\telem = elements[ index ];\n\t\tif ( !elem.style ) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tvalues[ index ] = dataPriv.get( elem, "olddisplay" );\n\t\tdisplay = elem.style.display;\n\t\tif ( show ) {\n\n\t\t\t// Reset the inline display of this element to learn if it is\n\t\t\t// being hidden by cascaded rules or not\n\t\t\tif ( !values[ index ] && display === "none" ) {\n\t\t\t\telem.style.display = "";\n\t\t\t}\n\n\t\t\t// Set elements which have been overridden with display: none\n\t\t\t// in a stylesheet to whatever the default browser style is\n\t\t\t// for such an element\n\t\t\tif ( elem.style.display === "" && isHidden( elem ) ) {\n\t\t\t\tvalues[ index ] = dataPriv.access(\n\t\t\t\t\telem,\n\t\t\t\t\t"olddisplay",\n\t\t\t\t\tdefaultDisplay( elem.nodeName )\n\t\t\t\t);\n\t\t\t}\n\t\t} else {\n\t\t\thidden = isHidden( elem );\n\n\t\t\tif ( display !== "none" || !hidden ) {\n\t\t\t\tdataPriv.set(\n\t\t\t\t\telem,\n\t\t\t\t\t"olddisplay",\n\t\t\t\t\thidden ? display : jQuery.css( elem, "display" )\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\t// Set the display of most of the elements in a second loop\n\t// to avoid the constant reflow\n\tfor ( index = 0; index < length; index++ ) {\n\t\telem = elements[ index ];\n\t\tif ( !elem.style ) {\n\t\t\tcontinue;\n\t\t}\n\t\tif ( !show || elem.style.display === "none" || elem.style.display === "" ) {\n\t\t\telem.style.display = show ? values[ index ] || "" : "none";\n\t\t}\n\t}\n\n\treturn elements;\n}\n\njQuery.extend( {\n\n\t// Add in style property hooks for overriding the default\n\t// behavior of getting and setting a style property\n\tcssHooks: {\n\t\topacity: {\n\t\t\tget: function( elem, computed ) {\n\t\t\t\tif ( computed ) {\n\n\t\t\t\t\t// We should always get a number back from opacity\n\t\t\t\t\tvar ret = curCSS( elem, "opacity" );\n\t\t\t\t\treturn ret === "" ? "1" : ret;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t// Don\'t automatically add "px" to these possibly-unitless properties\n\tcssNumber: {\n\t\t"animationIterationCount": true,\n\t\t"columnCount": true,\n\t\t"fillOpacity": true,\n\t\t"flexGrow": true,\n\t\t"flexShrink": true,\n\t\t"fontWeight": true,\n\t\t"lineHeight": true,\n\t\t"opacity": true,\n\t\t"order": true,\n\t\t"orphans": true,\n\t\t"widows": true,\n\t\t"zIndex": true,\n\t\t"zoom": true\n\t},\n\n\t// Add in properties whose names you wish to fix before\n\t// setting or getting the value\n\tcssProps: {\n\t\t"float": "cssFloat"\n\t},\n\n\t// Get and set the style property on a DOM Node\n\tstyle: function( elem, name, value, extra ) {\n\n\t\t// Don\'t set styles on text and comment nodes\n\t\tif ( !elem || elem.nodeType === 3 || elem.nodeType === 8 || !elem.style ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Make sure that we\'re working with the right name\n\t\tvar ret, type, hooks,\n\t\t\torigName = jQuery.camelCase( name ),\n\t\t\tstyle = elem.style;\n\n\t\tname = jQuery.cssProps[ origName ] ||\n\t\t\t( jQuery.cssProps[ origName ] = vendorPropName( origName ) || origName );\n\n\t\t// Gets hook for the prefixed version, then unprefixed version\n\t\thooks = jQuery.cssHooks[ name ] || jQuery.cssHooks[ origName ];\n\n\t\t// Check if we\'re setting a value\n\t\tif ( value !== undefined ) {\n\t\t\ttype = typeof value;\n\n\t\t\t// Convert "+=" or "-=" to relative numbers (#7345)\n\t\t\tif ( type === "string" && ( ret = rcssNum.exec( value ) ) && ret[ 1 ] ) {\n\t\t\t\tvalue = adjustCSS( elem, name, ret );\n\n\t\t\t\t// Fixes bug #9237\n\t\t\t\ttype = "number";\n\t\t\t}\n\n\t\t\t// Make sure that null and NaN values aren\'t set (#7116)\n\t\t\tif ( value == null || value !== value ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// If a number was passed in, add the unit (except for certain CSS properties)\n\t\t\tif ( type === "number" ) {\n\t\t\t\tvalue += ret && ret[ 3 ] || ( jQuery.cssNumber[ origName ] ? "" : "px" );\n\t\t\t}\n\n\t\t\t// Support: IE9-11+\n\t\t\t// background-* props affect original clone\'s values\n\t\t\tif ( !support.clearCloneStyle && value === "" && name.indexOf( "background" ) === 0 ) {\n\t\t\t\tstyle[ name ] = "inherit";\n\t\t\t}\n\n\t\t\t// If a hook was provided, use that value, otherwise just set the specified value\n\t\t\tif ( !hooks || !( "set" in hooks ) ||\n\t\t\t\t( value = hooks.set( elem, value, extra ) ) !== undefined ) {\n\n\t\t\t\tstyle[ name ] = value;\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// If a hook was provided get the non-computed value from there\n\t\t\tif ( hooks && "get" in hooks &&\n\t\t\t\t( ret = hooks.get( elem, false, extra ) ) !== undefined ) {\n\n\t\t\t\treturn ret;\n\t\t\t}\n\n\t\t\t// Otherwise just get the value from the style object\n\t\t\treturn style[ name ];\n\t\t}\n\t},\n\n\tcss: function( elem, name, extra, styles ) {\n\t\tvar val, num, hooks,\n\t\t\torigName = jQuery.camelCase( name );\n\n\t\t// Make sure that we\'re working with the right name\n\t\tname = jQuery.cssProps[ origName ] ||\n\t\t\t( jQuery.cssProps[ origName ] = vendorPropName( origName ) || origName );\n\n\t\t// Try prefixed name followed by the unprefixed name\n\t\thooks = jQuery.cssHooks[ name ] || jQuery.cssHooks[ origName ];\n\n\t\t// If a hook was provided get the computed value from there\n\t\tif ( hooks && "get" in hooks ) {\n\t\t\tval = hooks.get( elem, true, extra );\n\t\t}\n\n\t\t// Otherwise, if a way to get the computed value exists, use that\n\t\tif ( val === undefined ) {\n\t\t\tval = curCSS( elem, name, styles );\n\t\t}\n\n\t\t// Convert "normal" to computed value\n\t\tif ( val === "normal" && name in cssNormalTransform ) {\n\t\t\tval = cssNormalTransform[ name ];\n\t\t}\n\n\t\t// Make numeric if forced or a qualifier was provided and val looks numeric\n\t\tif ( extra === "" || extra ) {\n\t\t\tnum = parseFloat( val );\n\t\t\treturn extra === true || isFinite( num ) ? num || 0 : val;\n\t\t}\n\t\treturn val;\n\t}\n} );\n\njQuery.each( [ "height", "width" ], function( i, name ) {\n\tjQuery.cssHooks[ name ] = {\n\t\tget: function( elem, computed, extra ) {\n\t\t\tif ( computed ) {\n\n\t\t\t\t// Certain elements can have dimension info if we invisibly show them\n\t\t\t\t// but it must have a current display style that would benefit\n\t\t\t\treturn rdisplayswap.test( jQuery.css( elem, "display" ) ) &&\n\t\t\t\t\telem.offsetWidth === 0 ?\n\t\t\t\t\t\tswap( elem, cssShow, function() {\n\t\t\t\t\t\t\treturn getWidthOrHeight( elem, name, extra );\n\t\t\t\t\t\t} ) :\n\t\t\t\t\t\tgetWidthOrHeight( elem, name, extra );\n\t\t\t}\n\t\t},\n\n\t\tset: function( elem, value, extra ) {\n\t\t\tvar matches,\n\t\t\t\tstyles = extra && getStyles( elem ),\n\t\t\t\tsubtract = extra && augmentWidthOrHeight(\n\t\t\t\t\telem,\n\t\t\t\t\tname,\n\t\t\t\t\textra,\n\t\t\t\t\tjQuery.css( elem, "boxSizing", false, styles ) === "border-box",\n\t\t\t\t\tstyles\n\t\t\t\t);\n\n\t\t\t// Convert to pixels if value adjustment is needed\n\t\t\tif ( subtract && ( matches = rcssNum.exec( value ) ) &&\n\t\t\t\t( matches[ 3 ] || "px" ) !== "px" ) {\n\n\t\t\t\telem.style[ name ] = value;\n\t\t\t\tvalue = jQuery.css( elem, name );\n\t\t\t}\n\n\t\t\treturn setPositiveNumber( elem, value, subtract );\n\t\t}\n\t};\n} );\n\njQuery.cssHooks.marginLeft = addGetHookIf( support.reliableMarginLeft,\n\tfunction( elem, computed ) {\n\t\tif ( computed ) {\n\t\t\treturn ( parseFloat( curCSS( elem, "marginLeft" ) ) ||\n\t\t\t\telem.getBoundingClientRect().left -\n\t\t\t\t\tswap( elem, { marginLeft: 0 }, function() {\n\t\t\t\t\t\treturn elem.getBoundingClientRect().left;\n\t\t\t\t\t} )\n\t\t\t\t) + "px";\n\t\t}\n\t}\n);\n\n// Support: Android 2.3\njQuery.cssHooks.marginRight = addGetHookIf( support.reliableMarginRight,\n\tfunction( elem, computed ) {\n\t\tif ( computed ) {\n\t\t\treturn swap( elem, { "display": "inline-block" },\n\t\t\t\tcurCSS, [ elem, "marginRight" ] );\n\t\t}\n\t}\n);\n\n// These hooks are used by animate to expand properties\njQuery.each( {\n\tmargin: "",\n\tpadding: "",\n\tborder: "Width"\n}, function( prefix, suffix ) {\n\tjQuery.cssHooks[ prefix + suffix ] = {\n\t\texpand: function( value ) {\n\t\t\tvar i = 0,\n\t\t\t\texpanded = {},\n\n\t\t\t\t// Assumes a single number if not a string\n\t\t\t\tparts = typeof value === "string" ? value.split( " " ) : [ value ];\n\n\t\t\tfor ( ; i < 4; i++ ) {\n\t\t\t\texpanded[ prefix + cssExpand[ i ] + suffix ] =\n\t\t\t\t\tparts[ i ] || parts[ i - 2 ] || parts[ 0 ];\n\t\t\t}\n\n\t\t\treturn expanded;\n\t\t}\n\t};\n\n\tif ( !rmargin.test( prefix ) ) {\n\t\tjQuery.cssHooks[ prefix + suffix ].set = setPositiveNumber;\n\t}\n} );\n\njQuery.fn.extend( {\n\tcss: function( name, value ) {\n\t\treturn access( this, function( elem, name, value ) {\n\t\t\tvar styles, len,\n\t\t\t\tmap = {},\n\t\t\t\ti = 0;\n\n\t\t\tif ( jQuery.isArray( name ) ) {\n\t\t\t\tstyles = getStyles( elem );\n\t\t\t\tlen = name.length;\n\n\t\t\t\tfor ( ; i < len; i++ ) {\n\t\t\t\t\tmap[ name[ i ] ] = jQuery.css( elem, name[ i ], false, styles );\n\t\t\t\t}\n\n\t\t\t\treturn map;\n\t\t\t}\n\n\t\t\treturn value !== undefined ?\n\t\t\t\tjQuery.style( elem, name, value ) :\n\t\t\t\tjQuery.css( elem, name );\n\t\t}, name, value, arguments.length > 1 );\n\t},\n\tshow: function() {\n\t\treturn showHide( this, true );\n\t},\n\thide: function() {\n\t\treturn showHide( this );\n\t},\n\ttoggle: function( state ) {\n\t\tif ( typeof state === "boolean" ) {\n\t\t\treturn state ? this.show() : this.hide();\n\t\t}\n\n\t\treturn this.each( function() {\n\t\t\tif ( isHidden( this ) ) {\n\t\t\t\tjQuery( this ).show();\n\t\t\t} else {\n\t\t\t\tjQuery( this ).hide();\n\t\t\t}\n\t\t} );\n\t}\n} );\n\n\nfunction Tween( elem, options, prop, end, easing ) {\n\treturn new Tween.prototype.init( elem, options, prop, end, easing );\n}\njQuery.Tween = Tween;\n\nTween.prototype = {\n\tconstructor: Tween,\n\tinit: function( elem, options, prop, end, easing, unit ) {\n\t\tthis.elem = elem;\n\t\tthis.prop = prop;\n\t\tthis.easing = easing || jQuery.easing._default;\n\t\tthis.options = options;\n\t\tthis.start = this.now = this.cur();\n\t\tthis.end = end;\n\t\tthis.unit = unit || ( jQuery.cssNumber[ prop ] ? "" : "px" );\n\t},\n\tcur: function() {\n\t\tvar hooks = Tween.propHooks[ this.prop ];\n\n\t\treturn hooks && hooks.get ?\n\t\t\thooks.get( this ) :\n\t\t\tTween.propHooks._default.get( this );\n\t},\n\trun: function( percent ) {\n\t\tvar eased,\n\t\t\thooks = Tween.propHooks[ this.prop ];\n\n\t\tif ( this.options.duration ) {\n\t\t\tthis.pos = eased = jQuery.easing[ this.easing ](\n\t\t\t\tpercent, this.options.duration * percent, 0, 1, this.options.duration\n\t\t\t);\n\t\t} else {\n\t\t\tthis.pos = eased = percent;\n\t\t}\n\t\tthis.now = ( this.end - this.start ) * eased + this.start;\n\n\t\tif ( this.options.step ) {\n\t\t\tthis.options.step.call( this.elem, this.now, this );\n\t\t}\n\n\t\tif ( hooks && hooks.set ) {\n\t\t\thooks.set( this );\n\t\t} else {\n\t\t\tTween.propHooks._default.set( this );\n\t\t}\n\t\treturn this;\n\t}\n};\n\nTween.prototype.init.prototype = Tween.prototype;\n\nTween.propHooks = {\n\t_default: {\n\t\tget: function( tween ) {\n\t\t\tvar result;\n\n\t\t\t// Use a property on the element directly when it is not a DOM element,\n\t\t\t// or when there is no matching style property that exists.\n\t\t\tif ( tween.elem.nodeType !== 1 ||\n\t\t\t\ttween.elem[ tween.prop ] != null && tween.elem.style[ tween.prop ] == null ) {\n\t\t\t\treturn tween.elem[ tween.prop ];\n\t\t\t}\n\n\t\t\t// Passing an empty string as a 3rd parameter to .css will automatically\n\t\t\t// attempt a parseFloat and fallback to a string if the parse fails.\n\t\t\t// Simple values such as "10px" are parsed to Float;\n\t\t\t// complex values such as "rotate(1rad)" are returned as-is.\n\t\t\tresult = jQuery.css( tween.elem, tween.prop, "" );\n\n\t\t\t// Empty strings, null, undefined and "auto" are converted to 0.\n\t\t\treturn !result || result === "auto" ? 0 : result;\n\t\t},\n\t\tset: function( tween ) {\n\n\t\t\t// Use step hook for back compat.\n\t\t\t// Use cssHook if its there.\n\t\t\t// Use .style if available and use plain properties where available.\n\t\t\tif ( jQuery.fx.step[ tween.prop ] ) {\n\t\t\t\tjQuery.fx.step[ tween.prop ]( tween );\n\t\t\t} else if ( tween.elem.nodeType === 1 &&\n\t\t\t\t( tween.elem.style[ jQuery.cssProps[ tween.prop ] ] != null ||\n\t\t\t\t\tjQuery.cssHooks[ tween.prop ] ) ) {\n\t\t\t\tjQuery.style( tween.elem, tween.prop, tween.now + tween.unit );\n\t\t\t} else {\n\t\t\t\ttween.elem[ tween.prop ] = tween.now;\n\t\t\t}\n\t\t}\n\t}\n};\n\n// Support: IE9\n// Panic based approach to setting things on disconnected nodes\nTween.propHooks.scrollTop = Tween.propHooks.scrollLeft = {\n\tset: function( tween ) {\n\t\tif ( tween.elem.nodeType && tween.elem.parentNode ) {\n\t\t\ttween.elem[ tween.prop ] = tween.now;\n\t\t}\n\t}\n};\n\njQuery.easing = {\n\tlinear: function( p ) {\n\t\treturn p;\n\t},\n\tswing: function( p ) {\n\t\treturn 0.5 - Math.cos( p * Math.PI ) / 2;\n\t},\n\t_default: "swing"\n};\n\njQuery.fx = Tween.prototype.init;\n\n// Back Compat <1.8 extension point\njQuery.fx.step = {};\n\n\n\n\nvar\n\tfxNow, timerId,\n\trfxtypes = /^(?:toggle|show|hide)$/,\n\trrun = /queueHooks$/;\n\n// Animations created synchronously will run synchronously\nfunction createFxNow() {\n\twindow.setTimeout( function() {\n\t\tfxNow = undefined;\n\t} );\n\treturn ( fxNow = jQuery.now() );\n}\n\n// Generate parameters to create a standard animation\nfunction genFx( type, includeWidth ) {\n\tvar which,\n\t\ti = 0,\n\t\tattrs = { height: type };\n\n\t// If we include width, step value is 1 to do all cssExpand values,\n\t// otherwise step value is 2 to skip over Left and Right\n\tincludeWidth = includeWidth ? 1 : 0;\n\tfor ( ; i < 4 ; i += 2 - includeWidth ) {\n\t\twhich = cssExpand[ i ];\n\t\tattrs[ "margin" + which ] = attrs[ "padding" + which ] = type;\n\t}\n\n\tif ( includeWidth ) {\n\t\tattrs.opacity = attrs.width = type;\n\t}\n\n\treturn attrs;\n}\n\nfunction createTween( value, prop, animation ) {\n\tvar tween,\n\t\tcollection = ( Animation.tweeners[ prop ] || [] ).concat( Animation.tweeners[ "*" ] ),\n\t\tindex = 0,\n\t\tlength = collection.length;\n\tfor ( ; index < length; index++ ) {\n\t\tif ( ( tween = collection[ index ].call( animation, prop, value ) ) ) {\n\n\t\t\t// We\'re done with this property\n\t\t\treturn tween;\n\t\t}\n\t}\n}\n\nfunction defaultPrefilter( elem, props, opts ) {\n\t/* jshint validthis: true */\n\tvar prop, value, toggle, tween, hooks, oldfire, display, checkDisplay,\n\t\tanim = this,\n\t\torig = {},\n\t\tstyle = elem.style,\n\t\thidden = elem.nodeType && isHidden( elem ),\n\t\tdataShow = dataPriv.get( elem, "fxshow" );\n\n\t// Handle queue: false promises\n\tif ( !opts.queue ) {\n\t\thooks = jQuery._queueHooks( elem, "fx" );\n\t\tif ( hooks.unqueued == null ) {\n\t\t\thooks.unqueued = 0;\n\t\t\toldfire = hooks.empty.fire;\n\t\t\thooks.empty.fire = function() {\n\t\t\t\tif ( !hooks.unqueued ) {\n\t\t\t\t\toldfire();\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\thooks.unqueued++;\n\n\t\tanim.always( function() {\n\n\t\t\t// Ensure the complete handler is called before this completes\n\t\t\tanim.always( function() {\n\t\t\t\thooks.unqueued--;\n\t\t\t\tif ( !jQuery.queue( elem, "fx" ).length ) {\n\t\t\t\t\thooks.empty.fire();\n\t\t\t\t}\n\t\t\t} );\n\t\t} );\n\t}\n\n\t// Height/width overflow pass\n\tif ( elem.nodeType === 1 && ( "height" in props || "width" in props ) ) {\n\n\t\t// Make sure that nothing sneaks out\n\t\t// Record all 3 overflow attributes because IE9-10 do not\n\t\t// change the overflow attribute when overflowX and\n\t\t// overflowY are set to the same value\n\t\topts.overflow = [ style.overflow, style.overflowX, style.overflowY ];\n\n\t\t// Set display property to inline-block for height/width\n\t\t// animations on inline elements that are having width/height animated\n\t\tdisplay = jQuery.css( elem, "display" );\n\n\t\t// Test default display if display is currently "none"\n\t\tcheckDisplay = display === "none" ?\n\t\t\tdataPriv.get( elem, "olddisplay" ) || defaultDisplay( elem.nodeName ) : display;\n\n\t\tif ( checkDisplay === "inline" && jQuery.css( elem, "float" ) === "none" ) {\n\t\t\tstyle.display = "inline-block";\n\t\t}\n\t}\n\n\tif ( opts.overflow ) {\n\t\tstyle.overflow = "hidden";\n\t\tanim.always( function() {\n\t\t\tstyle.overflow = opts.overflow[ 0 ];\n\t\t\tstyle.overflowX = opts.overflow[ 1 ];\n\t\t\tstyle.overflowY = opts.overflow[ 2 ];\n\t\t} );\n\t}\n\n\t// show/hide pass\n\tfor ( prop in props ) {\n\t\tvalue = props[ prop ];\n\t\tif ( rfxtypes.exec( value ) ) {\n\t\t\tdelete props[ prop ];\n\t\t\ttoggle = toggle || value === "toggle";\n\t\t\tif ( value === ( hidden ? "hide" : "show" ) ) {\n\n\t\t\t\t// If there is dataShow left over from a stopped hide or show\n\t\t\t\t// and we are going to proceed with show, we should pretend to be hidden\n\t\t\t\tif ( value === "show" && dataShow && dataShow[ prop ] !== undefined ) {\n\t\t\t\t\thidden = true;\n\t\t\t\t} else {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\torig[ prop ] = dataShow && dataShow[ prop ] || jQuery.style( elem, prop );\n\n\t\t// Any non-fx value stops us from restoring the original display value\n\t\t} else {\n\t\t\tdisplay = undefined;\n\t\t}\n\t}\n\n\tif ( !jQuery.isEmptyObject( orig ) ) {\n\t\tif ( dataShow ) {\n\t\t\tif ( "hidden" in dataShow ) {\n\t\t\t\thidden = dataShow.hidden;\n\t\t\t}\n\t\t} else {\n\t\t\tdataShow = dataPriv.access( elem, "fxshow", {} );\n\t\t}\n\n\t\t// Store state if its toggle - enables .stop().toggle() to "reverse"\n\t\tif ( toggle ) {\n\t\t\tdataShow.hidden = !hidden;\n\t\t}\n\t\tif ( hidden ) {\n\t\t\tjQuery( elem ).show();\n\t\t} else {\n\t\t\tanim.done( function() {\n\t\t\t\tjQuery( elem ).hide();\n\t\t\t} );\n\t\t}\n\t\tanim.done( function() {\n\t\t\tvar prop;\n\n\t\t\tdataPriv.remove( elem, "fxshow" );\n\t\t\tfor ( prop in orig ) {\n\t\t\t\tjQuery.style( elem, prop, orig[ prop ] );\n\t\t\t}\n\t\t} );\n\t\tfor ( prop in orig ) {\n\t\t\ttween = createTween( hidden ? dataShow[ prop ] : 0, prop, anim );\n\n\t\t\tif ( !( prop in dataShow ) ) {\n\t\t\t\tdataShow[ prop ] = tween.start;\n\t\t\t\tif ( hidden ) {\n\t\t\t\t\ttween.end = tween.start;\n\t\t\t\t\ttween.start = prop === "width" || prop === "height" ? 1 : 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t// If this is a noop like .hide().hide(), restore an overwritten display value\n\t} else if ( ( display === "none" ? defaultDisplay( elem.nodeName ) : display ) === "inline" ) {\n\t\tstyle.display = display;\n\t}\n}\n\nfunction propFilter( props, specialEasing ) {\n\tvar index, name, easing, value, hooks;\n\n\t// camelCase, specialEasing and expand cssHook pass\n\tfor ( index in props ) {\n\t\tname = jQuery.camelCase( index );\n\t\teasing = specialEasing[ name ];\n\t\tvalue = props[ index ];\n\t\tif ( jQuery.isArray( value ) ) {\n\t\t\teasing = value[ 1 ];\n\t\t\tvalue = props[ index ] = value[ 0 ];\n\t\t}\n\n\t\tif ( index !== name ) {\n\t\t\tprops[ name ] = value;\n\t\t\tdelete props[ index ];\n\t\t}\n\n\t\thooks = jQuery.cssHooks[ name ];\n\t\tif ( hooks && "expand" in hooks ) {\n\t\t\tvalue = hooks.expand( value );\n\t\t\tdelete props[ name ];\n\n\t\t\t// Not quite $.extend, this won\'t overwrite existing keys.\n\t\t\t// Reusing \'index\' because we have the correct "name"\n\t\t\tfor ( index in value ) {\n\t\t\t\tif ( !( index in props ) ) {\n\t\t\t\t\tprops[ index ] = value[ index ];\n\t\t\t\t\tspecialEasing[ index ] = easing;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tspecialEasing[ name ] = easing;\n\t\t}\n\t}\n}\n\nfunction Animation( elem, properties, options ) {\n\tvar result,\n\t\tstopped,\n\t\tindex = 0,\n\t\tlength = Animation.prefilters.length,\n\t\tdeferred = jQuery.Deferred().always( function() {\n\n\t\t\t// Don\'t match elem in the :animated selector\n\t\t\tdelete tick.elem;\n\t\t} ),\n\t\ttick = function() {\n\t\t\tif ( stopped ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar currentTime = fxNow || createFxNow(),\n\t\t\t\tremaining = Math.max( 0, animation.startTime + animation.duration - currentTime ),\n\n\t\t\t\t// Support: Android 2.3\n\t\t\t\t// Archaic crash bug won\'t allow us to use `1 - ( 0.5 || 0 )` (#12497)\n\t\t\t\ttemp = remaining / animation.duration || 0,\n\t\t\t\tpercent = 1 - temp,\n\t\t\t\tindex = 0,\n\t\t\t\tlength = animation.tweens.length;\n\n\t\t\tfor ( ; index < length ; index++ ) {\n\t\t\t\tanimation.tweens[ index ].run( percent );\n\t\t\t}\n\n\t\t\tdeferred.notifyWith( elem, [ animation, percent, remaining ] );\n\n\t\t\tif ( percent < 1 && length ) {\n\t\t\t\treturn remaining;\n\t\t\t} else {\n\t\t\t\tdeferred.resolveWith( elem, [ animation ] );\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tanimation = deferred.promise( {\n\t\t\telem: elem,\n\t\t\tprops: jQuery.extend( {}, properties ),\n\t\t\topts: jQuery.extend( true, {\n\t\t\t\tspecialEasing: {},\n\t\t\t\teasing: jQuery.easing._default\n\t\t\t}, options ),\n\t\t\toriginalProperties: properties,\n\t\t\toriginalOptions: options,\n\t\t\tstartTime: fxNow || createFxNow(),\n\t\t\tduration: options.duration,\n\t\t\ttweens: [],\n\t\t\tcreateTween: function( prop, end ) {\n\t\t\t\tvar tween = jQuery.Tween( elem, animation.opts, prop, end,\n\t\t\t\t\t\tanimation.opts.specialEasing[ prop ] || animation.opts.easing );\n\t\t\t\tanimation.tweens.push( tween );\n\t\t\t\treturn tween;\n\t\t\t},\n\t\t\tstop: function( gotoEnd ) {\n\t\t\t\tvar index = 0,\n\n\t\t\t\t\t// If we are going to the end, we want to run all the tweens\n\t\t\t\t\t// otherwise we skip this part\n\t\t\t\t\tlength = gotoEnd ? animation.tweens.length : 0;\n\t\t\t\tif ( stopped ) {\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\t\t\tstopped = true;\n\t\t\t\tfor ( ; index < length ; index++ ) {\n\t\t\t\t\tanimation.tweens[ index ].run( 1 );\n\t\t\t\t}\n\n\t\t\t\t// Resolve when we played the last frame; otherwise, reject\n\t\t\t\tif ( gotoEnd ) {\n\t\t\t\t\tdeferred.notifyWith( elem, [ animation, 1, 0 ] );\n\t\t\t\t\tdeferred.resolveWith( elem, [ animation, gotoEnd ] );\n\t\t\t\t} else {\n\t\t\t\t\tdeferred.rejectWith( elem, [ animation, gotoEnd ] );\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t}\n\t\t} ),\n\t\tprops = animation.props;\n\n\tpropFilter( props, animation.opts.specialEasing );\n\n\tfor ( ; index < length ; index++ ) {\n\t\tresult = Animation.prefilters[ index ].call( animation, elem, props, animation.opts );\n\t\tif ( result ) {\n\t\t\tif ( jQuery.isFunction( result.stop ) ) {\n\t\t\t\tjQuery._queueHooks( animation.elem, animation.opts.queue ).stop =\n\t\t\t\t\tjQuery.proxy( result.stop, result );\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\t}\n\n\tjQuery.map( props, createTween, animation );\n\n\tif ( jQuery.isFunction( animation.opts.start ) ) {\n\t\tanimation.opts.start.call( elem, animation );\n\t}\n\n\tjQuery.fx.timer(\n\t\tjQuery.extend( tick, {\n\t\t\telem: elem,\n\t\t\tanim: animation,\n\t\t\tqueue: animation.opts.queue\n\t\t} )\n\t);\n\n\t// attach callbacks from options\n\treturn animation.progress( animation.opts.progress )\n\t\t.done( animation.opts.done, animation.opts.complete )\n\t\t.fail( animation.opts.fail )\n\t\t.always( animation.opts.always );\n}\n\njQuery.Animation = jQuery.extend( Animation, {\n\ttweeners: {\n\t\t"*": [ function( prop, value ) {\n\t\t\tvar tween = this.createTween( prop, value );\n\t\t\tadjustCSS( tween.elem, prop, rcssNum.exec( value ), tween );\n\t\t\treturn tween;\n\t\t} ]\n\t},\n\n\ttweener: function( props, callback ) {\n\t\tif ( jQuery.isFunction( props ) ) {\n\t\t\tcallback = props;\n\t\t\tprops = [ "*" ];\n\t\t} else {\n\t\t\tprops = props.match( rnotwhite );\n\t\t}\n\n\t\tvar prop,\n\t\t\tindex = 0,\n\t\t\tlength = props.length;\n\n\t\tfor ( ; index < length ; index++ ) {\n\t\t\tprop = props[ index ];\n\t\t\tAnimation.tweeners[ prop ] = Animation.tweeners[ prop ] || [];\n\t\t\tAnimation.tweeners[ prop ].unshift( callback );\n\t\t}\n\t},\n\n\tprefilters: [ defaultPrefilter ],\n\n\tprefilter: function( callback, prepend ) {\n\t\tif ( prepend ) {\n\t\t\tAnimation.prefilters.unshift( callback );\n\t\t} else {\n\t\t\tAnimation.prefilters.push( callback );\n\t\t}\n\t}\n} );\n\njQuery.speed = function( speed, easing, fn ) {\n\tvar opt = speed && typeof speed === "object" ? jQuery.extend( {}, speed ) : {\n\t\tcomplete: fn || !fn && easing ||\n\t\t\tjQuery.isFunction( speed ) && speed,\n\t\tduration: speed,\n\t\teasing: fn && easing || easing && !jQuery.isFunction( easing ) && easing\n\t};\n\n\topt.duration = jQuery.fx.off ? 0 : typeof opt.duration === "number" ?\n\t\topt.duration : opt.duration in jQuery.fx.speeds ?\n\t\t\tjQuery.fx.speeds[ opt.duration ] : jQuery.fx.speeds._default;\n\n\t// Normalize opt.queue - true/undefined/null -> "fx"\n\tif ( opt.queue == null || opt.queue === true ) {\n\t\topt.queue = "fx";\n\t}\n\n\t// Queueing\n\topt.old = opt.complete;\n\n\topt.complete = function() {\n\t\tif ( jQuery.isFunction( opt.old ) ) {\n\t\t\topt.old.call( this );\n\t\t}\n\n\t\tif ( opt.queue ) {\n\t\t\tjQuery.dequeue( this, opt.queue );\n\t\t}\n\t};\n\n\treturn opt;\n};\n\njQuery.fn.extend( {\n\tfadeTo: function( speed, to, easing, callback ) {\n\n\t\t// Show any hidden elements after setting opacity to 0\n\t\treturn this.filter( isHidden ).css( "opacity", 0 ).show()\n\n\t\t\t// Animate to the value specified\n\t\t\t.end().animate( { opacity: to }, speed, easing, callback );\n\t},\n\tanimate: function( prop, speed, easing, callback ) {\n\t\tvar empty = jQuery.isEmptyObject( prop ),\n\t\t\toptall = jQuery.speed( speed, easing, callback ),\n\t\t\tdoAnimation = function() {\n\n\t\t\t\t// Operate on a copy of prop so per-property easing won\'t be lost\n\t\t\t\tvar anim = Animation( this, jQuery.extend( {}, prop ), optall );\n\n\t\t\t\t// Empty animations, or finishing resolves immediately\n\t\t\t\tif ( empty || dataPriv.get( this, "finish" ) ) {\n\t\t\t\t\tanim.stop( true );\n\t\t\t\t}\n\t\t\t};\n\t\t\tdoAnimation.finish = doAnimation;\n\n\t\treturn empty || optall.queue === false ?\n\t\t\tthis.each( doAnimation ) :\n\t\t\tthis.queue( optall.queue, doAnimation );\n\t},\n\tstop: function( type, clearQueue, gotoEnd ) {\n\t\tvar stopQueue = function( hooks ) {\n\t\t\tvar stop = hooks.stop;\n\t\t\tdelete hooks.stop;\n\t\t\tstop( gotoEnd );\n\t\t};\n\n\t\tif ( typeof type !== "string" ) {\n\t\t\tgotoEnd = clearQueue;\n\t\t\tclearQueue = type;\n\t\t\ttype = undefined;\n\t\t}\n\t\tif ( clearQueue && type !== false ) {\n\t\t\tthis.queue( type || "fx", [] );\n\t\t}\n\n\t\treturn this.each( function() {\n\t\t\tvar dequeue = true,\n\t\t\t\tindex = type != null && type + "queueHooks",\n\t\t\t\ttimers = jQuery.timers,\n\t\t\t\tdata = dataPriv.get( this );\n\n\t\t\tif ( index ) {\n\t\t\t\tif ( data[ index ] && data[ index ].stop ) {\n\t\t\t\t\tstopQueue( data[ index ] );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor ( index in data ) {\n\t\t\t\t\tif ( data[ index ] && data[ index ].stop && rrun.test( index ) ) {\n\t\t\t\t\t\tstopQueue( data[ index ] );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor ( index = timers.length; index--; ) {\n\t\t\t\tif ( timers[ index ].elem === this &&\n\t\t\t\t\t( type == null || timers[ index ].queue === type ) ) {\n\n\t\t\t\t\ttimers[ index ].anim.stop( gotoEnd );\n\t\t\t\t\tdequeue = false;\n\t\t\t\t\ttimers.splice( index, 1 );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Start the next in the queue if the last step wasn\'t forced.\n\t\t\t// Timers currently will call their complete callbacks, which\n\t\t\t// will dequeue but only if they were gotoEnd.\n\t\t\tif ( dequeue || !gotoEnd ) {\n\t\t\t\tjQuery.dequeue( this, type );\n\t\t\t}\n\t\t} );\n\t},\n\tfinish: function( type ) {\n\t\tif ( type !== false ) {\n\t\t\ttype = type || "fx";\n\t\t}\n\t\treturn this.each( function() {\n\t\t\tvar index,\n\t\t\t\tdata = dataPriv.get( this ),\n\t\t\t\tqueue = data[ type + "queue" ],\n\t\t\t\thooks = data[ type + "queueHooks" ],\n\t\t\t\ttimers = jQuery.timers,\n\t\t\t\tlength = queue ? queue.length : 0;\n\n\t\t\t// Enable finishing flag on private data\n\t\t\tdata.finish = true;\n\n\t\t\t// Empty the queue first\n\t\t\tjQuery.queue( this, type, [] );\n\n\t\t\tif ( hooks && hooks.stop ) {\n\t\t\t\thooks.stop.call( this, true );\n\t\t\t}\n\n\t\t\t// Look for any active animations, and finish them\n\t\t\tfor ( index = timers.length; index--; ) {\n\t\t\t\tif ( timers[ index ].elem === this && timers[ index ].queue === type ) {\n\t\t\t\t\ttimers[ index ].anim.stop( true );\n\t\t\t\t\ttimers.splice( index, 1 );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Look for any animations in the old queue and finish them\n\t\t\tfor ( index = 0; index < length; index++ ) {\n\t\t\t\tif ( queue[ index ] && queue[ index ].finish ) {\n\t\t\t\t\tqueue[ index ].finish.call( this );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Turn off finishing flag\n\t\t\tdelete data.finish;\n\t\t} );\n\t}\n} );\n\njQuery.each( [ "toggle", "show", "hide" ], function( i, name ) {\n\tvar cssFn = jQuery.fn[ name ];\n\tjQuery.fn[ name ] = function( speed, easing, callback ) {\n\t\treturn speed == null || typeof speed === "boolean" ?\n\t\t\tcssFn.apply( this, arguments ) :\n\t\t\tthis.animate( genFx( name, true ), speed, easing, callback );\n\t};\n} );\n\n// Generate shortcuts for custom animations\njQuery.each( {\n\tslideDown: genFx( "show" ),\n\tslideUp: genFx( "hide" ),\n\tslideToggle: genFx( "toggle" ),\n\tfadeIn: { opacity: "show" },\n\tfadeOut: { opacity: "hide" },\n\tfadeToggle: { opacity: "toggle" }\n}, function( name, props ) {\n\tjQuery.fn[ name ] = function( speed, easing, callback ) {\n\t\treturn this.animate( props, speed, easing, callback );\n\t};\n} );\n\njQuery.timers = [];\njQuery.fx.tick = function() {\n\tvar timer,\n\t\ti = 0,\n\t\ttimers = jQuery.timers;\n\n\tfxNow = jQuery.now();\n\n\tfor ( ; i < timers.length; i++ ) {\n\t\ttimer = timers[ i ];\n\n\t\t// Checks the timer has not already been removed\n\t\tif ( !timer() && timers[ i ] === timer ) {\n\t\t\ttimers.splice( i--, 1 );\n\t\t}\n\t}\n\n\tif ( !timers.length ) {\n\t\tjQuery.fx.stop();\n\t}\n\tfxNow = undefined;\n};\n\njQuery.fx.timer = function( timer ) {\n\tjQuery.timers.push( timer );\n\tif ( timer() ) {\n\t\tjQuery.fx.start();\n\t} else {\n\t\tjQuery.timers.pop();\n\t}\n};\n\njQuery.fx.interval = 13;\njQuery.fx.start = function() {\n\tif ( !timerId ) {\n\t\ttimerId = window.setInterval( jQuery.fx.tick, jQuery.fx.interval );\n\t}\n};\n\njQuery.fx.stop = function() {\n\twindow.clearInterval( timerId );\n\n\ttimerId = null;\n};\n\njQuery.fx.speeds = {\n\tslow: 600,\n\tfast: 200,\n\n\t// Default speed\n\t_default: 400\n};\n\n\n// Based off of the plugin by Clint Helfers, with permission.\n// http://web.archive.org/web/20100324014747/http://blindsignals.com/index.php/2009/07/jquery-delay/\njQuery.fn.delay = function( time, type ) {\n\ttime = jQuery.fx ? jQuery.fx.speeds[ time ] || time : time;\n\ttype = type || "fx";\n\n\treturn this.queue( type, function( next, hooks ) {\n\t\tvar timeout = window.setTimeout( next, time );\n\t\thooks.stop = function() {\n\t\t\twindow.clearTimeout( timeout );\n\t\t};\n\t} );\n};\n\n\n( function() {\n\tvar input = document.createElement( "input" ),\n\t\tselect = document.createElement( "select" ),\n\t\topt = select.appendChild( document.createElement( "option" ) );\n\n\tinput.type = "checkbox";\n\n\t// Support: iOS<=5.1, Android<=4.2+\n\t// Default value for a checkbox should be "on"\n\tsupport.checkOn = input.value !== "";\n\n\t// Support: IE<=11+\n\t// Must access selectedIndex to make default options select\n\tsupport.optSelected = opt.selected;\n\n\t// Support: Android<=2.3\n\t// Options inside disabled selects are incorrectly marked as disabled\n\tselect.disabled = true;\n\tsupport.optDisabled = !opt.disabled;\n\n\t// Support: IE<=11+\n\t// An input loses its value after becoming a radio\n\tinput = document.createElement( "input" );\n\tinput.value = "t";\n\tinput.type = "radio";\n\tsupport.radioValue = input.value === "t";\n} )();\n\n\nvar boolHook,\n\tattrHandle = jQuery.expr.attrHandle;\n\njQuery.fn.extend( {\n\tattr: function( name, value ) {\n\t\treturn access( this, jQuery.attr, name, value, arguments.length > 1 );\n\t},\n\n\tremoveAttr: function( name ) {\n\t\treturn this.each( function() {\n\t\t\tjQuery.removeAttr( this, name );\n\t\t} );\n\t}\n} );\n\njQuery.extend( {\n\tattr: function( elem, name, value ) {\n\t\tvar ret, hooks,\n\t\t\tnType = elem.nodeType;\n\n\t\t// Don\'t get/set attributes on text, comment and attribute nodes\n\t\tif ( nType === 3 || nType === 8 || nType === 2 ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Fallback to prop when attributes are not supported\n\t\tif ( typeof elem.getAttribute === "undefined" ) {\n\t\t\treturn jQuery.prop( elem, name, value );\n\t\t}\n\n\t\t// All attributes are lowercase\n\t\t// Grab necessary hook if one is defined\n\t\tif ( nType !== 1 || !jQuery.isXMLDoc( elem ) ) {\n\t\t\tname = name.toLowerCase();\n\t\t\thooks = jQuery.attrHooks[ name ] ||\n\t\t\t\t( jQuery.expr.match.bool.test( name ) ? boolHook : undefined );\n\t\t}\n\n\t\tif ( value !== undefined ) {\n\t\t\tif ( value === null ) {\n\t\t\t\tjQuery.removeAttr( elem, name );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( hooks && "set" in hooks &&\n\t\t\t\t( ret = hooks.set( elem, value, name ) ) !== undefined ) {\n\t\t\t\treturn ret;\n\t\t\t}\n\n\t\t\telem.setAttribute( name, value + "" );\n\t\t\treturn value;\n\t\t}\n\n\t\tif ( hooks && "get" in hooks && ( ret = hooks.get( elem, name ) ) !== null ) {\n\t\t\treturn ret;\n\t\t}\n\n\t\tret = jQuery.find.attr( elem, name );\n\n\t\t// Non-existent attributes return null, we normalize to undefined\n\t\treturn ret == null ? undefined : ret;\n\t},\n\n\tattrHooks: {\n\t\ttype: {\n\t\t\tset: function( elem, value ) {\n\t\t\t\tif ( !support.radioValue && value === "radio" &&\n\t\t\t\t\tjQuery.nodeName( elem, "input" ) ) {\n\t\t\t\t\tvar val = elem.value;\n\t\t\t\t\telem.setAttribute( "type", value );\n\t\t\t\t\tif ( val ) {\n\t\t\t\t\t\telem.value = val;\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\tremoveAttr: function( elem, value ) {\n\t\tvar name, propName,\n\t\t\ti = 0,\n\t\t\tattrNames = value && value.match( rnotwhite );\n\n\t\tif ( attrNames && elem.nodeType === 1 ) {\n\t\t\twhile ( ( name = attrNames[ i++ ] ) ) {\n\t\t\t\tpropName = jQuery.propFix[ name ] || name;\n\n\t\t\t\t// Boolean attributes get special treatment (#10870)\n\t\t\t\tif ( jQuery.expr.match.bool.test( name ) ) {\n\n\t\t\t\t\t// Set corresponding property to false\n\t\t\t\t\telem[ propName ] = false;\n\t\t\t\t}\n\n\t\t\t\telem.removeAttribute( name );\n\t\t\t}\n\t\t}\n\t}\n} );\n\n// Hooks for boolean attributes\nboolHook = {\n\tset: function( elem, value, name ) {\n\t\tif ( value === false ) {\n\n\t\t\t// Remove boolean attributes when set to false\n\t\t\tjQuery.removeAttr( elem, name );\n\t\t} else {\n\t\t\telem.setAttribute( name, name );\n\t\t}\n\t\treturn name;\n\t}\n};\njQuery.each( jQuery.expr.match.bool.source.match( /\\w+/g ), function( i, name ) {\n\tvar getter = attrHandle[ name ] || jQuery.find.attr;\n\n\tattrHandle[ name ] = function( elem, name, isXML ) {\n\t\tvar ret, handle;\n\t\tif ( !isXML ) {\n\n\t\t\t// Avoid an infinite loop by temporarily removing this function from the getter\n\t\t\thandle = attrHandle[ name ];\n\t\t\tattrHandle[ name ] = ret;\n\t\t\tret = getter( elem, name, isXML ) != null ?\n\t\t\t\tname.toLowerCase() :\n\t\t\t\tnull;\n\t\t\tattrHandle[ name ] = handle;\n\t\t}\n\t\treturn ret;\n\t};\n} );\n\n\n\n\nvar rfocusable = /^(?:input|select|textarea|button)$/i,\n\trclickable = /^(?:a|area)$/i;\n\njQuery.fn.extend( {\n\tprop: function( name, value ) {\n\t\treturn access( this, jQuery.prop, name, value, arguments.length > 1 );\n\t},\n\n\tremoveProp: function( name ) {\n\t\treturn this.each( function() {\n\t\t\tdelete this[ jQuery.propFix[ name ] || name ];\n\t\t} );\n\t}\n} );\n\njQuery.extend( {\n\tprop: function( elem, name, value ) {\n\t\tvar ret, hooks,\n\t\t\tnType = elem.nodeType;\n\n\t\t// Don\'t get/set properties on text, comment and attribute nodes\n\t\tif ( nType === 3 || nType === 8 || nType === 2 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( nType !== 1 || !jQuery.isXMLDoc( elem ) ) {\n\n\t\t\t// Fix name and attach hooks\n\t\t\tname = jQuery.propFix[ name ] || name;\n\t\t\thooks = jQuery.propHooks[ name ];\n\t\t}\n\n\t\tif ( value !== undefined ) {\n\t\t\tif ( hooks && "set" in hooks &&\n\t\t\t\t( ret = hooks.set( elem, value, name ) ) !== undefined ) {\n\t\t\t\treturn ret;\n\t\t\t}\n\n\t\t\treturn ( elem[ name ] = value );\n\t\t}\n\n\t\tif ( hooks && "get" in hooks && ( ret = hooks.get( elem, name ) ) !== null ) {\n\t\t\treturn ret;\n\t\t}\n\n\t\treturn elem[ name ];\n\t},\n\n\tpropHooks: {\n\t\ttabIndex: {\n\t\t\tget: function( elem ) {\n\n\t\t\t\t// elem.tabIndex doesn\'t always return the\n\t\t\t\t// correct value when it hasn\'t been explicitly set\n\t\t\t\t// http://fluidproject.org/blog/2008/01/09/getting-setting-and-removing-tabindex-values-with-javascript/\n\t\t\t\t// Use proper attribute retrieval(#12072)\n\t\t\t\tvar tabindex = jQuery.find.attr( elem, "tabindex" );\n\n\t\t\t\treturn tabindex ?\n\t\t\t\t\tparseInt( tabindex, 10 ) :\n\t\t\t\t\trfocusable.test( elem.nodeName ) ||\n\t\t\t\t\t\trclickable.test( elem.nodeName ) && elem.href ?\n\t\t\t\t\t\t\t0 :\n\t\t\t\t\t\t\t-1;\n\t\t\t}\n\t\t}\n\t},\n\n\tpropFix: {\n\t\t"for": "htmlFor",\n\t\t"class": "className"\n\t}\n} );\n\nif ( !support.optSelected ) {\n\tjQuery.propHooks.selected = {\n\t\tget: function( elem ) {\n\t\t\tvar parent = elem.parentNode;\n\t\t\tif ( parent && parent.parentNode ) {\n\t\t\t\tparent.parentNode.selectedIndex;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t};\n}\n\njQuery.each( [\n\t"tabIndex",\n\t"readOnly",\n\t"maxLength",\n\t"cellSpacing",\n\t"cellPadding",\n\t"rowSpan",\n\t"colSpan",\n\t"useMap",\n\t"frameBorder",\n\t"contentEditable"\n], function() {\n\tjQuery.propFix[ this.toLowerCase() ] = this;\n} );\n\n\n\n\nvar rclass = /[\\t\\r\\n\\f]/g;\n\nfunction getClass( elem ) {\n\treturn elem.getAttribute && elem.getAttribute( "class" ) || "";\n}\n\njQuery.fn.extend( {\n\taddClass: function( value ) {\n\t\tvar classes, elem, cur, curValue, clazz, j, finalValue,\n\t\t\ti = 0;\n\n\t\tif ( jQuery.isFunction( value ) ) {\n\t\t\treturn this.each( function( j ) {\n\t\t\t\tjQuery( this ).addClass( value.call( this, j, getClass( this ) ) );\n\t\t\t} );\n\t\t}\n\n\t\tif ( typeof value === "string" && value ) {\n\t\t\tclasses = value.match( rnotwhite ) || [];\n\n\t\t\twhile ( ( elem = this[ i++ ] ) ) {\n\t\t\t\tcurValue = getClass( elem );\n\t\t\t\tcur = elem.nodeType === 1 &&\n\t\t\t\t\t( " " + curValue + " " ).replace( rclass, " " );\n\n\t\t\t\tif ( cur ) {\n\t\t\t\t\tj = 0;\n\t\t\t\t\twhile ( ( clazz = classes[ j++ ] ) ) {\n\t\t\t\t\t\tif ( cur.indexOf( " " + clazz + " " ) < 0 ) {\n\t\t\t\t\t\t\tcur += clazz + " ";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Only assign if different to avoid unneeded rendering.\n\t\t\t\t\tfinalValue = jQuery.trim( cur );\n\t\t\t\t\tif ( curValue !== finalValue ) {\n\t\t\t\t\t\telem.setAttribute( "class", finalValue );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tremoveClass: function( value ) {\n\t\tvar classes, elem, cur, curValue, clazz, j, finalValue,\n\t\t\ti = 0;\n\n\t\tif ( jQuery.isFunction( value ) ) {\n\t\t\treturn this.each( function( j ) {\n\t\t\t\tjQuery( this ).removeClass( value.call( this, j, getClass( this ) ) );\n\t\t\t} );\n\t\t}\n\n\t\tif ( !arguments.length ) {\n\t\t\treturn this.attr( "class", "" );\n\t\t}\n\n\t\tif ( typeof value === "string" && value ) {\n\t\t\tclasses = value.match( rnotwhite ) || [];\n\n\t\t\twhile ( ( elem = this[ i++ ] ) ) {\n\t\t\t\tcurValue = getClass( elem );\n\n\t\t\t\t// This expression is here for better compressibility (see addClass)\n\t\t\t\tcur = elem.nodeType === 1 &&\n\t\t\t\t\t( " " + curValue + " " ).replace( rclass, " " );\n\n\t\t\t\tif ( cur ) {\n\t\t\t\t\tj = 0;\n\t\t\t\t\twhile ( ( clazz = classes[ j++ ] ) ) {\n\n\t\t\t\t\t\t// Remove *all* instances\n\t\t\t\t\t\twhile ( cur.indexOf( " " + clazz + " " ) > -1 ) {\n\t\t\t\t\t\t\tcur = cur.replace( " " + clazz + " ", " " );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Only assign if different to avoid unneeded rendering.\n\t\t\t\t\tfinalValue = jQuery.trim( cur );\n\t\t\t\t\tif ( curValue !== finalValue ) {\n\t\t\t\t\t\telem.setAttribute( "class", finalValue );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\ttoggleClass: function( value, stateVal ) {\n\t\tvar type = typeof value;\n\n\t\tif ( typeof stateVal === "boolean" && type === "string" ) {\n\t\t\treturn stateVal ? this.addClass( value ) : this.removeClass( value );\n\t\t}\n\n\t\tif ( jQuery.isFunction( value ) ) {\n\t\t\treturn this.each( function( i ) {\n\t\t\t\tjQuery( this ).toggleClass(\n\t\t\t\t\tvalue.call( this, i, getClass( this ), stateVal ),\n\t\t\t\t\tstateVal\n\t\t\t\t);\n\t\t\t} );\n\t\t}\n\n\t\treturn this.each( function() {\n\t\t\tvar className, i, self, classNames;\n\n\t\t\tif ( type === "string" ) {\n\n\t\t\t\t// Toggle individual class names\n\t\t\t\ti = 0;\n\t\t\t\tself = jQuery( this );\n\t\t\t\tclassNames = value.match( rnotwhite ) || [];\n\n\t\t\t\twhile ( ( className = classNames[ i++ ] ) ) {\n\n\t\t\t\t\t// Check each className given, space separated list\n\t\t\t\t\tif ( self.hasClass( className ) ) {\n\t\t\t\t\t\tself.removeClass( className );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tself.addClass( className );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t// Toggle whole class name\n\t\t\t} else if ( value === undefined || type === "boolean" ) {\n\t\t\t\tclassName = getClass( this );\n\t\t\t\tif ( className ) {\n\n\t\t\t\t\t// Store className if set\n\t\t\t\t\tdataPriv.set( this, "__className__", className );\n\t\t\t\t}\n\n\t\t\t\t// If the element has a class name or if we\'re passed `false`,\n\t\t\t\t// then remove the whole classname (if there was one, the above saved it).\n\t\t\t\t// Otherwise bring back whatever was previously saved (if anything),\n\t\t\t\t// falling back to the empty string if nothing was stored.\n\t\t\t\tif ( this.setAttribute ) {\n\t\t\t\t\tthis.setAttribute( "class",\n\t\t\t\t\t\tclassName || value === false ?\n\t\t\t\t\t\t"" :\n\t\t\t\t\t\tdataPriv.get( this, "__className__" ) || ""\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t},\n\n\thasClass: function( selector ) {\n\t\tvar className, elem,\n\t\t\ti = 0;\n\n\t\tclassName = " " + selector + " ";\n\t\twhile ( ( elem = this[ i++ ] ) ) {\n\t\t\tif ( elem.nodeType === 1 &&\n\t\t\t\t( " " + getClass( elem ) + " " ).replace( rclass, " " )\n\t\t\t\t\t.indexOf( className ) > -1\n\t\t\t) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n} );\n\n\n\n\nvar rreturn = /\\r/g;\n\njQuery.fn.extend( {\n\tval: function( value ) {\n\t\tvar hooks, ret, isFunction,\n\t\t\telem = this[ 0 ];\n\n\t\tif ( !arguments.length ) {\n\t\t\tif ( elem ) {\n\t\t\t\thooks = jQuery.valHooks[ elem.type ] ||\n\t\t\t\t\tjQuery.valHooks[ elem.nodeName.toLowerCase() ];\n\n\t\t\t\tif ( hooks &&\n\t\t\t\t\t"get" in hooks &&\n\t\t\t\t\t( ret = hooks.get( elem, "value" ) ) !== undefined\n\t\t\t\t) {\n\t\t\t\t\treturn ret;\n\t\t\t\t}\n\n\t\t\t\tret = elem.value;\n\n\t\t\t\treturn typeof ret === "string" ?\n\n\t\t\t\t\t// Handle most common string cases\n\t\t\t\t\tret.replace( rreturn, "" ) :\n\n\t\t\t\t\t// Handle cases where value is null/undef or number\n\t\t\t\t\tret == null ? "" : ret;\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tisFunction = jQuery.isFunction( value );\n\n\t\treturn this.each( function( i ) {\n\t\t\tvar val;\n\n\t\t\tif ( this.nodeType !== 1 ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( isFunction ) {\n\t\t\t\tval = value.call( this, i, jQuery( this ).val() );\n\t\t\t} else {\n\t\t\t\tval = value;\n\t\t\t}\n\n\t\t\t// Treat null/undefined as ""; convert numbers to string\n\t\t\tif ( val == null ) {\n\t\t\t\tval = "";\n\n\t\t\t} else if ( typeof val === "number" ) {\n\t\t\t\tval += "";\n\n\t\t\t} else if ( jQuery.isArray( val ) ) {\n\t\t\t\tval = jQuery.map( val, function( value ) {\n\t\t\t\t\treturn value == null ? "" : value + "";\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\thooks = jQuery.valHooks[ this.type ] || jQuery.valHooks[ this.nodeName.toLowerCase() ];\n\n\t\t\t// If set returns undefined, fall back to normal setting\n\t\t\tif ( !hooks || !( "set" in hooks ) || hooks.set( this, val, "value" ) === undefined ) {\n\t\t\t\tthis.value = val;\n\t\t\t}\n\t\t} );\n\t}\n} );\n\njQuery.extend( {\n\tvalHooks: {\n\t\toption: {\n\t\t\tget: function( elem ) {\n\n\t\t\t\t// Support: IE<11\n\t\t\t\t// option.value not trimmed (#14858)\n\t\t\t\treturn jQuery.trim( elem.value );\n\t\t\t}\n\t\t},\n\t\tselect: {\n\t\t\tget: function( elem ) {\n\t\t\t\tvar value, option,\n\t\t\t\t\toptions = elem.options,\n\t\t\t\t\tindex = elem.selectedIndex,\n\t\t\t\t\tone = elem.type === "select-one" || index < 0,\n\t\t\t\t\tvalues = one ? null : [],\n\t\t\t\t\tmax = one ? index + 1 : options.length,\n\t\t\t\t\ti = index < 0 ?\n\t\t\t\t\t\tmax :\n\t\t\t\t\t\tone ? index : 0;\n\n\t\t\t\t// Loop through all the selected options\n\t\t\t\tfor ( ; i < max; i++ ) {\n\t\t\t\t\toption = options[ i ];\n\n\t\t\t\t\t// IE8-9 doesn\'t update selected after form reset (#2551)\n\t\t\t\t\tif ( ( option.selected || i === index ) &&\n\n\t\t\t\t\t\t\t// Don\'t return options that are disabled or in a disabled optgroup\n\t\t\t\t\t\t\t( support.optDisabled ?\n\t\t\t\t\t\t\t\t!option.disabled : option.getAttribute( "disabled" ) === null ) &&\n\t\t\t\t\t\t\t( !option.parentNode.disabled ||\n\t\t\t\t\t\t\t\t!jQuery.nodeName( option.parentNode, "optgroup" ) ) ) {\n\n\t\t\t\t\t\t// Get the specific value for the option\n\t\t\t\t\t\tvalue = jQuery( option ).val();\n\n\t\t\t\t\t\t// We don\'t need an array for one selects\n\t\t\t\t\t\tif ( one ) {\n\t\t\t\t\t\t\treturn value;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Multi-Selects return an array\n\t\t\t\t\t\tvalues.push( value );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn values;\n\t\t\t},\n\n\t\t\tset: function( elem, value ) {\n\t\t\t\tvar optionSet, option,\n\t\t\t\t\toptions = elem.options,\n\t\t\t\t\tvalues = jQuery.makeArray( value ),\n\t\t\t\t\ti = options.length;\n\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\toption = options[ i ];\n\t\t\t\t\tif ( option.selected =\n\t\t\t\t\t\t\tjQuery.inArray( jQuery.valHooks.option.get( option ), values ) > -1\n\t\t\t\t\t) {\n\t\t\t\t\t\toptionSet = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Force browsers to behave consistently when non-matching value is set\n\t\t\t\tif ( !optionSet ) {\n\t\t\t\t\telem.selectedIndex = -1;\n\t\t\t\t}\n\t\t\t\treturn values;\n\t\t\t}\n\t\t}\n\t}\n} );\n\n// Radios and checkboxes getter/setter\njQuery.each( [ "radio", "checkbox" ], function() {\n\tjQuery.valHooks[ this ] = {\n\t\tset: function( elem, value ) {\n\t\t\tif ( jQuery.isArray( value ) ) {\n\t\t\t\treturn ( elem.checked = jQuery.inArray( jQuery( elem ).val(), value ) > -1 );\n\t\t\t}\n\t\t}\n\t};\n\tif ( !support.checkOn ) {\n\t\tjQuery.valHooks[ this ].get = function( elem ) {\n\t\t\treturn elem.getAttribute( "value" ) === null ? "on" : elem.value;\n\t\t};\n\t}\n} );\n\n\n\n\n// Return jQuery for attributes-only inclusion\n\n\nvar rfocusMorph = /^(?:focusinfocus|focusoutblur)$/;\n\njQuery.extend( jQuery.event, {\n\n\ttrigger: function( event, data, elem, onlyHandlers ) {\n\n\t\tvar i, cur, tmp, bubbleType, ontype, handle, special,\n\t\t\teventPath = [ elem || document ],\n\t\t\ttype = hasOwn.call( event, "type" ) ? event.type : event,\n\t\t\tnamespaces = hasOwn.call( event, "namespace" ) ? event.namespace.split( "." ) : [];\n\n\t\tcur = tmp = elem = elem || document;\n\n\t\t// Don\'t do events on text and comment nodes\n\t\tif ( elem.nodeType === 3 || elem.nodeType === 8 ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// focus/blur morphs to focusin/out; ensure we\'re not firing them right now\n\t\tif ( rfocusMorph.test( type + jQuery.event.triggered ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( type.indexOf( "." ) > -1 ) {\n\n\t\t\t// Namespaced trigger; create a regexp to match event type in handle()\n\t\t\tnamespaces = type.split( "." );\n\t\t\ttype = namespaces.shift();\n\t\t\tnamespaces.sort();\n\t\t}\n\t\tontype = type.indexOf( ":" ) < 0 && "on" + type;\n\n\t\t// Caller can pass in a jQuery.Event object, Object, or just an event type string\n\t\tevent = event[ jQuery.expando ] ?\n\t\t\tevent :\n\t\t\tnew jQuery.Event( type, typeof event === "object" && event );\n\n\t\t// Trigger bitmask: & 1 for native handlers; & 2 for jQuery (always true)\n\t\tevent.isTrigger = onlyHandlers ? 2 : 3;\n\t\tevent.namespace = namespaces.join( "." );\n\t\tevent.rnamespace = event.namespace ?\n\t\t\tnew RegExp( "(^|\\\\.)" + namespaces.join( "\\\\.(?:.*\\\\.|)" ) + "(\\\\.|$)" ) :\n\t\t\tnull;\n\n\t\t// Clean up the event in case it is being reused\n\t\tevent.result = undefined;\n\t\tif ( !event.target ) {\n\t\t\tevent.target = elem;\n\t\t}\n\n\t\t// Clone any incoming data and prepend the event, creating the handler arg list\n\t\tdata = data == null ?\n\t\t\t[ event ] :\n\t\t\tjQuery.makeArray( data, [ event ] );\n\n\t\t// Allow special events to draw outside the lines\n\t\tspecial = jQuery.event.special[ type ] || {};\n\t\tif ( !onlyHandlers && special.trigger && special.trigger.apply( elem, data ) === false ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Determine event propagation path in advance, per W3C events spec (#9951)\n\t\t// Bubble up to document, then to window; watch for a global ownerDocument var (#9724)\n\t\tif ( !onlyHandlers && !special.noBubble && !jQuery.isWindow( elem ) ) {\n\n\t\t\tbubbleType = special.delegateType || type;\n\t\t\tif ( !rfocusMorph.test( bubbleType + type ) ) {\n\t\t\t\tcur = cur.parentNode;\n\t\t\t}\n\t\t\tfor ( ; cur; cur = cur.parentNode ) {\n\t\t\t\teventPath.push( cur );\n\t\t\t\ttmp = cur;\n\t\t\t}\n\n\t\t\t// Only add window if we got to document (e.g., not plain obj or detached DOM)\n\t\t\tif ( tmp === ( elem.ownerDocument || document ) ) {\n\t\t\t\teventPath.push( tmp.defaultView || tmp.parentWindow || window );\n\t\t\t}\n\t\t}\n\n\t\t// Fire handlers on the event path\n\t\ti = 0;\n\t\twhile ( ( cur = eventPath[ i++ ] ) && !event.isPropagationStopped() ) {\n\n\t\t\tevent.type = i > 1 ?\n\t\t\t\tbubbleType :\n\t\t\t\tspecial.bindType || type;\n\n\t\t\t// jQuery handler\n\t\t\thandle = ( dataPriv.get( cur, "events" ) || {} )[ event.type ] &&\n\t\t\t\tdataPriv.get( cur, "handle" );\n\t\t\tif ( handle ) {\n\t\t\t\thandle.apply( cur, data );\n\t\t\t}\n\n\t\t\t// Native handler\n\t\t\thandle = ontype && cur[ ontype ];\n\t\t\tif ( handle && handle.apply && acceptData( cur ) ) {\n\t\t\t\tevent.result = handle.apply( cur, data );\n\t\t\t\tif ( event.result === false ) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tevent.type = type;\n\n\t\t// If nobody prevented the default action, do it now\n\t\tif ( !onlyHandlers && !event.isDefaultPrevented() ) {\n\n\t\t\tif ( ( !special._default ||\n\t\t\t\tspecial._default.apply( eventPath.pop(), data ) === false ) &&\n\t\t\t\tacceptData( elem ) ) {\n\n\t\t\t\t// Call a native DOM method on the target with the same name name as the event.\n\t\t\t\t// Don\'t do default actions on window, that\'s where global variables be (#6170)\n\t\t\t\tif ( ontype && jQuery.isFunction( elem[ type ] ) && !jQuery.isWindow( elem ) ) {\n\n\t\t\t\t\t// Don\'t re-trigger an onFOO event when we call its FOO() method\n\t\t\t\t\ttmp = elem[ ontype ];\n\n\t\t\t\t\tif ( tmp ) {\n\t\t\t\t\t\telem[ ontype ] = null;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Prevent re-triggering of the same event, since we already bubbled it above\n\t\t\t\t\tjQuery.event.triggered = type;\n\t\t\t\t\telem[ type ]();\n\t\t\t\t\tjQuery.event.triggered = undefined;\n\n\t\t\t\t\tif ( tmp ) {\n\t\t\t\t\t\telem[ ontype ] = tmp;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn event.result;\n\t},\n\n\t// Piggyback on a donor event to simulate a different one\n\tsimulate: function( type, elem, event ) {\n\t\tvar e = jQuery.extend(\n\t\t\tnew jQuery.Event(),\n\t\t\tevent,\n\t\t\t{\n\t\t\t\ttype: type,\n\t\t\t\tisSimulated: true\n\n\t\t\t\t// Previously, `originalEvent: {}` was set here, so stopPropagation call\n\t\t\t\t// would not be triggered on donor event, since in our own\n\t\t\t\t// jQuery.event.stopPropagation function we had a check for existence of\n\t\t\t\t// originalEvent.stopPropagation method, so, consequently it would be a noop.\n\t\t\t\t//\n\t\t\t\t// But now, this "simulate" function is used only for events\n\t\t\t\t// for which stopPropagation() is noop, so there is no need for that anymore.\n\t\t\t\t//\n\t\t\t\t// For the compat branch though, guard for "click" and "submit"\n\t\t\t\t// events is still used, but was moved to jQuery.event.stopPropagation function\n\t\t\t\t// because `originalEvent` should point to the original event for the constancy\n\t\t\t\t// with other events and for more focused logic\n\t\t\t}\n\t\t);\n\n\t\tjQuery.event.trigger( e, null, elem );\n\n\t\tif ( e.isDefaultPrevented() ) {\n\t\t\tevent.preventDefault();\n\t\t}\n\t}\n\n} );\n\njQuery.fn.extend( {\n\n\ttrigger: function( type, data ) {\n\t\treturn this.each( function() {\n\t\t\tjQuery.event.trigger( type, data, this );\n\t\t} );\n\t},\n\ttriggerHandler: function( type, data ) {\n\t\tvar elem = this[ 0 ];\n\t\tif ( elem ) {\n\t\t\treturn jQuery.event.trigger( type, data, elem, true );\n\t\t}\n\t}\n} );\n\n\njQuery.each( ( "blur focus focusin focusout load resize scroll unload click dblclick " +\n\t"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave " +\n\t"change select submit keydown keypress keyup error contextmenu" ).split( " " ),\n\tfunction( i, name ) {\n\n\t// Handle event binding\n\tjQuery.fn[ name ] = function( data, fn ) {\n\t\treturn arguments.length > 0 ?\n\t\t\tthis.on( name, null, data, fn ) :\n\t\t\tthis.trigger( name );\n\t};\n} );\n\njQuery.fn.extend( {\n\thover: function( fnOver, fnOut ) {\n\t\treturn this.mouseenter( fnOver ).mouseleave( fnOut || fnOver );\n\t}\n} );\n\n\n\n\nsupport.focusin = "onfocusin" in window;\n\n\n// Support: Firefox\n// Firefox doesn\'t have focus(in | out) events\n// Related ticket - https://bugzilla.mozilla.org/show_bug.cgi?id=687787\n//\n// Support: Chrome, Safari\n// focus(in | out) events fire after focus & blur events,\n// which is spec violation - http://www.w3.org/TR/DOM-Level-3-Events/#events-focusevent-event-order\n// Related ticket - https://code.google.com/p/chromium/issues/detail?id=449857\nif ( !support.focusin ) {\n\tjQuery.each( { focus: "focusin", blur: "focusout" }, function( orig, fix ) {\n\n\t\t// Attach a single capturing handler on the document while someone wants focusin/focusout\n\t\tvar handler = function( event ) {\n\t\t\tjQuery.event.simulate( fix, event.target, jQuery.event.fix( event ) );\n\t\t};\n\n\t\tjQuery.event.special[ fix ] = {\n\t\t\tsetup: function() {\n\t\t\t\tvar doc = this.ownerDocument || this,\n\t\t\t\t\tattaches = dataPriv.access( doc, fix );\n\n\t\t\t\tif ( !attaches ) {\n\t\t\t\t\tdoc.addEventListener( orig, handler, true );\n\t\t\t\t}\n\t\t\t\tdataPriv.access( doc, fix, ( attaches || 0 ) + 1 );\n\t\t\t},\n\t\t\tteardown: function() {\n\t\t\t\tvar doc = this.ownerDocument || this,\n\t\t\t\t\tattaches = dataPriv.access( doc, fix ) - 1;\n\n\t\t\t\tif ( !attaches ) {\n\t\t\t\t\tdoc.removeEventListener( orig, handler, true );\n\t\t\t\t\tdataPriv.remove( doc, fix );\n\n\t\t\t\t} else {\n\t\t\t\t\tdataPriv.access( doc, fix, attaches );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} );\n}\nvar location = window.location;\n\nvar nonce = jQuery.now();\n\nvar rquery = ( /\\?/ );\n\n\n\n// Support: Android 2.3\n// Workaround failure to string-cast null input\njQuery.parseJSON = function( data ) {\n\treturn JSON.parse( data + "" );\n};\n\n\n// Cross-browser xml parsing\njQuery.parseXML = function( data ) {\n\tvar xml;\n\tif ( !data || typeof data !== "string" ) {\n\t\treturn null;\n\t}\n\n\t// Support: IE9\n\ttry {\n\t\txml = ( new window.DOMParser() ).parseFromString( data, "text/xml" );\n\t} catch ( e ) {\n\t\txml = undefined;\n\t}\n\n\tif ( !xml || xml.getElementsByTagName( "parsererror" ).length ) {\n\t\tjQuery.error( "Invalid XML: " + data );\n\t}\n\treturn xml;\n};\n\n\nvar\n\trhash = /#.*$/,\n\trts = /([?&])_=[^&]*/,\n\trheaders = /^(.*?):[ \\t]*([^\\r\\n]*)$/mg,\n\n\t// #7653, #8125, #8152: local protocol detection\n\trlocalProtocol = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/,\n\trnoContent = /^(?:GET|HEAD)$/,\n\trprotocol = /^\\/\\//,\n\n\t/* Prefilters\n\t * 1) They are useful to introduce custom dataTypes (see ajax/jsonp.js for an example)\n\t * 2) These are called:\n\t *    - BEFORE asking for a transport\n\t *    - AFTER param serialization (s.data is a string if s.processData is true)\n\t * 3) key is the dataType\n\t * 4) the catchall symbol "*" can be used\n\t * 5) execution will start with transport dataType and THEN continue down to "*" if needed\n\t */\n\tprefilters = {},\n\n\t/* Transports bindings\n\t * 1) key is the dataType\n\t * 2) the catchall symbol "*" can be used\n\t * 3) selection will start with transport dataType and THEN go to "*" if needed\n\t */\n\ttransports = {},\n\n\t// Avoid comment-prolog char sequence (#10098); must appease lint and evade compression\n\tallTypes = "*/".concat( "*" ),\n\n\t// Anchor tag for parsing the document origin\n\toriginAnchor = document.createElement( "a" );\n\toriginAnchor.href = location.href;\n\n// Base "constructor" for jQuery.ajaxPrefilter and jQuery.ajaxTransport\nfunction addToPrefiltersOrTransports( structure ) {\n\n\t// dataTypeExpression is optional and defaults to "*"\n\treturn function( dataTypeExpression, func ) {\n\n\t\tif ( typeof dataTypeExpression !== "string" ) {\n\t\t\tfunc = dataTypeExpression;\n\t\t\tdataTypeExpression = "*";\n\t\t}\n\n\t\tvar dataType,\n\t\t\ti = 0,\n\t\t\tdataTypes = dataTypeExpression.toLowerCase().match( rnotwhite ) || [];\n\n\t\tif ( jQuery.isFunction( func ) ) {\n\n\t\t\t// For each dataType in the dataTypeExpression\n\t\t\twhile ( ( dataType = dataTypes[ i++ ] ) ) {\n\n\t\t\t\t// Prepend if requested\n\t\t\t\tif ( dataType[ 0 ] === "+" ) {\n\t\t\t\t\tdataType = dataType.slice( 1 ) || "*";\n\t\t\t\t\t( structure[ dataType ] = structure[ dataType ] || [] ).unshift( func );\n\n\t\t\t\t// Otherwise append\n\t\t\t\t} else {\n\t\t\t\t\t( structure[ dataType ] = structure[ dataType ] || [] ).push( func );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n}\n\n// Base inspection function for prefilters and transports\nfunction inspectPrefiltersOrTransports( structure, options, originalOptions, jqXHR ) {\n\n\tvar inspected = {},\n\t\tseekingTransport = ( structure === transports );\n\n\tfunction inspect( dataType ) {\n\t\tvar selected;\n\t\tinspected[ dataType ] = true;\n\t\tjQuery.each( structure[ dataType ] || [], function( _, prefilterOrFactory ) {\n\t\t\tvar dataTypeOrTransport = prefilterOrFactory( options, originalOptions, jqXHR );\n\t\t\tif ( typeof dataTypeOrTransport === "string" &&\n\t\t\t\t!seekingTransport && !inspected[ dataTypeOrTransport ] ) {\n\n\t\t\t\toptions.dataTypes.unshift( dataTypeOrTransport );\n\t\t\t\tinspect( dataTypeOrTransport );\n\t\t\t\treturn false;\n\t\t\t} else if ( seekingTransport ) {\n\t\t\t\treturn !( selected = dataTypeOrTransport );\n\t\t\t}\n\t\t} );\n\t\treturn selected;\n\t}\n\n\treturn inspect( options.dataTypes[ 0 ] ) || !inspected[ "*" ] && inspect( "*" );\n}\n\n// A special extend for ajax options\n// that takes "flat" options (not to be deep extended)\n// Fixes #9887\nfunction ajaxExtend( target, src ) {\n\tvar key, deep,\n\t\tflatOptions = jQuery.ajaxSettings.flatOptions || {};\n\n\tfor ( key in src ) {\n\t\tif ( src[ key ] !== undefined ) {\n\t\t\t( flatOptions[ key ] ? target : ( deep || ( deep = {} ) ) )[ key ] = src[ key ];\n\t\t}\n\t}\n\tif ( deep ) {\n\t\tjQuery.extend( true, target, deep );\n\t}\n\n\treturn target;\n}\n\n/* Handles responses to an ajax request:\n * - finds the right dataType (mediates between content-type and expected dataType)\n * - returns the corresponding response\n */\nfunction ajaxHandleResponses( s, jqXHR, responses ) {\n\n\tvar ct, type, finalDataType, firstDataType,\n\t\tcontents = s.contents,\n\t\tdataTypes = s.dataTypes;\n\n\t// Remove auto dataType and get content-type in the process\n\twhile ( dataTypes[ 0 ] === "*" ) {\n\t\tdataTypes.shift();\n\t\tif ( ct === undefined ) {\n\t\t\tct = s.mimeType || jqXHR.getResponseHeader( "Content-Type" );\n\t\t}\n\t}\n\n\t// Check if we\'re dealing with a known content-type\n\tif ( ct ) {\n\t\tfor ( type in contents ) {\n\t\t\tif ( contents[ type ] && contents[ type ].test( ct ) ) {\n\t\t\t\tdataTypes.unshift( type );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t// Check to see if we have a response for the expected dataType\n\tif ( dataTypes[ 0 ] in responses ) {\n\t\tfinalDataType = dataTypes[ 0 ];\n\t} else {\n\n\t\t// Try convertible dataTypes\n\t\tfor ( type in responses ) {\n\t\t\tif ( !dataTypes[ 0 ] || s.converters[ type + " " + dataTypes[ 0 ] ] ) {\n\t\t\t\tfinalDataType = type;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif ( !firstDataType ) {\n\t\t\t\tfirstDataType = type;\n\t\t\t}\n\t\t}\n\n\t\t// Or just use first one\n\t\tfinalDataType = finalDataType || firstDataType;\n\t}\n\n\t// If we found a dataType\n\t// We add the dataType to the list if needed\n\t// and return the corresponding response\n\tif ( finalDataType ) {\n\t\tif ( finalDataType !== dataTypes[ 0 ] ) {\n\t\t\tdataTypes.unshift( finalDataType );\n\t\t}\n\t\treturn responses[ finalDataType ];\n\t}\n}\n\n/* Chain conversions given the request and the original response\n * Also sets the responseXXX fields on the jqXHR instance\n */\nfunction ajaxConvert( s, response, jqXHR, isSuccess ) {\n\tvar conv2, current, conv, tmp, prev,\n\t\tconverters = {},\n\n\t\t// Work with a copy of dataTypes in case we need to modify it for conversion\n\t\tdataTypes = s.dataTypes.slice();\n\n\t// Create converters map with lowercased keys\n\tif ( dataTypes[ 1 ] ) {\n\t\tfor ( conv in s.converters ) {\n\t\t\tconverters[ conv.toLowerCase() ] = s.converters[ conv ];\n\t\t}\n\t}\n\n\tcurrent = dataTypes.shift();\n\n\t// Convert to each sequential dataType\n\twhile ( current ) {\n\n\t\tif ( s.responseFields[ current ] ) {\n\t\t\tjqXHR[ s.responseFields[ current ] ] = response;\n\t\t}\n\n\t\t// Apply the dataFilter if provided\n\t\tif ( !prev && isSuccess && s.dataFilter ) {\n\t\t\tresponse = s.dataFilter( response, s.dataType );\n\t\t}\n\n\t\tprev = current;\n\t\tcurrent = dataTypes.shift();\n\n\t\tif ( current ) {\n\n\t\t// There\'s only work to do if current dataType is non-auto\n\t\t\tif ( current === "*" ) {\n\n\t\t\t\tcurrent = prev;\n\n\t\t\t// Convert response if prev dataType is non-auto and differs from current\n\t\t\t} else if ( prev !== "*" && prev !== current ) {\n\n\t\t\t\t// Seek a direct converter\n\t\t\t\tconv = converters[ prev + " " + current ] || converters[ "* " + current ];\n\n\t\t\t\t// If none found, seek a pair\n\t\t\t\tif ( !conv ) {\n\t\t\t\t\tfor ( conv2 in converters ) {\n\n\t\t\t\t\t\t// If conv2 outputs current\n\t\t\t\t\t\ttmp = conv2.split( " " );\n\t\t\t\t\t\tif ( tmp[ 1 ] === current ) {\n\n\t\t\t\t\t\t\t// If prev can be converted to accepted input\n\t\t\t\t\t\t\tconv = converters[ prev + " " + tmp[ 0 ] ] ||\n\t\t\t\t\t\t\t\tconverters[ "* " + tmp[ 0 ] ];\n\t\t\t\t\t\t\tif ( conv ) {\n\n\t\t\t\t\t\t\t\t// Condense equivalence converters\n\t\t\t\t\t\t\t\tif ( conv === true ) {\n\t\t\t\t\t\t\t\t\tconv = converters[ conv2 ];\n\n\t\t\t\t\t\t\t\t// Otherwise, insert the intermediate dataType\n\t\t\t\t\t\t\t\t} else if ( converters[ conv2 ] !== true ) {\n\t\t\t\t\t\t\t\t\tcurrent = tmp[ 0 ];\n\t\t\t\t\t\t\t\t\tdataTypes.unshift( tmp[ 1 ] );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Apply converter (if not an equivalence)\n\t\t\t\tif ( conv !== true ) {\n\n\t\t\t\t\t// Unless errors are allowed to bubble, catch and return them\n\t\t\t\t\tif ( conv && s.throws ) {\n\t\t\t\t\t\tresponse = conv( response );\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tresponse = conv( response );\n\t\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tstate: "parsererror",\n\t\t\t\t\t\t\t\terror: conv ? e : "No conversion from " + prev + " to " + current\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn { state: "success", data: response };\n}\n\njQuery.extend( {\n\n\t// Counter for holding the number of active queries\n\tactive: 0,\n\n\t// Last-Modified header cache for next request\n\tlastModified: {},\n\tetag: {},\n\n\tajaxSettings: {\n\t\turl: location.href,\n\t\ttype: "GET",\n\t\tisLocal: rlocalProtocol.test( location.protocol ),\n\t\tglobal: true,\n\t\tprocessData: true,\n\t\tasync: true,\n\t\tcontentType: "application/x-www-form-urlencoded; charset=UTF-8",\n\t\t/*\n\t\ttimeout: 0,\n\t\tdata: null,\n\t\tdataType: null,\n\t\tusername: null,\n\t\tpassword: null,\n\t\tcache: null,\n\t\tthrows: false,\n\t\ttraditional: false,\n\t\theaders: {},\n\t\t*/\n\n\t\taccepts: {\n\t\t\t"*": allTypes,\n\t\t\ttext: "text/plain",\n\t\t\thtml: "text/html",\n\t\t\txml: "application/xml, text/xml",\n\t\t\tjson: "application/json, text/javascript"\n\t\t},\n\n\t\tcontents: {\n\t\t\txml: /\\bxml\\b/,\n\t\t\thtml: /\\bhtml/,\n\t\t\tjson: /\\bjson\\b/\n\t\t},\n\n\t\tresponseFields: {\n\t\t\txml: "responseXML",\n\t\t\ttext: "responseText",\n\t\t\tjson: "responseJSON"\n\t\t},\n\n\t\t// Data converters\n\t\t// Keys separate source (or catchall "*") and destination types with a single space\n\t\tconverters: {\n\n\t\t\t// Convert anything to text\n\t\t\t"* text": String,\n\n\t\t\t// Text to html (true = no transformation)\n\t\t\t"text html": true,\n\n\t\t\t// Evaluate text as a json expression\n\t\t\t"text json": jQuery.parseJSON,\n\n\t\t\t// Parse text as xml\n\t\t\t"text xml": jQuery.parseXML\n\t\t},\n\n\t\t// For options that shouldn\'t be deep extended:\n\t\t// you can add your own custom options here if\n\t\t// and when you create one that shouldn\'t be\n\t\t// deep extended (see ajaxExtend)\n\t\tflatOptions: {\n\t\t\turl: true,\n\t\t\tcontext: true\n\t\t}\n\t},\n\n\t// Creates a full fledged settings object into target\n\t// with both ajaxSettings and settings fields.\n\t// If target is omitted, writes into ajaxSettings.\n\tajaxSetup: function( target, settings ) {\n\t\treturn settings ?\n\n\t\t\t// Building a settings object\n\t\t\tajaxExtend( ajaxExtend( target, jQuery.ajaxSettings ), settings ) :\n\n\t\t\t// Extending ajaxSettings\n\t\t\tajaxExtend( jQuery.ajaxSettings, target );\n\t},\n\n\tajaxPrefilter: addToPrefiltersOrTransports( prefilters ),\n\tajaxTransport: addToPrefiltersOrTransports( transports ),\n\n\t// Main method\n\tajax: function( url, options ) {\n\n\t\t// If url is an object, simulate pre-1.5 signature\n\t\tif ( typeof url === "object" ) {\n\t\t\toptions = url;\n\t\t\turl = undefined;\n\t\t}\n\n\t\t// Force options to be an object\n\t\toptions = options || {};\n\n\t\tvar transport,\n\n\t\t\t// URL without anti-cache param\n\t\t\tcacheURL,\n\n\t\t\t// Response headers\n\t\t\tresponseHeadersString,\n\t\t\tresponseHeaders,\n\n\t\t\t// timeout handle\n\t\t\ttimeoutTimer,\n\n\t\t\t// Url cleanup var\n\t\t\turlAnchor,\n\n\t\t\t// To know if global events are to be dispatched\n\t\t\tfireGlobals,\n\n\t\t\t// Loop variable\n\t\t\ti,\n\n\t\t\t// Create the final options object\n\t\t\ts = jQuery.ajaxSetup( {}, options ),\n\n\t\t\t// Callbacks context\n\t\t\tcallbackContext = s.context || s,\n\n\t\t\t// Context for global events is callbackContext if it is a DOM node or jQuery collection\n\t\t\tglobalEventContext = s.context &&\n\t\t\t\t( callbackContext.nodeType || callbackContext.jquery ) ?\n\t\t\t\t\tjQuery( callbackContext ) :\n\t\t\t\t\tjQuery.event,\n\n\t\t\t// Deferreds\n\t\t\tdeferred = jQuery.Deferred(),\n\t\t\tcompleteDeferred = jQuery.Callbacks( "once memory" ),\n\n\t\t\t// Status-dependent callbacks\n\t\t\tstatusCode = s.statusCode || {},\n\n\t\t\t// Headers (they are sent all at once)\n\t\t\trequestHeaders = {},\n\t\t\trequestHeadersNames = {},\n\n\t\t\t// The jqXHR state\n\t\t\tstate = 0,\n\n\t\t\t// Default abort message\n\t\t\tstrAbort = "canceled",\n\n\t\t\t// Fake xhr\n\t\t\tjqXHR = {\n\t\t\t\treadyState: 0,\n\n\t\t\t\t// Builds headers hashtable if needed\n\t\t\t\tgetResponseHeader: function( key ) {\n\t\t\t\t\tvar match;\n\t\t\t\t\tif ( state === 2 ) {\n\t\t\t\t\t\tif ( !responseHeaders ) {\n\t\t\t\t\t\t\tresponseHeaders = {};\n\t\t\t\t\t\t\twhile ( ( match = rheaders.exec( responseHeadersString ) ) ) {\n\t\t\t\t\t\t\t\tresponseHeaders[ match[ 1 ].toLowerCase() ] = match[ 2 ];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmatch = responseHeaders[ key.toLowerCase() ];\n\t\t\t\t\t}\n\t\t\t\t\treturn match == null ? null : match;\n\t\t\t\t},\n\n\t\t\t\t// Raw string\n\t\t\t\tgetAllResponseHeaders: function() {\n\t\t\t\t\treturn state === 2 ? responseHeadersString : null;\n\t\t\t\t},\n\n\t\t\t\t// Caches the header\n\t\t\t\tsetRequestHeader: function( name, value ) {\n\t\t\t\t\tvar lname = name.toLowerCase();\n\t\t\t\t\tif ( !state ) {\n\t\t\t\t\t\tname = requestHeadersNames[ lname ] = requestHeadersNames[ lname ] || name;\n\t\t\t\t\t\trequestHeaders[ name ] = value;\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\n\t\t\t\t// Overrides response content-type header\n\t\t\t\toverrideMimeType: function( type ) {\n\t\t\t\t\tif ( !state ) {\n\t\t\t\t\t\ts.mimeType = type;\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\n\t\t\t\t// Status-dependent callbacks\n\t\t\t\tstatusCode: function( map ) {\n\t\t\t\t\tvar code;\n\t\t\t\t\tif ( map ) {\n\t\t\t\t\t\tif ( state < 2 ) {\n\t\t\t\t\t\t\tfor ( code in map ) {\n\n\t\t\t\t\t\t\t\t// Lazy-add the new callback in a way that preserves old ones\n\t\t\t\t\t\t\t\tstatusCode[ code ] = [ statusCode[ code ], map[ code ] ];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t// Execute the appropriate callbacks\n\t\t\t\t\t\t\tjqXHR.always( map[ jqXHR.status ] );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\n\t\t\t\t// Cancel the request\n\t\t\t\tabort: function( statusText ) {\n\t\t\t\t\tvar finalText = statusText || strAbort;\n\t\t\t\t\tif ( transport ) {\n\t\t\t\t\t\ttransport.abort( finalText );\n\t\t\t\t\t}\n\t\t\t\t\tdone( 0, finalText );\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\t\t};\n\n\t\t// Attach deferreds\n\t\tdeferred.promise( jqXHR ).complete = completeDeferred.add;\n\t\tjqXHR.success = jqXHR.done;\n\t\tjqXHR.error = jqXHR.fail;\n\n\t\t// Remove hash character (#7531: and string promotion)\n\t\t// Add protocol if not provided (prefilters might expect it)\n\t\t// Handle falsy url in the settings object (#10093: consistency with old signature)\n\t\t// We also use the url parameter if available\n\t\ts.url = ( ( url || s.url || location.href ) + "" ).replace( rhash, "" )\n\t\t\t.replace( rprotocol, location.protocol + "//" );\n\n\t\t// Alias method option to type as per ticket #12004\n\t\ts.type = options.method || options.type || s.method || s.type;\n\n\t\t// Extract dataTypes list\n\t\ts.dataTypes = jQuery.trim( s.dataType || "*" ).toLowerCase().match( rnotwhite ) || [ "" ];\n\n\t\t// A cross-domain request is in order when the origin doesn\'t match the current origin.\n\t\tif ( s.crossDomain == null ) {\n\t\t\turlAnchor = document.createElement( "a" );\n\n\t\t\t// Support: IE8-11+\n\t\t\t// IE throws exception if url is malformed, e.g. http://example.com:80x/\n\t\t\ttry {\n\t\t\t\turlAnchor.href = s.url;\n\n\t\t\t\t// Support: IE8-11+\n\t\t\t\t// Anchor\'s host property isn\'t correctly set when s.url is relative\n\t\t\t\turlAnchor.href = urlAnchor.href;\n\t\t\t\ts.crossDomain = originAnchor.protocol + "//" + originAnchor.host !==\n\t\t\t\t\turlAnchor.protocol + "//" + urlAnchor.host;\n\t\t\t} catch ( e ) {\n\n\t\t\t\t// If there is an error parsing the URL, assume it is crossDomain,\n\t\t\t\t// it can be rejected by the transport if it is invalid\n\t\t\t\ts.crossDomain = true;\n\t\t\t}\n\t\t}\n\n\t\t// Convert data if not already a string\n\t\tif ( s.data && s.processData && typeof s.data !== "string" ) {\n\t\t\ts.data = jQuery.param( s.data, s.traditional );\n\t\t}\n\n\t\t// Apply prefilters\n\t\tinspectPrefiltersOrTransports( prefilters, s, options, jqXHR );\n\n\t\t// If request was aborted inside a prefilter, stop there\n\t\tif ( state === 2 ) {\n\t\t\treturn jqXHR;\n\t\t}\n\n\t\t// We can fire global events as of now if asked to\n\t\t// Don\'t fire events if jQuery.event is undefined in an AMD-usage scenario (#15118)\n\t\tfireGlobals = jQuery.event && s.global;\n\n\t\t// Watch for a new set of requests\n\t\tif ( fireGlobals && jQuery.active++ === 0 ) {\n\t\t\tjQuery.event.trigger( "ajaxStart" );\n\t\t}\n\n\t\t// Uppercase the type\n\t\ts.type = s.type.toUpperCase();\n\n\t\t// Determine if request has content\n\t\ts.hasContent = !rnoContent.test( s.type );\n\n\t\t// Save the URL in case we\'re toying with the If-Modified-Since\n\t\t// and/or If-None-Match header later on\n\t\tcacheURL = s.url;\n\n\t\t// More options handling for requests with no content\n\t\tif ( !s.hasContent ) {\n\n\t\t\t// If data is available, append data to url\n\t\t\tif ( s.data ) {\n\t\t\t\tcacheURL = ( s.url += ( rquery.test( cacheURL ) ? "&" : "?" ) + s.data );\n\n\t\t\t\t// #9682: remove data so that it\'s not used in an eventual retry\n\t\t\t\tdelete s.data;\n\t\t\t}\n\n\t\t\t// Add anti-cache in url if needed\n\t\t\tif ( s.cache === false ) {\n\t\t\t\ts.url = rts.test( cacheURL ) ?\n\n\t\t\t\t\t// If there is already a \'_\' parameter, set its value\n\t\t\t\t\tcacheURL.replace( rts, "$1_=" + nonce++ ) :\n\n\t\t\t\t\t// Otherwise add one to the end\n\t\t\t\t\tcacheURL + ( rquery.test( cacheURL ) ? "&" : "?" ) + "_=" + nonce++;\n\t\t\t}\n\t\t}\n\n\t\t// Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.\n\t\tif ( s.ifModified ) {\n\t\t\tif ( jQuery.lastModified[ cacheURL ] ) {\n\t\t\t\tjqXHR.setRequestHeader( "If-Modified-Since", jQuery.lastModified[ cacheURL ] );\n\t\t\t}\n\t\t\tif ( jQuery.etag[ cacheURL ] ) {\n\t\t\t\tjqXHR.setRequestHeader( "If-None-Match", jQuery.etag[ cacheURL ] );\n\t\t\t}\n\t\t}\n\n\t\t// Set the correct header, if data is being sent\n\t\tif ( s.data && s.hasContent && s.contentType !== false || options.contentType ) {\n\t\t\tjqXHR.setRequestHeader( "Content-Type", s.contentType );\n\t\t}\n\n\t\t// Set the Accepts header for the server, depending on the dataType\n\t\tjqXHR.setRequestHeader(\n\t\t\t"Accept",\n\t\t\ts.dataTypes[ 0 ] && s.accepts[ s.dataTypes[ 0 ] ] ?\n\t\t\t\ts.accepts[ s.dataTypes[ 0 ] ] +\n\t\t\t\t\t( s.dataTypes[ 0 ] !== "*" ? ", " + allTypes + "; q=0.01" : "" ) :\n\t\t\t\ts.accepts[ "*" ]\n\t\t);\n\n\t\t// Check for headers option\n\t\tfor ( i in s.headers ) {\n\t\t\tjqXHR.setRequestHeader( i, s.headers[ i ] );\n\t\t}\n\n\t\t// Allow custom headers/mimetypes and early abort\n\t\tif ( s.beforeSend &&\n\t\t\t( s.beforeSend.call( callbackContext, jqXHR, s ) === false || state === 2 ) ) {\n\n\t\t\t// Abort if not done already and return\n\t\t\treturn jqXHR.abort();\n\t\t}\n\n\t\t// Aborting is no longer a cancellation\n\t\tstrAbort = "abort";\n\n\t\t// Install callbacks on deferreds\n\t\tfor ( i in { success: 1, error: 1, complete: 1 } ) {\n\t\t\tjqXHR[ i ]( s[ i ] );\n\t\t}\n\n\t\t// Get transport\n\t\ttransport = inspectPrefiltersOrTransports( transports, s, options, jqXHR );\n\n\t\t// If no transport, we auto-abort\n\t\tif ( !transport ) {\n\t\t\tdone( -1, "No Transport" );\n\t\t} else {\n\t\t\tjqXHR.readyState = 1;\n\n\t\t\t// Send global event\n\t\t\tif ( fireGlobals ) {\n\t\t\t\tglobalEventContext.trigger( "ajaxSend", [ jqXHR, s ] );\n\t\t\t}\n\n\t\t\t// If request was aborted inside ajaxSend, stop there\n\t\t\tif ( state === 2 ) {\n\t\t\t\treturn jqXHR;\n\t\t\t}\n\n\t\t\t// Timeout\n\t\t\tif ( s.async && s.timeout > 0 ) {\n\t\t\t\ttimeoutTimer = window.setTimeout( function() {\n\t\t\t\t\tjqXHR.abort( "timeout" );\n\t\t\t\t}, s.timeout );\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tstate = 1;\n\t\t\t\ttransport.send( requestHeaders, done );\n\t\t\t} catch ( e ) {\n\n\t\t\t\t// Propagate exception as error if not done\n\t\t\t\tif ( state < 2 ) {\n\t\t\t\t\tdone( -1, e );\n\n\t\t\t\t// Simply rethrow otherwise\n\t\t\t\t} else {\n\t\t\t\t\tthrow e;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Callback for when everything is done\n\t\tfunction done( status, nativeStatusText, responses, headers ) {\n\t\t\tvar isSuccess, success, error, response, modified,\n\t\t\t\tstatusText = nativeStatusText;\n\n\t\t\t// Called once\n\t\t\tif ( state === 2 ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// State is "done" now\n\t\t\tstate = 2;\n\n\t\t\t// Clear timeout if it exists\n\t\t\tif ( timeoutTimer ) {\n\t\t\t\twindow.clearTimeout( timeoutTimer );\n\t\t\t}\n\n\t\t\t// Dereference transport for early garbage collection\n\t\t\t// (no matter how long the jqXHR object will be used)\n\t\t\ttransport = undefined;\n\n\t\t\t// Cache response headers\n\t\t\tresponseHeadersString = headers || "";\n\n\t\t\t// Set readyState\n\t\t\tjqXHR.readyState = status > 0 ? 4 : 0;\n\n\t\t\t// Determine if successful\n\t\t\tisSuccess = status >= 200 && status < 300 || status === 304;\n\n\t\t\t// Get response data\n\t\t\tif ( responses ) {\n\t\t\t\tresponse = ajaxHandleResponses( s, jqXHR, responses );\n\t\t\t}\n\n\t\t\t// Convert no matter what (that way responseXXX fields are always set)\n\t\t\tresponse = ajaxConvert( s, response, jqXHR, isSuccess );\n\n\t\t\t// If successful, handle type chaining\n\t\t\tif ( isSuccess ) {\n\n\t\t\t\t// Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.\n\t\t\t\tif ( s.ifModified ) {\n\t\t\t\t\tmodified = jqXHR.getResponseHeader( "Last-Modified" );\n\t\t\t\t\tif ( modified ) {\n\t\t\t\t\t\tjQuery.lastModified[ cacheURL ] = modified;\n\t\t\t\t\t}\n\t\t\t\t\tmodified = jqXHR.getResponseHeader( "etag" );\n\t\t\t\t\tif ( modified ) {\n\t\t\t\t\t\tjQuery.etag[ cacheURL ] = modified;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// if no content\n\t\t\t\tif ( status === 204 || s.type === "HEAD" ) {\n\t\t\t\t\tstatusText = "nocontent";\n\n\t\t\t\t// if not modified\n\t\t\t\t} else if ( status === 304 ) {\n\t\t\t\t\tstatusText = "notmodified";\n\n\t\t\t\t// If we have data, let\'s convert it\n\t\t\t\t} else {\n\t\t\t\t\tstatusText = response.state;\n\t\t\t\t\tsuccess = response.data;\n\t\t\t\t\terror = response.error;\n\t\t\t\t\tisSuccess = !error;\n\t\t\t\t}\n\t\t\t} else {\n\n\t\t\t\t// Extract error from statusText and normalize for non-aborts\n\t\t\t\terror = statusText;\n\t\t\t\tif ( status || !statusText ) {\n\t\t\t\t\tstatusText = "error";\n\t\t\t\t\tif ( status < 0 ) {\n\t\t\t\t\t\tstatus = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Set data for the fake xhr object\n\t\t\tjqXHR.status = status;\n\t\t\tjqXHR.statusText = ( nativeStatusText || statusText ) + "";\n\n\t\t\t// Success/Error\n\t\t\tif ( isSuccess ) {\n\t\t\t\tdeferred.resolveWith( callbackContext, [ success, statusText, jqXHR ] );\n\t\t\t} else {\n\t\t\t\tdeferred.rejectWith( callbackContext, [ jqXHR, statusText, error ] );\n\t\t\t}\n\n\t\t\t// Status-dependent callbacks\n\t\t\tjqXHR.statusCode( statusCode );\n\t\t\tstatusCode = undefined;\n\n\t\t\tif ( fireGlobals ) {\n\t\t\t\tglobalEventContext.trigger( isSuccess ? "ajaxSuccess" : "ajaxError",\n\t\t\t\t\t[ jqXHR, s, isSuccess ? success : error ] );\n\t\t\t}\n\n\t\t\t// Complete\n\t\t\tcompleteDeferred.fireWith( callbackContext, [ jqXHR, statusText ] );\n\n\t\t\tif ( fireGlobals ) {\n\t\t\t\tglobalEventContext.trigger( "ajaxComplete", [ jqXHR, s ] );\n\n\t\t\t\t// Handle the global AJAX counter\n\t\t\t\tif ( !( --jQuery.active ) ) {\n\t\t\t\t\tjQuery.event.trigger( "ajaxStop" );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn jqXHR;\n\t},\n\n\tgetJSON: function( url, data, callback ) {\n\t\treturn jQuery.get( url, data, callback, "json" );\n\t},\n\n\tgetScript: function( url, callback ) {\n\t\treturn jQuery.get( url, undefined, callback, "script" );\n\t}\n} );\n\njQuery.each( [ "get", "post" ], function( i, method ) {\n\tjQuery[ method ] = function( url, data, callback, type ) {\n\n\t\t// Shift arguments if data argument was omitted\n\t\tif ( jQuery.isFunction( data ) ) {\n\t\t\ttype = type || callback;\n\t\t\tcallback = data;\n\t\t\tdata = undefined;\n\t\t}\n\n\t\t// The url can be an options object (which then must have .url)\n\t\treturn jQuery.ajax( jQuery.extend( {\n\t\t\turl: url,\n\t\t\ttype: method,\n\t\t\tdataType: type,\n\t\t\tdata: data,\n\t\t\tsuccess: callback\n\t\t}, jQuery.isPlainObject( url ) && url ) );\n\t};\n} );\n\n\njQuery._evalUrl = function( url ) {\n\treturn jQuery.ajax( {\n\t\turl: url,\n\n\t\t// Make this explicit, since user can override this through ajaxSetup (#11264)\n\t\ttype: "GET",\n\t\tdataType: "script",\n\t\tasync: false,\n\t\tglobal: false,\n\t\t"throws": true\n\t} );\n};\n\n\njQuery.fn.extend( {\n\twrapAll: function( html ) {\n\t\tvar wrap;\n\n\t\tif ( jQuery.isFunction( html ) ) {\n\t\t\treturn this.each( function( i ) {\n\t\t\t\tjQuery( this ).wrapAll( html.call( this, i ) );\n\t\t\t} );\n\t\t}\n\n\t\tif ( this[ 0 ] ) {\n\n\t\t\t// The elements to wrap the target around\n\t\t\twrap = jQuery( html, this[ 0 ].ownerDocument ).eq( 0 ).clone( true );\n\n\t\t\tif ( this[ 0 ].parentNode ) {\n\t\t\t\twrap.insertBefore( this[ 0 ] );\n\t\t\t}\n\n\t\t\twrap.map( function() {\n\t\t\t\tvar elem = this;\n\n\t\t\t\twhile ( elem.firstElementChild ) {\n\t\t\t\t\telem = elem.firstElementChild;\n\t\t\t\t}\n\n\t\t\t\treturn elem;\n\t\t\t} ).append( this );\n\t\t}\n\n\t\treturn this;\n\t},\n\n\twrapInner: function( html ) {\n\t\tif ( jQuery.isFunction( html ) ) {\n\t\t\treturn this.each( function( i ) {\n\t\t\t\tjQuery( this ).wrapInner( html.call( this, i ) );\n\t\t\t} );\n\t\t}\n\n\t\treturn this.each( function() {\n\t\t\tvar self = jQuery( this ),\n\t\t\t\tcontents = self.contents();\n\n\t\t\tif ( contents.length ) {\n\t\t\t\tcontents.wrapAll( html );\n\n\t\t\t} else {\n\t\t\t\tself.append( html );\n\t\t\t}\n\t\t} );\n\t},\n\n\twrap: function( html ) {\n\t\tvar isFunction = jQuery.isFunction( html );\n\n\t\treturn this.each( function( i ) {\n\t\t\tjQuery( this ).wrapAll( isFunction ? html.call( this, i ) : html );\n\t\t} );\n\t},\n\n\tunwrap: function() {\n\t\treturn this.parent().each( function() {\n\t\t\tif ( !jQuery.nodeName( this, "body" ) ) {\n\t\t\t\tjQuery( this ).replaceWith( this.childNodes );\n\t\t\t}\n\t\t} ).end();\n\t}\n} );\n\n\njQuery.expr.filters.hidden = function( elem ) {\n\treturn !jQuery.expr.filters.visible( elem );\n};\njQuery.expr.filters.visible = function( elem ) {\n\n\t// Support: Opera <= 12.12\n\t// Opera reports offsetWidths and offsetHeights less than zero on some elements\n\t// Use OR instead of AND as the element is not visible if either is true\n\t// See tickets #10406 and #13132\n\treturn elem.offsetWidth > 0 || elem.offsetHeight > 0 || elem.getClientRects().length > 0;\n};\n\n\n\n\nvar r20 = /%20/g,\n\trbracket = /\\[\\]$/,\n\trCRLF = /\\r?\\n/g,\n\trsubmitterTypes = /^(?:submit|button|image|reset|file)$/i,\n\trsubmittable = /^(?:input|select|textarea|keygen)/i;\n\nfunction buildParams( prefix, obj, traditional, add ) {\n\tvar name;\n\n\tif ( jQuery.isArray( obj ) ) {\n\n\t\t// Serialize array item.\n\t\tjQuery.each( obj, function( i, v ) {\n\t\t\tif ( traditional || rbracket.test( prefix ) ) {\n\n\t\t\t\t// Treat each array item as a scalar.\n\t\t\t\tadd( prefix, v );\n\n\t\t\t} else {\n\n\t\t\t\t// Item is non-scalar (array or object), encode its numeric index.\n\t\t\t\tbuildParams(\n\t\t\t\t\tprefix + "[" + ( typeof v === "object" && v != null ? i : "" ) + "]",\n\t\t\t\t\tv,\n\t\t\t\t\ttraditional,\n\t\t\t\t\tadd\n\t\t\t\t);\n\t\t\t}\n\t\t} );\n\n\t} else if ( !traditional && jQuery.type( obj ) === "object" ) {\n\n\t\t// Serialize object item.\n\t\tfor ( name in obj ) {\n\t\t\tbuildParams( prefix + "[" + name + "]", obj[ name ], traditional, add );\n\t\t}\n\n\t} else {\n\n\t\t// Serialize scalar item.\n\t\tadd( prefix, obj );\n\t}\n}\n\n// Serialize an array of form elements or a set of\n// key/values into a query string\njQuery.param = function( a, traditional ) {\n\tvar prefix,\n\t\ts = [],\n\t\tadd = function( key, value ) {\n\n\t\t\t// If value is a function, invoke it and return its value\n\t\t\tvalue = jQuery.isFunction( value ) ? value() : ( value == null ? "" : value );\n\t\t\ts[ s.length ] = encodeURIComponent( key ) + "=" + encodeURIComponent( value );\n\t\t};\n\n\t// Set traditional to true for jQuery <= 1.3.2 behavior.\n\tif ( traditional === undefined ) {\n\t\ttraditional = jQuery.ajaxSettings && jQuery.ajaxSettings.traditional;\n\t}\n\n\t// If an array was passed in, assume that it is an array of form elements.\n\tif ( jQuery.isArray( a ) || ( a.jquery && !jQuery.isPlainObject( a ) ) ) {\n\n\t\t// Serialize the form elements\n\t\tjQuery.each( a, function() {\n\t\t\tadd( this.name, this.value );\n\t\t} );\n\n\t} else {\n\n\t\t// If traditional, encode the "old" way (the way 1.3.2 or older\n\t\t// did it), otherwise encode params recursively.\n\t\tfor ( prefix in a ) {\n\t\t\tbuildParams( prefix, a[ prefix ], traditional, add );\n\t\t}\n\t}\n\n\t// Return the resulting serialization\n\treturn s.join( "&" ).replace( r20, "+" );\n};\n\njQuery.fn.extend( {\n\tserialize: function() {\n\t\treturn jQuery.param( this.serializeArray() );\n\t},\n\tserializeArray: function() {\n\t\treturn this.map( function() {\n\n\t\t\t// Can add propHook for "elements" to filter or add form elements\n\t\t\tvar elements = jQuery.prop( this, "elements" );\n\t\t\treturn elements ? jQuery.makeArray( elements ) : this;\n\t\t} )\n\t\t.filter( function() {\n\t\t\tvar type = this.type;\n\n\t\t\t// Use .is( ":disabled" ) so that fieldset[disabled] works\n\t\t\treturn this.name && !jQuery( this ).is( ":disabled" ) &&\n\t\t\t\trsubmittable.test( this.nodeName ) && !rsubmitterTypes.test( type ) &&\n\t\t\t\t( this.checked || !rcheckableType.test( type ) );\n\t\t} )\n\t\t.map( function( i, elem ) {\n\t\t\tvar val = jQuery( this ).val();\n\n\t\t\treturn val == null ?\n\t\t\t\tnull :\n\t\t\t\tjQuery.isArray( val ) ?\n\t\t\t\t\tjQuery.map( val, function( val ) {\n\t\t\t\t\t\treturn { name: elem.name, value: val.replace( rCRLF, "\\r\\n" ) };\n\t\t\t\t\t} ) :\n\t\t\t\t\t{ name: elem.name, value: val.replace( rCRLF, "\\r\\n" ) };\n\t\t} ).get();\n\t}\n} );\n\n\njQuery.ajaxSettings.xhr = function() {\n\ttry {\n\t\treturn new window.XMLHttpRequest();\n\t} catch ( e ) {}\n};\n\nvar xhrSuccessStatus = {\n\n\t\t// File protocol always yields status code 0, assume 200\n\t\t0: 200,\n\n\t\t// Support: IE9\n\t\t// #1450: sometimes IE returns 1223 when it should be 204\n\t\t1223: 204\n\t},\n\txhrSupported = jQuery.ajaxSettings.xhr();\n\nsupport.cors = !!xhrSupported && ( "withCredentials" in xhrSupported );\nsupport.ajax = xhrSupported = !!xhrSupported;\n\njQuery.ajaxTransport( function( options ) {\n\tvar callback, errorCallback;\n\n\t// Cross domain only allowed if supported through XMLHttpRequest\n\tif ( support.cors || xhrSupported && !options.crossDomain ) {\n\t\treturn {\n\t\t\tsend: function( headers, complete ) {\n\t\t\t\tvar i,\n\t\t\t\t\txhr = options.xhr();\n\n\t\t\t\txhr.open(\n\t\t\t\t\toptions.type,\n\t\t\t\t\toptions.url,\n\t\t\t\t\toptions.async,\n\t\t\t\t\toptions.username,\n\t\t\t\t\toptions.password\n\t\t\t\t);\n\n\t\t\t\t// Apply custom fields if provided\n\t\t\t\tif ( options.xhrFields ) {\n\t\t\t\t\tfor ( i in options.xhrFields ) {\n\t\t\t\t\t\txhr[ i ] = options.xhrFields[ i ];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Override mime type if needed\n\t\t\t\tif ( options.mimeType && xhr.overrideMimeType ) {\n\t\t\t\t\txhr.overrideMimeType( options.mimeType );\n\t\t\t\t}\n\n\t\t\t\t// X-Requested-With header\n\t\t\t\t// For cross-domain requests, seeing as conditions for a preflight are\n\t\t\t\t// akin to a jigsaw puzzle, we simply never set it to be sure.\n\t\t\t\t// (it can always be set on a per-request basis or even using ajaxSetup)\n\t\t\t\t// For same-domain requests, won\'t change header if already provided.\n\t\t\t\tif ( !options.crossDomain && !headers[ "X-Requested-With" ] ) {\n\t\t\t\t\theaders[ "X-Requested-With" ] = "XMLHttpRequest";\n\t\t\t\t}\n\n\t\t\t\t// Set headers\n\t\t\t\tfor ( i in headers ) {\n\t\t\t\t\txhr.setRequestHeader( i, headers[ i ] );\n\t\t\t\t}\n\n\t\t\t\t// Callback\n\t\t\t\tcallback = function( type ) {\n\t\t\t\t\treturn function() {\n\t\t\t\t\t\tif ( callback ) {\n\t\t\t\t\t\t\tcallback = errorCallback = xhr.onload =\n\t\t\t\t\t\t\t\txhr.onerror = xhr.onabort = xhr.onreadystatechange = null;\n\n\t\t\t\t\t\t\tif ( type === "abort" ) {\n\t\t\t\t\t\t\t\txhr.abort();\n\t\t\t\t\t\t\t} else if ( type === "error" ) {\n\n\t\t\t\t\t\t\t\t// Support: IE9\n\t\t\t\t\t\t\t\t// On a manual native abort, IE9 throws\n\t\t\t\t\t\t\t\t// errors on any property access that is not readyState\n\t\t\t\t\t\t\t\tif ( typeof xhr.status !== "number" ) {\n\t\t\t\t\t\t\t\t\tcomplete( 0, "error" );\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tcomplete(\n\n\t\t\t\t\t\t\t\t\t\t// File: protocol always yields status 0; see #8605, #14207\n\t\t\t\t\t\t\t\t\t\txhr.status,\n\t\t\t\t\t\t\t\t\t\txhr.statusText\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tcomplete(\n\t\t\t\t\t\t\t\t\txhrSuccessStatus[ xhr.status ] || xhr.status,\n\t\t\t\t\t\t\t\t\txhr.statusText,\n\n\t\t\t\t\t\t\t\t\t// Support: IE9 only\n\t\t\t\t\t\t\t\t\t// IE9 has no XHR2 but throws on binary (trac-11426)\n\t\t\t\t\t\t\t\t\t// For XHR2 non-text, let the caller handle it (gh-2498)\n\t\t\t\t\t\t\t\t\t( xhr.responseType || "text" ) !== "text"  ||\n\t\t\t\t\t\t\t\t\ttypeof xhr.responseText !== "string" ?\n\t\t\t\t\t\t\t\t\t\t{ binary: xhr.response } :\n\t\t\t\t\t\t\t\t\t\t{ text: xhr.responseText },\n\t\t\t\t\t\t\t\t\txhr.getAllResponseHeaders()\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t};\n\n\t\t\t\t// Listen to events\n\t\t\t\txhr.onload = callback();\n\t\t\t\terrorCallback = xhr.onerror = callback( "error" );\n\n\t\t\t\t// Support: IE9\n\t\t\t\t// Use onreadystatechange to replace onabort\n\t\t\t\t// to handle uncaught aborts\n\t\t\t\tif ( xhr.onabort !== undefined ) {\n\t\t\t\t\txhr.onabort = errorCallback;\n\t\t\t\t} else {\n\t\t\t\t\txhr.onreadystatechange = function() {\n\n\t\t\t\t\t\t// Check readyState before timeout as it changes\n\t\t\t\t\t\tif ( xhr.readyState === 4 ) {\n\n\t\t\t\t\t\t\t// Allow onerror to be called first,\n\t\t\t\t\t\t\t// but that will not handle a native abort\n\t\t\t\t\t\t\t// Also, save errorCallback to a variable\n\t\t\t\t\t\t\t// as xhr.onerror cannot be accessed\n\t\t\t\t\t\t\twindow.setTimeout( function() {\n\t\t\t\t\t\t\t\tif ( callback ) {\n\t\t\t\t\t\t\t\t\terrorCallback();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\t// Create the abort callback\n\t\t\t\tcallback = callback( "abort" );\n\n\t\t\t\ttry {\n\n\t\t\t\t\t// Do send the request (this may raise an exception)\n\t\t\t\t\txhr.send( options.hasContent && options.data || null );\n\t\t\t\t} catch ( e ) {\n\n\t\t\t\t\t// #14683: Only rethrow if this hasn\'t been notified as an error yet\n\t\t\t\t\tif ( callback ) {\n\t\t\t\t\t\tthrow e;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tabort: function() {\n\t\t\t\tif ( callback ) {\n\t\t\t\t\tcallback();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n} );\n\n\n\n\n// Install script dataType\njQuery.ajaxSetup( {\n\taccepts: {\n\t\tscript: "text/javascript, application/javascript, " +\n\t\t\t"application/ecmascript, application/x-ecmascript"\n\t},\n\tcontents: {\n\t\tscript: /\\b(?:java|ecma)script\\b/\n\t},\n\tconverters: {\n\t\t"text script": function( text ) {\n\t\t\tjQuery.globalEval( text );\n\t\t\treturn text;\n\t\t}\n\t}\n} );\n\n// Handle cache\'s special case and crossDomain\njQuery.ajaxPrefilter( "script", function( s ) {\n\tif ( s.cache === undefined ) {\n\t\ts.cache = false;\n\t}\n\tif ( s.crossDomain ) {\n\t\ts.type = "GET";\n\t}\n} );\n\n// Bind script tag hack transport\njQuery.ajaxTransport( "script", function( s ) {\n\n\t// This transport only deals with cross domain requests\n\tif ( s.crossDomain ) {\n\t\tvar script, callback;\n\t\treturn {\n\t\t\tsend: function( _, complete ) {\n\t\t\t\tscript = jQuery( "<script>" ).prop( {\n\t\t\t\t\tcharset: s.scriptCharset,\n\t\t\t\t\tsrc: s.url\n\t\t\t\t} ).on(\n\t\t\t\t\t"load error",\n\t\t\t\t\tcallback = function( evt ) {\n\t\t\t\t\t\tscript.remove();\n\t\t\t\t\t\tcallback = null;\n\t\t\t\t\t\tif ( evt ) {\n\t\t\t\t\t\t\tcomplete( evt.type === "error" ? 404 : 200, evt.type );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\t// Use native DOM manipulation to avoid our domManip AJAX trickery\n\t\t\t\tdocument.head.appendChild( script[ 0 ] );\n\t\t\t},\n\t\t\tabort: function() {\n\t\t\t\tif ( callback ) {\n\t\t\t\t\tcallback();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n} );\n\n\n\n\nvar oldCallbacks = [],\n\trjsonp = /(=)\\?(?=&|$)|\\?\\?/;\n\n// Default jsonp settings\njQuery.ajaxSetup( {\n\tjsonp: "callback",\n\tjsonpCallback: function() {\n\t\tvar callback = oldCallbacks.pop() || ( jQuery.expando + "_" + ( nonce++ ) );\n\t\tthis[ callback ] = true;\n\t\treturn callback;\n\t}\n} );\n\n// Detect, normalize options and install callbacks for jsonp requests\njQuery.ajaxPrefilter( "json jsonp", function( s, originalSettings, jqXHR ) {\n\n\tvar callbackName, overwritten, responseContainer,\n\t\tjsonProp = s.jsonp !== false && ( rjsonp.test( s.url ) ?\n\t\t\t"url" :\n\t\t\ttypeof s.data === "string" &&\n\t\t\t\t( s.contentType || "" )\n\t\t\t\t\t.indexOf( "application/x-www-form-urlencoded" ) === 0 &&\n\t\t\t\trjsonp.test( s.data ) && "data"\n\t\t);\n\n\t// Handle iff the expected data type is "jsonp" or we have a parameter to set\n\tif ( jsonProp || s.dataTypes[ 0 ] === "jsonp" ) {\n\n\t\t// Get callback name, remembering preexisting value associated with it\n\t\tcallbackName = s.jsonpCallback = jQuery.isFunction( s.jsonpCallback ) ?\n\t\t\ts.jsonpCallback() :\n\t\t\ts.jsonpCallback;\n\n\t\t// Insert callback into url or form data\n\t\tif ( jsonProp ) {\n\t\t\ts[ jsonProp ] = s[ jsonProp ].replace( rjsonp, "$1" + callbackName );\n\t\t} else if ( s.jsonp !== false ) {\n\t\t\ts.url += ( rquery.test( s.url ) ? "&" : "?" ) + s.jsonp + "=" + callbackName;\n\t\t}\n\n\t\t// Use data converter to retrieve json after script execution\n\t\ts.converters[ "script json" ] = function() {\n\t\t\tif ( !responseContainer ) {\n\t\t\t\tjQuery.error( callbackName + " was not called" );\n\t\t\t}\n\t\t\treturn responseContainer[ 0 ];\n\t\t};\n\n\t\t// Force json dataType\n\t\ts.dataTypes[ 0 ] = "json";\n\n\t\t// Install callback\n\t\toverwritten = window[ callbackName ];\n\t\twindow[ callbackName ] = function() {\n\t\t\tresponseContainer = arguments;\n\t\t};\n\n\t\t// Clean-up function (fires after converters)\n\t\tjqXHR.always( function() {\n\n\t\t\t// If previous value didn\'t exist - remove it\n\t\t\tif ( overwritten === undefined ) {\n\t\t\t\tjQuery( window ).removeProp( callbackName );\n\n\t\t\t// Otherwise restore preexisting value\n\t\t\t} else {\n\t\t\t\twindow[ callbackName ] = overwritten;\n\t\t\t}\n\n\t\t\t// Save back as free\n\t\t\tif ( s[ callbackName ] ) {\n\n\t\t\t\t// Make sure that re-using the options doesn\'t screw things around\n\t\t\t\ts.jsonpCallback = originalSettings.jsonpCallback;\n\n\t\t\t\t// Save the callback name for future use\n\t\t\t\toldCallbacks.push( callbackName );\n\t\t\t}\n\n\t\t\t// Call if it was a function and we have a response\n\t\t\tif ( responseContainer && jQuery.isFunction( overwritten ) ) {\n\t\t\t\toverwritten( responseContainer[ 0 ] );\n\t\t\t}\n\n\t\t\tresponseContainer = overwritten = undefined;\n\t\t} );\n\n\t\t// Delegate to script\n\t\treturn "script";\n\t}\n} );\n\n\n\n\n// Support: Safari 8+\n// In Safari 8 documents created via document.implementation.createHTMLDocument\n// collapse sibling forms: the second one becomes a child of the first one.\n// Because of that, this security measure has to be disabled in Safari 8.\n// https://bugs.webkit.org/show_bug.cgi?id=137337\nsupport.createHTMLDocument = ( function() {\n\tvar body = document.implementation.createHTMLDocument( "" ).body;\n\tbody.innerHTML = "<form></form><form></form>";\n\treturn body.childNodes.length === 2;\n} )();\n\n\n// Argument "data" should be string of html\n// context (optional): If specified, the fragment will be created in this context,\n// defaults to document\n// keepScripts (optional): If true, will include scripts passed in the html string\njQuery.parseHTML = function( data, context, keepScripts ) {\n\tif ( !data || typeof data !== "string" ) {\n\t\treturn null;\n\t}\n\tif ( typeof context === "boolean" ) {\n\t\tkeepScripts = context;\n\t\tcontext = false;\n\t}\n\n\t// Stop scripts or inline event handlers from being executed immediately\n\t// by using document.implementation\n\tcontext = context || ( support.createHTMLDocument ?\n\t\tdocument.implementation.createHTMLDocument( "" ) :\n\t\tdocument );\n\n\tvar parsed = rsingleTag.exec( data ),\n\t\tscripts = !keepScripts && [];\n\n\t// Single tag\n\tif ( parsed ) {\n\t\treturn [ context.createElement( parsed[ 1 ] ) ];\n\t}\n\n\tparsed = buildFragment( [ data ], context, scripts );\n\n\tif ( scripts && scripts.length ) {\n\t\tjQuery( scripts ).remove();\n\t}\n\n\treturn jQuery.merge( [], parsed.childNodes );\n};\n\n\n// Keep a copy of the old load method\nvar _load = jQuery.fn.load;\n\n/**\n * Load a url into a page\n */\njQuery.fn.load = function( url, params, callback ) {\n\tif ( typeof url !== "string" && _load ) {\n\t\treturn _load.apply( this, arguments );\n\t}\n\n\tvar selector, type, response,\n\t\tself = this,\n\t\toff = url.indexOf( " " );\n\n\tif ( off > -1 ) {\n\t\tselector = jQuery.trim( url.slice( off ) );\n\t\turl = url.slice( 0, off );\n\t}\n\n\t// If it\'s a function\n\tif ( jQuery.isFunction( params ) ) {\n\n\t\t// We assume that it\'s the callback\n\t\tcallback = params;\n\t\tparams = undefined;\n\n\t// Otherwise, build a param string\n\t} else if ( params && typeof params === "object" ) {\n\t\ttype = "POST";\n\t}\n\n\t// If we have elements to modify, make the request\n\tif ( self.length > 0 ) {\n\t\tjQuery.ajax( {\n\t\t\turl: url,\n\n\t\t\t// If "type" variable is undefined, then "GET" method will be used.\n\t\t\t// Make value of this field explicit since\n\t\t\t// user can override it through ajaxSetup method\n\t\t\ttype: type || "GET",\n\t\t\tdataType: "html",\n\t\t\tdata: params\n\t\t} ).done( function( responseText ) {\n\n\t\t\t// Save response for use in complete callback\n\t\t\tresponse = arguments;\n\n\t\t\tself.html( selector ?\n\n\t\t\t\t// If a selector was specified, locate the right elements in a dummy div\n\t\t\t\t// Exclude scripts to avoid IE \'Permission Denied\' errors\n\t\t\t\tjQuery( "<div>" ).append( jQuery.parseHTML( responseText ) ).find( selector ) :\n\n\t\t\t\t// Otherwise use the full result\n\t\t\t\tresponseText );\n\n\t\t// If the request succeeds, this function gets "data", "status", "jqXHR"\n\t\t// but they are ignored because response was set above.\n\t\t// If it fails, this function gets "jqXHR", "status", "error"\n\t\t} ).always( callback && function( jqXHR, status ) {\n\t\t\tself.each( function() {\n\t\t\t\tcallback.apply( self, response || [ jqXHR.responseText, status, jqXHR ] );\n\t\t\t} );\n\t\t} );\n\t}\n\n\treturn this;\n};\n\n\n\n\n// Attach a bunch of functions for handling common AJAX events\njQuery.each( [\n\t"ajaxStart",\n\t"ajaxStop",\n\t"ajaxComplete",\n\t"ajaxError",\n\t"ajaxSuccess",\n\t"ajaxSend"\n], function( i, type ) {\n\tjQuery.fn[ type ] = function( fn ) {\n\t\treturn this.on( type, fn );\n\t};\n} );\n\n\n\n\njQuery.expr.filters.animated = function( elem ) {\n\treturn jQuery.grep( jQuery.timers, function( fn ) {\n\t\treturn elem === fn.elem;\n\t} ).length;\n};\n\n\n\n\n/**\n * Gets a window from an element\n */\nfunction getWindow( elem ) {\n\treturn jQuery.isWindow( elem ) ? elem : elem.nodeType === 9 && elem.defaultView;\n}\n\njQuery.offset = {\n\tsetOffset: function( elem, options, i ) {\n\t\tvar curPosition, curLeft, curCSSTop, curTop, curOffset, curCSSLeft, calculatePosition,\n\t\t\tposition = jQuery.css( elem, "position" ),\n\t\t\tcurElem = jQuery( elem ),\n\t\t\tprops = {};\n\n\t\t// Set position first, in-case top/left are set even on static elem\n\t\tif ( position === "static" ) {\n\t\t\telem.style.position = "relative";\n\t\t}\n\n\t\tcurOffset = curElem.offset();\n\t\tcurCSSTop = jQuery.css( elem, "top" );\n\t\tcurCSSLeft = jQuery.css( elem, "left" );\n\t\tcalculatePosition = ( position === "absolute" || position === "fixed" ) &&\n\t\t\t( curCSSTop + curCSSLeft ).indexOf( "auto" ) > -1;\n\n\t\t// Need to be able to calculate position if either\n\t\t// top or left is auto and position is either absolute or fixed\n\t\tif ( calculatePosition ) {\n\t\t\tcurPosition = curElem.position();\n\t\t\tcurTop = curPosition.top;\n\t\t\tcurLeft = curPosition.left;\n\n\t\t} else {\n\t\t\tcurTop = parseFloat( curCSSTop ) || 0;\n\t\t\tcurLeft = parseFloat( curCSSLeft ) || 0;\n\t\t}\n\n\t\tif ( jQuery.isFunction( options ) ) {\n\n\t\t\t// Use jQuery.extend here to allow modification of coordinates argument (gh-1848)\n\t\t\toptions = options.call( elem, i, jQuery.extend( {}, curOffset ) );\n\t\t}\n\n\t\tif ( options.top != null ) {\n\t\t\tprops.top = ( options.top - curOffset.top ) + curTop;\n\t\t}\n\t\tif ( options.left != null ) {\n\t\t\tprops.left = ( options.left - curOffset.left ) + curLeft;\n\t\t}\n\n\t\tif ( "using" in options ) {\n\t\t\toptions.using.call( elem, props );\n\n\t\t} else {\n\t\t\tcurElem.css( props );\n\t\t}\n\t}\n};\n\njQuery.fn.extend( {\n\toffset: function( options ) {\n\t\tif ( arguments.length ) {\n\t\t\treturn options === undefined ?\n\t\t\t\tthis :\n\t\t\t\tthis.each( function( i ) {\n\t\t\t\t\tjQuery.offset.setOffset( this, options, i );\n\t\t\t\t} );\n\t\t}\n\n\t\tvar docElem, win,\n\t\t\telem = this[ 0 ],\n\t\t\tbox = { top: 0, left: 0 },\n\t\t\tdoc = elem && elem.ownerDocument;\n\n\t\tif ( !doc ) {\n\t\t\treturn;\n\t\t}\n\n\t\tdocElem = doc.documentElement;\n\n\t\t// Make sure it\'s not a disconnected DOM node\n\t\tif ( !jQuery.contains( docElem, elem ) ) {\n\t\t\treturn box;\n\t\t}\n\n\t\tbox = elem.getBoundingClientRect();\n\t\twin = getWindow( doc );\n\t\treturn {\n\t\t\ttop: box.top + win.pageYOffset - docElem.clientTop,\n\t\t\tleft: box.left + win.pageXOffset - docElem.clientLeft\n\t\t};\n\t},\n\n\tposition: function() {\n\t\tif ( !this[ 0 ] ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar offsetParent, offset,\n\t\t\telem = this[ 0 ],\n\t\t\tparentOffset = { top: 0, left: 0 };\n\n\t\t// Fixed elements are offset from window (parentOffset = {top:0, left: 0},\n\t\t// because it is its only offset parent\n\t\tif ( jQuery.css( elem, "position" ) === "fixed" ) {\n\n\t\t\t// Assume getBoundingClientRect is there when computed position is fixed\n\t\t\toffset = elem.getBoundingClientRect();\n\n\t\t} else {\n\n\t\t\t// Get *real* offsetParent\n\t\t\toffsetParent = this.offsetParent();\n\n\t\t\t// Get correct offsets\n\t\t\toffset = this.offset();\n\t\t\tif ( !jQuery.nodeName( offsetParent[ 0 ], "html" ) ) {\n\t\t\t\tparentOffset = offsetParent.offset();\n\t\t\t}\n\n\t\t\t// Add offsetParent borders\n\t\t\t// Subtract offsetParent scroll positions\n\t\t\tparentOffset.top += jQuery.css( offsetParent[ 0 ], "borderTopWidth", true ) -\n\t\t\t\toffsetParent.scrollTop();\n\t\t\tparentOffset.left += jQuery.css( offsetParent[ 0 ], "borderLeftWidth", true ) -\n\t\t\t\toffsetParent.scrollLeft();\n\t\t}\n\n\t\t// Subtract parent offsets and element margins\n\t\treturn {\n\t\t\ttop: offset.top - parentOffset.top - jQuery.css( elem, "marginTop", true ),\n\t\t\tleft: offset.left - parentOffset.left - jQuery.css( elem, "marginLeft", true )\n\t\t};\n\t},\n\n\t// This method will return documentElement in the following cases:\n\t// 1) For the element inside the iframe without offsetParent, this method will return\n\t//    documentElement of the parent window\n\t// 2) For the hidden or detached element\n\t// 3) For body or html element, i.e. in case of the html node - it will return itself\n\t//\n\t// but those exceptions were never presented as a real life use-cases\n\t// and might be considered as more preferable results.\n\t//\n\t// This logic, however, is not guaranteed and can change at any point in the future\n\toffsetParent: function() {\n\t\treturn this.map( function() {\n\t\t\tvar offsetParent = this.offsetParent;\n\n\t\t\twhile ( offsetParent && jQuery.css( offsetParent, "position" ) === "static" ) {\n\t\t\t\toffsetParent = offsetParent.offsetParent;\n\t\t\t}\n\n\t\t\treturn offsetParent || documentElement;\n\t\t} );\n\t}\n} );\n\n// Create scrollLeft and scrollTop methods\njQuery.each( { scrollLeft: "pageXOffset", scrollTop: "pageYOffset" }, function( method, prop ) {\n\tvar top = "pageYOffset" === prop;\n\n\tjQuery.fn[ method ] = function( val ) {\n\t\treturn access( this, function( elem, method, val ) {\n\t\t\tvar win = getWindow( elem );\n\n\t\t\tif ( val === undefined ) {\n\t\t\t\treturn win ? win[ prop ] : elem[ method ];\n\t\t\t}\n\n\t\t\tif ( win ) {\n\t\t\t\twin.scrollTo(\n\t\t\t\t\t!top ? val : win.pageXOffset,\n\t\t\t\t\ttop ? val : win.pageYOffset\n\t\t\t\t);\n\n\t\t\t} else {\n\t\t\t\telem[ method ] = val;\n\t\t\t}\n\t\t}, method, val, arguments.length );\n\t};\n} );\n\n// Support: Safari<7-8+, Chrome<37-44+\n// Add the top/left cssHooks using jQuery.fn.position\n// Webkit bug: https://bugs.webkit.org/show_bug.cgi?id=29084\n// Blink bug: https://code.google.com/p/chromium/issues/detail?id=229280\n// getComputedStyle returns percent when specified for top/left/bottom/right;\n// rather than make the css module depend on the offset module, just check for it here\njQuery.each( [ "top", "left" ], function( i, prop ) {\n\tjQuery.cssHooks[ prop ] = addGetHookIf( support.pixelPosition,\n\t\tfunction( elem, computed ) {\n\t\t\tif ( computed ) {\n\t\t\t\tcomputed = curCSS( elem, prop );\n\n\t\t\t\t// If curCSS returns percentage, fallback to offset\n\t\t\t\treturn rnumnonpx.test( computed ) ?\n\t\t\t\t\tjQuery( elem ).position()[ prop ] + "px" :\n\t\t\t\t\tcomputed;\n\t\t\t}\n\t\t}\n\t);\n} );\n\n\n// Create innerHeight, innerWidth, height, width, outerHeight and outerWidth methods\njQuery.each( { Height: "height", Width: "width" }, function( name, type ) {\n\tjQuery.each( { padding: "inner" + name, content: type, "": "outer" + name },\n\t\tfunction( defaultExtra, funcName ) {\n\n\t\t// Margin is only for outerHeight, outerWidth\n\t\tjQuery.fn[ funcName ] = function( margin, value ) {\n\t\t\tvar chainable = arguments.length && ( defaultExtra || typeof margin !== "boolean" ),\n\t\t\t\textra = defaultExtra || ( margin === true || value === true ? "margin" : "border" );\n\n\t\t\treturn access( this, function( elem, type, value ) {\n\t\t\t\tvar doc;\n\n\t\t\t\tif ( jQuery.isWindow( elem ) ) {\n\n\t\t\t\t\t// As of 5/8/2012 this will yield incorrect results for Mobile Safari, but there\n\t\t\t\t\t// isn\'t a whole lot we can do. See pull request at this URL for discussion:\n\t\t\t\t\t// https://github.com/jquery/jquery/pull/764\n\t\t\t\t\treturn elem.document.documentElement[ "client" + name ];\n\t\t\t\t}\n\n\t\t\t\t// Get document width or height\n\t\t\t\tif ( elem.nodeType === 9 ) {\n\t\t\t\t\tdoc = elem.documentElement;\n\n\t\t\t\t\t// Either scroll[Width/Height] or offset[Width/Height] or client[Width/Height],\n\t\t\t\t\t// whichever is greatest\n\t\t\t\t\treturn Math.max(\n\t\t\t\t\t\telem.body[ "scroll" + name ], doc[ "scroll" + name ],\n\t\t\t\t\t\telem.body[ "offset" + name ], doc[ "offset" + name ],\n\t\t\t\t\t\tdoc[ "client" + name ]\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\treturn value === undefined ?\n\n\t\t\t\t\t// Get width or height on the element, requesting but not forcing parseFloat\n\t\t\t\t\tjQuery.css( elem, type, extra ) :\n\n\t\t\t\t\t// Set width or height on the element\n\t\t\t\t\tjQuery.style( elem, type, value, extra );\n\t\t\t}, type, chainable ? margin : undefined, chainable, null );\n\t\t};\n\t} );\n} );\n\n\njQuery.fn.extend( {\n\n\tbind: function( types, data, fn ) {\n\t\treturn this.on( types, null, data, fn );\n\t},\n\tunbind: function( types, fn ) {\n\t\treturn this.off( types, null, fn );\n\t},\n\n\tdelegate: function( selector, types, data, fn ) {\n\t\treturn this.on( types, selector, data, fn );\n\t},\n\tundelegate: function( selector, types, fn ) {\n\n\t\t// ( namespace ) or ( selector, types [, fn] )\n\t\treturn arguments.length === 1 ?\n\t\t\tthis.off( selector, "**" ) :\n\t\t\tthis.off( types, selector || "**", fn );\n\t},\n\tsize: function() {\n\t\treturn this.length;\n\t}\n} );\n\njQuery.fn.andSelf = jQuery.fn.addBack;\n\n\n\n\n// Register as a named AMD module, since jQuery can be concatenated with other\n// files that may use define, but not via a proper concatenation script that\n// understands anonymous AMD modules. A named AMD is safest and most robust\n// way to register. Lowercase jquery is used because AMD module names are\n// derived from file names, and jQuery is normally delivered in a lowercase\n// file name. Do this after creating the global so that if an AMD module wants\n// to call noConflict to hide this version of jQuery, it will work.\n\n// Note that for maximum portability, libraries that are not jQuery should\n// declare themselves as anonymous modules, and avoid setting a global if an\n// AMD loader is present. jQuery is a special case. For more information, see\n// https://github.com/jrburke/requirejs/wiki/Updating-existing-libraries#wiki-anon\n\nif ( typeof define === "function" && define.amd ) {\n\tdefine( "jquery", [], function() {\n\t\treturn jQuery;\n\t} );\n}\n\n\n\nvar\n\n\t// Map over jQuery in case of overwrite\n\t_jQuery = window.jQuery,\n\n\t// Map over the $ in case of overwrite\n\t_$ = window.$;\n\njQuery.noConflict = function( deep ) {\n\tif ( window.$ === jQuery ) {\n\t\twindow.$ = _$;\n\t}\n\n\tif ( deep && window.jQuery === jQuery ) {\n\t\twindow.jQuery = _jQuery;\n\t}\n\n\treturn jQuery;\n};\n\n// Expose jQuery and $ identifiers, even in AMD\n// (#7102#comment:10, https://github.com/jquery/jquery/pull/557)\n// and CommonJS for browser emulators (#13566)\nif ( !noGlobal ) {\n\twindow.jQuery = window.$ = jQuery;\n}\n\nreturn jQuery;\n}));\n'},ETvt:function(t,e){t.exports="/*\r\n*                                                                  *\r\n* Exformatics SharePoint 2003, 2007 javascript functions           *\r\n*                                                                  *\r\n* Copyright (c) Exformatics.  All rights reserved.                 *\r\n*                                                                  *\r\n********************************************************************/\r\n\r\n// Change log\r\n// Date        User  Description\r\n// ==========  ====  =================================================================\r\n// 01-02-2008  mmq   FKIL modifications retrieved. %0% in DL_FolderParams\r\n// 07-02-2008  mmq   EXBRMCreateMail - new functions fo er creating BRM emails with case documents attached\r\n// 13-02-2008  mmq   InitDLDashboard modified - Initialize web parts here rather than invoking javascript directly in web part\r\n// 21-02-2008  mmq   EXActivitiesRollout - stored procedure\r\n// 21-02-2008  mmq   SetEntityItemValue - added 3. property\r\n// 21-02-2008  mmq   EXCloseTask - set text decoration on line when closed\r\n// 25-02-2008  mmq   EXGotoCase - new function, go to a DL_CaseNo (generalised from LO and FTF)\r\n// 26-02-2008  mmq   AJAXDocumentBasket function added - EXInitMainEntity\r\n// 27-02-2008  mmq   EXDocBasketToEntity implemented\r\n// 04-03-2008  mmq   SearchAD functionality added\r\n// 06-03-2008  mmq   getsafe function - duplicate removed. Critical error!\r\n// 11-03-2008  mmq   EXTrackMail - new function in Outlook\r\n// 12-03-2008  mmq   mapcontact - displays Google Map for contact location\r\n// 26-03-2008  mmq   ActionSubMenu - changed from 4 to 8 seconds\r\n// 01-04-2008  mmq   FKIL code merged into this.\r\n// 09-04-2008  mmq   EXInitAJAXDocumentBasket - New icons\r\n// 09-04-2008  mmq   EXDocBasketRefresh - New delete icon\r\n// 09-04-2008  mmq   EXshowListData - new HTML column width\r\n// 09-04-2008  mmq   getEntityData3 created.\r\n// 10-04-2008  mmq   Query modified to use MSSQLFT search - can now search for documents in specific areas\r\n// 13-04-2008  mmq   Floating Document basket - EXInitMainEntity\r\n// 15-04-2008  mmq   Flere justeringer - småfejl - rettet.\r\n// 19-04-2008  jrd   Lille ændring i EXCloseTask for bagud kompatibilitet\r\n// 23-04-2008  mmq   showAppointment, new javascript and Outlook AddIn function - only if CreatedBy = %WUSER% should be added as criteria!\r\n// 24-04-2008  mmq   Upgraded CorpNordic - fixed small stuff in JS\r\n// 29-04-2008  mmq   _EXInitAJAXDocumentBasket function copied from CN\r\n// 12-05-2008  mmq   EXAssignTaskToCase added\r\n// 18-05-2008  mmq   _EXShowListData - minor fix\r\n// 01-06-2008  mmq   getDictionaryData added\r\n// 02-06-2008  mmq   newappointment - dlmeetingtype added as parameter\r\n// 02-06-2008  mmq   EXBRMNewContact - negative contact for Frie\r\n// 03-06-2008  mmq   EXInitMainEntity - bDispalyENtity parameter used in meeting\r\n// 09-06-2008  mmq   mapexcompany - new function\r\n// 11-06-2008  mmq   Code from Frie merged into solution - excluding LOCALIZATION - what do we do?'\r\n// 11-06-2008  mmq   _EXInitAJAXDOcumentBasket localized - EXLanguage modified\r\n// 17-07-2008  mmq   EXOpenPickFacet added\r\n// 28-07-2008  mmq   Minor modifications, loadentityexcel adjusted\r\n// 29-07-2008  mmq   FillDropDown modified - overwrite value only if field has no value - strange it worked before\r\n// 08-08-2008  mmq   PickDictionary routines moved to same location\r\n// 14-08-2008  mmq   EXLoadQuickSearch - portaltype added\r\n// 16-08-2008  mmq   EXLoadQuickSearch - now opens in new DIV rather than DL_Information\r\n// 18-08-2008  mmq   EXInitMainEntity - case log added as flag\r\n// 19-08-2008  mmq   getResource localized\r\n// 19-08-2008  mmq   EXInitMainEntity - foreign key added\r\n// 26-08-2008  mmq   LEXSearchCaseDocuments localized\r\n// 28-08-2008  mmq   EXTX - stress test measurement and logging\r\n// 01-09-2008  mmq   Changes from Tele Greenland taken back. QuickSearch modified a little.\r\n// 03-09-2008  mmq   EXAdvDrop retrieved from LO and made standard functionality (needed for Tele)\r\n// 07-09-2008  mmq   loadentity - appendparam missing as parameter - fix\r\n// 07-09-2008  mmq   displayentity modified - now uses EXDisplayEntity.html\r\n// 09-09-2008  mmq   Default security values for workflow - EXhandleDLWFCaseTypeChange\r\n// 09-09-2008  mmq   EXGotoCase - localized\r\n// 11-09-2008  mmq   EXAdvDropaddChar modified to support DynamicSearch and AJAX\r\n// 16-09-2008  mmq   loadentitysecurity - new function\r\n// 29-09-2008  mmq   EXGotoCase - now search much better\r\n// 01-10-2008  mmq   EXGotoObject - check to see if object exists - if not warn user.\r\n// 09-10-2008  jd    ShowAppointment: changed error message.\r\n// 23-10-2008  mmq   DLopentask, opentask - if cannot open in Outlook loadentity instea\r\n// 23-10-2008  mmq   EXAdvDropaddchar - arrow up and down adjusted\r\n// 09-11-2008  mmq   EXTX - stress testing logic - removed\r\n// 15-02-2009  jrd   Changed Freetext to Contains in MSSQLFT freetext search to handle wildcard search\r\n// 12-03-2009  mmq   LO functionality, Covert2PDF, added\r\n// 15-03-2009  mmq   _EXshowListData - optimized for speed - 3 getEntity changed to 1\r\n// 30-03-2009  mmq   EXShowDeleteCase added, EXformatData moved from EXDynamicForm.js to this file\r\n// 08-05-2009  mmq   EXGotoObject optimized. SetRecentValue now works asynchronously.\r\n// 19-05-2009  mmq   EXConvertDocBasket2PDF - errors only reported once\r\n// 19-05-2009  mmq   Page title set based on DL_CMAllView in EXInitMainEntity\r\n// 20-06-2009  mmq   IT Case 393 - DocBasket 2 PDF nu en konfigurationsparameter\r\n// 16-08-2009  mmq   Dynamic reload - 09-0099\r\n// 21-08-2009  mmq   getEntityData2Async added - together with response handler\r\n// 15-09-2009  mmq   IT Case 748 - SELECT FillDropDown og EXFillWFCaseType fejler begge to - da koden fjerner onchange event'en.\r\n// 03-11-2009  mmq   Security model on portal added\r\n// 04-12-2009  mb    Added bDisable parameter to FillDropDown enabling emptying and disabeling DropDowns based on input.\r\n// 18-12-2009  mmq   Document basket menu is now a drop down list\r\n// 30-12-2009  mmq   EXAddToFavorites - ingen alert mere\r\n// 03-01-2010  mmq   09-0319 - modifications\r\n// 12-02-2010  mmq   ctrlKey --\x3eshiftKey - as this is more standard internet functionality\r\n// 13-02-2010  mmq   http://intranet removed from code\r\n// 03-05-2010   mb   Added RemoveOnClick function and updated EXPrintSpecial to remove all onclick's and href's from teh html code.\r\n// 16-05-2010  mmq   EXXMLHTTP - new function - replaces XMLHTTP\r\n// 16-05-2010  mmq   XMLHTTP - .Open-.open, .Send-.send, .ResponseXML-.responseXML\r\n// 23-05-2010  mmq   Twitter funktionalitet tilføjet - omdøbt til Exformatics\r\n// 17-06-2010  mmq   EXInitMainEntity - now using setTimeout in order to increase loading speed - start all functions asap\r\n// 12-07-2010  mmq   http://intranet moved to Exformatics_cust.js as variable EXServerRoot\r\n// 15-07-2010  mmq   EXformatValue - DL_Money added and formatted nice\r\n// 18-07-2010  mmq   IT Case 1323 - PickDictionarySearch added\r\n// 24-07-2010  mmq   DL_ExformationType included in exforamtions\r\n// 05-08-2010  mmq   EXPickDictionarySearch - default value added\r\n// 16-08-2010  mmq   EXDocBasketCreateMail added\r\n// 06-10-2010  mmq   Added ExformaticsOutlookAddIn.Connect\r\n// 29-10-2010  mmq   EXReportITCase modified - now link with Exformatics SharePoint Master Page\r\n// 28-01-2011  mmq   Added iButtonNames. \r\n// 12-03-2011  mmq   EXWFSearchCases - added case specific data in search\r\n// 21-03-2011  mmq   Workflow specific data search - parent node can be empty - we might need to change this\r\n// 26-03-2011  jd    Rettet fejl i loadentityexcel: where clause ej XMLSafe\r\n// 26-03-2011  jd    Rettet fejl i MakeXMLSafe: Quote og dobbelt-quote ej XMLSafe\r\n// 30-03-2011  mmq   IT-sag 2034\r\n// 06-04-2011  mmq   Year databases supported in EXGotoObject\r\n// 07-04-2011  mb    Added support for new AddIn (ExformaticsOfficeExtension.AddinModule)\r\n// 15-04-2011  mmq   EXResetAllFavorites added - avoid having to click all favorites one by one\r\n// 29-04-2011  mmq   IT Case 2035 - InfoPath - MapToAll\r\n// 30-05-2011  mmq   IT Case 2186 - avoid alert if Outlook not started\r\n// 06-06-2011  mmq   IT Case 2186 - getOutlook altered to use new ActiveXObject only and give an alert to check security\r\n// 21-06-2011  mmq   Added debug functionality\r\n// 06-07-2011  mmq   IT-Case 679\r\n// 12-07-2011  mmq   IT Case 2367 - cross browser support\r\n// 15-07-2011  mmq   IT Case 2362 - EXFillWFCaseType\r\n// 25-07-2011  mmq   IT Case 2403 - getsafe fails\r\n// 05-08-2011  mmq   IT Case 2414 - onmouseover on images set using the title property in IE8\r\n// 29-08-2011  mmq   IT Case 2478 - identifical to 2403.\r\n// 05-09-2011  mmq   EXWPMenuGet - now supports multiple keypairs\r\n// 08-09-2011  mmq   DLLinkObject2Object2 added\r\n// 01-11-2011  mmq   IT_Case 2558\r\n// 09-11-2011  mmq   IT_Case 2750 Tilføjet versionstjek\r\n// 18-11-2011  mmq   IT-Case 2679\r\n// 15-12-2011  mmq   setCookie - if expires is null then cookies are NOT saved between sessions\r\n// 21-01-2012  mmq   Set width for DL_Information IFRAME in order to avoid scrollbars\r\n// 26-01-2012  mmq   loadentityexcel modified - new parameters\r\n// 30-01-2012  mmq   ApproveDocumentProcess\r\n// 25-02-2012  mmq   EXLoadNewDocument localization\r\n// 25-02-2012  mmq   EXIWould - EXInitMainEntity - set title to specific DL_WFCaseType when creating new object\r\n// 28-03-2012  mmq   EXHTML2XLS - minor modifications - error found at VBA - workflow decode didn't work\r\n// 16-04-2012  mmq   EXLoadActivityStream added\r\n// 10-05-2012  mmq   IT Case 3218 - document.all.item(..) modified\r\n// 02-06-2012  mmq   EXGotoCase updated - code from LO\r\n// 05-06-2012  mmq   EXWPMenuGet - minor modifications\r\n// 05-06-2012  mb    EXHTML2XLS - Added lookup of jQuery - type ahead dictionaries when exporting to Excel.\r\n// 15-06-2012  mmq   EXHTML2XLS - format date in a new way - need to consider this for DynamicSearch - localization needed\r\n// 01-08-2012  mmq   userLanguage function added - retrieve ASP.Net language setting in browser - NOT POSSIBLE IN javascript !!!\r\n// 07-08-2012  mmq   EXWPMenuGet - handle workflow actions\r\n// 09-08-2012  mmq   12-0845 - LO wish - show icons in Document Basket and Document Web Parts rather than just functions\r\n// 29-08-2012  mmq   I would like ... DL_WFCaseType - load right object if data exists\r\n// 11-12-2012  mmq   Document package creation will display stamkort\r\n// 04-01-2013  mmq   Join document package into one PDF document, sort sequence etc (used at LO - and VBA)\r\n// 15-01-2013  mmq   Add documents in basket to activity stream\r\n// 19-06-2013  mmq   EXConvertBasket2PDF modified - so MSG files are not converted. This mean that we cannot combine all documents into one bug PDF file\r\n// 26-07-2013  mmq   SetEntityItemValue - return true|false\r\n// 02-08-2013  mmq   date functions now use jQuery datepicker - formatting etc should now work in any language\r\n// 01-12-2014  tas   Changed width of center column to 41%, on 43% it was causing UI issue (3rd column dropped to bottom)\r\n// 05-12-2014  tas   Creating overlay and show loading icon while switching business object\r\n// 20-12-2014  os    Added ExformaticsMovePost method to move one post to another one\r\n// iButtonNames - check numbers below - duplicate\r\n// Naming standard iButton<Function> (CamelCase)\r\n// 31.3.2013 - check out DL_D760:DL_DocumentBasketButtonCodes for detail - documentation found here\r\n// 13-02-2015 tas  To avoid alert box when leaving page with some data altered in DynamicForm\r\n// 03-09-2015 tas  Added method resizeIframe to reset height of iframe\r\n// 06-11-2015  mmq   Use jQuery dialog in EXLoadQuickSearch\r\n// 14+04+2016  mmq  Add EXWFOpenCasesExcel\r\n//Testing purpose new LO angular 4\r\nvar LEX_CannotGotoObjectProbablyNoAccess = 'No access';\r\nfunction  goToURL(page, id){\r\n\tdocument.location = 'http://sagssystem/EX_Custom/FEA/index.html?&DL_Id='+id+'&page='+page.split('_')[1];\r\n}\r\nfunction resizeIframe(obj) {\r\n    obj.style.height = obj.contentWindow.document.body.scrollHeight + 'px';\r\n    document.getElementById(\"iframeheader\").style.display = 'inline-block';\r\n}\r\nvar iButtonDelete = 1; \t //   01 - Empty document basket button\r\nvar iButtonNotify = 2; \t //   02 - Notify document basket\r\nvar iButtonTransmittal = 4;  //   04 - Create transmittal based on document basket\r\nvar iButtonCreateEmail = 8;  //   08 - Create new email with document basket documents contained\r\nvar iButtonLink = 16; \t //   16 - Copy document basket to actual business object as linked documents\r\nvar iButtonExportBasket = 32;  //   32 - Export document basket to desktop\r\n//   64 - EXMoveCopyDocuments action\r\nvar iButtonConvert2PDF = 128;    //  128 - Convert to PDF\r\nvar iButtonPasteDocuments = 256; //  256 - Paste to folder //06-07-2011 BH Corpnordic update\r\nvar iButtonCreateDocumentApproval = 512; // 30.1.2012\r\nvar iButtonShowIcons = 1024; \t//  1024 - show icons on top - LO wish - 120845 - 9.8.2012\r\nvar iButtonPrint = 2048;\r\nvar iButtonJoinBasket = 4096;    // 4096 - join basket into one PDF document\r\nvar iButtonToStream = 8192; // 8192 - add documents to activity stream on current object - one message for each document\r\n\r\nvar SPSAudience = '';\r\nvar ns4 = document.layers;\r\nvar ie4 = document.all;\r\nvar ns6 = document.getElementById && !document.all;\r\nvar loadedobjects = \"\"\r\n\r\nString.prototype.format = function () {\r\n    var str = this;\r\n    for (var i = 0; i < arguments.length; i++) {\r\n        var re = new RegExp('\\\\{' + (i) + '\\\\}', 'gm');\r\n        str = str.replace(re, arguments[i]);\r\n    }\r\n    return str;\r\n}\r\nString.prototype.trim = function () { // 15.7.2011\r\n    return this.replace(/^\\s*/, \"\").replace(/\\s*$/, \"\");\r\n}\r\n\r\n\r\n// http://km0.la/js/mozXPath/\r\n// mozXPath [http://km0ti0n.blunted.co.uk/mozxpath/] km0ti0n@gmail.com\r\n// Code licensed under Creative Commons Attribution-ShareAlike License \r\n// http://creativecommons.org/licenses/by-sa/2.5/\r\nif (document.implementation.hasFeature(\"XPath\", \"3.0\")) {\r\n    if (typeof XMLDocument == \"undefined\") { XMLDocument = Document; }\r\n    XMLDocument.prototype.selectNodes = function (cXPathString, xNode) {\r\n        if (!xNode) { xNode = this; }\r\n        var oNSResolver = this.createNSResolver(this.documentElement)\r\n        var aItems = this.evaluate(cXPathString, xNode, oNSResolver, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null)\r\n        var aResult = [];\r\n        for (var i = 0; i < aItems.snapshotLength; i++) { aResult[i] = aItems.snapshotItem(i); }\r\n        return aResult;\r\n    }\r\n    XMLDocument.prototype.selectSingleNode = function (cXPathString, xNode) {\r\n        if (!xNode) { xNode = this; }\r\n        var xItems = this.selectNodes(cXPathString, xNode);\r\n        if (xItems.length > 0) { return xItems[0]; }\r\n        else { return null; }\r\n    }\r\n    Element.prototype.selectNodes = function (cXPathString) {\r\n        if (this.ownerDocument.selectNodes) { return this.ownerDocument.selectNodes(cXPathString, this); }\r\n        else { throw \"For XML Elements Only\"; }\r\n    }\r\n    Element.prototype.selectSingleNode = function (cXPathString) {\r\n        if (this.ownerDocument.selectSingleNode) { return this.ownerDocument.selectSingleNode(cXPathString, this); }\r\n        else { throw \"For XML Elements Only\"; }\r\n    }\r\n}\r\n\r\n// 1.3.2012\r\nfunction ExDefaultNamespaceResolver(sPrefix) {\r\n    switch (sPrefix) {\r\n        case \"rs\":\r\n            return \"urn:schemas-microsoft-com:rowset\";\r\n            break;\r\n        case \"z\":\r\n            return \"#RowsetSchema\";\r\n            break;\r\n\r\n        default:\r\n            return null;\r\n            break;\r\n    }\r\n}\r\n\r\n\r\ntry {\r\n    Element.prototype.xml = function () {\r\n        var doc = this.ownerDocument || this;\r\n        return doc.documentElement.textContent;\r\n    }\r\n\r\n    Element.prototype.selectNodes = function (xPathExpression) {\r\n\r\n\r\n        var doc = this.ownerDocument || this;\r\n        var resolver = doc.createNSResolver(doc.documentElement);\r\n        var oResult = doc.evaluate(xPathExpression, this, ExDefaultNamespaceResolver, XPathResult.ORDERED_NODE_ITERATOR_TYPE, null);\r\n        var aNodes = new Array();\r\n\r\n        if (oResult != null) {\r\n            var oElement = oResult.iterateNext();\r\n\r\n            while (oElement) {\r\n                aNodes.push(oElement);\r\n                oElement = oResult.iterateNext();\r\n            }\r\n        }\r\n\r\n        return aNodes;\r\n    };\r\n\r\n} catch (e) { }\r\n\r\nfunction EXensureLanguageScriptAreLoaded() {\r\n    try {\r\n        if (self.EXLanguageScript) { // Already exists\r\n            return;\r\n        }\r\n        var head = document.getElementsByTagName(\"head\")[0];\r\n        script = document.createElement('script');\r\n        script.id = 'EXLanguageScript';\r\n        script.type = 'text/javascript';\r\n        script.src = \"/EX_Resources/js/EXLanguage.js\";\r\n        head.appendChild(script)\r\n    } catch (e) { alert('EXensureLanguageScriptAreLoaded ' + e.message); }\r\n}\r\n// EXensureLanguageScriptAreLoaded();\r\n/* 13.8.2013 - removed\r\nfunction getResource(resource) { // 17.1.2012 - need to leverage EXLanguage.js\r\ntry {\r\nif (EXLCID == undefined) {\r\nEXLCID = '1033';\r\n} } catch (e) {EXLCID = '1030';}\r\n\r\nif (EXLCID == '1030') {\r\nswitch(resource) { // 18.8.2008 - localization\r\ncase 'Search': return 'S\\370g';\r\ncase 'Reset': return 'Nulstil';\r\ncase 'CreateNew': return 'Skab ny: ';\r\ncase 'DeleteRecord': return 'Slet posten? ';\r\ndefault: return '';\r\n}\r\n}\r\nelse { // EXLCID = 1033\r\nswitch(resource) {\r\ncase 'Search': return 'Search';\r\ncase 'Reset': return 'Reset';\r\ncase 'CreateNew': return 'Create new: ';\r\ncase 'DeleteRecord': return 'Delete record? ';\r\ndefault: return '';\r\n}\r\n}\r\n}\r\n*/\r\nfunction EXXMLHTTP() { // 16.5.2010\r\n    /*\r\n    var xmlhttp;\r\n    if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari\r\n    xmlhttp=new XMLHttpRequest();\r\n    }\r\n    else {// code for IE6, IE5\r\n    xmlhttp=new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n    }\r\n    */\r\n    var xmlhttp = null;\r\n    try {\r\n        xmlhttp = new ActiveXObject(\"MSXML2.XMLHTTP.3.0\");\r\n    } catch (e) { xmlhttp = null; }\r\n    if (xmlhttp == null) // Google Chrome, Apple Safari\r\n        xmlhttp = new XMLHttpRequest();\r\n    return xmlhttp;\r\n}\r\nfunction EXDOMDocument() { // 16.5.2010\r\n    var domdoc = null;\r\n    try {\r\n        domdoc = new ActiveXObject('MSXML2.DOMDocument');\r\n    } catch (e) { domdoc = null; }\r\n    if (domdoc == null)\r\n        domdoc = document.implementation.createDocument(\"\", \"\", null); // ActiveXObject('MSXML2.DOMDocument');\r\n    return domdoc;\r\n}\r\nfunction EXgetEntityTitle(entity) {\r\n    var title = GetEntityItemWhere('DL_D610', 'DL_EntityName = \\'' + entity + '\\'', 'DL_EntityDescription');\r\n    return title;\r\n}\r\n\r\nfunction EXgetSVCURL() {\r\n    var s;\r\n    s = '' + window.location;\r\n    if (s.indexOf('file') == 0) {\r\n        if (typeof (EXServerRoot) == 'undefined') // 12.7.2010\r\n            alert('Please add EXServerRoot to Exformatics_cust.js\\nContact administrator');\r\n        return EXServerRoot; // 12.7.2010 'http://intranet';\r\n    }\r\n    else {\r\n        var i, j;\r\n        i = s.indexOf('//');\r\n        j = s.substr(i + 2).indexOf('/');\r\n        s = s.substring(0, i + 2 + j);\r\n        return s;\r\n    }\r\n}\r\n\r\nfunction EXgetSVCURLFromSite() {\r\n    var s;\r\n    s = '' + window.location;\r\n    if (s.indexOf('file') == 0) {\r\n        if (typeof (EXServerRoot) == 'undefined') // 12.7.2010\r\n            alert('Please add EXServerRoot to Exformatics_cust.js\\nContact administrator');\r\n        return EXServerRoot; // 12.7.2010 'http://intranet';\r\n    }\r\n    else {\r\n        var i, j;\r\n        i = s.indexOf('//');\r\n        j = s.substr(i + 2).indexOf('/');\r\n        if (s.indexOf('/sites/') > 0) { // 12.11.2012\r\n            i = s.indexOf('/sites/');\r\n            j = s.substr(i + 7).indexOf('/');\r\n            //alert('URL=' + s + ' result=' + s.substring(0,i+7+j));\r\n            s = s.substring(0, i + 7 + j);\r\n        }\r\n        else {\r\n            //alert('EXgetSVCURLFromSite() - NOT /sites/ i=' + i + ' j=' + j + ' s=' + s.substring(0,i+2+j));\r\n            s = s.substring(0, i + 2 + j);\r\n        }\r\n        return s;\r\n    }\r\n}\r\nfunction getAbsoluteURLFromSite(url) { // 12.11.2012\r\n    if (typeof (url) == 'undefined') // 23.6.2009\r\n        url = '';\r\n    //alert('getAbsoluteURL(' + url + ') started');\r\n    var s;\r\n    try {\r\n        if (url.indexOf('http') == 0)\r\n            return url;\r\n        if (url.indexOf('file://') == 0) // 8.8.2001\r\n            return url;\r\n        if (url == '' || url == null) {\r\n            s = EXgetSVCURLFromSite();\r\n        }\r\n        else {\r\n            if (url.indexOf('/') == 0)\r\n                s = EXgetSVCURLFromSite() + url;\r\n            else\r\n                s = EXgetSVCURLFromSite() + '/' + url;\r\n        }\r\n        //    alert('getAbsoluteURL = ' + s);\r\n        return s;\r\n    }\r\n    catch (e) { alert('getAbsoluteURLFromSite(' + url + ') failed >>> ' + e.message); }\r\n}\r\nfunction getAbsoluteURL(url) {\r\n    if (typeof (url) == 'undefined') // 23.6.2009\r\n        url = '';\r\n    //alert('getAbsoluteURL(' + url + ') started');\r\n    var s;\r\n    try {\r\n        if (url.indexOf('http') == 0)\r\n            return url;\r\n        if (url.indexOf('file://') == 0) // 8.8.2001\r\n            return url;\r\n        if (url == '' || url == null) {\r\n            s = EXgetSVCURL();\r\n        }\r\n        else {\r\n            if (url.indexOf('/') == 0)\r\n                s = EXgetSVCURL() + url;\r\n            else\r\n                s = EXgetSVCURL() + '/' + url;\r\n        }\r\n        //    alert('getAbsoluteURL = ' + s);\r\n        return s;\r\n    }\r\n    catch (e) { alert('getAbsoluteURL(' + url + ') failed >>> ' + e.message); }\r\n}\r\nfunction AddMod() {\r\n    return; // 28.9.2009 - Ignore this function\r\n    var tblTR = document.getElementsByTagName(\"tr\");\r\n    try {\r\n        for (var x = 0; x < tblTR.length; x++) {\r\n            var trElm = tblTR(x);\r\n            var strClass = trElm.className;\r\n            if ((strClass == 'ms-WPHeader') || (strClass.indexOf('dl-') > -1)) {\r\n                var strcontent = trElm.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.innerHTML;\r\n                var i = strcontent.indexOf('DL_Color');\r\n                if (i > -1) {\r\n                    var strColorType = strcontent.substr(i, 11);\r\n                    switch (strColorType) {\r\n                        case 'DL_ColorStd': trElm.className = \"MS-WPHeader\"; break;\r\n                        case 'DL_ColorBlu': trElm.className = \"dl-BlueColor\"; break;\r\n                        case 'DL_ColorGrn': trElm.className = \"dl-GreenColor\"; break;\r\n                        case 'DL_ColorRed': trElm.className = \"dl-RedColor\"; break;\r\n                        default:\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    catch (e) {\r\n        alert('AddMod exception ' + e.tostring);\r\n    };\r\n}\r\nfunction ModifyWPTitle(frame) {\r\n    //return; // 28.9.2009\r\n    var sFrame = '';\r\n    if (frame != null && frame != '') { sFrame = frame; } else { sFrame = 'DL_Information'; }\r\n    var oEle = document.getElementById(sFrame);\r\n    if (oEle == null) {\r\n        oEle = parent.document.getElementById(sFrame);\r\n    }\r\n    var oDiv = oEle.parentNode.parentNode.parentNode.parentNode;\r\n\r\n    var tblTR = oDiv.getElementsByTagName(\"div\");\r\n    try {\r\n        for (var x = 0; x < tblTR.length; x++) {\r\n            var trElm = tblTR[x]; // 14.9.2012 IT Case 3455\r\n            if (trElm.className == \"ms-WPTitle\") {\r\n                //alert('DEBUG\\nModifyWPTitle(' + frame + ') trElm=' + trElm.innerHTML + '\\n' + oEle.parentNode.title + '\\n' + trElm.parentNode.parentNode.outerHTML);\r\n                //trElm.innerText = oEle.parentNode.title; // 28.9.2009\r\n                trElm.innerHTML = ' ' + oEle.parentNode.title;\r\n            }\r\n        }\r\n    }\r\n    catch (e) { alert('ModifyWPTitle exception ' + e.tostring); };\r\n}\r\nfunction AddWPTitle(sTitle, frame) {\r\n    //return; // 28.9.2009\r\n    var sFrame = '';\r\n    if (frame != null && frame != '') { sFrame = frame; } else { sFrame = 'DL_Information'; }\r\n    try {\r\n        //alert('AddWPTitle ' + document.getElementById(sFrame).parentNode.title + ' --\x3e ' + sTitle);\r\n        var oInfo;\r\n\r\n        oInfo = document.getElementById(sFrame);\r\n        if (oInfo == null) {\r\n            oInfo = parent.document.getElementById(sFrame);\r\n        }\r\n        oInfo.parentNode.title = sTitle;\r\n        /* 28.9.2009 - REMOVE\r\n        oInfo.parentNode.name = 'DL_ColorStd';\r\n        if (sTitle.indexOf('Activity') > - 1)\r\n        {\r\n        oInfo.parentNode.name = 'DL_ColorBlu';}\r\n        if (sTitle.indexOf('Task') > - 1)\r\n        {\t\r\n        oInfo.parentNode.name = 'DL_ColorGrn';}\r\n        */\r\n        ModifyWPTitle(frame);\r\n        AddMod();\r\n    } catch (e) { alert('AddWPTitle(' + sTitle + ') >>> ' + e.message); }\r\n}\r\nfunction GetProjectMailbox(sProject) {\r\n    var sQueryStr = 'DL_ProjectID = \\'' + sProject + '\\'';\r\n    var sProjMail = '//' + GetEntityItemWhere('DL_ProjectDefinition', sQueryStr, 'DL_MailboxURL') + '/Inbox';\r\n    return sProjMail;\r\n}\r\n\r\n// GetEntityItemWhere\r\nfunction GetEntityItemWhere(dlentity, sWhere, dlproperty) {\r\n    var strResult;\r\n    try {\r\n        var objXMLHTTP;\r\n        var xmlParamDoc; // As New MSXML2.DOMDocument30\r\n        objXMLHTTP = EXXMLHTTP();\r\n        objXMLHTTP.open('Post', '/EX_SQLSVC/svcDLEntity.asmx/getEntityData2', false);\r\n        objXMLHTTP.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n        var strParam;\r\n        strParam = 'strNames=' + dlproperty + '&DL_Entity=' + dlentity + '&strWhere=' + escape(sWhere) + '&strOrderBy=DL_Id DESC';\r\n        objXMLHTTP.send(strParam);\r\n        // 16.5.2010\r\n        var res = getsafe(objXMLHTTP.responseXML, '//DL_ENTITYDATA/' + dlentity + '/' + dlproperty);\r\n        objXMLHTTP = null;\r\n        return res;\r\n\r\n        xmlParamDoc = EXDOMDocument();\r\n        xmlParamDoc.loadXML(objXMLHTTP.responseText);\r\n        strResult = xmlParamDoc.text;\r\n        //alert(strResult);\r\n        var xN;\r\n        xN = xmlParamDoc.selectSingleNode('//DL_ENTITYDATA/' + dlentity + '/' + dlproperty);\r\n        if (xN != null)\r\n            strResult = xN.text;\r\n        xmlParamDoc = null; xN = null;\r\n        objXMLHTTP = null;\r\n    }\r\n    catch (e) {\r\n        alert('GetEntityItemWhere ' + e.message);\r\n        strResult = '';\r\n    };\r\n    return strResult;\r\n}\r\n// GetEntityItemValue\r\nfunction GetEntityItemValue(dlentity, dlid, dlproperty) {\r\n    var strResult;\r\n    try {\r\n        var objXMLHTTP;\r\n        var xmlParamDoc; // As New MSXML2.DOMDocument30\r\n        objXMLHTTP = EXXMLHTTP();\r\n        objXMLHTTP.open('Post', '/EX_SQLSVC/svcDLEntity.asmx/getEntityData2', false);\r\n        objXMLHTTP.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n        var strParam;\r\n        strParam = 'strNames=' + dlproperty + '&DL_Entity=' + dlentity + '&strWhere=DL_Id=' + dlid + '&strOrderBy=DL_Id';\r\n        objXMLHTTP.send(strParam);\r\n        // 16.5.2010\r\n        var res = getsafe(objXMLHTTP.responseXML, '//DL_ENTITYDATA/' + dlentity + '/' + dlproperty);\r\n        objXMLHTTP = null;\r\n        return res;\r\n\r\n        xmlParamDoc = EXDOMDocument();\r\n        xmlParamDoc.loadXML(objXMLHTTP.responseText);\r\n        strResult = xmlParamDoc.text;\r\n        xmlParamDoc = null;\r\n        objXMLHTTP = null;\r\n    }\r\n    catch (e) {\r\n        strResult = '';\r\n    };\r\n    return strResult;\r\n}\r\n// SetEntityItemValue\r\n// 21.2.2008 - property 3 added\r\nfunction SetEntityItemValue(dlentity, dlid, dlmodified, dlproperty, dlvalue, dlproperty2, dlvalue2, dlproperty3, dlvalue3) {\r\n    if (typeof (dlproperty2) == 'undefined') // 10.9.2008\r\n        dlproperty2 = '';\r\n    if (typeof (dlproperty3) == 'undefined')\r\n        dlproperty3 = '';\r\n    var objXMLHTTP;\r\n    var getSoapEnvelope;\r\n    var strParam = '<oEntity><xmlEntityData><delEntityData></delEntityData><updEntityData><xmlEntityData xmlns=\"\"><DL_Id>' + dlid + '</DL_Id><DL_Modified>' + dlmodified + '</DL_Modified><' + dlproperty + '>' + dlvalue + '</' + dlproperty + '>';\r\n    if (dlproperty2 != '') {\r\n        strParam = strParam + '<' + dlproperty2 + '>' + dlvalue2 + '</' + dlproperty2 + '>';\r\n    }\r\n    if (dlproperty3 != '') {\r\n        strParam = strParam + '<' + dlproperty3 + '>' + dlvalue3 + '</' + dlproperty3 + '>';\r\n    }\r\n    strParam = strParam + '<DL_RowNumber>1</DL_RowNumber></xmlEntityData></updEntityData><addEntityData></addEntityData></xmlEntityData></oEntity>';\r\n    //alert('DEBUG\\nSetEntityItemValue ' + strParam);\r\n    getSoapEnvelope = '<?xml version=\"1.0\" encoding=\"utf-8\" ?><soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"><soap:Body><setEntity xmlns=\"http://doclife.net/svcDLEntity\"><strEntity>' + dlentity + '</strEntity>' + strParam + '</setEntity></soap:Body></soap:Envelope>';\r\n    objXMLHTTP = EXXMLHTTP();\r\n    objXMLHTTP.open('Post', '/EX_SQLSVC/svcDLEntity.asmx', false);\r\n    objXMLHTTP.setRequestHeader('Content-Type', 'text/xml; charset=utf-8');\r\n    objXMLHTTP.setRequestHeader('SOAPAction', 'http://doclife.net/svcDLEntity/setEntity');\r\n    objXMLHTTP.setRequestHeader('Content-Length', getSoapEnvelope.length);\r\n    objXMLHTTP.send(getSoapEnvelope);\r\n    var bOK = objXMLHTTP.status == 200;\r\n    //alert(objXMLHTTP.status);\r\n    //alert(objXMLHTTP.responseText);\r\n    objXMLHTTP = null;\r\n    return bOK; // 26.7.2013 - return status true | false\r\n}\r\n// SetRecentValue\r\nfunction SetRecentValue(urn, value) {\r\n    try {\r\n        var xmldoc, FeedbackHTTP;\r\n        xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n        xmldoc = xmldoc + '<setRecentValue xmlns=\"http://doclife.net/svcDLState\">\\n';\r\n        xmldoc = xmldoc + '<urnPropertyID>' + urn + '</urnPropertyID>\\n';\r\n        //xmldoc = xmldoc +'<strValue>' + value + '</strValue>\\n';\r\n        value = '' + value;\r\n        //\talert('sdf urn:' + urn + '=' + value);\r\n        xmldoc = xmldoc + EXBuildXML('strValue', value);\r\n        xmldoc = xmldoc + '</setRecentValue>\\n';\r\n        xmldoc = xmldoc + '</soap:Body></soap:Envelope>';\r\n        //alert('SetRecentValue ' + xmldoc);\r\n\r\n        FeedbackHTTP = EXXMLHTTP()\r\n        FeedbackHTTP.open(\"POST\", getAbsoluteURL('/EX_SQLSVC/svcDLState.asmx?op=setRecentValue'), false);\r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", 'http://doclife.net/svcDLState/setRecentValue');\r\n        FeedbackHTTP.send(xmldoc);\r\n        //FeedbackHTTP.Send(xmlParamDoc);\r\n        // alert('SetRecentValue completed ' + FeedbackHTTP.responseText);\r\n        FeedbackHTTP = null;\r\n    } catch (e) { alert('SetRecentValue ' + e.message); }\r\n}\r\n\r\n// SetRecentValueXML\r\nfunction setRecentValueXML(href, xml) { // 17.10.2009\r\n    try {\r\n        var xmldoc, FeedbackHTTP;\r\n        xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n        xmldoc = xmldoc + '<setRecentValueXML xmlns=\"http://doclife.net/svcDLState\">\\n';\r\n        xmldoc = xmldoc + '<href>' + href + '</href>\\n';\r\n        xml = '' + xml;\r\n        xmldoc = xmldoc + EXBuildXML('xml', xml);\r\n        xmldoc = xmldoc + '</setRecentValueXML>\\n';\r\n        xmldoc = xmldoc + '</soap:Body></soap:Envelope>';\r\n        //alert('SetRecentValueXML ' + xmldoc);\r\n\r\n        FeedbackHTTP = EXXMLHTTP()\r\n        FeedbackHTTP.open(\"POST\", getAbsoluteURL('/EX_SQLSVC/svcDLState.asmx?op=setRecentValueXML'), false);\r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", 'http://doclife.net/svcDLState/setRecentValueXML');\r\n        FeedbackHTTP.send(xmldoc);\r\n        //FeedbackHTTP.Send(xmlParamDoc);\r\n        //alert('SetRecentValue completed ' + FeedbackHTTP.responseText);\r\n        FeedbackHTTP = null;\r\n    } catch (e) { alert('SetRecentValueXML(' + href + ',' + xml + ')' + e.message); }\r\n}\r\n// GetRecentValue\r\nfunction GetRecentValue(urn) {\r\n    var strResult;\r\n    try {\r\n        var objXMLHTTP;\r\n        var xmlParamDoc; // As New MSXML2.DOMDocument30\r\n        objXMLHTTP = EXXMLHTTP();\r\n        objXMLHTTP.open('Post', getAbsoluteURL('/EX_SQLSVC/svcDLState.asmx/getRecentValue'), false);\r\n        objXMLHTTP.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n        var strParam;\r\n        strParam = 'urnPropertyID=' + urn;\r\n        objXMLHTTP.send(strParam);\r\n\r\n        if (objXMLHTTP.responseXML.getElementsByTagName('string')[0].firstChild == null) return ''; // 15.4.2016 - avoid error\r\n        return objXMLHTTP.responseXML.getElementsByTagName('string')[0].firstChild.nodeValue; // 27.10.2010 - Google Chrome + IE 8 + ...\r\n        /*\r\n        xmlParamDoc = EXDOMDocument();\r\n        xmlParamDoc.loadXML (objXMLHTTP.responseText);\r\n        strResult = xmlParamDoc.text;\r\n        xmlParamDoc = null;\r\n        objXMLHTTP = null;\r\n        */\r\n    }\r\n    catch (e) {\r\n        alert('GetRecentValue exception ' + e.message);\r\n        strResult = '';\r\n    };\r\n    return strResult;\r\n}\r\n\r\n\r\n// getRecentValueXML\r\nfunction getRecentValueXML(href) { // 17.12.2009\r\n    var strResult;\r\n    try {\r\n        var objXMLHTTP;\r\n        var xmlParamDoc; // As New MSXML2.DOMDocument30\r\n        objXMLHTTP = EXXMLHTTP();\r\n        objXMLHTTP.open('Post', getAbsoluteURL('/EX_SQLSVC/svcDLState.asmx/getRecentValueXML'), false);\r\n        objXMLHTTP.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n        var strParam;\r\n        strParam = 'href=' + href;\r\n        objXMLHTTP.send(strParam);\r\n\r\n        xmlParamDoc = EXDOMDocument();\r\n        xmlParamDoc.loadXML(objXMLHTTP.responseText);\r\n        strResult = xmlParamDoc.text;\r\n        xmlParamDoc = null;\r\n        objXMLHTTP = null;\r\n    } catch (e) {\r\n        alert('getRecentValueXML exception ' + e.message);\r\n        strResult = '';\r\n    }\r\n    return strResult;\r\n}\r\n\r\nfunction setPickerValue(s, urn) {\r\n    SetRecentValue(urn, s);\r\n    return true;\r\n}\r\nfunction setGenericDBKeys(strXML) {\r\n    SetRecentValue('DL_GenericDB', strXML);\r\n}\r\n/* 24.4.2014 - hide - duplicate\r\nfunction OpenGenericDB(strTemplate) { // 15.8.2012\r\nvar objDoc3 = new ActiveXObject(\"Sharepoint.OpenDocuments.3\");\r\nobjDoc3.CreateNewDocument(strTemplate, '');\r\n}\r\n*/\r\nfunction CreateDocument(strTemplate, strDefSave) {\r\n    //alert('CreateDocument(' + strTemplate + ',' + strDefSave + ') invoked');\r\n    if (typeof (createNewDocumentWithProgIDCore) == 'function') { // 28.7.2008\r\n        return createNewDocumentWithProgIDCore(strTemplate, strDefSave, \"SharePoint.OpenDocuments.3\", null, \"Could not find office\");\r\n    }\r\n    //alert(11);     \t\r\n    var objDoc2 = new ActiveXObject(\"Sharepoint.OpenDocuments.2\");\r\n    objDoc2 = null;\r\n    if (objDoc2) // Office 2003\r\n    {\r\n        //if (objDoc2.CreateNewDocument(strTemplate, strDefSave))\r\n        if (objDoc2.CreateNewDocument2(window, strTemplate, strDefSave)) {\r\n            if (typeof (RefreshOnFocus) == 'function') // 28.7.2008 - check added\r\n                window.onfocus = RefreshOnFocus;\r\n        }\r\n    }\r\n    else {\r\n        var objDoc3 = new ActiveXObject(\"Sharepoint.OpenDocuments.2\");\r\n        if (objDoc3) {\r\n            try {\r\n                objDoc3.CreateNewDocument(strTemplate, strDefSave);\r\n                return;\r\n            }\r\n            catch (e) { alert(e.message); }\r\n        }\r\n        if (!objDoc3) objDoc3 = new ActiveXObject(\"Sharepoint.OpenDocuments.3\");\r\n        //alert('8 >' + objDoc3 + '<');\r\n        if (!objDoc3) objDoc3 = new ActiveXObject(\"Sharepoint.OpenDocuments.4\"); // 20.5.2012 - Office 2010?\r\n        //alert(9 + '  - ' + objDoc3);\r\n        if (objDoc3) {\r\n            //if (objDoc3.CreateNewDocument(strTemplate, strDefSave))\r\n            //alert('a ' + objDoc3);\r\n            if (objDoc3.CreateNewDocument2(window, strTemplate, strDefSave)) {\r\n                //alert('b')\r\n                if (typeof (RefreshOnFocus) == 'function') // 28.7.2008 - check added\r\n                    window.onfocus = RefreshOnFocus;\r\n            }\r\n            else // 28.7.2008\r\n                alert('CreateDocument(' + strTemplate + ',' + strDefSave + ') failed');\r\n        }\r\n        else {\r\n            alert(LEX_OfficeMustBeInstalled);\r\n        }\r\n    }\r\n}\r\nfunction CreateDocument1() {\r\n    var o = document.getElementById('NewDocument');\r\n    o = document.all.NewDocument;\r\n    var i = o.selectedIndex;\r\n    /*alert('CreateDocument1 --\x3e ');*/\r\n    var defsave = o.options[i].value;\r\n    var template = o.options[i].id;\r\n    CreateDocument(template, defsave);\r\n}\r\nfunction makeSnapshot(DL_Entity, DL_Id, defsave, templatehref) {\r\n    SetRecentValue('DLSmartDoc', '<DLSmartDoc><DLEntity>' + DL_Entity + '</DLEntity><DLId>' + DL_Id + '</DLId><Replace>true</Replace></DLSmartDoc>');\r\n    CreateDocument(templatehref, defsave);\r\n}\r\n// makesnapshop\r\nfunction makeSnapshop(DL_EntityName, DL_EntityId, defsave, URLTemplate) {\r\n    SetRecentValue('DLSmartDoc', '<DLSmartDoc><DLEntity>' + DL_EntityName + '</DLEntity><DLId>' + DL_EntityId + '</DLId><Replace>true</Replace></DLSmartDoc>');\r\n    CreateDocument(URLTemplate, defsave);\r\n}\r\nfunction OpenGenericDB(strHref) {\r\n    if (strHref == null || strHref == '') { // 28.7.2008\r\n        strHref = getAbsoluteURL('/EX_Custom/Templates/GenericDB.xlt');\r\n    }\r\n    //alert('OpenGenericDB(' + strHref + ')');\r\n    var objDoc3 = new ActiveXObject(\"Sharepoint.OpenDocuments.3\"); // 24.3.2014 - avoid issue in SharePoint\r\n    objDoc3.CreateNewDocument(strHref, '');\r\n    //    \tCreateDocument(strHref, '');\r\n}\r\n\r\n// EXOpenDoc2 - similar to SharePoint's DispDocItem\r\n// _spUserId is actual user - defined by SharePoint\r\n// SzExtension - returns extension of a URL\r\n// SzServer    - returns server\r\n// g_ExtensionDefaultForRead - ReadOnly extensions - PDF should probably be added\r\n// FDefaultOpenForReadOnly - returns true if read only extension\r\n// StsOpenEnsureEx - returns ActiveX object for provided szProgId\r\nfunction EXStsOpenEnsureEx(szProgId) {\r\n    var sVersion = 0;\r\n    if (szProgId.indexOf('.3') > 0)\r\n        sVersion = 3;\r\n    stsOpen = StsOpenEnsureEx(szProgId);\r\n    if (stsOpen == null && sVersion == 3) {\r\n        szProgId = szProgId.replace('.3', '.2');\r\n        sVersion = 2;\r\n        stsOpen = StsOpenEnsureEx(szProgId);\r\n    }\r\n    return stsOpen;\r\n}\r\nfunction EXOpenDoc2(Path, strCheckedoutUser, IsCheckedoutToLocal) {\r\n    var Ext = SzExtension(Path);\r\n    var i = Path.lastIndexOf('.');\r\n    var Ext = Path.substr(i + 1);\r\n    //var Ext = SzExtension(Path);\r\n    var sControl = MapToAll('', Ext, '@OpenControl');\r\n    if (sControl.indexOf('SharePoint.OpenDocument') > -1) {\r\n        stsOpen = EXStsOpenEnsureEx(sControl);\r\n        if (strCheckedoutUser == _spUserId || strCheckedoutUser == '')\r\n            if (typeof (_spUserId) == 'undefined')\r\n                _spUserId = '';\r\n        if (strCheckedoutUser == _spUserId || strCheckedoutUser == '') {\r\n            // alert('stsOpen.EditDocument2(window, ' + Path + ',' + sControl + ')');\r\n            stsOpen.EditDocument2(window, Path, sControl);\r\n        }\r\n        else if (strCheckedoutUser != '') {\r\n            if (confirm(LEX_DocumentCheckedOutToUser.format(strCheckedoutUser)))\r\n                stsOpen.ViewDocument2(window, Path, sControl);\r\n        }\r\n        else\r\n            stsOpen.ViewDocument2(window, Path, sControl);\r\n    }\r\n    else { // Display item\r\n        loadcontent(Path);\r\n    }\r\n}\r\nfunction EXOpenDoc(Path) {\r\n    var oIF = document.getElementById('DL_Information');\r\n    if (oIF != null) {\r\n        if (oIF.src == Path) {\r\n            //alert('EXOpenDoc - now free DL_Information');\r\n            oIF.src = '';\r\n        }\r\n    }\r\n    OpenDoc(Path);\r\n}\r\nfunction OpenDoc(Path) {\r\n    try {\r\n        var doctype;\r\n        var docpostfix = Path.substr(Path.length - 3, Path.length);\r\n        switch (docpostfix) {\r\n            case 'ppt': doctype = 'Powerpoint.Slide'; break;\r\n            case 'doc': doctype = 'Word.Document'; break;\r\n            case 'mht': doctype = 'Word.Document'; break;\r\n            case 'dot': doctype = 'Word.Document'; break;\r\n            case 'mht': doctype = 'Word.Document'; break;\r\n            case 'xls': doctype = 'Excel.Sheet'; break;\r\n            // case 'xlt' : doctype = 'Excel.Sheet';break; \r\n            case 'htm': doctype = 'Word.Document'; break;\r\n            default: doctype = 'Browser';\r\n        }\r\n        if (doctype == 'Browser') {\r\n            window.open(Path);\r\n        }\r\n        else {\r\n            try {\r\n                var objDoc = new ActiveXObject(\"Sharepoint.OpenDocuments.2\");\r\n                //alert('ObjDoc loaded: ' + Path + '/' + doctype);\r\n            }\r\n            catch (e) {\r\n                alert('OpenDoc(' + Path + ') failed ' + e.message);\r\n                try {\r\n                    objDoc = new ActiveXObject(\"Sharepoint.OpenDocuments.3\");\r\n                }\r\n                catch (e) { alert('OpenDoc(' + Path + ') failed ' + e.message); }\r\n            }\r\n            switch (docpostfix) {\r\n                case 'xlt': objDoc.CreateNewDocument(Path, ''); break;\r\n                case 'dot': objDoc.CreateNewDocument(Path, ''); break;\r\n                default: objDoc.EditDocument(Path); break;\r\n            }\r\n        }\r\n    } catch (e) { alert('OpenDoc(' + Path + ') failed ' + e.message); }\r\n}\r\n\r\nfunction DLopentask(DL_Entity, DL_Id) {\r\n    //alert('Open Task --\x3e ' + DL_Id + ' not implemented yet!');\r\n    if (true) {\r\n        if (DL_Entity == 'BPM_Task') {\r\n            DL_Entity = 'BPM'\r\n        }\r\n        var OutlookID;\r\n        OutlookID = DL_Entity + DL_Id;\r\n        //alert(OutlookID);\r\n        opentask(OutlookID);\r\n    }\r\n    else\r\n        loadentity(DL_Entity, DL_Id);\r\n}\r\n\r\nfunction newentity2(entity, foreignkeys, foreignvalues, appendparam, title, defaultkeys, defaultvalues) // 11.12.2012 - default keys and values added\r\n{\r\n    if (typeof (defaultkeys) == 'undefined') // 11.12.2012\r\n        defaultkeys = '';\r\n    var oIF = document.getElementById('DL_Information');\r\n    if (oIF == null && parent)\r\n        oIF = parent.document.getElementById('DL_Information');\r\n    if (oIF != null) {\r\n        if (EXGetUserRole() == 0) {// 3.11.2009\r\n            alert(LEX_UserNoAccessCannotCreate);\r\n            return;\r\n        }\r\n        var url = ''\r\n        if (foreignkeys == '') {\r\n            url = \"/EX_SQLSVC/DynamicForm.aspx?new=true&DL_ENTITY=\" + entity + \"&\" + appendparam;\r\n        }\r\n        else {\r\n            url = \"/EX_SQLSVC/DynamicForm.aspx?new=true&DL_ENTITY=\" + entity + \"&ForeignKeys=\" + foreignkeys + \"&ForeignValues=\" + foreignvalues + \"&\" + appendparam;\r\n            /*alert('URL=' + document.all.DL_Information.src);*/\r\n        }\r\n        if (defaultkeys != '') // 11.12.2012\r\n            url += '&DefaultKeys=' + defaultkeys + '&DefaultValues=' + defaultvalues;\r\n        url += \"&EXcheck=\" + Math.random();\r\n        oIF.src = url;\r\n        if (title == '' || title == null)\r\n            title = LEX_CreateNew + EXgetEntityTitle(entity) + \"\";\r\n        AddWPTitle(title);\r\n    }\r\n    //        \telse\r\n    //       \t\talert('new entity(' + entity + ',' + id + ') - Information Web Part missing');\r\n}\r\n\r\n// 30.11.2007\r\nfunction EXNewLoadEntity(entity, foreignkeys, foreignvalues, appendparam) {\r\n    try {\r\n        if (typeof (foreignkeys) == 'undefined' || foreignkeys == null)\r\n            foreignkeys = '';\r\n        if (typeof (foreignvalues) == 'undefined' || foreignvalues == null)\r\n            foreignvalues = '';\r\n        if (typeof (appendparam) == 'undefined' || appendparam == null)\r\n            appendparam = '';\r\n\r\n        var xOps = '<' + entity + '>';\r\n        var aKeys = foreignkeys.split(',');\r\n        var aValues = foreignvalues.split(',');\r\n        var sValue;\r\n        for (var i = 0; i < aKeys.length; i++) {\r\n            sValue = aValues[i];\r\n            if (sValue == '%DL_sAMAccountName%')\r\n                sValue = GetEntityItemWhere('DL_sAMAccountName', 'DL_sAMAccountName = %DL_sAMAccountName%', 'DL_sAMAccountName');\r\n            xOps = xOps + '<' + aKeys[i] + '>' + MakeXMLSafe(sValue) + '</' + aKeys[i] + '>';\r\n        }\r\n        xOps = xOps + '</' + entity + '>';\r\n        //alert('EXNewLoadEntity ' + xOps);\r\n        //return;\r\n        var DLId = setEntityDetail(entity, xOps);\r\n        if (DLId != '')\r\n            loadentity(entity, DLId, appendparam);\r\n    } catch (e) { alert('EXNewLoadEntity ' + e.message); }\r\n}\r\nfunction EXHTMLNotesAsMail(DLId) {\r\n    var oXML = getEntityData('DL_HTMLNotes', 'DL_Id = ' + DLId, '');\r\n    //alert('EXHTMLNotesAsMail ' + oXML.xml);\r\n    var outlookApp;\r\n    outlookApp = getOutlook();\r\n    if (outlookApp == null) {\r\n        outlookApp = null;\r\n    }\r\n    else {\r\n        var sHTML = getsafe(oXML, '//DL_HTMLText');\r\n        //alert(sHTML);\r\n        var oItem;\r\n        oItem = outlookApp.CreateItem(0); // Email\r\n        oItem.HTMLBody = sHTML;\r\n        oItem.Subject = 'Test email';\r\n        oItem.Display();\r\n        outlookApp = null;\r\n    }\r\n\r\n}\r\nfunction newentity(entity, foreignkeys, foreignvalues, appendparam, frame) {\r\n    if (EXGetUserRole() == 0) {// 3.11.2009\r\n        alert(LEX_UserNoAccessCannotCreate);\r\n        return;\r\n    }\r\n    if (frame == 'NEW') { // 10.12.2008\r\n        window.open(getAbsoluteURL(\"/EX_SQLSVC/DynamicForm.aspx?new=true&DL_ENTITY=\" + entity + \"&ForeignKeys=\" + foreignkeys + \"&ForeignValues=\" + foreignvalues + \"&\" + appendparam + \"&EXcheck=\" + Math.random()), '', 'width=380,height=200,toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,copyhistory=no,resizable=no');\r\n        return;\r\n    }\r\n    if (typeof (frame) == 'undefined') // 27.10.2008\r\n        frame = '';\r\n    //alert('newentity ' + entity);\r\n    if (frame == '')\r\n        frame = 'DL_Information';\r\n    if (document.getElementById(frame)) {\r\n        if (foreignkeys == '') {\r\n            // 23-8-2006 - adding focus\r\n            var oIF = document.getElementById(frame)\r\n            oIF.src = \"/EX_SQLSVC/DynamicForm.aspx?new=true&DL_ENTITY=\" + entity + \"&ForeignKeys=\" + foreignkeys + \"&ForeignValues=\" + foreignvalues + \"&\" + appendparam + \"&EXcheck=\" + Math.random();\r\n            if (oIF != null) {\r\n                //alert('IFRAME focus on');\r\n                oIF.focus = true;\r\n            }\r\n            //if (document.all.DL_Information.focus() != true) {\r\n            //window.status = 'not on top';\r\n            //}\r\n        }\r\n        else {\r\n            // 23-8-2006 - adding focus\r\n            var oIF = document.getElementById(frame)\r\n            oIF.src = \"/EX_SQLSVC/DynamicForm.aspx?new=true&DL_ENTITY=\" + entity + \"&ForeignKeys=\" + foreignkeys + \"&ForeignValues=\" + foreignvalues + \"&\" + appendparam + \"&EXcheck=\" + Math.random();\r\n            if (oIF != null) {\r\n                //alert('IFRAME focus on');\r\n                oIF.focus = true;\r\n            }\r\n            //if (document.all.DL_Information.focus() != true) {\r\n            //window.status = 'not on top';\r\n            //}\r\n        }\r\n        AddWPTitle(LEX_CreateNew + EXgetEntityTitle(entity) + '');\r\n    }\r\n    else {\r\n        var oEle = parent.document.getElementById(frame);\r\n        //alert('newentity - DL_Information missing'); //alert('new entity(' + entity + ',' + id + ') - Information Web Part missing');\r\n        if (oEle != null)\r\n            oEle.src = \"/EX_SQLSVC/DynamicForm.aspx?new=true&DL_ENTITY=\" + entity + \"&ForeignKeys=\" + foreignkeys + \"&ForeignValues=\" + foreignvalues + \"&\" + appendparam + \"&EXcheck=\" + Math.random();\r\n    }\r\n}\r\nfunction EXNewEntityCopy(DL_Entity, DL_Id, sMsg) {\r\n    var oXML = ExecuteProcedure('dbo.EXNewEntityCopy @DLEntity=\\'' + DL_Entity + '\\', @DL_Id = ' + DL_Id + ',@WUser = %WUSER%'); // 2.2.2010 - %WUSER% added\r\n    if (typeof (sMsg) == 'undefined') {\r\n        //sMsg = 'Ny aktivitet oprettet';\r\n        var s = getsafe(oXML, '//DL_EntityDescription');\r\n        sMsg = LEX_NewBusinessObjectCreated.format(s);\r\n    }\r\n    alert(sMsg);\r\n    //EXGotoObject(DL_Entity, 0);\r\n    //EXGotoObject(DL_Entity, GetRecentValue(DL_Entity)); // 3.2.2010 - hentet fra BDK\r\n    var Id = getsafe(oXML, '//' + DL_Entity + '/DL_Id');\r\n    EXCreateFolder(DL_Entity, Id);\r\n    EXGotoObject(DL_Entity, Id);\r\n\r\n}\r\nfunction newlink(DL_Entity, DL_Id) {\r\n    newentity('DL_DocumentLinks', 'DL_EntityNameForeign,DL_EntityId', DL_Entity + \",\" + DL_Id);\r\n}\r\nfunction loadentitysecurity(entity, id, DLCaseProtected, DLSecurityPersons, DLADSecurityGroups, WUser) { // 16.9.2008\r\n    var bOK;\r\n    if (DLCaseProtected == -1) {\r\n        // 13-1-2008/JRD: Corrected error: %DL_sAMAccountName% does not work as input parameter to EXCheckUserAuthorized\r\n        //\t\tvar xN = ExecuteProcedure('dbo.EXCheckUserAuthorized @User=%DL_sAMAccountName%, @DLSecurityPersons = \\'' + DLSecurityPersons + '\\', @DLADSecurityGroups = \\'' + DLADSecurityGroups + '\\'');\r\n        // 17.10.2010\t\tvar xN = ExecuteProcedure('dbo.EXCheckUserAuthorized @User=\\'\\', @DLSecurityPersons = \\'' + DLSecurityPersons + '\\', @DLADSecurityGroups = \\'' + DLADSecurityGroups + '\\'');\r\n        var xN = ExecuteProcedure('dbo.EXCheckUserAuthorized @User=\\'' + WUser + '\\', @DLSecurityPersons = \\'' + DLSecurityPersons + '\\', @DLADSecurityGroups = \\'' + DLADSecurityGroups + '\\'');\r\n        var Count = getsafe(xN, '//Count');\r\n        bOK = (Count == '1');\r\n    }\r\n    else\r\n        bOK = true;\r\n    if (bOK)\r\n        loadentity(entity, id);\r\n    else\r\n        displayentity(entity, id);\r\n}\r\nfunction exloadentity(entity, id) { // 11.3.2011\r\n    if (typeof (EXwfloadentity) == 'function')\r\n        EXwfloadentity();\r\n    else\r\n        loadentity(entity, id);\r\n}\r\nfunction loadentity(entity, id, appendparam, keyname, title, bFirstFieldFocus, bReloadOnChange) {\r\n    if (typeof (appendparam) == 'undefined') // 30.7.2009\r\n        appendparam = '';\r\n    //alert('loadentity ' + entity + ' ' + id);\r\n    var sTitle = title;\r\n    if (sTitle == null) {\r\n        sTitle = '';\r\n    }\r\n    if (typeof (keyname == 'undefined')) // 10.9.2008\r\n        keyname = '';\r\n    var sKeyName = keyname;\r\n    if (sKeyName == null) {\r\n        sKeyName = \"\";\r\n    }\r\n    if (sKeyName == \"\") {\r\n        sKeyName = \"DL_Id\";\r\n    }\r\n    if (bReloadOnChange && (appendparam == null || appendparam == ''))\r\n        appendparam = 'action=127';\r\n    // 16.5.2010 - generalize\r\n    var oIF = document.getElementById('DL_Information');\r\n    if (oIF == null && parent)\r\n        oIF = parent.document.getElementById('DL_Information');\r\n    //if (document.all.item(\"DL_Information\"))\r\n    if (oIF) {\r\n        if (EXGetUserRole() == 0) // 3.11.2009\r\n            displayentity(entity, id);\r\n        else {\r\n            if (bFirstFieldFocus == null) {\r\n                //document.all.DL_Information.src=\"/EX_SQLSVC/DynamicForm.aspx?update=true&DL_ENTITY=\" + entity + \"&where=\" + sKeyName + \"=\" + id + \"&\" + appendparam + \"&EXcheck=\" + Math.random();\r\n                oIF.src = \"/EX_SQLSVC/DynamicForm.aspx?update=true&DL_ENTITY=\" + entity + \"&where=\" + sKeyName + \"=\" + id + \"&\" + appendparam + \"&EXcheck=\" + Math.random();\r\n            }\r\n            else {\r\n                //document.all.DL_Information.src=\"/EX_SQLSVC/DynamicForm.aspx?update=true&DL_ENTITY=\" + entity + \"&where=\" + sKeyName + \"=\" + id + \"&\" + appendparam + \"&FirstFieldFocus=false\" + \"&EXcheck=\" + Math.random();\r\n                oIF.src = \"/EX_SQLSVC/DynamicForm.aspx?update=true&DL_ENTITY=\" + entity + \"&where=\" + sKeyName + \"=\" + id + \"&\" + appendparam + \"&FirstFieldFocus=false\" + \"&EXcheck=\" + Math.random();\r\n            }\r\n        }\r\n        if (sTitle == '') {\r\n            if (entity == 'DL_Tasks') {\r\n                AddWPTitle(EXgetEntityTitle(entity));\r\n            }\r\n            else {\r\n                AddWPTitle(EXgetEntityTitle(entity));\r\n            }\r\n            //    \t\tAddWPTitle(EXgetEntityTitle(entity) + \" #\" + id);}\r\n        }\r\n        else {\r\n            AddWPTitle(sTitle);\r\n        }\r\n    }\r\n    /*\r\n    else\r\n    {\r\n\r\n    if (parent.document.getElementById(\"DL_Information\")) {\r\n    //alert('DL_Information2 exists in parent');\r\n    if (EXGetUserRole() == 0) // 3.11.2009\r\n    parent.displayentity(entity,id);\r\n    else\r\n    parent.document.all.DL_Information.src=\"/EX_SQLSVC/DynamicForm.aspx?update=true&DL_ENTITY=\" + entity + \"&where=DL_Id=\" + id + \"&\" + appendparam + \"&EXcheck=\" + Math.random();\r\n    }\r\n    //\t\telse{\r\n    //       \t\talert('loadentity(' + entity + ',' + id + ') - Information Web Part missing');\r\n    //                }\r\n    }\r\n    */\r\n}\r\nfunction loadentityI2(entity, id, appendparam) {\r\n    //alert('loadentityI2 ' + entity + ' ' + id);\r\n    if (document.getElementById(\"DL_Information2\")) {\r\n        if (EXGetUserRole() == 0) // 3.11.2009\r\n            displayentity2(entity, id);\r\n        else\r\n            document.all.DL_Information2.src = \"/EX_SQLSVC/DynamicForm.aspx?update=true&DL_ENTITY=\" + entity + \"&where=DL_Id=\" + id + \"&\" + appendparam + \"&EXcheck=\" + Math.random(); // 27.8.2008\r\n    }\r\n    else {\r\n        // Can we locate the parent of this IFRAME and find DL_Information2 in another IFRAME?\r\n        if (parent.document.getElementById(\"DL_Information2\")) {\r\n            //alert('DL_Information2 exists in parent');\r\n            if (EXGetUserRole() == 0) // 3.11.2009\r\n                displayentity2(entity, id);\r\n            else\r\n                parent.document.all.DL_Information2.src = \"/EX_SQLSVC/DynamicForm.aspx?update=true&DL_ENTITY=\" + entity + \"&where=DL_Id=\" + id + \"&EXcheck=\" + Math.random();\r\n        }\r\n        else\r\n            loadentity(entity, id);\r\n        //alert('loadentityI2(' + entity + ',' + id + ') - Information2 Web Part missing');\r\n    }\r\n}\r\nfunction loadentity2(entity, id, frame, appendparam) { // 25.3.2013 frame added, appendparam\r\n    if (typeof (frame) == 'undefined') frame = 'DL_Information2';\r\n    if (typeof (appendparam) == 'undefined') appendparam = '';\r\n    var oI2 = document.getElementById(frame);\r\n    if (oI2 == null)\r\n        oI2 = parent.document.getElementById(frame);\r\n    if (oI2 != null) {\r\n        if (EXGetUserRole() == 0) // 3.11.2009\r\n            displayentity2(entity, id, '', frame);\r\n        else\r\n            oI2.src = \"/EX_SQLSVC/DynamicForm.aspx?update=true&DL_ENTITY=\" + entity + \"&where=DL_Id=\" + id + appendparam + \"&EXcheck=\" + Math.random();\r\n    }\r\n    else\r\n        loadentity(entity, id);\r\n}\r\nfunction displayentity2(entity, id, title, frame) // 25.3.2013 frame added\r\n{\r\n    if (typeof (frame) == 'undefined') frame = 'DL_Information2'; // 25.3.2013\r\n    if (document.getElementById(frame)) {\r\n        //document.all.DL_Information2.src=\"/EX_SQLSVC/DynamicForm.aspx?DL_ENTITY=\" + entity + \"&where=DL_Id=\" + id + \"&EXcheck=\" + Math.random();\r\n        //document.all.DL_Information2.src = '/EX_Resources/EXDisplayEntity.html?DL_ENTITY=' + entity + '&DL_Id=' + id + \"&EXcheck=\" + Math.random();\r\n        var oFrame = document.getElementById(frame);\r\n        oFrame.src = '/EX_Resources/EXDisplayEntity.html?DL_ENTITY=' + entity + '&DL_Id=' + id + \"&EXcheck=\" + Math.random();\r\n        if (title != null && title != '')\r\n            AddWPTitle(title, frame);\r\n    }\r\n    else\r\n        displayentity(entity, id);\r\n}\r\n\r\nfunction loadcontact(entity, DLContactID, appendparam) {\r\n    if (document.getElementById(\"DL_Information\")) {\r\n        document.all.DL_Information.src = \"/EX_SQLSVC/DynamicForm.aspx?update=true&DL_ENTITY=\" + entity + \"&where=DLContactID=\" + DLContactID + \"&\" + appendparam + \"&EXcheck=\" + Math.random();\r\n        AddWPTitle(EXgetEntityTitle(entity) + \" #\" + DLContactID);\r\n    }\r\n    //        \telse\r\n    //    \t{\r\n    //       \t\talert('loadentity(' + entity + ',' + DLContactID + ') - Information Web Part missing');\r\n    //    \t}\r\n}\r\nfunction mapcontact(DLContactID, title) { // 12.3.2008 - modified 26.5.2008 - add name to title\r\n    if (typeof (title) == 'undefined')\r\n        title = 'Google Map';\r\n    else\r\n        title = 'Google Map ' + title;\r\n    //alert('mapcontact(' + DLContactID + ',' + title + ')');\r\n    loadcontent2('/EX_Resources/EXGMap.html?DLContactID=' + DLContactID + '&EXcheck=' + Math.random(), title);\r\n    //return false; // 26.5.2008 avoid link being active\r\n}\r\nfunction mapexcompany(DLId, title) { // 9.6.2008\r\n    if (typeof (title) == 'undefined')\r\n        title = 'Google Map';\r\n    else\r\n        title = 'Google Map ' + title;\r\n    loadcontent2('/EX_Resources/EXGMap.html?DLEXCompany=' + DLId + '&EXcheck=' + Math.random(), title);\r\n}\r\n\r\nfunction EXGMapField(obj, DLPropName) {\r\n    this.obj = obj;\r\n    this.DLPropName = DLPropName;\r\n    var oEle = document.getElementById(DLPropName);\r\n    //oEle.style.display = 'none;'; // hide the field\r\n    var oA = document.createElement('A');\r\n    var oImg = document.createElement('IMG');\r\n    //var s = '<A href=\"javascript:' + this.obj + '.display();\"><img border=\"0\" src=\"/EX_Resources/img/16x16/marker.png\" alt=\"View Google Map\" style=\"cursor:pointer;\" id=\"GMapImg' + DLPropName + '\"></img></A>';\r\n    //alert(s);\r\n    //oImg.outerHTML = s;\r\n    var url = 'javascript:' + this.obj + '.display();';\r\n    oA.setAttribute('href', url);\r\n    oImg.id = 'GMapImg' + DLPropName;\r\n    oImg.border = \"0\";\r\n    if (oEle.value == '') {\r\n        oImg.alt = \"Please select a coordinate\";\r\n        oImg.src = \"/EX_Resources/img/view.gif\";\r\n    }\r\n    else {\r\n        oImg.alt = \"View and modify coordinates\";\r\n        oImg.src = \"/EX_Resources/img/16x16/marker.png\";\r\n    }\r\n    oA.appendChild(oImg);\r\n    //alert(oImg + ' ' + oImg.outerHTML);\r\n    oEle.parentNode.appendChild(oA);\r\n    //alert('1');\r\n    oImg = null;\r\n    //alert('2' + oEle.parentNode.outerHTML);\r\n    oEle.style.width = '0px';\r\n    //oEle.style.visibility = 'hidden';\r\n    //oEle.style.display = 'none;'; // hide the field\r\n    oImg = document.getElementById('GMapImg' + DLPropName);\r\n    //alert('2' + oImg);\r\n}\r\nEXGMapField.prototype.display = function () {\r\n    var oEle = document.getElementById(this.DLPropName);\r\n    //alert('EXGMapField.display ' + oEle.value);\r\n    var oA = document.getElementById(this.DLPropName);\r\n    var oA2 = document.getElementById(\"LABEL\" + this.DLPropName);\r\n    //if (oA2 == null)\r\n    //\toA2 = oA;\r\n    var s = oEle.value;\r\n    var lat, lng, i;\r\n    i = s.indexOf('-');\r\n    lat = s.substring(0, i);\r\n    lng = s.substring(i + 1);\r\n    var url = getAbsoluteURL(\"/EX_Resources/EXGMap.html?PropName=\" + this.DLPropName + \"&Div=\" + oEXPickForm.name + \"&Lat=\" + lat + \"&Lng=\" + lng + \"&EXcheck=\" + Math.random());\r\n    oEXPickForm.showURL(this.DLPropName, url, getElementLeft1(oA2), getElementTop1(oA), null, '500px', '400px');\r\n}\r\n\r\nfunction loadentitywforeign(entity, id, foreignkeys, foreignvalues, appendparam) {\r\n    if (document.getElementById(\"DL_Information\")) {\r\n        document.all.DL_Information.src = \"/EX_SQLSVC/DynamicForm.aspx?update=true&DL_ENTITY=\" + entity + \"&where=DL_Id=\" + id + \"&ForeignKeys=\" + foreignkeys + \"&ForeignValues=\" + foreignvalues + \"&\" + appendparam + \"&EXcheck=\" + Math.random();\r\n        AddWPTitle(EXgetEntityTitle(entity) + \" #\" + id);\r\n    }\r\n    //    \telse\r\n    //   \t\talert('loadentity(' + entity + ',' + id + ') - Information Web Part missing');\r\n}\r\n\r\nfunction loadentitynew(entity, foreignkeys, foreignvalues, view, appendparam) {\r\n    if (document.getElementById(\"DL_Information\")) {\r\n        document.all.DL_Information.src = \"/EX_SQLSVC/DynamicForm.aspx?create=true&DL_ENTITY=\" + entity + \"&ForeignKeys=\" + foreignkeys + \"&ForeignValues=\" + foreignvalues + \"&view=\" + view + \"&\" + appendparam + \"&EXcheck=\" + Math.random();\r\n        AddWPTitle(EXgetEntityTitle(entity));\r\n    }\r\n    //    \telse\r\n    //   \t\talert('loadentitynew(' + entity + ',' + foreignkeys + ',' + foreignvalues + ') - Information Web Part missing');\r\n}\r\nfunction displayentity(entity, id, bNewWindow, where, title) // 12.3.2010 - title added\r\n{\r\n    if (typeof (title) == 'undefined')\r\n        title = '';\r\n    if (typeof (where) == 'undefined' || where == '' || where == null)\r\n        where = 'DL_Id = ' + id;\r\n    if (bNewWindow) {\r\n        //var sUrl =\"/EX_SQLSVC/DynamicForm.aspx?DL_ENTITY=\" + entity + \"&where=\" + where + \"&EXcheck=\" + Math.random();\r\n        if (id == '' || id == null)\r\n            id = GetEntityItemWhere(entity, where, 'DL_Id');\r\n        var sUrl = \"/EX_Resources/EXDisplayEntity.html?DL_ENTITY=\" + entity + \"&DL_Id=\" + id + \"&EXcheck=\" + Math.random();\r\n        var printwin = window.open(getAbsoluteURL(sUrl));\r\n        return;\r\n    }\r\n    var oFrame = document.getElementById(\"DL_Information\"); // 8.3.2012\r\n    if (!oFrame && (parent))\r\n        oFrame = parent.document.getElementById('DL_Information');\r\n    if (!oFrame && (parent)) {\r\n        //\t\talert('displayentity - try parent');\r\n        oFrame = parent.document.getElementById(\"DL_Information\");\r\n    }\r\n    if (oFrame) {\r\n        //document.all.DL_Information.src=\"/EX_SQLSVC/DynamicForm.aspx?DL_ENTITY=\" + entity + \"&where=\" + where + \"&EXcheck=\" + Math.random();\r\n        //oFrame.src=\"/EX_SQLSVC/DynamicForm.aspx?DL_ENTITY=\" + entity + \"&Where=\" + where + \"&EXcheck=\" + Math.random();\r\n        if (id == '' || id == null)\r\n            id = GetEntityItemWhere(entity, where, 'DL_Id');\r\n        oFrame.src = '/EX_Resources/EXDisplayEntity.html?DL_ENTITY=' + entity + '&DL_Id=' + id + \"&EXcheck=\" + Math.random();\r\n        if (title == '') title = EXgetEntityTitle(entity);\r\n        AddWPTitle(title); // 11.2.2008\r\n    }\r\n    //        else\r\n    //       \t\talert('displayentity - DL_Information not found - strange' + entity + ' ' + id + ' ' + where);\r\n}\r\nfunction loadrelation(FixEntity, FixEntityId, DisplayEntity, DisplayFields, RelationEntity) {\r\n    if (document.getElementById(\"DL_Information\")) {\r\n        document.all.DL_Information.src = \"/EX_SQLSVC/GenericRelationPicker.aspx?FixEntity=\" + FixEntity + \"&FixEntityId=\" + FixEntityId + \"&DisplayEntity=\" + DisplayEntity + \"&DisplayFields=\" + DisplayFields + \"&RelationEntity=\" + RelationEntity + \"&AddExcel=true\" + \"&EXcheck=\" + Math.random();\r\n    }\r\n    else\r\n        alert('loadrelation - strange' + FixEntity + ' ' + FixEntityId);\r\n}\r\nfunction loadrelationextra(FixEntity, FixEntityId, DisplayEntity, DisplayFields, RelationEntity, where, orderby, title) {\r\n    var url;\r\n    url = \"/EX_SQLSVC/GenericRelationPicker.aspx?FixEntity=\" + FixEntity + \"&FixEntityId=\" + FixEntityId + \"&DisplayEntity=\" + DisplayEntity + \"&DisplayFields=\" + DisplayFields + \"&RelationEntity=\" + RelationEntity + \"&AddExcel=false&where=\" + where + \"&EXcheck=\" + Math.random();\r\n    loadcontent2(url, title);\r\n}\r\nfunction loadrelationfull(FixEntity, FixEntityId, DisplayEntity, DisplayFields, RelationEntity, RelationFixForeign, RelationDisplayForeign) {\r\n    if (document.getElementById(\"DL_Information\")) {\r\n        document.all.DL_Information.src = \"/EX_SQLSVC/GenericRelationPicker.aspx?FixEntity=\" + FixEntity + \"&FixEntityId=\" + FixEntityId + \"&DisplayEntity=\" + DisplayEntity + \"&DisplayFields=\" + DisplayFields + \"&RelationEntity=\" + RelationEntity + \"&RelationFixForeign=\" + RelationFixForeign + \"&RelationDisplayForeign=\" + RelationDisplayForeign + \"&AddExcel=true\" + \"&EXcheck=\" + Math.random();\r\n    }\r\n    else\r\n        alert('loadrelationfull - strange' + FixEntity + ' ' + FixEntityId);\r\n}\r\nfunction setupload(contentclass, id, title, path, meta, value, enhanced) {\r\n    if (document.getElementById(\"DLUpload\")) {\r\n        document.all.DLUpload.src = '/EX_SQLSVC/UploadFile.aspx?CC=' + contentclass + '&title=' + escape(title) + '&DL_Id=' + id + '&path=' + escape(path) + '&meta=' + meta + '&value=' + escape(value) + '&enhanced=' + enhanced;\r\n    }\r\n    else\r\n        alert('setupload(' + contentclass + ',' + id + ') requires DLUpload iframe');\r\n}\r\nfunction openupload(contentclass, id, title, path, meta, value, enhanced) {\r\n    if (true) {\r\n        openupload = window.open('/EX_SQLSVC/UploadFile.aspx?CC=' + contentclass + '&title=' + escape(title) + '&DL_Id=' + id + '&path=' + escape(path) + '&meta=' + meta + '&value=' + escape(value) + '&enhanced=' + enhanced, 'Upload', 'width=380,height=80,toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,copyhistory=no,resizable=no');\r\n    }\r\n    else\r\n        alert('openupload(' + contentclass + ',' + id + ') requires DLUpload iframe');\r\n}\r\nfunction loadcontent(url, frameid, title) // 28.10.2008 - title added\r\n{\r\n    if (typeof (frameid) == 'undefined')\r\n        frameid = null;\r\n    if (typeof (title) == 'undefined') // 28.10.2008\r\n        title = '';\r\n    if (frameid == 'NEW') {\r\n        window.open(url);\r\n        return;\r\n    }\r\n    //alert('loadcontent ' +url);\r\n    if (url.indexOf('http') == -1)  // 5-11-2007 - only add http if not already there !!!\r\n        url = getAbsoluteURL(url);\r\n    if (frameid == '' || frameid == null) // 28.10.2008\r\n        frameid = 'DL_Information';\r\n    if (frameid != '' && frameid != null) {\r\n        var frame = document.getElementById(frameid);\r\n        if (!frame) // 20.8.2008 - also search parent\r\n            frame = parent.document.getElementById(frameid);\r\n        if (frame)\r\n            frame.src = url;\r\n        if (title != '')\r\n            AddWPTitle(title, frameid); // 12.11.2008 - frameid added\r\n    }\r\n    else {\r\n        if (document.getElementById(\"DL_Information\")) {\r\n            document.all.DL_Information.src = url;\r\n            AddWPTitle(\"View Content\");\r\n        }\r\n        else { // 21-9-2006 - MMQ - search for DL_Information in parent if it doesn't exists\r\n            if (parent.document.getElementById(\"DL_Information\")) {\r\n                parent.document.all.DL_Information.src = url;\r\n                AddWPTitle(\"View Content\");\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction EXLoadPicture(url, title, bNewWindow) { // 30.11.2010\r\n    url = '/EX_Resources/EXShowPicture.html?URL=' + escape(url) + '&check=' + Math.random();\r\n    loadcontent2(url, title, bNewWindow);\r\n}\r\nfunction loadcontent2(url, title, bNewWindow) // 17.6.2008 - bNewWindow\r\n{\r\n    var e = window.event;\r\n    var ctrl;\r\n    if (e)\r\n    //ctrl = e.ctrlKey;\r\n        ctrl = e.shiftKey; // 12.2.2010\r\n    else\r\n        ctrl = false;\r\n    if (ctrl && !bNewWindow) // 7.8.2009\r\n        bNewWindow = true;\r\n    if (bNewWindow) { // 17.6.2008\r\n        var printwin = window.open(url);\r\n        return;\r\n    }\r\n\r\n    //alert('loadcontent2 ' + url + ' ' + title);\r\n    var oIF = document.getElementById('DL_Information');\r\n    if (oIF == null)\r\n        oIF = parent.document.getElementById('DL_Information'); // 29.11.2010 - parent added\r\n    if (oIF != null) {\r\n        oIF.src = url;\r\n        try { AddWPTitle(title); } catch (e) { }\r\n    }\r\n    return;\r\n    if (document.getElementById(\"DL_Information\")) {\r\n        document.all.DL_Information.src = url;\r\n        AddWPTitle(title);\r\n    }\r\n    else { // 21-9-2006 - MMQ - search for DL_Information in parent if it doesn't exists\r\n        if (parent.document.getElementById(\"DL_Information\")) {\r\n            parent.document.all.DL_Information.src = url;\r\n            AddWPTitle(title);\r\n        }\r\n    }\r\n    //alert('loadcontent2 done');\r\n}\r\n\r\nfunction EXDeleteCaseMeeting(DLEntity, DLId) {\r\n    var sWhere = 'DL_EntityNameForeign = \\'' + DLEntity + '\\' AND DL_EntityId = ' + DLId;\r\n    var oXML = getEntityData2('COUNT(*) as DL_Count', 'DL_CaseDocuments', sWhere, '');\r\n    var sCount = getsafe(oXML, '//DL_Count');\r\n    //alert(sWhere + ' ' + sCount + ' ' + oXML.xml);\r\n    if (sCount == '' || sCount == '0') {\r\n        EXdeleteentity(DLEntity, DLId, null, false, false);\r\n        return;\r\n    }\r\n    if (!confirm('Delete link to meeting including ' + sCount + ' documents?'))\r\n        return;\r\n    var xOps;\r\n    xOps = '<' + DLEntity + '><DELETE><row><DL_Id>' + DLId + '</DL_Id></row></DELETE></' + DLEntity + '>';\r\n    setEntity(DLEntity, xOps);\r\n    ExecuteProcedure('dbo.EXDeleteCaseDocuments @DLEntityNameForeign=\\'' + DLEntity + '\\', @DLEntityId=' + DLId);\r\n    EXReload();\r\n}\r\nfunction EXdeleteentity(DLEntity, DLId, msg, DLCreatedBysAMAccountName, bDoNotReload, sMarkAsDeleted) { // 21.11.2008 - sMarkAsDeleted added as parameter\r\n    if (EXGetUserRole() == 0) {// 3.11.2009\r\n        alert(LEX_UserNoAccessCannotDelete);\r\n        return;\r\n    }\r\n\r\n    var s;\r\n    if (typeof (sMarkAsDeleted) == 'undefined')\r\n        sMarkAsDeleted = '';\r\n    if (msg == null || msg == '')\r\n        s = LEX_DeleteRecord;\r\n    else\r\n        s = msg;\r\n    if (DLCreatedBysAMAccountName) {\r\n        var oXML = getEntityData('DL_sAMAccountName', 'DL_sAMAccountName = %DL_sAMAccountName%', '');\r\n        //var oEntity = getEntityDat(DLEntity, 'DL_Id = ' + DLId, '');\r\n        if (getsafe(oXML, '//DL_sAMAccountName/DL_sAMAccountName').toLowerCase() != DLCreatedBysAMAccountName.toLowerCase()) {\r\n            alert('Can only delete own records. Owner is ' + DLCreatedBysAMAccountName + '.');\r\n            oXML = null;\r\n            return;\r\n        }\r\n    }\r\n    if (confirm(s)) {\r\n        var xOps;\r\n        xOps = '<' + DLEntity + '><DELETE><row><DL_Id>' + DLId + '</DL_Id></row></DELETE></' + DLEntity + '>';\r\n        setEntity(DLEntity, xOps);\r\n\r\n        if (!bDoNotReload) {\r\n            if (typeof (EXDynWPRefresh) == 'function') // 16.8.2009 - dynamic reload\r\n                EXDynWPRefresh(DLEntity);\r\n            else\r\n                EXReload();\r\n        }\r\n        else if (sMarkAsDeleted != '') {\r\n            var oTR = document.getElementById(sMarkAsDeleted);\r\n            if (oTR != null)\r\n                oTR.style.textDecoration = 'line-through';\r\n        }\r\n    }\r\n}\r\nfunction EXdeleteentityWhere(DLEntity, Where) {\r\n    if (EXGetUserRole() == 0) {// 3.11.2009\r\n        alert(LEX_UserNoAccessCannotDelete);\r\n        return;\r\n    }\r\n    if (confirm(LEX_DeleteRecord)) {\r\n        var oXML, DLId;\r\n        oXML = getEntityData(DLEntity, Where, '');\r\n        DLId = getsafe(oXML, '//DL_Id');\r\n        if (DLId = '')\r\n            return;\r\n        var xOps;\r\n        xOps = '<' + DLEntity + '><DELETE><row><DL_Id>' + DLId + '</DL_Id></row></DELETE></' + DLEntity + '>';\r\n        setEntity(DLEntity, xOps);\r\n\r\n        EXReload();\r\n    }\r\n}\r\nfunction OpenTableWP(strXML, strHref) {\r\n    /*SetGenericDBKeys(strXML);*/\r\n    SetRecentValue('DL_GenericDB', strXML);\r\n    //  \tloadcontent(strHref);\r\n}\r\nfunction OpenGenericTable(iLogon, strXML, strHref) {\r\n    if (strHref == null) // 28.7.2008\r\n        strHref = '';\r\n    /*alert('OpenGenericTable ' + strXML);*/\r\n    if (iLogon == 1) {\r\n        self.location = 'Logon.aspx?XML=' + strXML + '&Href=' + strHref;\r\n    }\r\n    else {\r\n        /*SetGenericDBKeys(strXML);*/\r\n        //alert('GenericDB ' + strXML);\r\n        SetRecentValue('DL_GenericDB', strXML);\r\n        OpenGenericDB(strHref);\r\n    }\r\n}\r\nfunction loadentityexcel(DL_Entity, strHref, ForeignKey, ForeignValue, ForeignKey2, ForeignValue2, strWhere, strPropNames, GroupBy, SumFields, LoadSize, SheetCaption, bReadOnly, GroupByColor, NoFilter, NoGridlines, strOrderBy, bAllowDelete) // 23.7.2010 - GroupBy og SumFields added // 9.8.2010 - LoadSize added // 7.10.2010 SheetCaption added // 26.10.2011 - bReadOnly added // 26.1.2012 GropByColor, NoFilter, NoGridlines added // 29.8.2012 - strOrderBy added\r\n{\r\n    var sUser = '';\r\n    if (typeof (strWhere) == 'undefined') // 4.4.2016\r\n        strWhere = '';\r\n    if (typeof (ForeignValue) == 'undefined') // 14.4.2016\r\n        ForeignValue = '';\r\n    if (typeof (ForeignValue2) == 'undefined') // 14.4.2016\r\n        ForeignValue2 = '';\r\n    ForeignValue = '' + ForeignValue;\r\n    ForeignValue2 = '' + ForeignValue2;\r\n    if (ForeignValue.indexOf('%DL_sAMAccountName%') > -1 || ForeignValue2.indexOf('%DL_sAMAccountName%') > -1 || strWhere.indexOf('%DL_sAMAccountName%') > -1) {\r\n        sUser = GetEntityItemWhere('DL_sAMAccountName', 'DL_sAMAccountName = %DL_sAMAccountName%', 'DL_sAMAccountName'); // 4.2.2016\r\n        //alert(sUser);\r\n    }\r\n    if (typeof (strOrderBy) == 'undefined') // 29.8.2012\r\n        strOrderBy = '';\r\n    if (typeof (GroupByColor) == 'undefined') // 26.1.2012\r\n        GroupByColor = '';\r\n    if (typeof (NoFilter) == 'undefined') // 26.1.2012\r\n        NoFilter = '';\r\n    if (typeof (NoGridlines) == 'undefined') // 26.1.2012\r\n        NoGridlines = '';\r\n    if (typeof (SheetCaption) == 'undefined')\r\n        SheetCaption = '';\r\n    if (typeof (LoadSize) == 'undefined')\r\n        LoadSize = '';\r\n    if (typeof (SumFields) == 'undefined')\r\n        SumFields = '';\r\n    if (typeof (GroupBy) == 'undefined')\r\n        GroupBy = '';\r\n    if (typeof (strPropNames) == 'undefined')\r\n        strPropNames = '';\r\n    if (typeof (bReadOnly) == 'undefined')\r\n        bReadOnly = false;\r\n    var strXML;\r\n    strXML = '<DL_GenericDBParams><DL_EntityName>' + DL_Entity + '</DL_EntityName><TA_ProjectForeign/><TA_GroupCode/>';\r\n    if (EXGetUserRole() == 0 || bReadOnly) // 3.11.2009\r\n        strXML += '<DL_ReadOnly>true</DL_ReadOnly>';\r\n    if (ForeignKey != '' && ForeignKey != null) {\r\n        if (ForeignValue == '%DL_sAMAccountName%') ForeignValue = sUser;\r\n        strXML = strXML + '<DL_ForeignKey>' + ForeignKey + '</DL_ForeignKey>';\r\n        strXML = strXML + '<DL_ForeignValue>' + ForeignValue + '</DL_ForeignValue>';\r\n    }\r\n    if (ForeignKey2 != '' && ForeignKey2 != null) {\r\n        if (ForeignValue2 == '%DL_sAMAccountName%') ForeignValue2 = sUser;\r\n        strXML = strXML + '<DL_ForeignKey2>' + ForeignKey2 + '</DL_ForeignKey2>';\r\n        strXML = strXML + '<DL_ForeignValue2>' + ForeignValue2 + '</DL_ForeignValue2>';\r\n    }\r\n    if ((strWhere != null) && (strWhere != '')) {\r\n        strWhere = strWhere.replace('%DL_sAMAccountName%', '\\'' + sUser + '\\''); // 4.2.2016\r\n        strXML = strXML + '<strWhere>' + MakeXMLSafe(strWhere) + '</strWhere>';\r\n    }\r\n    if (strOrderBy != '') // 29.8.2012\r\n        strXML = strXML + '<strOrderBy>' + MakeXMLSafe(strOrderBy) + '</strOrderBy>';\r\n    if ((strPropNames != null) && (strPropNames != '')) // 28.7.2008\r\n    {\r\n        strXML = strXML + '<strPropNames>' + strPropNames + '</strPropNames>';\r\n    }\r\n    if (GroupBy != '') // 23.7.2010\r\n    {\r\n        strXML = strXML + '<GroupBy>' + GroupBy + '</GroupBy>';\r\n    }\r\n    if (SumFields != '') // 23.7.2010\r\n    {\r\n        strXML = strXML + '<SumFields>' + SumFields + '</SumFields>';\r\n    }\r\n    if (LoadSize != '') // 9.8.3010\r\n    {\r\n        strXML = strXML + '<LoadSize>' + LoadSize + '</LoadSize>';\r\n    }\r\n    if (SheetCaption != '') // 7.10.3010\r\n    {\r\n        strXML = strXML + '<SheetCaption>' + SheetCaption + '</SheetCaption>';\r\n    }\r\n    if (GroupByColor != '') // 26.1.2012\r\n        strXML = strXML + '<GroupByColor>' + GroupByColor + '</GroupByColor>';\r\n    if (NoFilter != '') // 26.1.2012\r\n        strXML = strXML + '<NoFilter>' + NoFilter + '</NoFilter>';\r\n    if (NoGridlines != '') // 26.1.2012\r\n        strXML = strXML + '<NoGridlines>' + NoGridlines + '</NoGridlines>';\r\n\tif (bAllowDelete) // 4.11.2014\r\n\t\tstrXML += '<DL_AllowDelete>true</DL_AllowDelete>';\r\n    strXML = strXML + '</DL_GenericDBParams>';\r\n    //alert('DEBUG\\nloadentityexcel - not OpenGenericTable - ' + strXML + ' ' + strHref);\r\n    OpenGenericTable(0, strXML, strHref);\r\n}\r\nfunction FunctionExists(name) {\r\n    var bFound;\r\n    var i;\r\n    bFound = false;\r\n    i = 0;\r\n    for (i = 0; i < document.scripts.length; i++) {\r\n        txt = document.scripts[i].text; // first script tag on the page \r\n        //alert(txt);\r\n        if (txt.indexOf('function ' + name) > -1) {\r\n            bFound = true;\r\n        }\r\n    };\r\n    if (bFound)\r\n        return true;\r\n    else\r\n        return false;\r\n}\r\n\r\nfunction InitDLDebug() {\r\n    // BH 23-06-2011 Function added\r\n    // Use URLParameter Debug=<Writediagnostics - value>\r\n    if (queryString('DebugDestination') != '') {\r\n\r\n    }\r\n\r\n    if (queryString('Debug') != '') {\r\n        if (queryString('Debug') == -1) {\r\n            deleteCookie('WriteDiagnostics');\r\n        }\r\n        else {\r\n            var exdate = new Date();\r\n            exdate.setDate(exdate.getDate() + 10);\r\n            setCookie('WriteDiagnostics', queryString('Debug'), exdate);\r\n            setCookie('DebugDestination', queryString('DebugDestination'), exdate);\r\n        }\r\n    }\r\n    initedDebug = true;\r\n    DebugAlert('Initialized', 100, 'EX_Resources.exformatics.js.InitDLDebug()');\r\n\r\n}\r\n\r\nvar initedDebug = false;\r\nvar debugInfo = '';\r\nfunction DebugAlert(msg, writeDiagnostics, src) {\r\n    if (!initedDebug) {\r\n        InitDLDebug();\r\n    }\r\n    if (writeDiagnostics <= getCookie('WriteDiagnostics')) {\r\n        if (getCookie('DebugDestination') == 'ClipBoard') {\r\n            EXCopyToClipboard((new Date().toUTCString()) + ' ' + src + ': ' + msg);\r\n        }\r\n        else {\r\n            alert('Debug: ' + src + \": \" + msg);\r\n        }\r\n    }\r\n}\r\n\r\nfunction InitDLGlobalMenu() {\r\n    var oXML = getEntityData2('*', 'DL_Favorites', 'DL_ModifiedBy=%WUSER%', '');\r\n\r\n    var sTest = '<ul class=\"sf-menu\"><li class=\"current\"> <a href=\"#a\">Exformatics</a> <ul>';\r\n    var favorites = oXML.selectNodes(\"//DL_Favorites\");\r\n    for (var i = 0; i < favorites.length; i++) {\r\n        sTest += \"<li><a href='javascript:EXGotoObject(\\\"\" + favorites[i].selectNodes(\"DL_EntityNameForeign\")[0].text + \"\\\", \" + favorites[i].selectNodes(\"DL_EntityId\")[0].text + \");'>\" + favorites[i].selectNodes(\"DL_Title\")[0].text + \"</a></li>\";\r\n    }\r\n    sTest += \"</ul></li></ul>\"\r\n    oDiv = document.getElementById('exformaticsmenu');\r\n    oDiv.innerHTML = sTest;\r\n    $(function () {\r\n        $('ul.sf-menu').superfish();\r\n    });\r\n}\r\n\r\nfunction InitDLDashBoard() {\r\n    // 23-06-2011 bh Added debug functionality\r\n    InitDLDebug();\r\n    //InitDLGlobalMenu()\r\n    //    \talert('InitDLDashBoard()');\r\n    if (window.InitMainEntity) {\r\n        //    \t\talert('InitMain()');\r\n        InitMainEntity();\r\n    }\r\n    //else alert('InitMainEntity undefined');\r\n    //if (window.EXInitLoadFolder) { // 13.2.2008 - code copied from FTF\r\n    if (typeof (EXInitLoadFolder) == \"function\") { // Folder web part\r\n        EXInitLoadFolder();\r\n    }\r\n    if (typeof (EXInitLoadDocuments) == \"function\") { // 13.2.2008 - code copied from FTF\r\n        EXInitLoadDocuments();\r\n    }\r\n}\r\n// SignOff record\r\nfunction signoff(DL_Entity, DL_IDs, Instruction, Description) {\r\n    if (DL_Entity == '' || DL_IDs == '')\r\n        alert('signoff(' + DL_Entity + ',' + DL_IDs + ') - invalid parameters');\r\n    if (typeof (Instruction) == 'undefined' || Instruction == null) // 23.7.2008\r\n        Instruction = '';\r\n    if (typeof (Description) == 'undefined' || Description == null) // 23.7.2008\r\n        Description = '';\r\n    /*alert('signoff(' + DL_Entity + ',' + DL_IDs + ')');*/\r\n    if (false) {\r\n        signoff = window.open('/EX_SQLSVC/SignOff.aspx?DL_ENTITY=' + DL_Entity + '&DL_IDs=' + DL_IDs, 'SignOff', 'width=300,height=280,toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,copyhistory=no,resizable=no');\r\n    }\r\n    else {\r\n        return window.showModalDialog('/EX_SQLSVC/SignOff.aspx?DL_ENTITY=' + DL_Entity + '&DL_IDs=' + DL_IDs + '&Duplicates=true&Instruction=' + Instruction + '&Description=' + Description + \"&EXcheck=\" + Math.random(), 'SignOff', 'dialogWidth:326px;dialogHeight:350px;toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,copyhistory=no,resizable=no,modal=yes');\r\n    }\r\n}\r\n// SelectAll\r\nfunction SelectAll(CheckBoxControl) {\r\n    // alert('SelectAll');\r\n    if (CheckBoxControl.checked == true) {\r\n        var i;\r\n        for (i = 0; i < document.forms[0].elements.length; i++) {\r\n            if ((document.forms[0].elements[i].type == 'checkbox') && (document.forms[0].elements[i].name.indexOf('ItemCheckBox') > -1)) {\r\n                var chkBox;\r\n                chkBox = document.forms[0].elements[i]\r\n                //alert(\"control \" + chkBox.name + \" enabled \" + chkBox.enabled + \" checked \" + chkBox.checked);\r\n                //if (document.forms[0].elements[i].enabled) {\r\n                document.forms[0].elements[i].checked = true;\r\n                //alert(\"set checked\");\r\n                //}\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        var i;\r\n        for (i = 0; i < document.forms[0].elements.length; i++) {\r\n            if ((document.forms[0].elements[i].type == 'checkbox') && (document.forms[0].elements[i].name.indexOf('ItemCheckBox') > -1)) {\r\n                document.forms[0].elements[i].checked = false;\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction getSelected2() { // 2.1.2011\r\n    var oEles = document.getElementsByTagName('INPUT');\r\n    var s = '';\r\n    for (var i = 0; i < oEles.length; i++) {\r\n        if (oEles[i].type == 'checkbox') {\r\n            if (oEles[i].checked) {\r\n                if (s != '') s += ',';\r\n                s += oEles[i].id.replace('cbDF', '');\r\n            }\r\n        }\r\n    }\r\n    return s;\r\n}\r\nfunction getSelected(id) {\r\n    if (typeof (id) == 'undefined') // 27.10.2010\r\n        id = '';\r\n    var i;\r\n    var s;\r\n    var ss;\r\n    s = '';\r\n    var oForm;\r\n    if (id == '')\r\n        oForm = document.forms[0];\r\n    else\r\n        oForm = document.getElementById(id);\r\n    for (i = 0; i < oForm.elements.length; i++) {\r\n        if ((oForm.elements[i].type == 'checkbox') && (document.forms[0].elements[i].name.indexOf('ItemCheckBox') > -1)) {\r\n            if (oForm.elements[i].checked) {\r\n                if (s != '') {\r\n                    s = s + ':';\r\n                }\r\n                ss = oForm.elements[i].name;\r\n                ss = ss.replace('ItemCheckBox', '');\r\n                s = s + ss;\r\n            }\r\n        }\r\n    }\r\n    return s;\r\n}\r\n// FindHREF\r\nfunction FindHREF(DL_Id, DLName) {\r\n    var e;\r\n    e = document.getElementById('DL_MainEntity');\r\n    if (e == null) {\r\n        alert('Could not find DL_MainEntity in document!');\r\n        FindHREF = '';\r\n        return;\r\n    }\r\n    var i;\r\n    var txt;\r\n    txt = e.innerHTML;\r\n    if (DLName == null) {\r\n        DLName = 'DL_Id';\r\n    }\r\n    i = txt.indexOf(DLName + '=' + DL_Id);\r\n    if (i > -1) {\r\n        var j;\r\n        var k;\r\n        j = txt.lastIndexOf('__doPostBack', i);\r\n        k = txt.indexOf('\\'', i);\r\n        k = txt.indexOf(')', k - 1);\r\n        var s;\r\n        s = txt.substr(j, k - j + 1);\r\n        return s;\r\n    }\r\n    else {\r\n        return '';\r\n    }\r\n}\r\n// GotoDocument\r\nfunction GotoDocument(DL_DocumentId) {\r\n    var strResult;\r\n    //alert('GotoDocument(' + DL_DocumentId + ')');\r\n    try {\r\n        var objXMLHTTP;\r\n        var xmlParamDoc; // As New MSXML2.DOMDocument30\r\n        objXMLHTTP = EXXMLHTTP();\r\n        objXMLHTTP.open('Post', '/EX_PKMCDO/svcDLPKMCDO.asmx/getLink', false);\r\n        objXMLHTTP.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n        var strParam;\r\n        strParam = 'DL_DocumentId=' + DL_DocumentId;\r\n        objXMLHTTP.send(strParam);\r\n        //strResult=objXMLHTTP.responseText;\r\n        xmlParamDoc = EXDOMDocument();\r\n        xmlParamDoc.loadXML(objXMLHTTP.responseText);\r\n        if (xmlParamDoc.documentElement.selectSingleNode(\"//DLLinks/DL_URL\") == null) {\r\n            strResult = xmlParamDoc.text;\r\n            strResult = xmlParamDoc.xml;\r\n        }\r\n        else {\r\n            strResult = xmlParamDoc.documentElement.selectSingleNode(\"//DLLinks/DL_URL\").text\r\n        };\r\n\r\n        objXMLHTTP = null;\r\n        // alert('GotoDocument=' + strParam);\r\n    }\r\n    catch (e) {\r\n        alert('exception ' + e.tostring);\r\n        strResult = '';\r\n    };\r\n    //alert('GotoDocument(' + DL_DocumentId + ')=' + strResult);\r\n    if (strResult != '') {\r\n        loadcontent(strResult);\r\n    }\r\n    //return strResult;\r\n}\r\n\r\n// PickDictionary\r\nfunction PickDictionarySearch(DLPropName, sReturnField) { // 18.7.2010\r\n    var oXML = getEntityData('DL_D710', 'DL_PropName = \\'' + DLPropName + '\\'', '');\r\n    var DLPropDictionary = getsafe(oXML, '//DL_PropDictionary');\r\n    var Title = getsafe(oXML, '//DL_PropDisplayName').toLowerCase();\r\n    var DLPropCodeKey = getsafe(oXML, '//DL_PropCodeKey');\r\n    var DLPropCodeDecode = getsafe(oXML, '//DL_PropCodeDecode');\r\n    var DLPropCodeDecode2 = getsafe(oXML, '//DL_PropCodeDecode2');\r\n    var DLPropCodeDecode3 = getsafe(oXML, '//DL_PropCodeDecode3');\r\n    var oEle = document.getElementById(sReturnField);\r\n    var sValue;\r\n    if (oEle == null)\r\n        sValue = '';\r\n    else\r\n        sValue = oEle.value;\r\n    var sSearchParameters = DLPropCodeKey;\r\n    if (sValue != '')\r\n        sSearchParameters += ':' + sValue;\r\n    if (DLPropCodeDecode != '')\r\n        sSearchParameters += ',' + DLPropCodeDecode;\r\n    if (DLPropCodeDecode2 != '')\r\n        sSearchParameters += ',' + DLPropCodeDecode2;\r\n    if (DLPropCodeDecode3 != '')\r\n        sSearchParameters += ',' + DLPropCodeDecode3;\r\n    //var url = getAbsoluteURL('/EX_SQLSVC/DynamicSearch.html?DLEntity=' + DLPropDictionary + '&Field=' + sReturnField + '&XPathValue=' + DLPropCodeKey + '&SearchParameters=' + sSearchParameters + '&DefaultKeys=' + DLPropCodeKey + '&DefaultValues=' + sValue + '&HideSave=true&DocumentTitle=' + LEX_Select + ' ' + Title + '&ClickAction=searchmodal');\r\n    var url = getAbsoluteURL('/EX_SQLSVC/DynamicSearch.html?DLEntity=' + DLPropDictionary + '&Field=' + sReturnField + '&XPathValue=' + DLPropCodeKey + '&SearchParameters=' + sSearchParameters + '&HideSave=true&DocumentTitle=' + LEX_Select + ' ' + Title + '&ClickAction=searchmodal');\r\n    sValue = window.showModalDialog(url, '', 'height=450,width=380');\r\n    if (typeof (sValue) == 'undefined')\r\n        return;\r\n    if (oEle != null)\r\n        oEle.value = sValue;\r\n}\r\nfunction EXPickDictionary(sReturnField, DLPropName) {\r\n    var ew = window.open(getAbsoluteURL('/EX_SQLSVC/PickDictionary.aspx?Multi=false&DL_PropName=' + DLPropName + '&returnfield=' + sReturnField, 'ew', 'height=450,width=320'));\r\n    ew.focus();\r\n}\r\nfunction PickDictionary(DL_PropName, returnfield, bMulti) {\r\n    var dictionary_window;\r\n    var url;\r\n    //url = '/EX_SQLSVC/PickDictionary.aspx?returnfield=Form1.' + returnfield;\r\n    url = getAbsoluteURL('/EX_SQLSVC/PickDictionary.aspx?DL_PropName=' + DL_PropName + '&returnfield=Form1.' + returnfield);\r\n    if (bMulti)\r\n        url = url + '&Multi=true';\r\n    dictionary_window = window.open(url, '', 'width=296,height=350');\r\n    dictionary_window.focus();\r\n    //\t\twindow.showModalDialog(url,'','width=296,height=450'); // 8.8.2008 - tried to make it work - cannot make it work with ASPX :-(\r\n}\r\n// Handle return value from PickDictionary.aspx\r\nfunction EXReturnValueFromForm(field, value, sDIV) {\r\n    try {\r\n        if (sDIV == null || sDIV == '')\r\n            sDIV = 'Gnyf';\r\n        var oEle;\r\n        oEle = parent.document.getElementById('urn:schemas-microsoft-com:office:office#' + field);\r\n        if (oEle == null) {\r\n            oEle = parent.document.getElementById(field);\r\n        }\r\n        if (oEle == null)\r\n            alert('EXReturnValueFromForm ' + field + ' not found');\r\n        oEle.value = value;\r\n        var oDIV;\r\n        oDIV = parent.document.getElementById(sDIV);  // PickForm - naming?!?!\r\n        if (oDIV != null) {\r\n            oDIV.style.visibility = 'hidden';\r\n            oDIV.style.visibility = 'hidden';\r\n        }\r\n        oEle.focus();\r\n    }\r\n    catch (e) { alert('EXReturnValueFromForm ' + e.message); }\r\n}\r\nfunction EXPickDictionaryReturnValue(field, values) { // 16.4.2008 - this function was missing - how is that possible?\r\n    try {\r\n        var i = field.indexOf('.');\r\n        if (i > -1)\r\n            field = field.substring(i + 1);\r\n        //alert(field +  ' ' + i);\r\n        var bMulti = window.location.href.indexOf('Multi=true') > -1; // 8.8.2008\r\n        //alert('EXPickDictionaryReturnValue(' + field + ',' + values + ') invoked ' + bMulti);\r\n        var oEle = window.opener.document.getElementById(field);\r\n        if (oEle == null)\r\n            oEle = parent.window.getElementById(field);\r\n        if (oEle == null)\r\n            alert('EXPickDictionaryReturnValue(' + field + ',' + values + ') ERROR');\r\n        //alert(oEle);\r\n        if (bMulti) {\r\n            oEle.value = oEle.value + ';' + values;\r\n            oEle.value = oEle.value.replace(/;;/g, \";\");\r\n        }\r\n        else\r\n            oEle.value = values;\r\n        window.close();\r\n    } catch (e) { alert('EXPickDictionaryReturnValue(' + field + ',' + values + ') >> ' + e.message); }\r\n}\r\n// loadmatrix\r\nfunction loadmatrix(Title, HorizontalTitle, HorizontalKey, VerticalTitle, VerticalKey, MatrixEntity, MatrixView, MatrixWhere, MatrixOrderBy, MatrixTitle, MatrixHorizontalKey, MatrixVerticalKey) {\r\n    //alert('loadmatrix');\r\n    if (1) //document.all.i(\"DL_Information\"))\r\n    {\r\n        //document.all.DL_Information.src=\"/EX_SQLSVC/MatrixRelationPicker.aspx?title=\" + Title + \"&horizontaltitle=\" + HorizontalTitle + \"&horizontalkey=\" + HorizontalKey + \"&verticaltitle=\" + VerticalTitle + \"&verticalkey=\" + VerticalKey + \"&matrixentity=\" + MatrixEntity + \"&matrixview=\" + MatrixView + \"&matrixwhere=\" + MatrixWhere + \"&matrixorderby=\" + MatrixOrderBy + \"&matrixtitle=\" + MatrixTitle + \"&matrixhorizontalkey=\" + MatrixHorizontalKey + \"&matrixverticalkey=\" + MatrixVerticalKey + \"&EXcheck=\" + Math.random();\r\n        loadmatrix = window.open('/EX_SQLSVC/MatrixRelationPicker.aspx?title=' + Title + '&horizontaltitle=' + HorizontalTitle + '&horizontalkey=' + HorizontalKey + '&verticaltitle=' + VerticalTitle + '&verticalkey=' + VerticalKey + '&matrixentity=' + MatrixEntity + '&matrixview=' + MatrixView + '&matrixwhere=' + MatrixWhere + '&matrixorderby=' + MatrixOrderBy + '&matrixtitle=' + MatrixTitle + '&matrixhorizontalkey=' + MatrixHorizontalKey + \"&matrixverticalkey=\" + MatrixVerticalKey + \"&EXcheck=\" + Math.random(), 'Upload', 'width=640,height=400,toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,copyhistory=no,resizable=no');\r\n    }\r\n    else\r\n        alert('loadmatrix - strange ' + Title + ' ' + HorizontalTitle);\r\n}\r\nfunction f_open_window_max(aURL, aWinName) {\r\n    var wOpen;\r\n    var sOptions;\r\n\r\n    sOptions = 'status=yes,menubar=yes,scrollbars=yes,resizable=yes,toolbar=yes';\r\n    sOptions = sOptions + ',width=' + (screen.availWidth - 10).toString();\r\n    sOptions = sOptions + ',height=' + (screen.availHeight - 122).toString();\r\n    sOptions = sOptions + ',screenX=0,screenY=0,left=0,top=0';\r\n\r\n    wOpen = window.open('', aWinName, sOptions);\r\n    wOpen.location = aURL;\r\n    wOpen.focus();\r\n    wOpen.moveTo(0, 0);\r\n    wOpen.resizeTo(screen.availWidth, screen.availHeight);\r\n    //   return wOpen;\r\n}\r\n\r\nfunction loadlist(sD610, sD710s, sFKey, sFValue, sAction, orderby, bReport, sTitle) { // 24.9.2008 - sTitle added\r\n    //alert('loadlist sD610=' + sD610 + ' sD710s=' + sD710s + ' sFKey=' + sFKey + ' sFValue=' + sFValue + ' sAction='+ sAction + ' bReport=' + bReport + ' sTitle=' + sTitle);\r\n    var sDoAction;\r\n    if (sAction != '' && sAction != null)\r\n        sDoAction = sAction;\r\n    else\r\n        sDoAction = '568'; // 30.3.2009 '69';\r\n\r\n    // MMQ 20-9-2006\r\n    //  loadcontent('/EX_SQLSVC/DynamicListForm.aspx?DL_ENTITY=' + sD610 + '&view=' + sD710s + '&ForeignKeys=' + sFKey + '&ForeignValues=\\'' + sFValue + '\\'&Action=' + sDoAction + \"&EXcheck=\" + Math.random());\r\n    if (bReport)\r\n        loadcontent('/EX_SQLSVC/DynamicListForm.aspx?DL_REPORT=' + sD610 + '&view=' + sD710s + '&ForeignKeys=' + sFKey + '&ForeignValues=' + sFValue + '&orderby=' + orderby + '&Action=' + sDoAction + \"&EXcheck=\" + Math.random());\r\n    else { // MMQ 9-8-2007 - D760 cannot be loaded using quicksearch\r\n        if (sD610 != 'DL_D760') { // MMQ 21-6-2007 - function EXLoadQuickSearch(Entity,bSearchOnLoad,ForeignKey,ForeignValue) {\r\n            EXLoadQuickSearch(sD610, true, sFKey, sFValue, null, 1);\r\n        }\r\n        else {\r\n            //var sTitle = GetEntityItemWhere('DL_D610','DL_EntityName = \\'' + sD610 + '\\'', 'DL_EntityDescription'); // 24.8.2008\r\n            loadcontent2('/EX_SQLSVC/DynamicListForm.aspx?DL_ENTITY=' + sD610 + '&view=' + sD710s + '&ForeignKeys=' + sFKey + '&ForeignValues=' + sFValue + '&Action=' + sDoAction + \"&EXcheck=\" + Math.random(), sTitle);\r\n        }\r\n    }\r\n    //loadcontent('','DL_Information2');\r\n    newentityMMQ(sD610, sFKey, sFValue, '');\r\n}\r\n\r\nfunction exloadlist(entity, view, where, proplist, clickaction, title, orderby) { // 14.4.2011 - title added // 12.9.2012 - orderby added\r\n    if (typeof (orderby) == 'undefined')\r\n        orderby = '';\r\n    if (typeof (title) == 'undefined')\r\n        title = '';\r\n    if (typeof (proplist) == 'undefined')\r\n        proplist = '';\r\n    if (typeof (clickaction) == 'undefined')\r\n        clickaction = '';\r\n    var s;\r\n    s = '/EX_SQLSVC/DynamicList.html?DLEntity=' + entity;\r\n    if (view != null & view != '')\r\n        s = s + '&DLView=' + view;\r\n    if (proplist != '')\r\n        s += '&PropList=' + proplist;\r\n    if (clickaction != '')\r\n        s += '&ClickAction=' + clickaction;\r\n    s = s + '&Where=' + where;\r\n    if (orderby != '')\r\n        s += '&Orderby=' + orderby;\r\n    loadcontent2(s, title);\r\n}\r\n\r\nfunction newentityMMQ(entity, foreignkeys, foreignvalues, appendparam) {\r\n    if (document.getElementById(\"DL_Information2\")) {\r\n        if (foreignkeys == '') {\r\n            document.all.DL_Information2.src = \"/EX_SQLSVC/DynamicForm.aspx?new=true&DL_ENTITY=\" + entity + \"&\" + appendparam;\r\n            // 23-8-2006 - adding focus\r\n            var oIF = document.getElementById(\"DL_Information2\")\r\n            if (oIF != null) {\r\n                //alert('IFRAME focus on');\r\n                oIF.focus = true;\r\n            }\r\n            if (document.all.DL_Information2.focus() != true) {\r\n                window.status = 'not on top';\r\n            }\r\n        }\r\n        else {\r\n            document.all.DL_Information2.src = \"/EX_SQLSVC/DynamicForm.aspx?new=true&DL_ENTITY=\" + entity + \"&ForeignKeys=\" + foreignkeys + \"&ForeignValues=\" + foreignvalues + \"&\" + appendparam;\r\n            // 23-8-2006 - adding focus\r\n            var oIF = document.getElementById(\"DL_Information2\")\r\n            if (oIF != null) {\r\n                //alert('IFRAME focus on');\r\n                oIF.focus = true;\r\n            }\r\n            if (document.all.DL_Information2.focus() != true) {\r\n                window.status = 'not on top';\r\n            }\r\n        }\r\n        AddWPTitle(LEX_CreateNew + EXgetEntityTitle(entity) + '', 'DL_Information2');\r\n    }\r\n    //        \telse\r\n    //       \t\talert('new entity(' + entity + ',' + id + ') - Information Web Part missing');\r\n}\r\n\r\n\r\n// DYnamicForm javascript functions to put a row ON/OFF - as well as set the style of a row\r\nfunction PropNameRowOnOff(DL_PropName, bOn) {\r\n    try {\r\n        if (DL_PropName.indexOf(',') == -1) {\r\n            var oEle = document.getElementById('CELL' + DL_PropName);\r\n            if (oEle == null)\r\n                return;\r\n            var oPELE = oEle.parentNode;\r\n            if (bOn == 1)\r\n                oPELE.style.display = '';\r\n            else\r\n                oPELE.style.display = 'none';\r\n        }\r\n        else {\r\n            for (var i = 0; i < DL_PropName.split(\",\").length; i++) {\r\n                PropNameRowOnOff(DL_PropName.split(\",\")[i], bOn);\r\n            }\r\n        }\r\n    } catch (e) { alert('PropNameRowOnOff(' + DL_PropName + ') ' + e.message); }\r\n}\r\nfunction PropNameRowClass(DL_PropName, className) {\r\n    try {\r\n        var oEle = document.getElementById('CELL' + DL_PropName);\r\n\tif (oEle == null) return; // 12.9.2014\r\n        var oPELE = oEle.parentNode;\r\n        oPELE.className = className;\r\n    } catch (e) { alert('PropNameRowClass(' + DL_PropName + ')'); }\r\n}\r\nfunction PropNameRowTitle(DL_PropName, title) {\r\n    try {\r\n        var oEle = document.getElementById('LABEL' + DL_PropName); // Title is placed in a local SPAN\r\n        if (oEle == null)\r\n            alert('PropNameRowTitle(' + DL_PropName + ',' + title + ') not found');\r\n        oEle.innerHTML = title;\r\n    } catch (e) { alert('PropNameRowTitle(' + DL_PropName + ') >>> ' + e.message); }\r\n}\r\nfunction PropNameRowProtect(DL_PropName) { // 21.11.2011\r\n    try {\r\n        var oEle = document.getElementById(DL_PropName);\r\n        if (oEle == null)\r\n            alert('PropNameRowProtect(' + DL_PropName + ') not found');\r\n        else { // 26.09.2012\r\n            //oEle.readonly = true;\r\n            oEle.readOnly = 'readonly'; // 26.9.2012 - capital readOnly\r\n            oEle.disabled = true;\r\n        }\r\n    } catch (e) { alert('PropNameRowProtect(' + DL_PropName + ') >>> ' + e.message); }\r\n}\r\nfunction EXsetTitle(id, value) {\r\n    var oEle = document.getElementById(id);\r\n    if (oEle != null)\r\n        oEle.innerHTML = value;\r\n}\r\nfunction EXSendToAll() {\r\n\r\n}\r\n// userLanguage\r\nfunction userLanguage() {\r\n    try {\r\n        var xmldoc, FeedbackHTTP;\r\n        xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n        xmldoc = xmldoc + '<userLanguage xmlns=\"http://doclife.net/svcDLEntity\">';\r\n        xmldoc = xmldoc + '</userLanguage>';\r\n        xmldoc = xmldoc + '</soap:Body></soap:Envelope>';\r\n\r\n        FeedbackHTTP = EXXMLHTTP();\r\n        FeedbackHTTP.open(\"POST\", getAbsoluteURL('/EX_SQLSVC/svcDLEntity.asmx?op=userLanguage'), false);\r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", 'http://doclife.net/svcDLEntity/userLanguage');\r\n        FeedbackHTTP.send(xmldoc);\r\n\r\n        var s = getsafe(FeedbackHTTP.responseXML, '//UserLanguage');\r\n        FeedbackHTTP = null;\r\n        return s;\r\n    }\r\n    catch (e) {\r\n        alert('userLanguage() failed ' + e.message);\r\n    }\r\n}\r\n\r\n// getEntityData\r\nfunction getEntityData(DL_Entity, strWhere, strOrderBy) {\r\n    try {\r\n        var xmldoc, FeedbackHTTP;\r\n        xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n        xmldoc = xmldoc + '<getEntityData xmlns=\"http://doclife.net/svcDLEntity\">';\r\n        xmldoc = xmldoc + '<DL_Entity>' + DL_Entity + '</DL_Entity>';\r\n        xmldoc = xmldoc + '<strWhere>' + strWhere + '</strWhere>';\r\n        xmldoc = xmldoc + '<strOrderBy>' + strOrderBy + '</strOrderBy>';\r\n        xmldoc = xmldoc + '</getEntityData>';\r\n        xmldoc = xmldoc + '</soap:Body></soap:Envelope>';\r\n\r\n        FeedbackHTTP = EXXMLHTTP();\r\n        FeedbackHTTP.open(\"POST\", getAbsoluteURL('/EX_SQLSVC/svcDLEntity.asmx?op=getEntityData'), false);\r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", 'http://doclife.net/svcDLEntity/getEntityData');\r\n        FeedbackHTTP.send(xmldoc);\r\n\r\n        var oXML = FeedbackHTTP.responseXML;\r\n        FeedbackHTTP = null;\r\n        return oXML;\r\n    }\r\n    catch (e) {\r\n        alert('getEntityData(' + DL_Entity + ',' + strWhere + ',' + strOrderBy + ') failed ' + e.message);\r\n    }\r\n}\r\n// getEntityData2\r\nfunction getEntityData2(strNames, DL_Entity, strWhere, strOrderBy) {\r\n    try {\r\n        var xmldoc, FeedbackHTTP;\r\n        xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n        xmldoc = xmldoc + '<getEntityData2 xmlns=\"http://doclife.net/svcDLEntity\">';\r\n        xmldoc = xmldoc + '<strNames>' + strNames + '</strNames>';\r\n        xmldoc = xmldoc + '<DL_Entity>' + DL_Entity + '</DL_Entity>';\r\n        xmldoc = xmldoc + '<strWhere>' + MakeXMLSafe(strWhere) + '</strWhere>';\r\n        xmldoc = xmldoc + '<strOrderBy>' + strOrderBy + '</strOrderBy>';\r\n        xmldoc = xmldoc + '</getEntityData2>';\r\n        xmldoc = xmldoc + '</soap:Body></soap:Envelope>';\r\n\r\n        FeedbackHTTP = EXXMLHTTP();\r\n        FeedbackHTTP.open(\"POST\", getAbsoluteURL('/EX_SQLSVC/svcDLEntity.asmx?op=getEntityData2'), false);\r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", 'http://doclife.net/svcDLEntity/getEntityData2');\r\n        FeedbackHTTP.send(xmldoc);\r\n\r\n        //alert('getEntityData2 - ' + xmldoc + ' - ' + FeedbackHTTP.ResponseText);\r\n        var oXML = FeedbackHTTP.responseXML;\r\n        FeedbackHTTP = null;\r\n        return oXML;\r\n    }\r\n    catch (e) {\r\n        alert('getEntityData2(' + strNames + ',' + DL_Entity + ',' + strWhere + ',' + strOrderBy + ') failed ' + e.message);\r\n    }\r\n}\r\nfunction getEntityData2Async(strNames, DL_Entity, strWhere, strOrderBy, fct) { // 21.8.2009\r\n    try {\r\n        var xmldoc, FeedbackHTTP;\r\n        xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n        xmldoc = xmldoc + '<getEntityData2 xmlns=\"http://doclife.net/svcDLEntity\">';\r\n        xmldoc = xmldoc + '<strNames>' + strNames + '</strNames>';\r\n        xmldoc = xmldoc + '<DL_Entity>' + DL_Entity + '</DL_Entity>';\r\n        xmldoc = xmldoc + '<strWhere>' + MakeXMLSafe(strWhere) + '</strWhere>';\r\n        xmldoc = xmldoc + '<strOrderBy>' + strOrderBy + '</strOrderBy>';\r\n        xmldoc = xmldoc + '</getEntityData2>';\r\n        xmldoc = xmldoc + '</soap:Body></soap:Envelope>';\r\n\r\n        var FeedbackHTTP = EXXMLHTTP();\r\n        var handlerFunction = getReadyStateHandler(FeedbackHTTP, fct);\r\n        FeedbackHTTP.onreadystatechange = handlerFunction;\r\n        FeedbackHTTP.open(\"POST\", getAbsoluteURL('/EX_SQLSVC/svcDLEntity.asmx?op=getEntityData2'), true);\r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", 'http://doclife.net/svcDLEntity/getEntityData2');\r\n        FeedbackHTTP.send(xmldoc);\r\n\r\n        //alert('getEntityData2 - ' + xmldoc + ' - ' + FeedbackHTTP.ResponseText);\r\n        //var oXML = FeedbackHTTP.ResponseXML;\r\n        //FeedbackHTTP = null;\r\n        //return oXML;\r\n    }\r\n    catch (e) {\r\n        alert('getEntityData2Async(' + strNames + ',' + DL_Entity + ',' + strWhere + ',' + strOrderBy + ') failed ' + e.message);\r\n    }\r\n}\r\nfunction getReadyStateHandler(req, responseHandler) { // Return an anonymous function that listens to the XMLHttpRequest instance \r\n    return function () {\r\n        if (req.readyState == 4) { // If the request's status is \"complete\" \r\n            var message = req.getResponseHeader(\"status\");\r\n            // Check that a successful server response was received \r\n            if (req.status == 200) {          //todo: catch 404 error.         \r\n                // Pass the payload of the response to the handler function \r\n                if (responseHandler != null) // 4.10.2010 - avoid error if no responseHandler\r\n                    responseHandler(req);\r\n            }\r\n            else if (message != undefined && message != null && message.length > 0) {\r\n                alert(\"Error status  [\" + req.status + \"] with message [\" + message + \"].\");\r\n            }\r\n        }\r\n    }\r\n}\r\n// getEntityData3\r\nfunction getEntityData3(strNames, DL_Entity, strWhere, strOrderBy, strGroupBy) {\r\n    try {\r\n        var xmldoc, FeedbackHTTP;\r\n        xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n        xmldoc = xmldoc + '<getEntityData3 xmlns=\"http://doclife.net/svcDLEntity\">';\r\n        xmldoc = xmldoc + '<strNames>' + strNames + '</strNames>';\r\n        xmldoc = xmldoc + '<DL_Entity>' + DL_Entity + '</DL_Entity>';\r\n        xmldoc = xmldoc + '<strWhere>' + MakeXMLSafe(strWhere) + '</strWhere>';\r\n        xmldoc = xmldoc + '<strOrderBy>' + strOrderBy + '</strOrderBy>';\r\n        xmldoc = xmldoc + '<strGroupBy>' + strGroupBy + '</strGroupBy>';\r\n        xmldoc = xmldoc + '</getEntityData3>';\r\n        xmldoc = xmldoc + '</soap:Body></soap:Envelope>';\r\n\r\n        FeedbackHTTP = EXXMLHTTP()\r\n        FeedbackHTTP.open(\"POST\", getAbsoluteURL('/EX_SQLSVC/svcDLEntity.asmx?op=getEntityData3'), false);\r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", 'http://doclife.net/svcDLEntity/getEntityData3');\r\n        FeedbackHTTP.send(xmldoc);\r\n\r\n        //alert('getEntityData3 - ' + xmldoc + ' - ' + FeedbackHTTP.ResponseText);\r\n        var oXML = FeedbackHTTP.responseXML;\r\n        FeedbackHTTP = null;\r\n        return oXML;\r\n    }\r\n    catch (e) {\r\n        alert('getEntityData3(' + strNames + ',' + DL_Entity + ',' + strWhere + ',' + strOrderBy + ',' + strGroupBy + ') failed ' + e.message);\r\n    }\r\n}\r\n// getEntityData34JSON\r\nfunction getEntityData34JSON(strNames, DL_Entity, strWhere, strOrderBy, strGroupBy) {\r\n    try {\r\n        var xmldoc, FeedbackHTTP;\r\n        xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n        xmldoc = xmldoc + '<getEntityData34JSON xmlns=\"http://doclife.net/svcDLEntity\">';\r\n        xmldoc = xmldoc + '<strNames>' + strNames + '</strNames>';\r\n        xmldoc = xmldoc + '<DL_Entity>' + DL_Entity + '</DL_Entity>';\r\n        xmldoc = xmldoc + '<strWhere>' + MakeXMLSafe(strWhere) + '</strWhere>';\r\n        xmldoc = xmldoc + '<strOrderBy>' + strOrderBy + '</strOrderBy>';\r\n        xmldoc = xmldoc + '<strGroupBy>' + strGroupBy + '</strGroupBy>';\r\n        xmldoc = xmldoc + '<strWUser>%WUSER%</strWUser><showNodeName>true</showNodeName>';\r\n        xmldoc = xmldoc + '</getEntityData34JSON>';\r\n        xmldoc = xmldoc + '</soap:Body></soap:Envelope>';\r\n\r\n        FeedbackHTTP = EXXMLHTTP()\r\n        FeedbackHTTP.open(\"POST\", getAbsoluteURL('/EX_SQLSVC/svcDLEntity.asmx?op=getEntityData34JSON'), false);\r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", 'http://doclife.net/svcDLEntity/getEntityData34JSON');\r\n        FeedbackHTTP.send(xmldoc);\r\n\r\n        //alert('getEntityData34JSON - ' + xmldoc + '\\n' + FeedbackHTTP.responseText);\r\n        var oXML = FeedbackHTTP.responseText;\r\n        FeedbackHTTP = null;\r\n        return oXML;\r\n    }\r\n    catch (e) {\r\n        alert('getEntityData3(' + strNames + ',' + DL_Entity + ',' + strWhere + ',' + strOrderBy + ',' + strGroupBy + ') failed ' + e.message);\r\n    }\r\n}\r\n// getDictionaryData\r\nfunction getDictionaryData(DLDictionary, DLPropCodeKey, DLPropCodeDecode) // 1.6.2008\r\n{\r\n    try {\r\n        var xmldoc, FeedbackHTTP;\r\n        xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n        xmldoc = xmldoc + '<getDictionaryData xmlns=\"http://doclife.net/svcDLEntity\">';\r\n        xmldoc = xmldoc + '<DL_Dictionary>' + DLDictionary + '</DL_Dictionary>';\r\n        xmldoc = xmldoc + '<DL_PropCodeKey>' + DLPropCodeKey + '</DL_PropCodeKey>';\r\n        xmldoc = xmldoc + '<DL_PropCodeDecode1>' + DLPropCodeDecode + '</DL_PropCodeDecode1>';\r\n        xmldoc = xmldoc + '<DL_PropCodeDecode2/><DL_PropCodeDecode3/><DL_DictKey1/><DL_DictValue1/>';\r\n        xmldoc = xmldoc + '</getDictionaryData>';\r\n        xmldoc = xmldoc + '</soap:Body></soap:Envelope>';\r\n\r\n        FeedbackHTTP = EXXMLHTTP()\r\n        var sUrl = getAbsoluteURL('/EX_SQLSVC/svcDLEntity.asmx?op=getDictionaryData');\r\n        FeedbackHTTP.open(\"POST\", sUrl, false);\r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", 'http://doclife.net/svcDLEntity/getDictionaryData');\r\n        FeedbackHTTP.send(xmldoc);\r\n\r\n        if (FeedbackHTTP.Status != 200) {\r\n            //\tEXCopyToClipboard(xmldoc);\r\n            alert(sUrl + ' getDictionaryData(' + DLDictionary + ',' + DLPropCodeKey + ',' + DLPropCodeDecode + ') failed ' + FeedbackHTTP.Status + '\\n' + xmldoc + '\\n' + FeedbackHTTP.ResponseText);\r\n        }\r\n        var oXML = FeedbackHTTP.responseXML;\r\n        FeedbackHTTP = null;\r\n        return oXML;\r\n    }\r\n    catch (e) {\r\n        alert('getDictionaryData(' + DLDictionary + ',' + DLPropCodeKey + ',' + DLPropCodeDecode + ') failed ' + e.message);\r\n    }\r\n}\r\nfunction getDictionaryData2(DLDictionary, DLPropCodeKey, DLPropCodeDecode, DLPropCodeDecode2, DLPropCodeDecode3, DLDictKey1, DLDictValue1, DLDictKey2, DLDictValue2, DLDictKey3, DLDictValue3) // 6.11.2011\r\n{\r\n    try {\r\n        if (typeof (DLDictKey1) == 'undefined') { DLDictKey1 = ''; DLDictValue1 = ''; }\r\n        if (typeof (DLDictKey2) == 'undefined') { DLDictKey2 = ''; DLDictValue2 = ''; }\r\n        if (typeof (DLDictKey3) == 'undefined') { DLDictKey3 = ''; DLDictValue3 = ''; }\r\n        var xmldoc, FeedbackHTTP;\r\n        xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n        xmldoc = xmldoc + '<getDictionaryData2 xmlns=\"http://doclife.net/svcDLEntity\">';\r\n        xmldoc = xmldoc + '<DL_Dictionary>' + DLDictionary + '</DL_Dictionary>';\r\n        xmldoc = xmldoc + '<DL_PropCodeKey>' + DLPropCodeKey + '</DL_PropCodeKey>';\r\n        xmldoc = xmldoc + '<DL_PropCodeDecode1>' + DLPropCodeDecode + '</DL_PropCodeDecode1>';\r\n        xmldoc = xmldoc + '<DL_PropCodeDecode2>' + DLPropCodeDecode2 + '</DL_PropCodeDecode2><DL_PropCodeDecode3>' + DLPropCodeDecode3 + '</DL_PropCodeDecode3>';\r\n        xmldoc = xmldoc + '<DL_DictKey1>' + DLDictKey1 + '</DL_DictKey1><DL_DictValue1>' + DLDictValue1 + '</DL_DictValue1>';\r\n        xmldoc = xmldoc + '<DL_DictKey2>' + DLDictKey2 + '</DL_DictKey2><DL_DictValue2>' + DLDictValue2 + '</DL_DictValue2>';\r\n        xmldoc = xmldoc + '<DL_DictKey3>' + DLDictKey3 + '</DL_DictKey3><DL_DictValue3>' + DLDictValue3 + '</DL_DictValue3>';\r\n        xmldoc = xmldoc + '</getDictionaryData2>';\r\n        xmldoc = xmldoc + '</soap:Body></soap:Envelope>';\r\n\r\n        FeedbackHTTP = EXXMLHTTP()\r\n        var sUrl = getAbsoluteURL('/EX_SQLSVC/svcDLEntity.asmx?op=getDictionaryData2');\r\n        FeedbackHTTP.open(\"POST\", sUrl, false);\r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", 'http://doclife.net/svcDLEntity/getDictionaryData2');\r\n        FeedbackHTTP.send(xmldoc);\r\n\r\n        if (FeedbackHTTP.Status != 200) {\r\n            //\tEXCopyToClipboard(xmldoc);\r\n            alert(sUrl + ' getDictionaryData2(' + DLDictionary + ',' + DLPropCodeKey + ',' + DLPropCodeDecode + ') failed ' + FeedbackHTTP.Status + '\\n' + xmldoc + '\\n' + FeedbackHTTP.ResponseText);\r\n        }\r\n        var oXML = FeedbackHTTP.responseXML;\r\n        FeedbackHTTP = null;\r\n        return oXML;\r\n    }\r\n    catch (e) {\r\n        alert('getDictionaryData2(' + DLDictionary + ',' + DLPropCodeKey + ',' + DLPropCodeDecode + ') failed ' + e.message);\r\n    }\r\n}\r\n// getEntity\r\nfunction getEntity(DL_Entity, strWhere, strOrderBy) {\r\n    try {\r\n        var xmldoc, FeedbackHTTP;\r\n        xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n        xmldoc = xmldoc + '<_getEntity xmlns=\"http://doclife.net/svcDLEntity\">';\r\n        xmldoc = xmldoc + '<strEntity>' + DL_Entity + '</strEntity>';\r\n        xmldoc = xmldoc + '<strWhere>' + MakeXMLSafe(strWhere) + '</strWhere>'; // 31.5.2008 - MakeXMLSafe\r\n        xmldoc = xmldoc + '<strOrderBy>' + strOrderBy + '</strOrderBy>';\r\n        xmldoc = xmldoc + '</_getEntity>';\r\n        xmldoc = xmldoc + '</soap:Body></soap:Envelope>';\r\n        // alert('getEntity ' + xmldoc);\r\n\r\n        FeedbackHTTP = EXXMLHTTP()\r\n        FeedbackHTTP.open(\"POST\", getAbsoluteURL('/EX_SQLSVC/svcDLEntity.asmx?op=_getEntity'), false);\r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", 'http://doclife.net/svcDLEntity/_getEntity');\r\n        FeedbackHTTP.send(xmldoc);\r\n        // alert('getEntity completed ' + FeedbackHTTP.ResponseText);\r\n        var oXML;\r\n        oXML = FeedbackHTTP.responseXML;\r\n        FeedbackHTTP = null;\r\n        return oXML;\r\n    }\r\n    catch (e) {\r\n        alert('getEntity(' + DL_Entity + ',' + strWhere + ',' + strOrderBy + ') failed ' + e.message);\r\n    }\r\n}\r\n// ExecuteProcedure \r\nfunction ExecuteProcedure(Operation, bReportError) { // 1.8.2012 - bReportError added\r\n    if (typeof (bReportError) == 'undefined')\r\n        bReportError = true;\r\n    try {\r\n        var xmldoc;\r\n        xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n        xmldoc = xmldoc + '<ExecuteProcedure xmlns=\"http://doclife.net/svcDLEntity\">';\r\n        xmldoc = xmldoc + '<sProcedure>' + MakeXMLSafe(Operation) + '</sProcedure>'; // 18.5.2012 - MakeXMLSafe added\r\n        xmldoc = xmldoc + '</ExecuteProcedure>';\r\n        xmldoc = xmldoc + '</soap:Body></soap:Envelope>';\r\n        //alert('ExecuteProcedure ' + xmldoc);\r\n\r\n        FeedbackHTTP = EXXMLHTTP();\r\n        FeedbackHTTP.open(\"POST\", '/EX_SQLSVC/svcDLEntity.asmx?op=ExecuteProcedure', false);\r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", 'http://doclife.net/svcDLEntity/ExecuteProcedure');\r\n        FeedbackHTTP.send(xmldoc);\r\n        //alert('ExecuteProcedure completed ' + FeedbackHTTP.ResponseText);\r\n        //return (getsafe(FeedbackHTTP.responseXML, 'boolean') == 'true');\r\n        return FeedbackHTTP.responseXML;\r\n    }\r\n    catch (e) {\r\n        if (bReportError)\r\n            alert('ExecuteProcedure(' + Operation + ') failed ' + e.message);\r\n        return null;\r\n    }\r\n}\r\nfunction ExecuteProcedureAsync(Operation, callback) // 21.8.2010\r\n{\r\n    try {\r\n        var xmldoc;\r\n        xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n        xmldoc = xmldoc + '<ExecuteProcedure xmlns=\"http://doclife.net/svcDLEntity\">';\r\n        xmldoc = xmldoc + '<sProcedure>' + Operation + '</sProcedure>';\r\n        xmldoc = xmldoc + '</ExecuteProcedure>';\r\n        xmldoc = xmldoc + '</soap:Body></soap:Envelope>';\r\n        //alert('ExecuteProcedure ' + xmldoc);\r\n\r\n        FeedbackHTTP = EXXMLHTTP();\r\n        var handlerFunction = getReadyStateHandler(FeedbackHTTP, callback);\r\n        FeedbackHTTP.onreadystatechange = handlerFunction;\r\n        FeedbackHTTP.open(\"POST\", '/EX_SQLSVC/svcDLEntity.asmx?op=ExecuteProcedure', false);\r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", 'http://doclife.net/svcDLEntity/ExecuteProcedure');\r\n        FeedbackHTTP.send(xmldoc);\r\n    }\r\n    catch (e) {\r\n        alert('ExecuteProcedureAsync(' + Operation + ') failed ' + e.message);\r\n    }\r\n}\r\n// 6.3.2008\r\nfunction EXADSearchInitField(PropName) {\r\n    var oEle = document.getElementById(PropName);\r\n    if (oEle == null)\r\n        return;\r\n    if (oEle.value == '')\r\n        return;\r\n    var s = GetEntityItemWhere('DL_sAMAccountName', 'DL_sAMAccountName = \\'' + oEle.value + '\\'', 'DL_FullName');\r\n    //alert('EXADSearchInitField(' + PropName + ') = ' + s + '\\n' + oEle.parentNode.outerHTML);\r\n    oEle.parentNode.title = s;\r\n}\r\n// 4.3.2008\r\nfunction SearchAD(strPath, strFilter, strProperty) {\r\n    try {\r\n        var xmldoc, FeedbackHTTP;\r\n        xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n        xmldoc = xmldoc + '<SearchAD xmlns=\"http://doclife.net/svcDLEntity\">';\r\n        xmldoc = xmldoc + '<strPath>' + strPath + '</strPath>';\r\n        xmldoc = xmldoc + '<strFilter>' + MakeXMLSafe(strFilter) + '</strFilter>';\r\n        xmldoc = xmldoc + '<strProperty>' + strProperty + '</strProperty>';\r\n        xmldoc = xmldoc + '</SearchAD>';\r\n        xmldoc = xmldoc + '</soap:Body></soap:Envelope>';\r\n\r\n        FeedbackHTTP = EXXMLHTTP()\r\n        FeedbackHTTP.open(\"POST\", getAbsoluteURL('/EX_SQLSVC/svcDLEntity.asmx?op=SearchAD'), false);\r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", 'http://doclife.net/svcDLEntity/SearchAD');\r\n        FeedbackHTTP.send(xmldoc);\r\n        if (FeedbackHTTP.Status != 200)\r\n            alert('SearchAD(' + strPath + ',' + strFilter + ',' + strProperty + ') failed ' + FeedbackHTTP.Status + '\\n' + xmldoc + '\\n--- ' + FeedbackHTTP.responseText);\r\n        var oXML = FeedbackHTTP.responseXML;\r\n        FeedbackHTTP = null;\r\n        return oXML;\r\n    }\r\n    catch (e) {\r\n        alert('SearchAD(' + strPath + ',' + strFilter + ',' + strProperty + ') failed ' + e.message);\r\n    }\r\n}\r\n// CreateFolder - SQL Services interface\r\nfunction CreateFolder(DLEntity, DLId) {\r\n    try {\r\n        var xmldoc;\r\n        xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n        xmldoc = xmldoc + '<CreateFolder xmlns=\"http://doclife.net/svcDLState\">';\r\n        xmldoc = xmldoc + '<DL_Entity>' + DLEntity + '</DL_Entity>';\r\n        xmldoc = xmldoc + '<DL_Id>' + DLId + '</DL_Id>';\r\n        xmldoc = xmldoc + '</CreateFolder>';\r\n        xmldoc = xmldoc + '</soap:Body></soap:Envelope>';\r\n\r\n        FeedbackHTTP = EXXMLHTTP()\r\n        FeedbackHTTP.open(\"POST\", '/EX_SQLSVC/svcDLState.asmx?op=CreateFolder', false);\r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", 'http://doclife.net/svcDLState/CreateFolder');\r\n        FeedbackHTTP.send(xmldoc);\r\n        //alert('ExecuteProcedure completed ' + FeedbackHTTP.ResponseText);\r\n        return (getsafe(FeedbackHTTP.responseXML, 'boolean') == 'true');\r\n    } catch (e) { alert('CreateFolder(' + DLEntity + ',' + DLId + ') failed ' + e.message); }\r\n}\r\n\r\n\r\n// EXCreateFolder - SharePoint Services interface\r\nfunction EXCreateFolder(DLEntity, DLId) {\r\n    try {\r\n        var xmldoc;\r\n        xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n        xmldoc = xmldoc + '<CreateFolder xmlns=\"http://exformatics.net/SharePointServices\">';\r\n        xmldoc = xmldoc + '<DL_EntityName>' + DLEntity + '</DL_EntityName>';\r\n        xmldoc = xmldoc + '<DL_Id>' + DLId + '</DL_Id>';\r\n        xmldoc = xmldoc + '</CreateFolder>';\r\n        xmldoc = xmldoc + '</soap:Body></soap:Envelope>';\r\n\r\n        FeedbackHTTP = EXXMLHTTP()\r\n        FeedbackHTTP.open(\"POST\", '/EX_SPSADMSVC/svcSharePoint.asmx?op=CreateFolder', false);\r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", 'http://exformatics.net/SharePointServices/CreateFolder');\r\n        FeedbackHTTP.send(xmldoc);\r\n        return (getsafe(FeedbackHTTP.responseXML, '//CreateFolderResult') == 'true');\r\n    } catch (e) { alert('EXCreateFolder(' + DLEntity + ',' + DLId + ') failed ' + e.message); }\r\n}\r\n\r\n// getDocumentsFromView\r\nfunction getDocumentsFromView(URL, DL_ViewName) {\r\n    try {\r\n        var xmldoc;\r\n        xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n        xmldoc = xmldoc + '<getDocumentsFromView xmlns=\"http://exformatics.net/SharePointServices\">';\r\n        xmldoc = xmldoc + '<URL>' + URL + '</URL>';\r\n        xmldoc = xmldoc + '<DL_ViewName>' + DL_ViewName + '</DL_ViewName>';\r\n        xmldoc = xmldoc + '</getDocumentsFromView>';\r\n        xmldoc = xmldoc + '</soap:Body></soap:Envelope>';\r\n\r\n        FeedbackHTTP = EXXMLHTTP()\r\n        FeedbackHTTP.open(\"POST\", '/EX_SPSSVC/svcSharePoint.asmx?op=getDocumentsFromView', false);\r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", 'http://exformatics.net/SharePointServices/getDocumentsFromView');\r\n        FeedbackHTTP.send(xmldoc);\r\n        //alert(FeedbackHTTP.responseText);\r\n        return FeedbackHTTP.responseXML;\r\n    }\r\n    catch (e) { alert('getDocumentsFromView(' + DL_Entity + ',' + strWhere + ',' + strOrderBy + ') failed ' + e.message); }\r\n}\r\n\r\n\r\nfunction _EXnewTransmittal(DLEntityNameForeign, DLEntityId, title) {\r\n    var xOps = '<DL_Transmittal>';\r\n    xOps = xOps + '<DL_Title>' + title + '</DL_Title><DL_DueDate>now</DL_DueDate><DL_EntityNameForeign>' + DLEntityNameForeign + '</DL_EntityNameForeign><DL_EntityId>' + DLEntityId + '</DL_EntityId>';\r\n    xOps = xOps + '</DL_Transmittal>';\r\n    //alert(xOps);\r\n    var DL_Transmittal = setEntityDetail('DL_Transmittal', xOps);\r\n    return DL_Transmittal;\r\n}\r\nfunction EXnewTransmittalFromOld(DLsAMAccountName, DLId) {\r\n    try {\r\n        var oXML;\r\n        oXML = ExecuteProcedure('EXCopyTransmittal @DL_sAMAccountName = ' + DLsAMAccountName + ', @DLId = ' + DLId);\r\n        var DL_Transmittal;\r\n        DL_Transmittal = GetRecentValue('DL_Transmittal');\r\n        // Create new folder\r\n        CreateFolder('DL_Transmittal', DL_Transmittal);\r\n        EXGotoUrl(getAbsoluteURL(EXgetTransmittalPortalURL()) + DL_Transmittal);\r\n    } catch (e) { alert('EXnewTransmittalFromOld ' + e.message); }\r\n}\r\n\r\nfunction EXnewTransmittal(portal) {\r\n    try {\r\n        var xOps, DL_Transmittal;\r\n        // create new transmittal, open portal page, and assign that to view\r\n        var DL_Case;\r\n        DL_Case = GetRecentValue('DL_Case');\r\n        if (confirm(LEX_TransmittalCreate.format(DL_Case))) {\r\n            var DL_Title;\r\n            DL_Title = '';\r\n            DL_Title = prompt(LEX_TransmittalEnterTitle);\r\n            if (DL_Title == '' || DL_Title == 'undefined') {\r\n                alert(LEX_TransmittalNoTitle);\r\n                return;\r\n            }\r\n            xOps = '<DL_Transmittal>';\r\n            //xOps = xOps + '<DL_Title>Transmittal - AJAX created</DL_Title>';\r\n            xOps = xOps + '<DL_Title>' + DL_Title + '</DL_Title><DL_DueDate>now</DL_DueDate><DL_EntityNameForeign>DL_Case</DL_EntityNameForeign><DL_EntityId>' + DL_Case + '</DL_EntityId>';\r\n            xOps = xOps + '</DL_Transmittal>';\r\n            //alert(xOps);\r\n            DL_Transmittal = setEntityDetail('DL_Transmittal', xOps);\r\n\r\n            // open portal page\r\n            //      alert('new transmittal #' + DL_Transmittal + ' created for activity ' + DL_Case + ' - please specify various data');\r\n            if (portal == 1) {\r\n                //loadcontent(getAbsoluteURL('/C7/Transmittal/default.aspx?DL_Transmittal=') + DL_Transmittal);\r\n                loadentity('DL_Transmittal', DL_Transmittal);\r\n            }\r\n            else {\r\n                window.open(getAbsoluteURL(EXgetTransmittalPortalURL()) + DL_Transmittal);\r\n            }\r\n            return DL_Transmittal;\r\n        }\r\n        else {\r\n            alert(LEX_TransmittalSelectAnother);\r\n            return '';\r\n        }\r\n    } catch (e) { alert('EXnewTransmittal() - ' + e.message); }\r\n}\r\nfunction EXAddDocumentToCase(EXDocumentID, Title, sSite, sURL, portal, EXVersion) {\r\n    //alert('EXAddDocumentToCase(' + EXDocumentID + ',' + Title + ',' + sSite + ',' + sURL + ',' + EXVersion + ')');\r\n    var DL_Entity = 'DL_Transmittal';\r\n    var DL_Transmittal = GetRecentValue('DL_Transmittal');\r\n    //alert('getRecentValue ' + DL_Entity + '=' + DL_Transmittal);\r\n\r\n    var xOps;\r\n\r\n    // get LastModified date for Transmittal\r\n    var DL_LastModified, DL_Title;\r\n    var bCreate;\r\n    bCreate = false;\r\n    DL_LastModified = '';\r\n    DL_Title = '';\r\n    if (DL_Transmittal != null && DL_Transmittal != '') {\r\n        var xTransmittalLastModified;\r\n        xTransmittalLastModified = getEntityData('DL_TransmittalLastModified', \"DL_Id=\" + DL_Transmittal, \"\");\r\n        DL_LastModified = getsafe(xTransmittalLastModified, \"//DL_Modified\");\r\n        DL_Title = getsafe(xTransmittalLastModified, \"//DL_Title\");\r\n        xTransmittalLastModified = null;\r\n\r\n        if (DL_LastModified == '') {\r\n            bCreate = true;\r\n        }\r\n    }\r\n    else {\r\n        bCreate = true;\r\n    }\r\n\r\n    if (bCreate) {\r\n        alert(LEX_TransmittalNoActiveAbort);\r\n        return false;\r\n    }\r\n    if (confirm(LEX_TransmittalAddDocument.format(DL_Transmittal, DL_Title, DL_LastModified))) {\r\n        _EXAddDocumentToTransmittal(bCreate, DL_Entity, DL_Transmittal, EXDocumentID, Title, sURL, portal, EXVersion);\r\n    }\r\n}\r\nfunction EXConvertBasket2PDF(bAsk, DLEntityNameForeign, DLEntityId) { // 12.3.2009 // 16.1.2013 - DLEntityNameForeign+DLEntityId added\r\n    if (typeof (bAsk) == 'undefined')\r\n        bAsk = true;\r\n    if (typeof (DLEntityNameForeign) == 'undefined')\r\n        DLEntityNameForeign = '';\r\n    if (typeof (DLEntityId) == 'undefined')\r\n        DLEntityId = '';\r\n    var bConvert = false;\r\n    var sWhere = 'DL_EntityNameForeign = \\'DL_sAMAccountName\\' AND DL_ModifiedBy = %WUSER%';\r\n    if (DLEntityNameForeign != '')\r\n        sWhere = 'DL_EntityNameForeign = \\'' + DLEntityNameForeign + '\\' AND DL_EntityId=' + DLEntityId;\r\n    var xDocs = getEntityData('DL_CaseDocuments', sWhere, '');\r\n    var xNodes = xDocs.selectNodes('//DL_CaseDocuments');\r\n    sDocs = '';\r\n    for (var i = 0; i < xNodes.length; i++) {\r\n        var sUrl = getsafe(xNodes[i], 'DL_URLDocument');\r\n        var j = sUrl.lastIndexOf('.');\r\n        var ext = sUrl.substring(j);\r\n        if (ext.toLowerCase() != '.pdf' && ext.toLowerCase() != '.msg') { // 12.3.2009\r\n            bConvert = true;\r\n        }\r\n    }\r\n    if (bConvert) {\r\n        if (bAsk)\r\n            bConvert = confirm(LEX_DocumentBasket2PDF); // 19.4.2013 - localization check\r\n        if (bConvert) {\r\n            var sRes = '';\r\n            for (var i = 0; i < xNodes.length; i++) {\r\n                var sUrl = getsafe(xNodes[i], 'DL_URLDocument');\r\n                var j = sUrl.lastIndexOf('.');\r\n                var ext = sUrl.substring(j);\r\n                if (ext.toLowerCase() != '.pdf' && ext.toLowerCase() != '.msg') { // 12.3.2009\r\n                    if (ConvertFile2PDF(sUrl, 'pdf')) {\r\n                        j = sUrl.lastIndexOf('/');\r\n                        var sNewUrl = sUrl.substring(0, j) + '/pdf/';\r\n                        sUrl = sUrl.substring(j + 1);\r\n                        j = sUrl.lastIndexOf('.');\r\n                        sNewUrl = sNewUrl + sUrl.substring(0, j) + '.pdf';\r\n                        //alert(sNewUrl);\r\n                        j = sNewUrl.substring(8).indexOf('/');\r\n                        var sUrl2 = sNewUrl.substring(8 + j);\r\n                        var xDoc = getEntityData2('Top 1 *', 'DL_Documents', \"DL_URLDocument = '\" + sUrl2 + \"'\", 'DL_Id desc');\r\n                        var sDocumentID = getsafe(xDoc, '//DL_DocumentId');\r\n                        var xMeta = EXgetDocumentMetaData(sNewUrl);\r\n                        var sVersion = getsafe(xMeta, '//_UIVersionString');\r\n                        //alert('DEBUG\\n' + sUrl2 + ' ' + xDoc.xml + ' ' + sDocumentID + ' ' + sVersion + '\\n' + xMeta.xml);\r\n                        //alert(xMeta.xml);\r\n                        SetEntityItemValue('DL_CaseDocuments', getsafe(xNodes[i], 'DL_Id'), getsafe(xNodes[i], 'DL_Modified'), 'DL_URLDocument', sNewUrl, 'DL_DocumentID', sDocumentID, 'DL_DocumentVersion', sVersion);\r\n                        sUrl = sNewUrl;\r\n                    }\r\n                    else\r\n                        sRes += 'Kunne ikke konvertere ' + sUrl + ' til pdf\\n';\r\n                }\r\n            }\r\n            if (sRes != '')\r\n                alert(sRes);\r\n            if (typeof (EXDocBasketRefresh) == 'function' && DLEntityNameForeign == '') // 17.11.2009\r\n                EXDocBasketRefresh();\r\n        }\r\n    }\r\n}\r\n// iType: 0=docs,1=Emails,2=Attachments\r\nfunction EXAdd2DocBasket(EXDocumentID, Title, sURL, EXVersion, szCheckedOutUser, iType) {\r\n    // 30.03.2011 - BH - IT-sag 2034\r\n    // 7.6.2011 - MMQ - REMOVED AGAIN - strange\r\n    //Title = unescape(unescape(Title));\r\n    //sURL = unescape(unescape(sURL));\n\tTitle = decodeURIComponent(Title);\r\n\tsURL = decodeURIComponent(sURL);\r\n    //alert('EXAdd2DocBasket ' + Title);\r\n    //271111, JRD: Removed...\r\n    //if (EXDocumentID == '') {\r\n    //  alert(LEX_DocBasketEXDocumentIDEmpty);\r\n    //  return;\r\n    //}\r\n    if (szCheckedOutUser == null)\r\n        szCheckedOutUser = '';\r\n    if (szCheckedOutUser != '') {\r\n        if (szCheckedOutUser.indexOf(';#') > 0)\r\n            szCheckedOutUser = szCheckedOutUser.substr(szCheckedOutUser.indexOf(';#') + 2);\r\n        if (!confirm(LEX_DocumentCheckedOutAddAnyway.format(szCheckedOutUser)))\r\n            return;\r\n    }\r\n    // 3.1.2010\r\n    var e = window.event;\r\n    var ctrl;\r\n    if (e)\r\n    //ctrl = e.ctrlKey;\r\n        ctrl = e.shiftKey; // 12.2.2010\r\n    else\r\n        ctrl = false;\r\n    //alert('DEBUG\\nEXAdd2DocBasket(' + EXDocumentID + ',' + Title + ',' + sURL + ',' + EXVersion + ',' + szCheckedOutUser + ',' + iType + ') started. ctrl=' + ctrl);\r\n\r\n    //_EXAddDocumentToTransmittal(false, 'DL_sAMAccountName', 0, EXDocumentID, Title, sURL, true, EXVersion, 'Document \\'' + Title + '\\' added to basket.');\r\n    //_EXAddDocumentToTransmittal(false, 'DL_sAMAccountName', 0, EXDocumentID, Title, sURL, true, EXVersion, LEX_DocBasketDocumentAdded.format(Title),iType);\r\n    _EXAddDocumentToTransmittal(false, 'DL_sAMAccountName', 0, EXDocumentID, Title, sURL, true, EXVersion, '', iType, ctrl); // 26.2.2008\r\n    EXDocBasketRefresh(); // 26.2.2008\r\n}\r\nvar EXaddMetaData2CaseDocuments = false;\r\nfunction _EXAddDocumentToTransmittal(bCreate, DL_Entity, DL_Transmittal, EXDocumentID, Title, sURL, portal, EXVersion, sMsg, iType, ctrl) { // 3.1.2010 - ctrl added\r\n    if (typeof (ctrl) == 'undefined')\r\n        ctrl = false;\r\n    if (bCreate) {\r\n        DL_Transmittal = EXnewTransmittal(portal);\r\n        if (DL_Transmittal == '')\r\n            return;\r\n        SetRecentValue('DL_Transmittal', DL_Transmittal);\r\n    }\r\n\r\n    // already in case documents\r\n    var xDocuments;\r\n    //271111, JRD: Removed check on DocumentID\r\n    //  var sWhere = \"DL_EntityNameForeign='\" + DL_Entity + \"' AND DL_EntityId=\" + DL_Transmittal + \" AND DL_DocumentId='\" + EXDocumentID + \"' AND DL_ModifiedBy = %WUSER%\";\r\n    var sWhere = \"DL_EntityNameForeign='\" + DL_Entity + \"' AND DL_EntityId=\" + DL_Transmittal + \" AND DL_URLDocument='\" + sURL + \"' AND DL_ModifiedBy = %WUSER%\";\r\n    if (iType > 0) {\r\n        sWhere = sWhere + \" AND DL_URLDocument = '\" + sURL.replace(/'/g, \"''\") + \"'\";\r\n        //alert('_EXAddDocumentToTransmittal ' + iType + ' ' + sWhere);\r\n    }\r\n    xDocuments = getEntityData('DL_CaseDocuments', sWhere, \"\");\r\n    //if (xDocuments.text != \"\") {\r\n    if (getsafe(xDocuments, '//DL_Id') != '') { // 19.5.2010 - cross browser support\r\n        if (DL_Entity == 'DL_sAMAccountName')\r\n            alert(LEX_DocBasketAlreadyExists.format(Title));\r\n        else\r\n            alert(LEX_TransmittalAddCaseDocuments.format(DL_Entity, DL_Transmittal));\r\n        return;\r\n    }\r\n\r\n    // Add document to DL_CaseDocuments\r\n    xOps = '<DL_CaseDocuments><DELETE/><UPDATE/><INSERT>';\r\n    xOps = xOps + '<Row><DL_EntityNameForeign>' + DL_Entity + '</DL_EntityNameForeign><DL_EntityId>' + DL_Transmittal + '</DL_EntityId><DL_URLDocument>' + sURL + '</DL_URLDocument><DL_Title>' + Title + '</DL_Title><DL_DocumentId>' + EXDocumentID + '</DL_DocumentId>';\r\n    if (EXVersion != '')\r\n        xOps = xOps + '<DL_DocumentVersion>' + EXVersion + '</DL_DocumentVersion>';\r\n    if (ctrl) // 3.1.2010\r\n        xOps += '<DL_UseSpecificVersion>1</DL_UseSpecificVersion>';\r\n    // HINT - EX_DocProperties MUST be the last element in the xml dataset - if not it is ignored!!\r\n    if (EXaddMetaData2CaseDocuments) {\r\n        var oXML = EXgetDocumentMetaData(sURL);\r\n        if (oXML != null) {\r\n            xOps = xOps + '<EX_DocProperties>' + MakeXMLSafe(oXML.xml) + '</EX_DocProperties>';\r\n        }\r\n    }\r\n    xOps = xOps + '</Row></INSERT></DL_CaseDocuments>';\r\n    //alert(xOps);\r\n    setEntity('DL_CaseDocuments', xOps);\r\n    if (sMsg != '' && sMsg != null)\r\n        alert(sMsg);\r\n}\r\n\r\n\r\n\r\n// loadtransmittals\r\nfunction loadtransmittals(DL_Entity, EXDocumentID, portal) {\r\n    if (portal == 1) {\r\n        loadcontent(\"/ex_sqlsvc/DynamicListForm.aspx?DL_Entity=DL_CaseTransmittalsDocs&list=true&view=DL_Id,DL_Title&orderby=DL_Id%20DESC&Action=171&where=DL_DocumentId='\" + EXDocumentID + \"'\" + \"&EXcheck=\" + Math.random());\r\n    }\r\n    else {\r\n        window.open(getAbsoluteURL(\"/ex_sqlsvc/DynamicListForm.aspx?DL_Entity=DL_CaseTransmittalsDocs&list=true&view=DL_Id,DL_Title&orderby=DL_Id%20DESC&Action=156&where=DL_DocumentId='\" + EXDocumentID + \"'\" + \"&EXcheck=\" + Math.random()));\r\n    }\r\n}\r\n// setEntity\r\nfunction setEntity(strEntity, oEntity) {\r\n    try {\r\n        var xmldoc;\r\n        xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n        xmldoc = xmldoc + '<setEntity xmlns=\"http://doclife.net/svcDLEntity\">';\r\n        xmldoc = xmldoc + '<strEntity>' + strEntity + '</strEntity>';\r\n        xmldoc = xmldoc + '<oEntity>' + oEntity + '</oEntity>';\r\n        xmldoc = xmldoc + '</setEntity>';\r\n        xmldoc = xmldoc + '</soap:Body></soap:Envelope>';\r\n        //alert('setEntity ' + xmldoc);\r\n\r\n        FeedbackHTTP = EXXMLHTTP()\r\n        FeedbackHTTP.open(\"POST\", getAbsoluteURL('/EX_SQLSVC/svcDLEntity.asmx?op=setEntity'), false);  // 31.5.2008\r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", 'http://doclife.net/svcDLEntity/setEntity');\r\n        FeedbackHTTP.send(xmldoc);\r\n        //alert(FeedbackHTTP.responseText);\r\n        //alert('setEntity completed');\r\n        if (FeedbackHTTP.status != 200) {\r\n            alert('setEntity ' + FeedbackHTTP.status + ' ' + FeedbackHTTP.ResponseText);\r\n        }\r\n        return true;\r\n    }\r\n    catch (e) {\r\n        alert('setEntity(' + strEntity + ',' + oEntity + ') failed ' + e.message);\r\n        return false;\r\n    }\r\n}\r\n\r\n\r\n// setEntityDetail\r\nfunction setEntityDetail(strEntity, oEntity) {\r\n    try {\r\n        var xmldoc;\r\n        xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n        xmldoc = xmldoc + '<setEntityDetail xmlns=\"http://doclife.net/svcDLEntity\">';\r\n        xmldoc = xmldoc + '<strEntity>' + strEntity + '</strEntity>';\r\n        xmldoc = xmldoc + '<oEntity>' + oEntity + '</oEntity>';\r\n        xmldoc = xmldoc + '</setEntityDetail>';\r\n        xmldoc = xmldoc + '</soap:Body></soap:Envelope>';\r\n        //alert('setEntityDetail ' + xmldoc);\r\n\r\n        FeedbackHTTP = EXXMLHTTP()\r\n        FeedbackHTTP.open(\"POST\", getAbsoluteURL('/EX_SQLSVC/svcDLEntity.asmx?op=setEntityDetail'), false);\r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", 'http://doclife.net/svcDLEntity/setEntityDetail');\r\n        FeedbackHTTP.send(xmldoc);\r\n        //alert(FeedbackHTTP.ResponseText);\r\n        var xmlParamDoc;\r\n        if (FeedbackHTTP.status != 200)\r\n            alert('setEntityDetail(' + strEntity + ',' + oEntity + ') >>> ' + FeedbackHTTP.status + ' ' + FeedbackHTTP.responseText);\r\n        // 10.5.2012 - re-active code as it fails at AddPro\r\n        xmlParamDoc = EXDOMDocument();\r\n        xmlParamDoc.loadXML(FeedbackHTTP.responseText);\r\n        FeedbackHTTP = null;\r\n        var DL_Id;\r\n        DL_Id = getsafe(xmlParamDoc, \"//\" + strEntity + \"/DL_Id\");\r\n        xmlParamDoc = null;\r\n        //    DL_Id = getsafe(FeedbackHTTP.responseXML, \"//\" + strEntity + \"/DL_Id\"); // 12.7.2011\r\n        //alert('DL_Id=' + DL_Id);\r\n        return DL_Id;\r\n    }\r\n    catch (e) {\r\n        alert('setEntityDetail(' + strEntity + ',' + oEntity + ') failed ' + e.message);\r\n        return null;\r\n    }\r\n}\r\n\r\n\r\n// getsafe(xNode, XPath)\r\nfunction getsafe(xNode, XPath) {\r\n    if (xNode == null)\r\n        return '';\r\n    var xN;\r\n    xN = xNode.selectSingleNode(XPath);\r\n    if (xN == null) {\r\n        return '';\r\n    }\r\n    if (xN.firstChild == null)\r\n        return '';\r\n    if (xN.firstChild.nodeValue != null) // 25.7.2011\r\n        return xN.firstChild.nodeValue; // 16.5.2010 - Safari and general support\r\n    return xN.firstChild.text;\r\n    return xN.text;\r\n}\r\n\r\n\r\n/********************************************************************\r\n*                                                                  *\r\n*  EXWEB functions - SPS 2003                                      *\r\n*                                                                  *\r\n********************************************************************/\r\nfunction EXSetProperty(sField, sValue) {\r\n    try {\r\n        var oEle = EXgetField(sField);\r\n        if (oEle != null) {\r\n            oEle.value = sValue;\r\n        }\r\n    }\r\n    catch (e) { alert('EXSetProperty ' + e.message); }\r\n}\r\nfunction EXProtectEXDocumentID(i) {\r\n    try {\r\n        //var EXDocumentID = document.getElementById('urn:schemas-microsoft-com:office:office#EXDocumentID');\r\n        var EXDocumentID = EXgetField('EXDocumentID');\r\n        if (EXDocumentID == null) {\r\n            alert('EXDocumentID not found - critical error');\r\n        }\r\n        EXDocumentID.readOnly = true;\r\n\r\n        var oEleMultiple = document.getElementById('diidIOUploadMultipleLink');\r\n        if (oEleMultiple) {  // Hide row\r\n            oEleMultiple.style.display = 'none';\r\n        }\r\n    } catch (e) { alert('EXProtectEXDocumentID failed'); }\r\n}\r\nfunction EXhandlechange(e) {\r\n    var oEle;\r\n    oEle = document.getElementById('onetidIOFile');\r\n    var s, i;\r\n    s = oEle.value;\r\n    i = s.lastIndexOf('.');\r\n    s = s.substring(i + 1);\r\n    s = s.toLowerCase();\r\n    if (s != 'pdf') {\r\n        // <INPUT type=file ...> ***CANNOT*** be modified\r\n        alert('Only PDF documents can be uploaded ' + s);\r\n        //oEle.disabled = true;\r\n        //alert(oEle.value);\r\n    }\r\n    else { // 20/9-2006 - MMQ - parse properties based on filename\r\n        if (oEXDocLibFunction.bAddExtraUploadButton) {\r\n            BWSCParseFileName(oEle.value);\r\n        }\r\n    }\r\n    //else\r\n    //  oEle.disabled = false;\r\n    //alert('handlechange - ' + oEle.value);\r\n}\r\n\r\nfunction EXhandleIMG(e) {\r\n    var sMessage;\r\n    sMessage = 'start';\r\n    try {\r\n        var oImg = window.event.srcElement;\r\n        var sID = oImg.id.substring(3);\r\n        sMessage = 'ID ' + sID;\r\n        //alert(sID + ' clicked');\r\n        var oXML;\r\n        //oXML = EXaddDropDown(1); // Retrieve XML structure\r\n        var sDID = sID.replace('_x0020_', ' ');\r\n        sMessage = 'EXgetFormMetaData';\r\n        oXML = EXgetFormMetaData();\r\n        sMessage = 'EXShowForm ' + sID;\r\n        EXShowForm(sID, sDID, oXML);\r\n        return;\r\n        //alert('now open');\r\n        var oField;\r\n        //oField = document.getElementById('urn:schemas-microsoft-com:office:office#' + sID);\r\n        oField = EXgetField(sID);\r\n        oField.id = sID;\r\n        //alert(oField.outerHTML);\r\n        var sPath;\r\n        sPath = getAbsoluteURL('/EX_SQLSVC/PickDictionary.aspx?DL_PropName=') + sID + '&returnfield=_ctl1.' + sID + '&SPS=true'; //&XML=' + oXML;\r\n        //sPath = 'http://www.dr.dk';\r\n        //alert('sPath=' + sPath);\r\n        var oW;\r\n        sMessage = 'oW';\r\n        oW = window.open(sPath); //,'Pick a value'); //,'width=500,height=150');\r\n        //alert('ok');\r\n        sMessage = 'focus';\r\n        oW.focus();\r\n    } catch (e) { alert('EXhandleIMG failed ' + e.message + ' ' + sMessage); }\r\n}\r\n\r\nfunction EXgetField(field) {\r\n    try {\r\n        return (document.getElementById('urn:schemas-microsoft-com:office:office#' + field));\r\n    } catch (e) { alert('EXgetField(' + field + ') ' + e.message); }\r\n}\r\nfunction EXgetFieldValue(field) {\r\n    var oField, value;\r\n    oField = EXgetField(field);\r\n    if (oField == null)\r\n        value = '';\r\n    else {\r\n        value = oField.value;\r\n        oField = null;\r\n    }\r\n    return value\r\n}\r\n\r\nfunction EXgetDocumentMetaData(url) {\r\n    try {\r\n        var xmldoc;\r\n        xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>'\r\n        xmldoc = xmldoc + '<getDocumentMetaData xmlns=\"http://exformatics.net/SharePointServices\">';\r\n        xmldoc = xmldoc + '<URL>' + url + '</URL>'\r\n        xmldoc = xmldoc + '</getDocumentMetaData></soap:Body></soap:Envelope>';\r\n\r\n        SOAPAction = 'http://exformatics.net/SharePointServices/getDocumentMetaData';\r\n        FeedbackHTTP = EXXMLHTTP();\r\n        FeedbackHTTP.open(\"POST\", getAbsoluteURL('/EX_SPSSVC/svcSharePoint.asmx?op=getDocumentMetaData'), false);\r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", SOAPAction);\r\n        FeedbackHTTP.send(xmldoc);\r\n\r\n        // alert('headers ' + FeedbackHTTP.getAllResponseHeaders() );\r\n        // alert('Status ' + FeedbackHTTP.responseXML);\r\n        var oXML;\r\n        //oXML = FeedbackHTTP.responseXML.xml;\r\n        oXML = FeedbackHTTP.responseXML;\r\n        // alert(oXML);\r\n        // alert('EXgetDocumentMetaData ' + FeedbackHTTP.ResponseText + ' ' + oXML.xml);\r\n        FeedbackHTTP = null;\r\n        return oXML;\r\n    }\r\n    catch (e) { alert('EXgetDocumentMetaData ' + e.message); }\r\n}\r\n\r\nfunction ConvertFile2PDF(Url, subfolder) { // 12.3.2009\r\n    try {\r\n        var xmldoc;\r\n        xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n        xmldoc = xmldoc + '<ConvertFile2PDF xmlns=\"http://exformatics.net/SharePointServices\">';\r\n        xmldoc = xmldoc + '<Url>' + Url + '</Url>';\r\n        xmldoc = xmldoc + '<subfolder>' + subfolder + '</subfolder>';\r\n        xmldoc = xmldoc + '</ConvertFile2PDF>';\r\n        xmldoc = xmldoc + '</soap:Body></soap:Envelope>';\r\n\r\n        FeedbackHTTP = EXXMLHTTP()\r\n        FeedbackHTTP.open(\"POST\", '/EX_SPSSVC/svcSharePoint.asmx?op=ConvertFile2PDF', false);\r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", 'http://exformatics.net/SharePointServices/ConvertFile2PDF');\r\n        FeedbackHTTP.send(xmldoc);\r\n        return (getsafe(FeedbackHTTP.responseXML, '//ConvertFile2PDFResult') == 'true');\r\n    } catch (e) { alert('ConvertFile2PDF(' + Url + ',' + subfolder + ') failed ' + e.message); }\r\n}\r\nfunction getEXDocumentIDFromURL(url) {\r\n    var oXML;\r\n    url = getAbsoluteURL(url);\r\n    //alert('url=' + url);\r\n    oXML = EXgetDocumentMetaData(url);\r\n    // alert('getEXDocumentIDFromURL( ' + url + ')=' + oXML.xml);\r\n    if (oXML == null)\r\n        return null;\r\n    else\r\n        return oXML.selectSingleNode(\"//EXDocumentID\").text;\r\n}\r\nfunction EXValidateProperties(URL, xProperties) {\r\n    try {\r\n        var xmldoc;\r\n        xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n        xmldoc = xmldoc + '<ValidateProperties xmlns=\"http://exformatics.net/SharePointServices\">';\r\n        xmldoc = xmldoc + '<URL>' + URL + '</URL>';\r\n        xmldoc = xmldoc + '<xProperties>' + xProperties + '</xProperties>';\r\n        xmldoc = xmldoc + '</ValidateProperties></soap:Body></soap:Envelope>';\r\n        //alert(xmldoc);\r\n\r\n        var SOAPAction;\r\n        SOAPAction = 'http://exformatics.net/SharePointServices/ValidateProperties';\r\n        FeedbackHTTP = EXXMLHTTP();\r\n        FeedbackHTTP.open(\"POST\", getAbsoluteURL('/EX_SPSSVC/svcSharePoint.asmx?op=ValidateProperties'), false);\r\n        //    FeedbackHTTP.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", SOAPAction);\r\n        FeedbackHTTP.send(xmldoc);\r\n\r\n        //alert('EXValidateProperties1 = ' + FeedbackHTTP.responseText);\r\n        //var xmlResponse = new ActiveXObject(\"MSXML2.DOMDocument.4.0\");\r\n        //xmlResponse.async = false;\r\n        //xmlResponse.loadXML(FeedbackHTTP.responseText);\r\n        //FeedbackHTTP = null;\r\n        //alert('EXValidateProperties2 = ' + xmlResponse.xml);\r\n\r\n        var oXML;\r\n        oXML = FeedbackHTTP.responseXML.selectSingleNode(\"//ValidatePropertiesResult\");\r\n        //oXML = xmlResponse.selectSingleNode('.//ValidatePropertiesResult');\r\n        //oXML = xmlResponse.childNodes[1].childNodes[0].childNodes[0].childNodes[0];\r\n        //alert('EXValidateProperties3 = ' + oXML.xml);\r\n        return oXML;\r\n    } catch (e) { alert('EXValidateProperties(' + URL + ',' + xProperties + ') >>>' + e.message); };\r\n}\r\n\r\n\r\nfunction getEXDocumentID(i) {\r\n    try {\r\n        var xmldoc;\r\n        xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>'\r\n        xmldoc = xmldoc + '<getNextID xmlns=\"http://doclife.net/svcDLEntity\">';\r\n        xmldoc = xmldoc + '<strURN>DL_DocumentId</strURN>'\r\n        xmldoc = xmldoc + '</getNextID></soap:Body></soap:Envelope>';\r\n\r\n        SOAPAction = 'http://doclife.net/svcDLEntity/getNextID';\r\n        FeedbackHTTP = EXXMLHTTP();\r\n        FeedbackHTTP.open(\"POST\", getAbsoluteURL('/EX_SQLSVC/svcDLEntity.asmx?op=getNextID'), false);\r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", SOAPAction);\r\n        FeedbackHTTP.send(xmldoc);\r\n\r\n        var EXDocumentID;\r\n        EXDocumentID = FeedbackHTTP.responseXML.selectSingleNode(\"//getNextIDResult\").text;\r\n        FeedbackHTTP = null;\r\n        var i;\r\n        i = EXDocumentID.length;\r\n        if (i < 9) {\r\n            EXDocumentID = '000000000'.substr(0, 9 - i) + EXDocumentID;\r\n        }\r\n        //alert(EXDocumentID);\r\n        return EXDocumentID;\r\n    } catch (e) { alert('getEXDocumentID ' + e.message); };\r\n}\r\nfunction EXSetID(FileName, bFileExists) {\r\n    var sMessage = '';\r\n    try {\r\n        var EXDocumentID = document.getElementById('urn:schemas-microsoft-com:office:office#EXDocumentID');\r\n        if (EXDocumentID == null) {\r\n            alert('EXDocumentID not found - retry');\r\n            return false;\r\n        }\r\n        EXDocumentID.readOnly = false;\r\n        if (EXDocumentID.value == '') {\r\n            if (bFileExists) { // read DocumentID from existing file\r\n                // alert('file already exists FileName=' + FileName);\r\n                var sId;\r\n                sMessage = 'getId ' + FileName;\r\n                if (FileName == '') {\r\n                    var sFile = EXgetTargetFile();\r\n                    sMessage = 'getEXDocumentIDFromURL(' + sFile + ')';\r\n                    sId = getEXDocumentIDFromURL(sFile);\r\n                    sMessage = '2';\r\n                }\r\n                else\r\n                    sId = getEXDocumentIDFromURL(FileName);\r\n                // alert('file already exists with id=' + sId);\r\n                EXDocumentID.value = sId;\r\n                return true;\r\n            }\r\n            else { // Generate new id\r\n                var sId;\r\n                sMessage = 'getEXDocumentID';\r\n                sId = getEXDocumentID(0);\r\n                EXDocumentID.value = sId;\r\n                return true;\r\n            }\r\n        }\r\n        else {\r\n            return true;\r\n        }\r\n    } catch (e) { alert('EXSetID(' + bFileExists + ') - ' + sMessage + ' - failed ' + e.message); return false; }\r\n}\r\nfunction EXValidateForm() {\r\n    try {\r\n        // alert('EXValidateForm started');\r\n        var oXML, oResult;\r\n        if (exfrm == null) {\r\n            return true;\r\n        }\r\n        oXML = EXgetFormMetaData();\r\n        oResult = EXValidateProperties('url', oXML);\r\n        if (oResult == null) {\r\n            return true;\r\n        }\r\n\r\n        var ifld;\r\n        var fld;\r\n        var stName;\r\n        //alert('EXValidateForm - now traverse fields');\r\n        for (ifld = 0; ifld < exfrm.ifldMax; ifld++) {\r\n            fld = exfrm.rgfld[ifld];\r\n            stName = fld.stName;\r\n            //alert(ifld + ' ' + stName);\r\n            if (oResult.selectSingleNode('//' + stName) != null) {\r\n                //alert('field found ' + stName);\r\n                fld.FieldFocus();\r\n                alert(stName + ' ' + oResult.selectSingleNode('//' + stName).text);\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    } catch (e) { alert('EXValidateForm - ' + e.messsage); return false; }\r\n}\r\nfunction EXgetDocLibAndFolder() {\r\n    try {\r\n        //var oEleDestination = document.getElementById('destination'); // INPUT\r\n        //alert('DocLibAndFolder=' + oEleDestination.value);\r\n        //return oEleDestination.value;\r\n\r\n        var s, root, i;\r\n        s = '' + window.location;\r\n        root = unescapeProperly(queryString('RootFolder'));\r\n        i = s.indexOf('/Forms/Upload.aspx');\r\n        s = s.substring(0, i);\r\n        //alert('window.location=' + s + ' root=' + root);\r\n        if (root != '') {\r\n            i = s.substring(8).indexOf('/') + 8;\r\n            s = s.substring(0, i) + root;\r\n        }\r\n        //  alert('EXgetDocLibAndFolder=' + s);\r\n        return s;\r\n    } catch (e) { alert('EXgetDocLibAndFolder - ' + e.message); }\r\n}\r\n\r\nfunction EXURLExists(sURL) {\r\n    try {\r\n        if (sURL == '')\r\n            return false;\r\n\r\n        var FeedbackHTTP;\r\n        FeedbackHTTP = EXXMLHTTP();\r\n        FeedbackHTTP.open(\"HEAD\", sURL, false);\r\n        FeedbackHTTP.send();\r\n        var iStatus;\r\n        iStatus = FeedbackHTTP.status;\r\n        //alert(FeedbackHTTP.responseText);\r\n        //alert('EXURLExists(' + sURL + ')=' + iStatus);\r\n        FeedbackHTTP = null;\r\n        return (iStatus == 200);\r\n    } catch (e) { alert('EXURLExists(' + sURL + ') failed ' + e.message); }\r\n}\r\n\r\nfunction EXgetTargetFile() {\r\n    var oEleDestination = document.getElementById('destination'); // INPUT\r\n    //alert(oEleDestination.outerHTML);\r\n    //alert(oEleDestination.value);\r\n    var oEleFilename = document.getElementById('onetidIOFile') // INPUT\r\n    //alert(oEleFilename.outerHTML);\r\n    //alert(oEleFilename.value);\r\n    var Path, filename, i;\r\n    Path = oEleDestination.value;\r\n    filename = oEleFilename.value;\r\n\r\n    // Generic code start\r\n    // if (window['EXgetCustomFileName']) {\r\n    if (oEXDocLibFunction.EXgetCustomFileName != null) {\r\n        filename = oEXDocLibFunction.EXgetCustomFileName(filename, '');\r\n        return filename;\r\n    }\r\n    // Generic code end\r\n\r\n    i = filename.lastIndexOf('\\\\');\r\n    filename = filename.substring(i + 1);\r\n    // alert('EXgetTargetFile Target=' + Path + '/' + filename);\r\n    if (filename == '')\r\n        return '';\r\n    else\r\n        return Path + '/' + filename;\r\n}\r\nfunction EXFileExists() {\r\n    return EXURLExists(EXgetTargetFile());\r\n}\r\nfunction EXgetFormMetaData() {\r\n    var oXML;\r\n    oXML = '<data xmlns=\\'\\'>';\r\n    var ifld;\r\n    var fld;\r\n    var stName, stValue;\r\n    var oField;\r\n    if (exfrm == null) {\r\n        alert('EXgetFormMetaData - exfrm is null - remember to set this variable in DocLib');\r\n        return null;\r\n    }\r\n    for (ifld = 0; ifld < exfrm.ifldMax; ifld++) {\r\n        fld = exfrm.rgfld[ifld];\r\n        stName = fld.stName;\r\n        oField = document.getElementById('urn:schemas-microsoft-com:office:office#' + stName);\r\n        //oField = getField(stName);\r\n        if (oField == null)\r\n            alert('oField is null ' + stName);\r\n        else {\r\n            stValue = MakeXMLSafe(oField.value);\r\n            if (oField.tagName == 'SELECT') {\r\n                stValue = 'ID:' + stValue;\r\n                // alert('SELECT field found ' + stName + ' value is an ID value ' + stValue);\r\n            }\r\n            // Dictionary fields that has no value is not added in order to avoid to have to check them\r\n            if (stValue != '') {\r\n                oXML = oXML + '<' + stName + '>';\r\n                oXML = oXML + stValue;\r\n                oXML = oXML + '</' + stName + '>';\r\n            }\r\n        }\r\n    }\r\n    oXML = oXML + '</data>';\r\n    return oXML;\r\n}\r\n\r\nfunction EXBuildXML(stName, stValue) {\r\n    var oXML;\r\n    oXML = '<' + stName + '>';\r\n    oXML = oXML + MakeXMLSafe(stValue);\r\n    oXML = oXML + '</' + stName + '>';\r\n    return oXML;\r\n}\r\n\r\nfunction MakeXMLSafe(s) {\r\n    s = '' + s; // 22.7.2009\r\n    s = s.replace(/&/g, '&amp;');\r\n    s = s.replace(/</g, '&lt;');\r\n    s = s.replace(/>/g, '&gt;');\r\n    //JRD: 26-03-2011 START\r\n\r\n    s = s.replace(/\\\"/g, '&quot;');\r\n\r\n    s = s.replace(/\\'/g, '&apos;');\r\n\r\n    // JRD: 26-03-2011 END\r\n    return s;\r\n}\r\nfunction MakeJSSafe(s) {\r\n    if (s.indexOf('\\'') > 0) {\r\n        //alert(s);\r\n    }\r\n    s = s.replace(/'/g, '');\r\n    s = s.replace(/\"/g, '');\r\n    s = s.replace(/\\n/g, ''); // 2-7-2007 - remember to remove spaces\r\n    return s;\r\n}\r\nfunction EXgetExtensionCAB() {\r\n    var oObject = document.createElement('DIV');\r\n    oObject.id = 'EXExtensionDiv';\r\n    document.body.appendChild(oObject);\r\n    oObject = null;\r\n    var s = '<OBJECT id=\"EXmycontrol1\" name=\"EXmycontrol1\" classid=\"clsid:20B65F67-C8F5-4674-916C-0E03772BB0EC\" codebase=\"http://intranet/EX_Resources/ExformaticsWindowsExtension.CAB#5,4,0,0\" class1d=\"/EX_Resources/EXUtilities.dll#Exformatics.Utilities\" width=\"0px\" height=\"0px\"></OBJECT>\\n';\r\n    var oA = document.getElementById('EXExtensionDiv');\r\n    if (oA == null)\r\n        alert('EXgetExtensionCAB - critical error');\r\n    oA.innerHTML = s;\r\n    //alert('EXgetExtensionCAB - will install EXExtension - ' + oA.innerHTML);\r\n    oA = null;\r\n    var LEX_ExformaticsWindowsExtensionBeingInstalled = 'Exformatics Windows Extension is currently being installed - please wait a second for it to finish before you proceed';\r\n    alert(LEX_ExformaticsWindowsExtensionBeingInstalled);\r\n}\r\nfunction EXgetOfficeExtensionCAB() {\r\n    var oObject = document.createElement('DIV');\r\n    oObject.id = 'EXExtensionDiv2';\r\n    document.body.appendChild(oObject);\r\n    oObject = null;\r\n    var s = '<OBJECT id=\"EXmycontrol2\" name=\"EXmycontrol2\" classid=\"CLSID:CBFAE475-DBD8-45b7-9708-75D2B23DC8D6\" codebase=\"http://intranet/EX_Resources/ExformaticsOfficeExtension.CAB#5,5,0,0\" classi1d=\"EXOfficeExtension.Connect\" width=\"0px\" height=\"0px\"></OBJECT>\\n';\r\n    var oA = document.getElementById('EXExtensionDiv2');\r\n    if (oA == null)\r\n        alert('EXgetOfficeExtensionCAB - critical error');\r\n    oA.innerHTML = s;\r\n    //alert('EXgetOfficeExtensionCAB - will install EXOfficeExtension - ' + oA.innerHTML);\r\n    oA = null;\r\n    var LEX_ExformaticsOfficeExtensionBeingInstalled = 'Exformatics Office Extension is currently being installed - please wait a second for it to finish before you proceed';\r\n    alert(LEX_ExformaticsOfficeExtensionBeingInstalled + '\\n' + s);\r\n}\r\nfunction getEXSystemTray() {\r\n    try {\r\n        //var oX = new ActiveXObject(\"clsid:20B65F67-C8F5-4674-916C-0E03773BB0FC\");\r\n        var oX = new ActiveXObject(\"Exformatics.EXSystemTray\");\r\n        //var oX = GetObject(\"\", \"Exformatics.EXSystemTray\");\r\n        return oX;\r\n    } catch (e) {\r\n        alert('Exformatics System Tray - Not found >>> ' + e.message);\r\n    }\r\n    return null;\r\n}\r\nfunction getEXUtilities() {\r\n    var oX = null;\r\n\r\n    try {\r\n        oX = new ActiveXObject(\"Exformatics.Utilities\");\r\n        //alert('getEXUtilities Version=' + oX.Version);\r\n    } catch (e) {\r\n    }\r\n    try {\r\n        var oX1 = new ActiveXObject(\"ExformaticsOfficeExtension.AddinModule\");\r\n        oX = oX1.WindowsExtension;\r\n        //alert('getEXUtilities Version=' + oX.Version);\r\n    } catch (e) {\r\n        var sVer = navigator.userAgent.toLowerCase();\r\n        alert(\"Error: \" + e.message + \"\\nVersion=\" + sVer);\r\n        //alert(e.message);\r\n        if (sVer.indexOf('msie 7.') > 0) {\r\n            alert('Please download and install Exformatics Windows Extension manually');\r\n            return;\r\n        }\r\n        EXgetExtensionCAB();\r\n        oX = null;\r\n    }\r\n    if (oX == null) {\r\n        for (var i = 0; i < 100; i++) {\r\n            try {\r\n                oX = new ActiveXObject(\"Exformatics.Utilities\");\r\n                break;\r\n            } catch (e) {\r\n                //alert('Please download and install Exformatics Windows Extension manually');\r\n                var j = 2121212 / 2121 * i;\r\n            }\r\n        }\r\n    }\r\n    if (oX == null) {\r\n        alert('Please wait a second for Exformatics Windows Extension to be installed. If it fails retry the operation');\r\n        try {\r\n            oX = new ActiveXObject(\"Exformatics.Utilities\");\r\n        } catch (e) {\r\n            //alert('Please download and install Exformatics Windows Extension manually');\r\n        }\r\n    }\r\n    if (oX == null) {\r\n        alert(LEX_ExformaticsWindowsExtensionNotInstalled);\r\n        //var ew; ew=window.open('http://www.exformatics.com/support/EXExtension.html');\r\n        return null;\r\n    }\r\n    // Optionally - upgrade version if not the newest\r\n    if (1 == 0) { // oX.Version != '5.4.0.0') {\r\n        var LEX_ExformaticsWindowsExtensionPleaseUpgrade = 'Not newest version of Extension - now try to upgrade';\r\n        alert(LEX_ExformaticsWindowsExtensionPleaseUpgrade + '\\n' + oX.Version);\r\n        oX = null;\r\n        EXgetExtensionCAB();\r\n        try {\r\n            oX = new ActiveXObject(\"Exformatics.Utilities\");\r\n        } catch (e) {\r\n        }\r\n    }\r\n\r\n    if (oX == null) {\r\n        try {\r\n            var oX2 = new ActiveXObject(\"ExformaticsOfficeExtension.AddinModule\");\r\n            var oX = oX2.WindowsExtension;\r\n        }\r\n        catch (e) {\r\n            alert('New model tried but failed');\r\n        }\r\n\r\n    }\r\n\r\n    return oX;\r\n}\r\nfunction getEXOfficeExtension() {\r\n    var oX = null;\r\n    //alert('getEXOfficeExtension started');\r\n    try {\r\n        oX = new ActiveXObject(\"EXOfficeExtension.Connect\");\r\n        //alert('getEXUtilities Version=' + oX.Version);\r\n    } catch (e) {\r\n        alert('Now invoke EXgetOfficeExtensionCAB()');\r\n        EXgetOfficeExtensionCAB();\r\n        oX = null;\r\n    }\r\n    if (oX == null) {\r\n        for (var i = 0; i < 100; i++) {\r\n            try {\r\n                oX = new ActiveXObject(\"EXOfficeExtension.Connect\");\r\n                break;\r\n            } catch (e) {\r\n                //alert('Please download and install Exformatics Windows Extension manually');\r\n                var j = 2121212 / 2121 * i;\r\n            }\r\n        }\r\n    }\r\n    if (oX == null) {\r\n        alert('Please wait a second for Exformatics Office Extension to be installed. If it fails retry the operation');\r\n        try {\r\n            oX = new ActiveXObject(\"EXOfficeExtension.Connect\");\r\n        } catch (e) {\r\n            //alert('Please download and install Exformatics Office Extension manually');\r\n        }\r\n    }\r\n    if (oX == null) {\r\n        alert(LEX_ExformaticsOfficeExtensionNotInstalled);\r\n        //var ew; ew=window.open('http://www.exformatics.com/support/EXExtension.html');\r\n        return null;\r\n    }\r\n    // Optionally - upgrade version if not the newest\r\n    if (oX.Version != '5.4.2883.41713') {\r\n        var LEX_ExformaticsOfficeExtensionPleaseUpgrade = 'Not newest version of Office Extension - now try to upgrade';\r\n        alert(LEX_ExformaticsOfficeExtensionPleaseUpgrade + '\\n' + oX.Version);\r\n        oX = null;\r\n        EXgetOfficeExtensionCAB();\r\n        try {\r\n            oX = new ActiveXObject(\"EXOfficeExtension.Connect\");\r\n        } catch (e) {\r\n        }\r\n    }\r\n    return oX;\r\n}\r\nfunction oldgetEXUtilities() {\r\n    var oX = null;\r\n    try {\r\n        oX = new ActiveXObject(\"Exformatics.Utilities\");\r\n        // alert('getEXUtilities');\r\n    }\r\n    catch (e) {\r\n        alert(LEX_ExformaticsWindowsExtensionNotInstalled);\r\n        var ew; ew = window.open('http://www.exformatics.com/support/EXExtension.html');\r\n    }\r\n    return oX;\r\n}\r\nfunction EXUpload(filename, sDocLibPath, newfilename, properties) {\r\n    try {\r\n        var oX = getEXUtilities();\r\n        if (!oX)\r\n            return false;\r\n\r\n        var s;\r\n        s = oX.Upload(filename, sDocLibPath, newfilename, properties);\r\n        oX = null;\r\n        if (s != '') {\r\n            alert(s);\r\n            return false;\r\n        }\r\n        else\r\n            return true;\r\n    } catch (e) { alert('EXUpload failed - check extensionerr.txt in %temp% folder >>> ' + e.message); } // 15.2.2008\r\n}\r\nfunction EXReload() {\r\n    if (parent)\r\n        parent.window.location = parent.window.location;\r\n    else\r\n        window.location = window.location;\r\n}\r\nfunction EXGotoUrl(url, bparent) { // 25.8.2009 - 09-0205 - performance - memory leak\r\n    //  alert('EXGotoUrl ' + url);\r\n    if (bparent) {\r\n        if (parent.window) {\r\n            //parent.window.location = url;\r\n            parent.window.location.replace(url);\r\n        }\r\n        else {\r\n            //window.location = url;\r\n            window.location.replace(url);\r\n        }\r\n    }\r\n    else {\r\n        //window.location = url;\r\n        window.location.replace(url);\r\n    }\r\n}\r\n\r\n\r\nfunction viewImage(url) {\r\n\r\n    var theImage = document.getElementById(\"the-display-image\");\r\n    var jqImg = $(theImage);\r\n    theImage.src = url;\r\n    var dlg = $(\"#display-image\");\r\n\r\n    dlg.dialog({\r\n        modal: true,\r\n        title: \"Image view (press Esc to close)\",\r\n        width: 800,\r\n        height: 600,\r\n        open: function (event, ui) {\r\n            $(this).parents(\".ui-dialog:first\").find(\".ui-widget-header\").css('background', '#99b0c5');\r\n            $(this).parents(\".ui-dialog:first\").find(\".ui-widget-header\").css('border-color', '#33618b');\r\n        }\r\n    });\r\n\r\n    dlg.dialog(\"open\");\r\n\r\n    if (theImage.width > 600) {\r\n        theImage.width = 600;\r\n        theImage.onclick = function () { window.open(theImage.src); };\r\n        jqImg.mouseover(function () { $(this).css('cursor', 'hand'); });\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\nfunction EXLoadActivityStream(DLEntity, DLId, bFollowing, DLType) { // 16.4.2012\r\n    if (typeof (DLEntity) == 'undefined')\r\n        DLEntity = '';\r\n    if (typeof (DLId) == 'undefined')\r\n        DLId = '';\r\n    if (typeof (bFollowing) == 'undefined')\r\n        bFollowing = false;\r\n    if (typeof (DLType) == 'undefined')\r\n        DLType = '';\r\n\r\n    var oIF = document.getElementById('DL_Information');\r\n    //alert(oIF.width + '\\n' + oIF.clientWidth);\r\n    //var sUrl = getAbsoluteURL('/EX_ActivityStream/Default.aspx?ViewPortWidth=' + (DLId != '' ? '374' : '405'));\r\n    var sUrl = getAbsoluteURL('/EX_ActivityStream/Default.aspx?ViewPortWidth=' + oIF.clientWidth); // scrollbar width - 18px ?\r\n    // 2.9.2012 - due to error in new stream\r\n    //var sUrl = getAbsoluteURL('/EX_Resources/EXExformation.html?x=y');\r\n    if (DLEntity != '')\r\n        sUrl += '&DL_EntityNameForeign=' + DLEntity;\r\n    if (DLId != '')\r\n        sUrl += '&DL_EntityId=' + DLId;\r\n    if (bFollowing == 'team')\r\n        sUrl += '&Following=team';\r\n    else if (bFollowing)\r\n        sUrl += '&Following=true';\r\n    if (DLType != '') {\r\n        sUrl += '&DLType=' + DLType;\r\n    }\r\n    loadcontent2(sUrl, LEX_KnowledgeExchanges);\r\n}\r\nfunction EXLoadAdvancedSearch(Entity) { // 7.12.2014\r\n    var sWhere = 'DL_EntityNameForeign = \\'' + Entity + '\\'';\r\n    var oXML = getEntityData('DL_D617', sWhere, '');\r\n    var url = getsafe(oXML, '//DL_URLSearch');\r\n    if (url == '')\r\n        alert('DL_SearchURL in DL_D617 is empoty for ' + Entity + '. Please contact Administrator' + oXML.xml);\r\n    EXGotoUrl(url);\r\n\r\n}\r\nfunction EXLoadQuickSearch(Entity, bSearchOnLoad, ForeignKey, ForeignValue, PortalType, bInitMainEntity, sParams) { // 1.9.2008 - bInitMainEntity added - set to true if form should be opened in DL_Information web part // 17.12.2010 - sParams tilføjet\r\n    if (typeof (sParams) == 'undefined')\r\n        sParams = '';\r\n    if (typeof (PortalType) == 'undefined' || PortalType == null)\r\n        PortalType = '';\r\n    if (typeof (bInitMainEntity) == 'undefined' || bInitMainEntity == null)\r\n        bInitMainEntity = false;\r\n    var sWhere = 'DL_EntityNameForeign = \\'' + Entity + '\\'';\r\n    if (PortalType != '')\r\n        sWhere = sWhere + ' AND DL_PortalType = ' + PortalType;\r\n    var oXML = getEntityData('DL_D617', sWhere, '');\r\n    var url = getsafe(oXML, '//DL_QuickSearch');\n\t \r\n    //alert(sWhere + '\\n' + oXML.xml);\r\n    if (url == '') {\r\n        alert('EXLoadQuickSearch(' + Entity + ',' + bSearchOnLoad + ',' + ForeignKey + ',' + ForeignValue + ') object not defined in DL_D617 - please contact administrator');\r\n        return;\r\n    }\r\n    if (bSearchOnLoad)\r\n        url = url + '&SearchOnLoad=true';\r\n    if (sParams != '')\r\n        url = url + '&' + sParams;\r\n    //alert('EXLoadQUickSearch url=' + url);\r\n    if (ForeignKey != '' && ForeignKey != null) {\r\n        if (url.indexOf('%' + ForeignKey) > 0)\r\n            url = url.replace('%' + ForeignKey + '%', ForeignValue);\r\n        else if (url.indexOf(ForeignKey) > 0) { // 26.9.2012\r\n            var ii = url.indexOf(ForeignKey);\r\n            url = url.substr(0, ii + ForeignKey.length) + ':' + ForeignValue + url.substr(ii + ForeignKey.length);\r\n        }\r\n    }\r\n    //alert('EXLoadQUickSearch url=' + url);\r\n    if (url != '') {\r\n        //if (false) {//(\r\n        if (!bInitMainEntity) { // 16.8.2008\r\n            if (url.indexOf('Rows=') == -1) // 29.12.2008\r\n                url += '&Rows=30';\r\n            if (true) {\r\n                // 6.11.2015 - use JQuery dialog\r\n                var oDiv = document.getElementById('EXDialog');\r\n                if (oDiv == null) {\r\n                    var oDiv = document.createElement('DIV');\r\n                    oDiv.id = 'EXDialog';\r\n                    oDiv.innerHTML = '<IFRAME id=\"IFRAMEFACET\" frameboder=\"0\" width=\"100%\" height=\"100%\"></IFRAME>';\r\n                    document.body.appendChild(oDiv);\r\n                }\r\n                loadcontent(url, 'IFRAMEFACET', '');\r\n                $(\"#EXDialog\").dialog({\r\n                    resizable: true,\r\n                    autoOpen: true,\r\n                    modal: true,\r\n                    width: 900,\r\n                    height: 900,\r\n                    title: LEX_QuickSearchTitle + ' ' + EXgetEntityTitle(Entity).toLowerCase(),\r\n                    buttons: {\r\n                        'Close': function () {\r\n                            $(this).dialog('close');\r\n                        }\r\n                    }//end buttons\r\n                }); //end dialog\r\n\r\n            }\r\n            else {\r\n                var oQSIFrame = document.getElementById('IFRAMEQS');\r\n                if (oQSIFrame == null) {\r\n                    var oIFrame = document.createElement('IFRAME');\r\n                    oIFrame.id = 'IFRAMEQS';\r\n                    oIFrame.style.width = '200px';\r\n                    oIFrame.style.height = '200px';\r\n                    oIFrame.style.zIndex = '3';\r\n                    oIFrame.style.position = 'absolute';\r\n                    oIFrame.frameborder = 0;\r\n                    document.body.appendChild(oIFrame);\r\n                    oIFrame = null;\r\n\r\n                    var oDiv = document.createElement('DIV');\r\n                    oDiv.style.position = 'absolute';\r\n                    oDiv.id = 'DIVHeaderQS';\r\n                    oDiv.style.zIndex = '4';\r\n                    document.body.appendChild(oDiv);\r\n\r\n                    oDiv = document.createElement('DIV');\r\n                    oDiv.style.position = 'absolute';\r\n                    oDiv.id = 'DIVQS';\r\n                    oDiv.style.zIndex = '2';\r\n                    document.body.appendChild(oDiv);\r\n                    oQSIFrame = document.getElementById('IFRAMEQS');\r\n                }\r\n                var oQSDiv = document.getElementById('DIVQS');\r\n                var oQSHeaderDiv = document.getElementById('DIVHeaderQS');\r\n                var h, w;\r\n                w = document.body.clientWidth;\r\n                h = document.body.clientHeight;\r\n\r\n                oQSHeaderDiv.style.backgroundColor = '#dddddd'; //06.01.2009 Jw Changed color\r\n                //oQSHeaderDiv.style.filter = 'alpha(opacity=7)';\r\n                oQSHeaderDiv.style.display = '';\r\n\r\n                oQSDiv.style.left = 0;\r\n                oQSDiv.style.top = 0;\r\n                oQSDiv.style.width = w;\r\n                oQSDiv.style.height = h;\r\n                oQSDiv.style.backgroundColor = 'blue';\r\n                //oQSDiv.style.opacity = 0.8;\r\n                oQSDiv.style.filter = 'alpha(opacity=9)';\r\n                oQSDiv.style.display = '';\r\n\r\n                var oIF = document.getElementById('DL_Information');\r\n                if (oIF != null) {\r\n                    w = w - getElementLeft1(oIF);\r\n                }\r\n\r\n                h = h - 120;\r\n                if (oIF == null) // 29.12.2008 - only subtract if we could not find element\r\n                    w = w - 100;\r\n                oQSHeaderDiv.style.height = '20px';\r\n                oQSHeaderDiv.style.width = w;\r\n                if (oIF != null) {\r\n                    oQSHeaderDiv.style.top = getElementTop1(oIF) - 20;\r\n                    oQSHeaderDiv.style.left = getElementLeft1(oIF);\r\n                }\r\n                else {\r\n                    oQSHeaderDiv.style.top = 60;\r\n                    oQSHeaderDiv.style.left = 50;\r\n                }\r\n                oQSHeaderDiv.innerHTML = '<table><tr align=\"right\"><td width=\"' + (w - 24) + 'px\"></td><td align=\"right\" title=\"Luk...\"><a href=\"javascript:EXQSDIVClose()\"><img src=\"/EX_Resources/gif/16x16/Checkbox Crossed.gif\" border=\"0\"></a></td></tr></table>';\r\n\r\n                if (oIF != null) {\r\n                    oQSIFrame.style.left = getElementLeft1(oIF);\r\n                    oQSIFrame.style.top = getElementTop1(oIF);\r\n                }\r\n                else {\r\n                    oQSIFrame.style.left = 50;\r\n                    oQSIFrame.style.top = 80;\r\n                }\r\n                oQSIFrame.style.width = w;\r\n                oQSIFrame.style.height = h;\r\n                oQSIFrame.style.display = '';\r\n                oQSIFrame.src = url;\r\n            }\r\n} // 6.11.2015\r\n         else\r\n            loadcontent2(url, LEX_QuickSearchTitle + ' ' + EXgetEntityTitle(Entity).toLowerCase());  // 18.5.2012\r\n    }\r\n}\r\nfunction EXQSDIVClose() {\r\n    var oEle = document.getElementById('IFRAMEQS');\r\n    if (oEle != null)\r\n        oEle.style.display = 'none';\r\n    oEle = document.getElementById('DIVQS');\r\n    if (oEle != null)\r\n        oEle.style.display = 'none';\r\n    oEle = document.getElementById('DIVHeaderQS');\r\n    if (oEle != null)\r\n        oEle.style.display = 'none';\r\n}\r\nfunction EXGotoObjectFromURL(url) {\r\n    //alert('EXGotoObjectFromURL ' + url);\r\n    EXTryGotoURL(url);\r\n}\r\nfunction EXGotoOrDisplayObject(Entity, Id) {\r\n    if (Entity == 'DL_CaseDocuments') {\r\n        var oXML = getEntityData('DL_CaseDocuments', 'DL_Id = ' + Id, '');\r\n        var sUrl = getsafe(oXML, '//DL_URLDocument');\r\n        loadcontent(sUrl);\r\n    }\r\n    else\r\n        alert('EXGotoOrDisplayObject(' + Entity + ',' + Id + ') Unknown entity');\r\n}\r\nfunction EXGotoObjectExplorer(Entity, Id, DLEntity) {\r\n    if (DLEntity != '')\r\n        Entity = DLEntity;\r\n    if (Entity == '' || Id == '') {\r\n        alert('EXGotoObjectExplorer(' + Entity + ',' + Id + ') please specify data');\r\n        return;\r\n    }\r\n    var oXML = getEntityData2('Top 1 *', 'DL_D617', 'DL_EntityNameForeign = \\'' + Entity + '\\'', '');\r\n    var prop = getsafe(oXML, '//DL_Href');\r\n    SetRecentValue(prop, Id);\r\n    var oEntity = getEntityData2('*', Entity, 'DL_Id = ' + Id, '');\r\n    var DLFolderParams = getsafe(oEntity, '//DL_FolderParams');\r\n    EXGotoUrl(getAbsoluteURL('/EX_Resources/EXSharePointExplorer.html?DLEntity=' + Entity + '&' + prop + '=' + Id + '&DL_FolderParams=' + DLFolderParams), true);\r\n}\r\nfunction EXGotoCase(DLCaseNo, DLEntityNameForeign) { // 25.2.2008 - 2.6.2012 - updated with code from LO\r\n    if (typeof (DLEntityNameForeign) == 'undefined')\r\n        DLEntityNameForeign = '';\r\n    //alert('EXGotoCase(' + DLCaseNo + ',' + DLEntityNameForeign + ')');\r\n    var oXML;\r\n    if (DLCaseNo.indexOf('-') == -12) { // 29.9.2008 // 31.12.2008 - remove this logic at LO\r\n        var s = EXGetTodaysDate();\r\n        if (DLCaseNo.length < 4)\r\n            DLCaseNo = '0' + DLCaseNo;\r\n        if (DLCaseNo.length < 4)\r\n            DLCaseNo = '0' + DLCaseNo;\r\n        if (DLCaseNo.length < 4)\r\n            DLCaseNo = '0' + DLCaseNo;\r\n        DLCaseNo = s.substr(2, 2) + '-' + DLCaseNo;\r\n    }\r\n    if (DLCaseNo.length >= 7) {\r\n        if (DLEntityNameForeign == '')\r\n            oXML = getEntityData('DL_CMAllView', 'DL_CaseNo = \\'' + DLCaseNo + '\\'', '');\r\n        else\r\n            oXML = getEntityData('DL_CMAllView', 'DL_CaseNo = \\'' + DLCaseNo + '\\' AND DL_EntityNameForeign=\\'' + DLEntityNameForeign + '\\'', '');\r\n    }\r\n    else\r\n        if (DLEntityNameForeign == '')\r\n            oXML = getEntityData('DL_CMAllView', 'DL_CaseNo LIKE \\'' + DLCaseNo + '%\\'', '');\r\n        else\r\n            oXML = getEntityData('DL_CMAllView', 'DL_CaseNo LIKE \\'' + DLCaseNo + '%\\' AND DL_EntityNameForeign=\\'' + DLEntityNameForeign + '\\'', '');\r\n    var sEntity = getsafe(oXML, '//DL_EntityNameForeign');\r\n    var sId = getsafe(oXML, '//DL_EntityId');\r\n    //alert('EXGotoCase(' + DLCaseNo + ') Entity=' + sEntity + ' Id=' + sId);\r\n    if (sEntity != '' && sId != '')\r\n        EXGotoObject(sEntity, sId);\r\n    else { // 9.9.2008\r\n        alert(LEXCannotFindCase.format(DLCaseNo));\r\n    }\r\n}\r\n\r\nvar bGlobalPortalPreferences = false; // 8.5.2009 - use portal preferences in function for each user - or simply ignore (FKIL, CorpNordic uses this - others don't)\r\nfunction EXGotoObject(Entity, Id, bSearch, where, PortalType, bNewWindow, sTask) {\r\n    //alert('DEBUG\\nEXGotoObject ' + Entity + ' ' + Id);\r\n    try {\r\n        if (window.event) // 23.10.2008\r\n        //if (window.event.ctrlKey && !bNewWindow)\r\n            if (window.event.shiftKey && !bNewWindow) // 12.2.2010\r\n                bNewWindow = true;\r\n\tif (!bNewWindow){\r\n\t\tCreateOverlay();\r\n\t}\r\n        if (typeof (PortalType) == 'undefined' || PortalType == null)\r\n            PortalType = ''; // 14.4.2008\r\n        //var UserPreference = GetEntityItemWhere('DL_sAMAccountName','DL_sAMAccountName = %DL_sAMAccountName%','DL_PortalPreference');\r\n        var UserPreference = '';\r\n        if (bGlobalPortalPreferences) {\r\n            var oUser = getEntityData('DL_sAMAccountName', 'DL_sAMAccountName = %DL_sAMAccountName%', '');\r\n            UserPreference = getsafe(oUser, '//DL_PortalPreference');\r\n            oUser = null;\r\n        }\r\n        if (Entity == 'DL_SecurityGroupMember') {\r\n            EXGotoUrl('/Pages/securityGroup.aspx?GroupId=' + Id + '&GroupName=' + bSearch, true);\r\n            return;\r\n        }\r\n        if (Entity == 'DL_Tasks') { // 12.4.2011\r\n            var oT = getEntityData('DL_Tasks', 'DL_Id = ' + Id, '');\r\n            sTask = Id;\r\n            Entity = getsafe(oT, '//DL_EntityNameForeign');\r\n            Id = getsafe(oT, '//DL_EntityId');\r\n            if (Entity == '') {\r\n                parent.loadentity('DL_Tasks', sTask);\r\n                return;\r\n            }\r\n        }\r\n        var oObject;\r\n        if (typeof (where) == 'undefined' || where == null)\r\n            where = '';\r\n        if (Id == 0 && where == '') {\r\n            Id = GetRecentValue(prop); // 12.4.2011 - what is prop - strange!\r\n        }\r\n        if (Id == null || Id == '') {\r\n            oObject = getEntityData(Entity, where, '');\r\n            Id = getsafe(oObject, '//DL_Id');\r\n        }\r\n        else\r\n            oObject = getEntityData(Entity, 'DL_Id = ' + Id, '');\r\n        Id = getsafe(oObject, '//DL_Id');\r\n        //alert(Id);\r\n        if (Id == '') { // 1.10.2008 - no access\r\n            //var LEX_CannotGotoObjectProbablyNoAccess = 'Kan ikke g\\345 til objektet - du har formodentlig ikke adgang';\r\n            if (sTask != '') { // 22.1.2010 - IT Case 961\r\n                var oIF = document.getElementById('DL_Information');\r\n                var url = \"/EX_SQLSVC/DynamicForm.aspx?update=true&DL_ENTITY=DL_Tasks&where=DL_Id=\" + sTask + \"&EXcheck=\" + Math.random();\r\n                if (oIF == null) {\r\n                    window.open(getAbsoluteURL(url));\r\n                }\r\n                else\r\n                    loadentity('DL_Tasks', sTask, '', '', LEX_CannotGotoObjectProbablyNoAccess);\r\n            }\r\n            alert(LEX_CannotGotoObjectProbablyNoAccess);\r\n            oObject = null;\r\n            return;\r\n        }\r\n        /*\t\tvar prop;\r\n        var url;\r\n        if (Entity == 'DL_Activities' && !bSearch) { // 8.5.2009 - hard coded URL for some very highly used objects\r\n        prop = 'DL_Activities';\r\n        url = 'http://intranet/Activities/Pages/default.aspx?DL_Activities=%DL_Id%&DL_FolderParams=%DL_FolderParams%&DL_CaseNo=%DL_CaseNo%';\r\n        }\r\n        else { */\r\n        var D617Where = 'DL_EntityNameForeign=\\'' + Entity + '\\'';\r\n        if (UserPreference != '') {\r\n            D617Where = D617Where + ' AND isnull(DL_PortalPreference,0) = ' + UserPreference;\r\n        }\r\n        if (PortalType == '' || PortalType == null) {\r\n            //PortalType = GetEntityItemValue(Entity,Id,'DL_PortalType');\r\n            PortalType = getsafe(oObject, '//DL_PortalType');\r\n        }\r\n        if (PortalType != '') {\r\n            D617Where = D617Where + ' AND isnull(DL_PortalType,0) = ' + PortalType;\r\n        } // 1.4.2008 FKIL\r\n\r\n        //alert('D617Where: ' + D617Where);\r\n        var oXML = getEntityData2('*', 'DL_D617', D617Where, '');\r\n        var sParent = getsafe(oXML, '//DL_WFCaseEntity');\r\n        //alert(sParent);\r\n        if (sParent != '') {\r\n            D617Where = 'DL_Id = ' + Id;\r\n            var sId = GetEntityItemWhere(Entity, D617Where, getsafe(oXML, '//DL_PropNameForeign'));\r\n            //alert('Id modified from ' + Id + ' to ' + sId + ' where=' + D617Where);\r\n            if (sId != '') { // 21.3.2011 - only if value found we should do this\r\n                Id = sId;\r\n                Entity = sParent;\r\n                D617Where = 'DL_EntityNameForeign=\\'' + Entity + '\\'';\r\n                oXML = getEntityData2('*', 'DL_D617', D617Where, '');\r\n            }\r\n        }\r\n        prop = getsafe(oXML, '//DL_Href');\r\n        if (bSearch)\r\n            url = getsafe(oXML, '//DL_URLSearch');\r\n        else\r\n            url = getsafe(oXML, '//DL_URLPortal');\r\n        //\t\t}\r\n\r\n        SetRecentValue(prop, Id);\r\n        url = url.replace('%DL_Id%', Id);\r\n\r\n        // 6.4.2011 - year databases supported\r\n        if (url.indexOf('%0%') > -1 || url.indexOf('%1%') > -1 || url.indexOf('%2%') > -1) {\r\n            var DLFolderParams = getsafe(oObject, '//DL_FolderParams');\r\n            var aFolderParams = DLFolderParams.split('/');\r\n            url = url.replace('%0%', aFolderParams[0]);\r\n            url = url.replace('%1%', aFolderParams[1]);\r\n            url = url.replace('%2%', aFolderParams[2]);\r\n        }\r\n\r\n        if (url.indexOf('%') > -1) {\r\n            var xObj = oObject; // 8.5.2009 - don't retrieve two times - getEntityData2('*', Entity, sWhere,'');\r\n\r\n            var i, j, XPath;\r\n            i = url.indexOf('%');\r\n            j = url.substr(i + 1).indexOf('%');\r\n            XPath = url.substr(i + 1, j);\r\n            if (XPath == Entity)\r\n                sValue = getsafe(xObj, '//' + Entity + '/' + XPath);\r\n            else\r\n                sValue = getsafe(xObj, '//' + XPath);\r\n            url = url.replace('%' + XPath + '%', sValue);\r\n            if (url.indexOf('%') > -1) {\r\n                i = url.indexOf('%');\r\n                j = url.substr(i + 1).indexOf('%');\r\n                XPath = url.substr(i + 1, j);\r\n                sValue = getsafe(xObj, '//' + XPath);\r\n                url = url.replace('%' + XPath + '%', sValue);\r\n            }\r\n            if (url.indexOf('%') > -1) {\r\n                i = url.indexOf('%');\r\n                j = url.substr(i + 1).indexOf('%');\r\n                XPath = url.substr(i + 1, j);\r\n                sValue = getsafe(xObj, '//' + XPath);\r\n                url = url.replace('%' + XPath + '%', sValue);\r\n            }\r\n            if (url.indexOf('%') > -1) { // 1.4.2008 - FKIL - extra substitution\r\n                i = url.indexOf('%');\r\n                j = url.substr(i + 1).indexOf('%');\r\n                XPath = url.substr(i + 1, j);\r\n                sValue = getsafe(xObj, '//' + XPath);\r\n                url = url.replace('%' + XPath + '%', sValue);\r\n            }\r\n            xObj = null;\r\n        }\r\n        if (sTask != '' && sTask != null)\r\n            url = url + '&DL_Task=' + sTask;\r\n\r\n        //alert('EXGotoObject url=' + url + ' bNewWindow=' + bNewWindow);\r\n\r\n        oObject = null;\r\n        if (bNewWindow) {\r\n            window.open(url);\r\n            return; // 15.9.2010\r\n        }\r\n        else {\r\n            if (url.indexOf('javascript:') == 0) { // 10.8.2010\r\n                try {\r\n                    eval(url);\r\n                } catch (e) {\r\n                    alert('EXGotoObject url=' + url + ' >>> ' + e.message);\r\n                }\r\n            }\r\n            else\r\n                EXGotoUrl(url, true);\r\n        }\r\n        return true;\r\n    } catch (e) { \r\n\t\tif(e.message != ''){\r\n\t\t\t//13-02-2015: To avoid alert box when leaving page with some data altered in DynamicForm\r\n\t\t\talert('EXGotoObject ' + e.message); \r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction EXGotoObject2(Entity, Id, bSearch, where, PortalType, bNewWindow, sTask) {\r\n    //alert('EXGotoObject ' + Entity + ' ' + Id);\r\n    //alert('EXGotoObject ' + Entity + ' ' + Id);\r\n    try {\r\n        if (typeof (PortalType) == 'undefined' || PortalType == null) PortalType = ''; // 14.4.2008\r\n        //var UserPreference = GetEntityItemWhere('DL_sAMAccountName','DL_sAMAccountName = %DL_sAMAccountName%','DL_PortalPreference');\r\n        var oUser = getEntityData('DL_sAMAccountName', 'DL_sAMAccountName = %DL_sAMAccountName%', '');\r\n        var UserPreference = getsafe(oUser, '//DL_PortalPreference');\r\n        var oObject;\r\n        if (typeof (where) == 'undefined' || where == null)\r\n            where = '';\r\n        if (Id == 0 && where == '') {\r\n            Id = GetRecentValue(prop);\r\n        }\r\n        if (Id == null || Id == '') {\r\n            oObject = getEntityData(Entity, where, '');\r\n            Id = getsafe(oObject, '//DL_Id');\r\n        }\r\n        else\r\n            oObject = getEntityData(Entity, 'DL_Id = ' + Id, '');\r\n        Id = getsafe(oObject, '//DL_Id');\r\n        if (Id == '') { // 1.10.2008 - no access\r\n            //var LEX_CannotGotoObjectProbablyNoAccess = 'Kan ikke g\\345 til objektet - du har formodentlig ikke adgang';\r\n            alert(LEX_CannotGotoObjectProbablyNoAccess);\r\n            return;\r\n        }\r\n        var sWhere = 'DL_EntityNameForeign=\\'' + Entity + '\\'';\r\n        if (UserPreference != '') {\r\n            sWhere = sWhere + ' AND isnull(DL_PortalPreference,0) = ' + UserPreference;\r\n        }\r\n        if (PortalType == '' || PortalType == null) {\r\n            //PortalType = GetEntityItemValue(Entity,Id,'DL_PortalType');\r\n            PortalType = getsafe(oObject, '//DL_PortalType');\r\n        }\r\n        //else {sWhere = sWhere + ' AND DL_PortalType = \\'0\\'';}\r\n        if (PortalType != '') {\r\n            sWhere = sWhere + ' AND isnull(DL_PortalType,0) = ' + PortalType;\r\n        } // 1.4.2008 FKIL\r\n        //alert('sWhere: ' + sWhere);\r\n        var oXML = getEntityData2('*', 'DL_D617', sWhere, '');\r\n        var sParent = getsafe(oXML, '//DL_WFCaseEntity');\r\n        if (sParent != '') {\r\n            sWhere = 'DL_Id = ' + Id;\r\n            var sId = GetEntityItemWhere(Entity, sWhere, getsafe(oXML, '//DL_PropNameForeign'))\r\n            //alert('Id modified from ' + Id + ' to ' + sId + ' where=' + sWhere);\r\n            Id = sId;\r\n            Entity = sParent;\r\n            sWhere = 'DL_EntityNameForeign=\\'' + Entity + '\\'';\r\n            oXML = getEntityData2('*', 'DL_D617', sWhere, '');\r\n        }\r\n        //alert('EXGotoObject ' + oXML.xml);\r\n        var prop = getsafe(oXML, '//DL_Href');\r\n        if ((Id == null || Id == 0 || Id == '') && (where == null)) {\r\n            Id = GetRecentValue(prop);\r\n        }\r\n        else {\r\n            //      if (where != null)\r\n            SetRecentValue(prop, Id);\r\n        }\r\n        var url;\r\n        if (bSearch)\r\n            url = getsafe(oXML, '//DL_URLSearch');\r\n        else\r\n            url = getsafe(oXML, '//DL_URLPortal');\r\n        if (Id != null)\r\n            url = url.replace('%DL_Id%', Id);\r\n        //if (url == '')\r\n        //alert('EXGotoObject - SERIOUS ERROR ' + oXML.xml);\r\n        if (url.indexOf('%') > -1) {\r\n            var sWhere;\r\n            if (where == null || where == '')\r\n                sWhere = 'DL_Id = ' + Id;\r\n            else\r\n                sWhere = where;\r\n            //alert('gED ' + Entity + ' ' + sWhere + ' ' + Id);\r\n            var xObj = getEntityData2('*', Entity, sWhere, '');\r\n            if (where != null) {\r\n                Id = getsafe(xObj, '//DL_Id');\r\n                if (Id == null || Id == '')\r\n                    return false;\r\n                SetRecentValue(prop, Id);\r\n            }\r\n            url = url.replace('%DL_Id%', Id);\r\n            var i, j, XPath;\r\n            i = url.indexOf('%');\r\n            j = url.substr(i + 1).indexOf('%');\r\n            XPath = url.substr(i + 1, j);\r\n            if (XPath == Entity)\r\n                sValue = getsafe(xObj, '//' + Entity + '/' + XPath);\r\n            else\r\n                sValue = getsafe(xObj, '//' + XPath);\r\n            url = url.replace('%' + XPath + '%', sValue);\r\n            if (url.indexOf('%') > -1) {\r\n                i = url.indexOf('%');\r\n                j = url.substr(i + 1).indexOf('%');\r\n                XPath = url.substr(i + 1, j);\r\n                sValue = getsafe(xObj, '//' + XPath);\r\n                url = url.replace('%' + XPath + '%', sValue);\r\n            }\r\n            if (url.indexOf('%') > -1) {\r\n                i = url.indexOf('%');\r\n                j = url.substr(i + 1).indexOf('%');\r\n                XPath = url.substr(i + 1, j);\r\n                sValue = getsafe(xObj, '//' + XPath);\r\n                url = url.replace('%' + XPath + '%', sValue);\r\n            }\r\n            if (url.indexOf('%') > -1) { // 1.4.2008 - FKIL - extra substitution\r\n                i = url.indexOf('%');\r\n                j = url.substr(i + 1).indexOf('%');\r\n                XPath = url.substr(i + 1, j);\r\n                sValue = getsafe(xObj, '//' + XPath);\r\n                url = url.replace('%' + XPath + '%', sValue);\r\n            }\r\n        }\r\n        if (sTask != '' && sTask != null)\r\n            url = url + '&DL_Task=' + sTask;\r\n\r\n        if (window.event) // 23.10.2008\r\n        //if (window.event.ctrlKey && !bNewWindow)\r\n            if (window.event.shiftKey && !bNewWindow) // 12.2.2010\r\n                bNewWindow = true;\r\n        //alert('EXGotoObject url=' + url + ' bNewWindow=' + bNewWindow);\r\n        if (bNewWindow)\r\n            window.open(url);\r\n        else\r\n            EXGotoUrl(url, true);\r\n        return true;\r\n    } catch (e) { alert('EXGotoObject ' + e.message); }\r\n}\r\nfunction EXGotoUrlWSource(url) {\r\n    try {\r\n        url = url + GetSource();\r\n        // alert('EXGotoUrlWSource - ' + url);\r\n        EXGotoUrl(url);\r\n    } catch (e) { alert('EXGotoUrlWSource(' + url + ') failed ' + e.message); }\r\n}\r\nfunction EXgetCaseDocuments(DL_Entity, DL_Id) {\r\n    try {\r\n        var oX = getEXUtilities();\r\n        if (!oX)\r\n            return;\r\n\r\n        var s;\r\n        //      s = oX.Hello();\r\n        s = oX.getCaseDocuments(getAbsoluteURL(''), DL_Entity, DL_Id);\r\n        if (s != '' && s != null)\r\n            alert(s);\r\n        oX = null;\r\n        //return true;\r\n    } catch (e) { alert('EXgetCaseDocuments ' + e.message); };\r\n}\r\nfunction EXCreateMail(DL_Entity, DL_Id) {\r\n    try {\r\n        var objAddin;\r\n        objAddin = getOutlookAddIn();\r\n        var bResult;\r\n        if (objAddin == null) {\r\n            bResult = false;\r\n        }\r\n        else {\r\n            //alert('CreateMail - ' + DL_Entity + ' ' + DL_Id);\r\n            var sOperation;\r\n            sOperation = '<x><EXOperation>NewCaseEmail</EXOperation><DL_Entity>' + DL_Entity + '</DL_Entity><DL_Case>' + DL_Id + '</DL_Case><DL_Subject>New email</DL_Subject><Attachments>true</Attachments></x>';\r\n            bResult = objAddin.object.EXOperation(sOperation);\r\n            if (bResult == false) {\r\n                alert(LEX_OutAddInEmailCouldNotCreate.format(DL_Entity, DL_Id));\r\n            }\r\n        }\r\n        objAddin = null;\r\n    }\r\n    catch (e) { alert('EXCreateMail failed ' + e.message); }\r\n}\r\nfunction EXTrackMail(Folder, criteria, DLEntityNameForeign, DLEntityId) { // 11.3.2008 - FKIL\r\n    try {\r\n        var objAddin;\r\n        objAddin = getOutlookAddIn();\r\n        var bResult;\r\n        if (objAddin == null) {\r\n            return false;\r\n        }\r\n        objAddin.object.EXTrackMail(Folder, criteria, DLEntityNameForeign, DLEntityId);\r\n        objAddin = null;\r\n    }\r\n    catch (e) { alert('EXTrackMail failed ' + e.message); }\r\n}\r\nfunction EXBRMNewContact(DLCompanyID) { //, DLEntityNameForeign, DLEntityId) { // 2.6.2008\r\n    //newentity('DL_Contacts','DL_CompanyID,DL_EntityNameForeign,DL_EntityId',DLCompanyID + ',' + DLEntityNameForeign + ',' + DLEntityId);\r\n    var oXML = getEntityData2('min(DLContactID)-1 as DLContactID', 'DL_Contacts', '', '');\r\n    var DLContactID = 1 * getsafe(oXML, '//DLContactID'); // negative contactid\r\n    if (DLContactID >= 0)\r\n        DLContactID = -1;\r\n    //alert(DLContactID + ' ' + oXML.xml);\r\n    newentity('DL_Contacts', 'DL_CompanyID,DLContactID', DLCompanyID + ',' + DLContactID);\r\n}\r\nfunction EXBRMCreateMail(DL_Company, DL_Subject, DLEntityNameForeign, DLEntityId, DL_ToMail, bLinkAttachments) { // 7.2.2008\r\n    try {\r\n        var objAddin;\r\n        objAddin = getOutlookAddIn();\r\n        var bResult;\r\n        if (objAddin == null) {\r\n            bResult = false;\r\n        }\r\n        else {\r\n            var sOperation;\r\n            sOperation = '<x><EXOperation>NewCaseEmail</EXOperation>';\r\n            if (DL_Company != '') // BRM tracking\r\n                sOperation = sOperation + '<DL_Entity>DL_BRMConfig</DL_Entity><DL_Company>' + DL_Company + '</DL_Company>';\r\n            sOperation = sOperation + '<DL_EntityCaseDocuments>' + DLEntityNameForeign + '</DL_EntityCaseDocuments><DL_EntityId>' + DLEntityId + '</DL_EntityId><Attachments>true</Attachments>';\r\n            if (DL_Subject != '')\r\n                sOperation = sOperation + '<DL_Subject>' + MakeXMLSafe(DL_Subject) + '</DL_Subject>';\r\n            if (DL_ToMail != '')\r\n                sOperation = sOperation + '<DL_ToMail>' + MakeXMLSafe(DL_ToMail) + '</DL_ToMail>';\r\n            if (bLinkAttachments)\r\n                sOperation = sOperation + '<LinkAttachments>true</LinkAttachments>';\r\n            sOperation = sOperation + '</x>';\r\n            bResult = objAddin.object.EXOperation(sOperation);\r\n        }\r\n        // 24.6.2011 - bResult moved up\r\n        // bResult = objAddin.object.EXOperation(sOperation);\r\n        if (bResult == false) {\r\n            //var LEX_OutAddInEmailBRMCouldNotCreate = \"Could not create email for with attachments for company {0} to {1}\";\r\n            alert(LEX_OutAddInEmailBRMCouldNotCreate.format(DL_Company, DL_ToMail));\r\n        }\r\n        objAddin = null;\r\n    }\r\n    catch (e) { // 29.6.2009 - modified logic\r\n        if (e.message.indexOf(\"'object' \") > 0)\r\n            alert('EXBRMCreateMail failed - Outlook probably not started');\r\n        else\r\n            alert('EXBRMCreateMail failed ' + e.message);\r\n    }\r\n}\r\n// NOT USED ANYMORE\r\n/*\r\nfunction EXsendFile(filename, sDocLib, newfilename, xProperties) {\r\ntry {\r\nvar oDoc;\r\noDoc = new ActiveXObject(\"MSXML2.DOMDocument.4.0\");\r\noDoc.async = false;\r\nvar adoStream;\r\nadoStream = new ActiveXObject(\"ADODB.Stream\");\r\n//adoStream.Mode = 1; // read only , 3 read write <-- THIS property make the operation fail!!!\r\nadoStream.Type = 1; // adTypeBinary\r\nadoStream.open();\r\n//alert('EXsendFile invoked - ' + filename + ',' + sDocLib + ',' + newfilename + ' now LoadFromFile');\r\nadoStream.LoadFromFile(filename);\r\n//alert('LoadFromFile completed');\r\nvar URL;\r\nURL = sDocLib + filename.substr(filename.lastIndexOf(\"\\\\\")+1);\r\nif (newfilename == '')\r\nnewfilename = filename.lastIndexOf(\"\\\\\"+1);\r\n//alert('URL=' + URL);\r\nvar xmldoc;\r\nxmldoc='<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>'\r\nxmldoc = xmldoc + '<UploadDocument2 xmlns=\"http://exformatics.net/SharePointServices\">';\r\nxmldoc = xmldoc +'<xProperties>' + xProperties + '</xProperties>';\r\nxmldoc = xmldoc +'<URL>' + URL + '</URL>';\r\nxmldoc = xmldoc +'<FileName>' + newfilename + '</FileName>';\r\nxmldoc = xmldoc +'<docsize>' + adoStream.Size + '</docsize>';\r\nxmldoc = xmldoc +'<docbinaryarray></docbinaryarray>';\r\nxmldoc = xmldoc + '</UploadDocument2></soap:Body></soap:Envelope>';\r\n//alert(xmldoc);\r\n\r\noDoc.loadXML(xmldoc);\r\nvar oFile;\r\noFile = oDoc.selectSingleNode('//docbinaryarray');\r\noFile.dataType = \"bin.base64\";\r\noFile.nodeTypedValue = adoStream.Read(-1);//adoStream.Read(-1); // -1=adReadAll\r\n//var oDocSize;\r\n//oDocSize = oDoc.selectSingleNode('//docsize');\r\n//oDocSize.dataType = \"int\";\r\n//oDocSize.nodeTypedValue = '' + adoStream.Size;\r\n//alert(oDoc.xml);\r\n\r\nvar xmlhttp = EXXMLHTTP();\r\nxmlhttp.open(\"POST\", getAbsoluteURL('/EX_SPSSVC/svcSharePoint.asmx'), false);\r\nxmlhttp.setRequestHeader(\"Content-Type\",\"text/xml; charset=utf-8\");\r\n//xmlhttp.setRequestHeader(\"Content-Length\", oDoc.xml.length);\r\nxmlhttp.setRequestHeader(\"SOAPAction\", \"http://exformatics.net/SharePointServices/UploadDocument2\");\r\nxmlhttp.send(xmldoc);\r\nvar oResult;\r\noResult = xmlhttp.responseXML.selectSingleNode('//UploadDocument2Result');\r\nif (oResult == null) {\r\nalert('CRITICAL ERROR IN UPLOAD ' + xmlhttp.responseText);\r\n}\r\nelse {\r\nif (oResult.text == 'true') {\r\nalert(LEX_UploadFilesCompleted.format(''));\r\n}\r\nelse {\r\nalert(LEX_UploadFilesFailed.format(xmlhttp.responseText));\r\n}\r\n}\r\nxmlhttp = null;\r\n} catch (e) {alert('EXsendFile(' + filename + ',' + sDocLib + ') >>> ' + e.message); }\r\n}\r\n*/\r\n\r\n/********************************************************************\r\n*                                                                  *\r\n* Exformatics Outlook Extension Javascript                         *\r\n*                                                                  *\r\n********************************************************************/\r\n\r\n// getOutlook()\r\nfunction getOutlook() {\r\n    DebugAlert('Started', 100, 'EX_Resources.exformatics.js.getOutlook()');\r\n    var LEX_OutlookCouldNotStart = \"Outlook could not start. Please check your Internet Explorer securitysettings according to documentation!\";\r\n    var outlookApp = null; try {\r\n        // 06-06-2011 BH: Alteret to New ActiveXObject\r\n        outlookApp = new ActiveXObject(\"Outlook.Application\"); //GetObject(\"\", \"Outlook.Application\");\r\n    }\r\n    catch (e) {\r\n        DebugAlert('Error: Name: ' + e.name + '\\nMessage: ' + e.message + '\\nNumber: ' + e.number, 10, 'EX_Resources.exformatics.js.getOutlook()');\r\n        // 28-06-2011 BH: Found out, that if outlook is closing the new ActiveXObject will fail\r\n        if (e.number == -2147418111) {\r\n            DebugAlert('Trying to reload outlook', 50, 'EX_Resources.exformatics.js.getOutlook()');\r\n            wait(2000);\r\n            try {\r\n                outlookApp = new ActiveXObject(\"Outlook.Application\"); //GetObject(\"\", \"Outlook.Application\");\r\n            }\r\n            catch (e) {\r\n                alert(LEX_OutlookCouldNotStart);\r\n                outlookApp = null;\r\n            }\r\n        }\r\n        else {\r\n            alert(LEX_OutlookCouldNotStart);\r\n            outlookApp = null;\r\n        }\r\n    }\r\n    //\ttry {\r\n    //\t\tif (outlookApp == null) {\r\n    //\t\t\t//alert('Now ActiveXObject');\r\n    //\t\t    outlookApp = GetObject(\"\", \"Outlook.Application\");// new ActiveXObject(\"Outlook.Application\"); \r\n    //\t\t}\r\n    //\t} catch (e) {\r\n    //\t\t//alert(LEX_OutlookNotStarted + e.message) // 30.5.2011 - remove alert\r\n    //\t\toutlookApp = null;\r\n    //\t};\r\n    // 30.5.2011 - remove alert here - error handling moved to invoking function\r\n    if (outlookApp == null && false) {\r\n        alert(LEX_OutlookNotStarted);\r\n        window.open('http://www.exformatics.com/support/EXOutlookExtension.html');\r\n    }\r\n    return outlookApp;\r\n}\r\n// getOutlookAddIn()\r\nfunction getOutlookAddIn() {\r\n    DebugAlert('Started', 100, 'EX_Resources.exformatics.js.getOutlookAddin()');\r\n    var outlookApp;\r\n    var objAddin;\r\n    try {\r\n        outlookApp = getOutlook();\r\n        if (outlookApp == null) { // 30.5.2011 - IT Case 2186 - don't continue if Outlook not open - And don't alert this has happened once in the getOutlook\r\n            //alert('Could not get access to Outlook - please start');\r\n            return;\r\n        }\r\n        DebugAlert('Outlook loaded', 100, 'EX_Resources.exformatics.js.getOutlookAddin()');\r\n        //outlookApp = new ActiveXObject(\"DLRDocLife.DLRContactItem\");\r\n        //alert('Redemption loaded');\r\n        //outlookApp = outlookApp.Application;\r\n        //objAddin = new ActiveXObject(\"DocLifeExtensionforOutlookAddIn.Connect\"); // This works for security - but not for functionality :-(\r\n        //objAddin = GetObject(\"\", \"DocLifeExtensionforOutlookAddIn.Connect\"); // doesn't work - cannot find object :-(\r\n        //alert('Object loaded');\r\n        //\t\toutlookApp = objAddin.getApplication;\r\n        //alert('Now were ready');\r\n        //\t\tobjAddin = null;\r\n\r\n        for (i = 1; i <= outlookApp.COMAddIns.COunt; i++) {\r\n            DebugAlert('Comaddins: ' + outlookApp.COMAddIns.Item(i).ProgID, 200, 'EX_Resources.exformatics.js.getOutlookAddin()');\r\n            //DebugAlert('Comaddins: ', 200, 'EX_Resources.exformatics.js.getOutlookAddin()');\r\n        }\r\n        DebugAlert('Comaddins: ' + outlookApp.COMAddIns.COunt, 50, 'EX_Resources.exformatics.js.getOutlookAddin()');\r\n        objAddin = outlookApp.COMAddIns.Item(\"DocLifeExtensionforOutlookAddIn.Connect\"); // This works for functionality - but not for security\r\n        outlookApp = null;\r\n        //objAddin = new ActiveXObject(\"DocLifeExtensionforOutlookAddIn.Connect\"); // This works for security - but not for functionality :-(\r\n        //objAddin = GetObject(\"\", \"DocLifeExtensionforOutlookAddIn.Connect\"); // doesn't work - cannot find object :-(\r\n        //objAddin = GetObject(\"\", \"{CB5BDC81-93C1-11CF-8F20-00805F2CD064}\");\r\n    }\r\n    catch (e) {\r\n        // 06-10-2010 BH: Added ExformaticsOutlookAddIn.Connect Kept DocLifeExtensionforOutlookAddIn.Connect for backward compatibility\r\n        DebugAlert('Error1: ' + e.message, 100, 'EX_Resources.exformatics.js.getOutlookAddin()');\r\n        objAddin = null;\r\n        try {\r\n            objAddin = outlookApp.COMAddIns.Item(\"ExformaticsOutlookAddIn.Connect\");\r\n        }\r\n        catch (e2) {\r\n            DebugAlert('Error2: ' + e.message, 100, 'EX_Resources.exformatics.js.getOutlookAddin()');\r\n            objAddin = null;\r\n        }\r\n        if (objAddin == null) { // 6.4.2011\r\n            try {\r\n                objAddin = outlookApp.COMAddIns.Item(\"ExformaticsOfficeExtension.AddinModule\");   // 7.4.2011 mb\r\n            }\r\n            catch (e2) {\r\n                DebugAlert('Error3: ' + e.message, 100, 'EX_Resources.exformatics.js.getOutlookAddin()');\r\n                objAddin = null;\r\n            }\r\n        }\r\n    }\r\n    if (objAddin == null) {\r\n        alert(LEX_ExformaticsOutlookExtensionNotInstalled + e.message);\r\n        var ew; ew = window.open('http://www.exformatics.com/support/EXOutlookExtension.html');\r\n    }\r\n    outlookApp = null; // 16.2.2008 - ensure Outlook is released\r\n    DebugAlert('Return: ' + objAddin, 10, 'EX_Resources.exformatics.js.getOutlookAddin()');\r\n\r\n    return objAddin;\r\n}\r\n\r\nfunction getSecureOutlookAddIn() {\r\n    var objAddin;\r\n    try {\r\n        objAddin = new ActiveXObject(\"DocLifeExtensionforOutlookAddIn.Connect\"); // This works for security - but not for functionality :-(\r\n    }\r\n    catch (e) { objAddin = null; }\r\n    return objAddin;\r\n}\r\n// newphone\r\nfunction newphone(name, DL_Company) {\r\n    //\talert('newphone(' + name + ',' + DL_Company + ')');\r\n    newjournal(DL_Company, name, 'Phone call');\r\n}\r\n// newminute\r\nfunction newminute(name, DL_Company) {\r\n    newjournal(DL_Company, name, 'Meeting');\r\n    return false;\r\n}\r\n// newjournal\r\nfunction newjournal(DL_Company, name, type1) {\r\n    //\talert('newjournal(' + DL_Company + ',' + name + ',' + type1 + ')');\r\n    var outlookApp;\r\n    outlookApp = getOutlook();\r\n    if (outlookApp == null) {\r\n        outlookApp = null;\r\n    }\r\n    else {\r\n        var oItem;\r\n        oItem = outlookApp.CreateItem(4);\r\n        oItem.Companies = DL_Company;\r\n        oItem.Mileage = name;\r\n        oItem.Subject = name;\r\n        oItem.Type = type1;\r\n        oItem.StartTimer();\r\n        oItem.Display();\r\n        //alert('newjournal(' + DL_Company + ',' + name + ',' + type1 + ')');\r\n        outlookApp = null;\r\n    }\r\n    //alert('done');\r\n}\r\nfunction newappointment(DLEntity, DLEntityId, subject, location, recipient, dlmeetingtype) {\r\n    //\talert('newappointment(' + DLEntity + ',' + DLEntityId + ')');\r\n    var outlookApp;\r\n    outlookApp = getOutlook();\r\n    //dlmeetingtype=\"Test\";\r\n    if (outlookApp == null) {\r\n        outlookApp = null;\r\n    }\r\n    else {\r\n        var oItem;\r\n        oItem = outlookApp.CreateItem(1);\r\n        oItem.UserProperties.Add('DLMeeting', 1);\r\n        oItem.UserProperties('DLMeeting').Value = \"0\"; // Meeting not yet created\r\n        if (DLEntity != null) {\r\n            oItem.UserProperties.Add('DLEntity', 1);\r\n            oItem.UserProperties('DLEntity').Value = DLEntity;\r\n            oItem.UserProperties.Add('DLEntityId', 1);\r\n            oItem.UserProperties('DLEntityId').Value = '' + DLEntityId;\r\n        }\r\n        if (subject != null) // 23.4.2008\r\n            oItem.Subject = subject;\r\n        if (location != null) // 23.4.2008\r\n            oItem.location = location;\r\n        if (recipient != null) {\r\n            oItem.Recipients.Add(recipient)\r\n        }\r\n        if (dlmeetingtype != null) { // 2.6.2008\r\n            oItem.UserProperties.Add('DLMeetingType', 1);\r\n            oItem.UserProperties('DLMeetingType').Value = dlmeetingtype;\r\n            oItem.body = 'M\\370detype: ' + dlmeetingtype; // 5.6.2008\r\n        }\r\n        oItem.Display(); // 23.4.2008 - how do we get the \"signal\" back from Outlook to the browser?\r\n        oItem = null;\r\n        outlookApp = null;\r\n    }\r\n    //alert('done');\r\n}\r\nfunction newcasenotification(sTitle) { // 18.12.2009 - title added\r\n    if (typeof (sTitle) == 'undefined')\r\n        sTitle = '';\r\n    var outlookApp;\r\n    outlookApp = getOutlook();\r\n    if (outlookApp == null) {\r\n        outlookApp = null;\r\n    }\r\n    else {\r\n        try {\r\n            var oItem;\r\n            oItem = outlookApp.CreateItem(0);\r\n            oItem.Body = window.location.href;\r\n            if (sTitle != '')\r\n                oItem.Subject = sTitle;\r\n            oItem.Display();\r\n            //alert('newjournal(' + DL_Company + ',' + name + ',' + type1 + ')');\r\n            outlookApp = null;\r\n        }\r\n        catch (e) { alert('newcasenotification(' + sTitle + ')' + e.message); }\r\n    }\r\n    //alert('done');\r\n}\r\nfunction newcaseemail(DL_TrackTag, DL_Entity, DL_Id, sSubject, sHTML, DL_CaseNo, sRecipients) // 27.7.2009 - sSubject, sHTML added 15.5.2011 - DL_CaseNo added\r\n{\r\n    if (typeof (DL_CaseNo) == 'undefined')\r\n        DL_CaseNo = DL_Id;\r\n    if (typeof (sSubject) == 'undefined')\r\n        sSubject = '';\r\n    if (typeof (sHTML) == 'undefined')\r\n        sHTML = '';\r\n    //alert('newcaseemail(' + DL_Entity + ',' + DL_Id + ')');\r\n    var outlookApp;\r\n    outlookApp = getOutlook();\r\n    if (outlookApp == null) {\r\n        outlookApp = null;\r\n    }\r\n    else {\r\n        try {\r\n            var oItem;\r\n            oItem = outlookApp.CreateItem(0);\r\n            if (DL_TrackTag != '') {\r\n                oItem.UserProperties.Add('DLTrackTag', 1);\r\n                oItem.UserProperties('DLTrackTag').Value = DL_TrackTag;\r\n                oItem.UserProperties.Add(DL_TrackTag, 1);\r\n                oItem.UserProperties(DL_TrackTag).Value = DL_CaseNo; // 15.5.2011 DL_Id;\r\n                oItem.UserProperties.Add('DLEntity', 1);\r\n                oItem.UserProperties('DLEntity').Value = DL_Entity;\r\n                oItem.UserProperties.Add('DLEntityId', 1);\r\n                oItem.UserProperties('DLEntityId').Value = DL_Id;\r\n            }\r\n            //oItem.UserProperties.Add('DLCaseId', 1);\r\n            //oItem.UserProperties('DLCaseId').Value = DL_Id;\r\n            if (sSubject != '')\r\n                oItem.Subject = sSubject;\r\n            if (sHTML != '')\r\n                oItem.HTMLBody = sHTML;\r\n            if (sRecipients != '')\r\n                oItem.To = sRecipients;\r\n            oItem.Display();\r\n            //alert('newjournal(' + DL_Company + ',' + name + ',' + type1 + ')');\r\n            outlookApp = null;\r\n        }\r\n        catch (e) { alert(e.message); }\r\n    }\r\n    //alert('done');\r\n}\r\nfunction newcaseemail2(DL_TrackTag, DL_Entity, DL_Id, ProjectMailFolder) {\r\n    //alert('newcaseemail2(' + DL_Entity + ',' + DL_Id + ')');\r\n    var outlookApp;\r\n    outlookApp = getOutlook();\r\n    if (outlookApp == null) {\r\n        outlookApp = null;\r\n    }\r\n    else {\r\n        try {\r\n            var oItem;\r\n            oItem = outlookApp.CreateItem(0);\r\n            oItem.UserProperties.Add('DLTrackTag', 1);\r\n            oItem.UserProperties('DLTrackTag').Value = DL_TrackTag;\r\n            oItem.UserProperties.Add(DL_TrackTag, 1);\r\n            oItem.UserProperties(DL_TrackTag).Value = DL_Id;\r\n            oItem.UserProperties.Add('DLEntity', 1);\r\n            oItem.UserProperties('DLEntity').Value = DL_Entity;\r\n            oItem.UserProperties.Add('DLEntityId', 1);\r\n            oItem.UserProperties('DLEntityId').Value = DL_Id;\r\n            oItem.UserProperties.Add('DLMailFolder', 1);\r\n            oItem.UserProperties('DLMailFolder').Value = ProjectMailFolder;\r\n            //oItem.UserProperties.Add('DLCaseId', 1);\r\n            //oItem.UserProperties('DLCaseId').Value = DL_Id;\r\n            oItem.Display();\r\n            //alert('newjournal(' + DL_Company + ',' + name + ',' + type1 + ')');\r\n            outlookApp = null;\r\n        }\r\n        catch (e) { alert('newcaseemail2 exception ' + e.message); }\r\n    }\r\n    //alert('done');\r\n}\r\nfunction newcaseemail3(DL_TrackTag, DL_Entity, DL_Id) {\r\n    //alert('openmail2(' + DL_FolderPath + ',' + DL_MSGID + ')');\r\n    var objAddin;\r\n    objAddin = getOutlookAddIn();\r\n    var bResult;\r\n    if (objAddin == null) {\r\n        bResult = false;\r\n    }\r\n    else {\r\n        bResult = objAddin.object.newCaseEmail(DL_TrackTag, DL_Entity, DL_Id);\r\n        if (bResult == false) {\r\n            alert(LEX_OutAddInEmailCouldNotCreate.format(DL_TrackTag, DL_Id));\r\n        }\r\n    }\r\n    objAddin = null;\r\n}\r\n// newcontact\r\nfunction newcontact(DL_CompanyID) {\r\n    //alert('newcontact(' + DL_CompanyID + ')');\r\n    var objAddin;\r\n    objAddin = getOutlookAddIn();\r\n    var bResult;\r\n    if (objAddin == null) {\r\n        bResult = false;\r\n    }\r\n    else {\r\n        bResult = objAddin.object.newContact(DL_CompanyID);\r\n        if (bResult == false) {\r\n            alert(LEX_OutAddInContactCouldNotCreate.format(DL_CompanyID));\r\n        }\r\n    }\r\n    objAddin = null;\r\n}\r\n// opencontact\r\nfunction opencontact(DL_CompanyID, name) {\r\n    //alert('opencontact(' + DL_CompanyID + ',' + name + ')');\r\n    var objAddin;\r\n    objAddin = getOutlookAddIn();\r\n    var bResult;\r\n    if (objAddin == null) {\r\n        bResult = false;\r\n    }\r\n    else {\r\n        bResult = objAddin.object.showContact(DL_CompanyID, name);\r\n        if (bResult == false) {\r\n            alert(LEX_OutAddInContactCouldNotOpen.format(name));\r\n        }\r\n    }\r\n    objAddin = null;\r\n}\r\n// opencontact\r\nfunction EXOpenContact(DL_ContactID) {\r\n    return showcontact2(DL_ContactID);\r\n}\r\nfunction showcontact2(DL_ContactID) {\r\n    var objAddin;\r\n    try {\r\n        objAddin = getOutlookAddIn();\r\n        var bResult;\r\n        if (objAddin == null) {\r\n            bResult = false;\r\n        }\r\n        else {\r\n            //alert('showcontact2(' + DL_ContactID + ')');\r\n            //bResult = objAddin.object.showContact(102, 'Michael Rasmussen'); // TEST PURPOSE ONLY\r\n            //bResult = objAddin.object.showContact2(DL_ContactID);\r\n            //alert('now do it');\r\n            bResult = objAddin.object.showContact2(DL_ContactID);\r\n            if (bResult == false) {\r\n                alert(LEX_OutAddInContactCouldNotOpen.format(DL_ContactID));\r\n            }\r\n        }\r\n    } catch (e) { alert('showcontact2(' + DL_ContactID + ') failed >>> ' + e.message); }\r\n    objAddin = null; // 3.2.2009 - ensure object is deleted - whether error occur or not\r\n}\r\n// opentask\r\nfunction opentask(DL_TaskId) {\r\n    //alert('opentask(' + DL_TaskId + ')');\r\n    var objAddin;\r\n    objAddin = getOutlookAddIn();\r\n    var bResult;\r\n    if (objAddin == null) {\r\n        bResult = false;\r\n    }\r\n    else {\r\n        bResult = objAddin.object.showTask(DL_TaskId);\r\n        if (bResult == false) {\r\n            alert(LEX_OutAddInTaskCouldNotOpen.format(DL_TaskId));\r\n        }\r\n    }\r\n    objAddin = null;\r\n    return bResult; // 23.10.2008\r\n}\r\nfunction showAppointment(DLMeeting) { // 23.4.2008\r\n    var objAddin;\r\n    objAddin = getOutlookAddIn();\r\n    var bResult;\r\n    if (objAddin == null) {\r\n        bResult = false;\r\n    }\r\n    else {\r\n        bResult = objAddin.object.showAppointment(DLMeeting);\r\n        if (bResult == false) {\r\n            // 09-10-2008/JRD: Changed alert from LEX_OutAddInTaskCouldNotOpen to new alert LEX_OutAddInCalendarCouldNotOpen\r\n            alert(LEX_OutAddInCalendarCouldNotOpen.format(DLMeeting));\r\n        }\r\n    }\r\n    objAddin = null;\r\n}\r\n// opencontactsfolder\r\nfunction opencontactsfolder(DL_CompanyFolder) {\r\n    //alert('opencontactsfolder');\r\n    var objAddin;\r\n    objAddin = getOutlookAddIn();\r\n    var bResult;\r\n    if (objAddin == null) {\r\n        bResult = false;\r\n    }\r\n    else {\r\n        bResult = objAddin.object.openContactsFolder(DL_CompanyFolder);\r\n        if (bResult == false) {\r\n            alert(LEX_BRMCouldNotOpenContactFolder);\r\n        }\r\n    }\r\n    objAddin = null;\r\n}\r\n// openmailfolder\r\nfunction openmailfolder(DL_CompanyFolder) {\r\n    try {\r\n        //alert('openmailfolder(' + DL_CompanyFolder + ')');\r\n        var objAddin;\r\n        objAddin = getOutlookAddIn();\r\n        var bResult;\r\n        if (objAddin == null) {\r\n            bResult = false;\r\n        }\r\n        else {\r\n            var oAO = objAddin.object;\r\n            //bResult = objAddin.Object.openMailFolder(DL_CompanyFolder);\r\n            if (oAO == null)\r\n                oAO = objAddin;\r\n            bResult = oAO.openMailFolder(DL_CompanyFolder);\r\n            if (bResult == false) {\r\n                alert(LEX_BRMCouldNotOpenMailFolder.format(DL_CompanyFolder));\r\n            }\r\n        }\r\n        objAddin = null;\r\n    } catch (e) { alert('openmailfolder(' + DL_CompanyFolder + ') >>> ' + e.message); }\r\n}\r\n// openmailfolder\r\nfunction openPKMCDOfolder(DL_CompanyFolder) {\r\n    //alert('openmailfolder(' + DL_CompanyFolder + ')');\r\n    var objAddin;\r\n    objAddin = getOutlookAddIn();\r\n    var bResult;\r\n    if (objAddin == null) {\r\n        alert(LEX_ExformaticsOutlookExtensionNotInstalled);\r\n        bResult = false;\r\n    }\r\n    else {\r\n        bResult = objAddin.object.openMailFolder(DL_CompanyFolder);\r\n        if (bResult == false) {\r\n            alert(LEX_BRMCouldNotOpenMailFolder.format(DL_CompanyFolder));\r\n        }\r\n    }\r\n    objAddin = null;\r\n}\r\n// openmail\r\nfunction openmail(DL_CompanyFolder, DL_MSGID) {\r\n    //alert('openmail(' + DL_CompanyFolder + ',' + DL_MSGID + ')');\r\n    var objAddin;\r\n    objAddin = getOutlookAddIn();\r\n    var bResult;\r\n    if (objAddin == null) {\r\n        bResult = false;\r\n    }\r\n    else {\r\n        bResult = objAddin.object.openMail(DL_CompanyFolder, DL_MSGID);\r\n        if (bResult == false) {\r\n            alert(LEX_BRMCouldNotOpenEmail.format(DL_CompanyFolder, DL_MSGID));\r\n        }\r\n    }\r\n    objAddin = null;\r\n}\r\nfunction openmailD(DL_CompanyFolder, DL_DocumentId) {\r\n    try {\r\n        //alert('openmailD(' + DL_CompanyFolder + ',' + DL_DocumentId + ')');\r\n        var objAddin;\r\n        objAddin = getOutlookAddIn();\r\n        var bResult;\r\n        if (objAddin == null) {\r\n            bResult = false;\r\n        }\r\n        else {\r\n            bResult = objAddin.object.openEmailD(DL_CompanyFolder, DL_DocumentId);\r\n            if (bResult == false) {\r\n                alert(LEX_BRMCouldNotOpenEmail.format(DL_CompanyFolder, DL_DocumentId));\r\n            }\r\n        }\r\n        objAddin = null;\r\n    } catch (e) { alert('openmailD(' + DL_CompanyFolder + ',' + DL_DocumentId + ') failed ' + e.message); }\r\n}\r\n// openmail\r\nfunction replymail(DL_CompanyFolder, DL_MSGID) {\r\n    //alert('replymail(' + DL_CompanyFolder + ',' + DL_MSGID + ')');\r\n    var objAddin;\r\n    objAddin = getOutlookAddIn();\r\n    var bResult;\r\n    if (objAddin == null) {\r\n        bResult = false;\r\n    }\r\n    else {\r\n        bResult = objAddin.object.replyMail(DL_CompanyFolder, DL_MSGID);\r\n        if (bResult == false) {\r\n            alert(LEX_BRMCouldNotOpenReplyEmail.format(DL_CompanyFolder, DL_MSGID));\r\n        }\r\n    }\r\n    objAddin = null;\r\n}\r\n// openmail\r\nfunction openmail2(DL_FolderPath, DL_MSGID) {\r\n    //alert('openmail2(' + DL_FolderPath + ',' + DL_MSGID + ')');\r\n    var objAddin;\r\n    objAddin = getOutlookAddIn();\r\n    var bResult;\r\n    if (objAddin == null) {\r\n        bResult = false;\r\n    }\r\n    else {\r\n        bResult = objAddin.object.openEmail2(DL_FolderPath, DL_MSGID);\r\n        if (bResult == false) {\r\n            alert(LEX_BRMCouldNotOpenEmail.format(DL_FolderPath, DL_MSGID));\r\n        }\r\n    }\r\n    objAddin = null;\r\n}\r\n// openmail\r\nfunction replymail2(DL_FolderPath, DL_MSGID) {\r\n    //alert('replymail2(' + DL_FolderPath + ',' + DL_MSGID + ')');\r\n    var objAddin;\r\n    objAddin = getOutlookAddIn();\r\n    var bResult;\r\n    if (objAddin == null) {\r\n        bResult = false;\r\n    }\r\n    else {\r\n        bResult = objAddin.object.replyEmail2(DL_FolderPath, DL_MSGID);\r\n        if (bResult == false) {\r\n            alert(LEX_BRMCouldNotOpenReplyEmail.format(DL_FolderPath, DL_MSGID));\r\n        }\r\n    }\r\n    objAddin = null;\r\n}\r\n// SkypeCall\r\nfunction skypecall(SkypeName) {\r\n    //alert('skypecall(' + SkypeName + ')');\r\n    var objAddin;\r\n    objAddin = getOutlookAddIn();\r\n    var bResult;\r\n    if (objAddin == null) {\r\n        bResult = false;\r\n    }\r\n    else {\r\n        bResult = objAddin.object.SkypeCall(SkypeName);\r\n        if (bResult == false) {\r\n            alert('Could not Skype Call ' + SkypeName);\r\n        }\r\n    }\r\n    objAddin = null;\r\n}\r\n// SkypeChat\r\nfunction skypechat(SkypeName) {\r\n    //alert('skypechat(' + SkypeName + ')');\r\n    var objAddin;\r\n    objAddin = getOutlookAddIn();\r\n    var bResult;\r\n    if (objAddin == null) {\r\n        bResult = false;\r\n    }\r\n    else {\r\n        bResult = objAddin.object.SkypeChat(SkypeName);\r\n        if (bResult == false) {\r\n            alert('Could not Skype Chat ' + SkypeName);\r\n        }\r\n    }\r\n    objAddin = null;\r\n}\r\n/********************************************************************\r\n*                                                                  *\r\n* Exformatics Download CSV file                                    *\r\n*                                                                  *\r\n********************************************************************/\r\n// EXdownloadCSV\r\nfunction EXdownloadCSV(DL_Entity) {\r\n    openupload = window.open('/EX_SQLSVC/getEntityData.aspx?DL_Entity=' + DL_Entity, 'Download', 'width=200,height=40,toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,copyhistory=no,resizable=no');\r\n}\r\n\r\n/********************************************************************\r\n*                                                                  *\r\n* queryString functions                                            *\r\n*                                                                  *\r\n********************************************************************/\r\n// Parse Query String\r\n// http://www.eggheadcafe.com/articles/20020107.asp\r\nfunction PageQuery(q) {\r\n    if (q.length > 1) this.q = q.substring(1, q.length);\r\n    else this.q = null;\r\n    this.keyValuePairs = new Array();\r\n    if (q) {\r\n        for (var i = 0; i < this.q.split(\"&\").length; i++) {\r\n            this.keyValuePairs[i] = this.q.split(\"&\")[i];\r\n        }\r\n    }\r\n    this.getKeyValuePairs = function () { return this.keyValuePairs; }\r\n    this.getValue = function (s) {\r\n        for (var j = 0; j < this.keyValuePairs.length; j++) {\r\n            if (this.keyValuePairs[j].split(\"=\")[0] == s) {\r\n                // MMQ: 28/8-2006\r\n                var i = this.keyValuePairs[j].indexOf('=');\r\n                return this.keyValuePairs[j].substr(i + 1);\r\n                return this.keyValuePairs[j].split(\"=\")[1];\r\n            }\r\n        }\r\n        //    return false;\r\n        return '';\r\n    } // getvalue - object oriented\r\n    this.getParameters = function () {\r\n        var a = new Array(this.getLength());\r\n        for (var j = 0; j < this.keyValuePairs.length; j++) {\r\n            a[j] = this.keyValuePairs[j].split(\"=\")[0];\r\n        }\r\n        return a;\r\n    } // getParameters - object oriented\r\n    this.getLength = function () { return this.keyValuePairs.length; }\r\n} // PageQuery\r\nfunction queryString(key, bParent) {\r\n    try {\r\n        var page;\r\n        if (bParent)\r\n            page = new PageQuery(parent.window.location.search);\r\n        else\r\n            page = new PageQuery(window.location.search);\r\n        return unescape(page.getValue(key));\r\n    } catch (e) { alert('queryString(' + key + ',' + bParent + ') failed ' + e.message); } // 18.2.2013 - minor bug\r\n}\r\n//alert('exformatics.js - querystring');\r\n/********************************************************************\r\n*                                                                  *\r\n* FillDropDown                                                     *\r\n*                                                                  *\r\n* Notice - the drop down list must be within an element with NO    *\r\n* id or other stuff is this element is reset - use a DIV, TD,      *\r\n* SPAN or similar                                                  *\r\n*                                                                  *\r\n********************************************************************/\r\nfunction FillDropDown(sEle, sDictionary, sPropCodeKey, sPropCodeDecode, sDictKey, sDictValue, sDefault, sDictKey2, sDictValue2, sDictKey3, sDictValue3, bDisable, strWhere) // 23.9.2012 - strWhere added\r\n{\r\n    //alert('DEBUG\\nFillDropDown(' + sEle + ',' + sDictionary + ',' + sPropCodeDecode + ',' + sDictKey + ',' + sDictValue + ',' + sDefault + ' started');\r\n    var oEle = document.getElementById(sEle);\r\n    if (oEle == null) {\r\n        alert('ERROR\\nFillDropDown(' + sEle + ', ...) failed - element not found - please contact administrator');\r\n        return;\r\n    }\r\n    try {\r\n        var xmldoc;\r\n\r\n        if (typeof (strWhere) == 'undefined')\r\n            strWhere = '';\r\n\r\n        if (bDisable == null)\r\n            bDisable = false;\r\n\r\n        if (sDictKey == null)\r\n            sDictKey = '';\r\n\r\n        if (sDictValue == null)\r\n            sDictValue = '';\r\n\r\n        if (sDictKey3 == null)\r\n            sDictKey3 = '';\r\n\r\n        if (sDictValue3 == null)\r\n            sDictValue3 = '';\r\n\r\n        if (typeof (sDictKey2) == 'undefined' || sDictKey2 == null)\r\n            sDictKey2 = '';\r\n\r\n        if (typeof (sDictValue2) == 'undefined' || sDictValue2 == null)\r\n            sDictValue2 = '';\r\n\r\n        if (typeof (sDictKey3) == 'undefined' || sDictKey3 == null)\r\n            sDictKey3 = '';\r\n\r\n        if (typeof (sDictValue3) == 'undefined' || sDictValue3 == null)\r\n            sDictValue3 = '';\r\n\r\n        if (sPropCodeDecode == null)\r\n            sPropCodeDecode = '';\r\n\r\n        //if (sDefault == null)\r\n        //  sDefault = '';\r\n\r\n        if (sDictKey == 'DL_WFCaseEntity' && sDictValue.indexOf('DL_WF') == 0) // 11.6.2008\r\n        {\r\n            sDictKey = '';\r\n            sDictValue = '';\r\n        }\r\n\r\n        //mb - 04.12.2009\r\n        if (bDisable == true) {\r\n            if (sDictValue == null || sDictValue == '') {\r\n                oEle.options.length = 0;\r\n                oEle.disabled = true;\r\n                return;\r\n            }\r\n        }\r\n\r\n        var op;\r\n\r\n        if (sDefault == '%DL_sAMAccountName%') {\r\n            var oSAM = getEntityData('DL_sAMAccountName', 'DL_sAMAccountName = %DL_sAMAccountName%', '');\r\n            sDefault = getsafe(oSAM, '//DL_sAMAccountName/DL_sAMAccountName');\r\n        }\r\n\r\n        if (strWhere == '') {\r\n            if (sDictKey2 != '') {\r\n                xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n                xmldoc = xmldoc + '<getDictionaryData2 xmlns=\"http://doclife.net/svcDLEntity\">';\r\n                xmldoc = xmldoc + '<DL_Dictionary>' + sDictionary + '</DL_Dictionary>';\r\n                xmldoc = xmldoc + '<DL_PropCodeKey>' + sPropCodeKey + '</DL_PropCodeKey><DL_PropCodeDecode1>' + sPropCodeDecode + '</DL_PropCodeDecode1><DL_PropCodeDecode2/><DL_PropCodeDecode3/><DL_DictKey1>' + sDictKey + '</DL_DictKey1><DL_DictValue1>' + sDictValue + '</DL_DictValue1>';\r\n                xmldoc = xmldoc + '<DL_DictKey2>' + sDictKey2 + '</DL_DictKey2><DL_DictValue2>' + sDictValue2 + '</DL_DictValue2><DL_DictKey3>' + sDictKey3 + '</DL_DictKey3><DL_DictValue3>' + sDictValue3 + '</DL_DictValue3>';\r\n                op = 'getDictionaryData2';\r\n                SOAPAction = 'http://doclife.net/svcDLEntity/getDictionaryData2';\r\n                xmldoc = xmldoc + '</getDictionaryData2>';\r\n            }\r\n            else {\r\n                xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n                xmldoc = xmldoc + '<getDictionaryData xmlns=\"http://doclife.net/svcDLEntity\">';\r\n                xmldoc = xmldoc + '<DL_Dictionary>' + sDictionary + '</DL_Dictionary>';\r\n                xmldoc = xmldoc + '<DL_PropCodeKey>' + sPropCodeKey + '</DL_PropCodeKey><DL_PropCodeDecode1>' + sPropCodeDecode + '</DL_PropCodeDecode1><DL_PropCodeDecode2/><DL_PropCodeDecode3/><DL_DictKey1>' + sDictKey + '</DL_DictKey1><DL_DictValue1>' + MakeXMLSafe(sDictValue) + '</DL_DictValue1>';\r\n                op = 'getDictionaryData';\r\n                SOAPAction = 'http://doclife.net/svcDLEntity/getDictionaryData';\r\n                xmldoc = xmldoc + '</getDictionaryData>';\r\n            }\r\n        }\r\n        else {\r\n            op = 'getDictionaryData6';\r\n            SOAPAction = 'http://doclife.net/svcDLEntity/getDictionaryData6';\r\n            xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n            xmldoc = xmldoc + '<getDictionaryData6 xmlns=\"http://doclife.net/svcDLEntity\">';\r\n            xmldoc = xmldoc + '<DL_Dictionary>' + sDictionary + '</DL_Dictionary>';\r\n            xmldoc = xmldoc + '<DL_PropCodeKey>' + sPropCodeKey + '</DL_PropCodeKey><DL_PropCodeDecode1>' + sPropCodeDecode + '</DL_PropCodeDecode1>';\r\n            xmldoc = xmldoc + '<strWhere>' + MakeXMLSafe(strWhere) + '</strWhere>';\r\n            //\tif (strOrderBy != '')\r\n            //\t\txmldoc = xmldoc + '<strOrderBy>' + strOrderBy + '</strOrderBy>';\r\n            xmldoc = xmldoc + '<b4JSON>false</b4JSON>';\r\n            xmldoc = xmldoc + '</getDictionaryData6>';\r\n        }\r\n\r\n        xmldoc = xmldoc + '</soap:Body></soap:Envelope>';\r\n        //EXCopyToClipboard(xmldoc);\r\n        //alert('DEBUG\\nsoap=' + xmldoc);\r\n        var FeedbackHTTP = EXXMLHTTP(); // 29.1.2013 - \"var\" added - no global variable - unknown side effect\r\n        FeedbackHTTP.open(\"POST\", getAbsoluteURL('/EX_SQLSVC/svcDLEntity.asmx?op=' + op), false);\r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", SOAPAction);\r\n        FeedbackHTTP.send(xmldoc);\r\n\r\n        // 17.5.2010 - prepare for multi browser support - and save time\r\n        //var xmlResponse = EXDOMDocument();\r\n        //xmlResponse.async=false;\r\n        //xmlResponse.loadXML(FeedbackHTTP.responseText);\r\n\r\n        if (FeedbackHTTP.status != 200) {\r\n            //EXCopyToClipboard('Status: ' + FeedbackHTTP.status + ' - ' + FeedbackHTTP.statusText + '\\n\\n' + FeedbackHTTP.responseXML.xml);\r\n            alert('FillDropDown(' + sEle + ',' + sDictionary + ',' + sPropCodeKey + ') - Status:' + FeedbackHTTP.status);\r\n        }\r\n        else {\r\n            var xmlResponse = FeedbackHTTP.responseXML;\r\n            FeedbackHTTP = null;\r\n            //alert(FeedbackHTTP.status + ' ' + FeedbackHTTP.responseText);\r\n\r\n            if (xmlResponse == null) {\r\n                //alert('empty xmlResponse');\r\n            }\r\n            else {\r\n                //mb when '' as indata should the result be all or nothing?\r\n                //EXCopyToClipboard(xmlResponse.xml);\r\n                //alert('xmlResponse=' + xmlResponse.xml);\r\n\r\n                var xNodes;\r\n\r\n                if (sDictionary == 'DL_D760')\r\n                    xNodes = xmlResponse.selectNodes(\".//DL_D760/DL_D760\");\r\n                else\r\n                    xNodes = xmlResponse.selectNodes(\".//\" + sDictionary + \"/\" + sDictionary);\r\n\r\n                if (xNodes.length == 0) {\r\n                    //alert('FillDropDown(' + sDictionary + ') - no nodes found');\r\n                    oEle.disabled = true;\r\n                }\r\n                else {\r\n                    oEle.disabled = false;\r\n                    var i, xNode;\r\n                    var sValue, s;\r\n\r\n                    if (oEle.value == '')  // 29.7.2008 - use default value only if field has no value\r\n                    {\r\n                        if (sDefault == null)\r\n                            sValue = getCookie(sEle);\r\n                        else // get sValue from already selected field - if any\r\n                        {\r\n                            sValue = sDefault;\r\n                        }\r\n                    }\r\n                    else {\r\n                        sValue = oEle.value;\r\n                        //alert(sValue + ' ' + oEle.selectedIndex);\r\n                    }\r\n\r\n                    oEle.options.length = 0; // 15.9.2009\r\n\r\n                    var oP;\r\n\r\n                    oP = document.createElement('option');\r\n                    oP.value = ''; oP.text = '';\r\n                    if (!oEle.multiple) // 26.2.2015 - do not add row in this situation\r\n                        oEle.add(oP);\r\n\r\n                    i = xNodes.length;\r\n                    var arr = new Array(i + 1);\r\n\r\n                    // Add empty element initially - handling of default values?\r\n                    arr[0] = \"<OPTION></OPTION>\";\r\n                    if (xNodes.length != 0) {\r\n                        for (i = 0; i < xNodes.length; i++) {\r\n                            xNode = xNodes[i];\r\n                            var DL_PropCodeKey = getsafe(xNode, \"DL_PropCodeKey\");\r\n                            var DL_PropCodeDecode = getsafe(xNode, \"DL_PropCodeDecode\");\r\n\r\n                            if (DL_PropCodeDecode == '')\r\n                                DL_PropCodeDecode = DL_PropCodeKey;\r\n\r\n                            s = '<OPTION value=\"' + DL_PropCodeKey + '\"';\r\n\r\n                            if (sValue != null && sValue != '' && sValue == DL_PropCodeKey)\r\n                                s = s + ' SELECTED ';\r\n\r\n                            s = s + '>' + DL_PropCodeDecode + '</OPTION>';\r\n                            arr[i + 1] = s;\r\n                            oP = document.createElement('option'); // 15.9.2009\r\n                            oP.value = DL_PropCodeKey;\r\n                            oP.text = DL_PropCodeDecode;\r\n\r\n                            if (sValue != null && sValue != '' && sValue == DL_PropCodeKey)\r\n                                oP.selected = true;\r\n\r\n                            oEle.add(oP);\r\n                        };\r\n\r\n                        //mb code below never run???\r\n                        if (false) // 15.9.2009\r\n                        {\r\n                            var ss, s1;\r\n                            var oParent;\r\n\r\n                            oParent = oEle.parentElement;\r\n                            s = oEle.outerHTML;\r\n                            i = s.toLowerCase().indexOf('<option');\r\n\r\n                            if (i == -1)\r\n                                i = s.toLowerCase().indexOf('</select>');\r\n\r\n                            ss = s.substr(0, i);\r\n                            ss = ss + arr.join('');\r\n                            i = s.toLowerCase().indexOf('</select>');\r\n                            ss = ss + s.substr(i, s.length);\r\n                            oParent.innerHTML = ss;\r\n                            //alert('DEBUG\\nFillDropDown ss=' + ss);\r\n                        }\r\n\r\n                        i = 2;\r\n                        //alert('onchange event set ' + oEle.id);\r\n                        //oEle.attachEvent('onclick', EXhandleSELECTCHANGE);\r\n\r\n                        if (sDefault == null) {\r\n                            oEle = document.getElementById(sEle);\r\n                            //oEle.onchange = EXhandleSELECTCHANGE;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    catch (e) {\r\n        alert('FillDropDown(' + sEle + ',' + sDictionary + ',' + sPropCodeKey + ') - ' + e.message);\r\n    };\r\n}\r\n\r\nfunction EXhandleSELECTCHANGE() {\r\n    //alert('EXhandleSELECTCHANGE');\r\n    var sMessage;\r\n    sMessage = 'start';\r\n    try {\r\n        var oSelect = window.event.srcElement;\r\n        var sID = oSelect.id;\r\n        var sValue = oSelect.options[oSelect.selectedIndex].value;\r\n        //    alert(sID + ' clicked =' + sValue);\r\n        setCookie(sID, sValue);\r\n    } catch (e) { alert('EXhandleSELECTCHANGE failed ' + e.message + ' ' + sMessage); }\r\n}\r\n\r\n// 6.3.2008 - function removed as it is already there\r\n//function getsafe(xNode, XPath) {\r\n//  var xN = xNode.selectSingleNode(XPath);\r\n//  if (xN == null)\r\n//    return '';\r\n//  else\r\n//    return xN.text;\r\n//}\r\n\r\nfunction EXdate2ISO(sDate, sAdd) { // 23.1.2008 - sAdd added as field\r\n    if (typeof (sAdd) == 'undefined')\r\n        sAdd = '';\r\n    // 2.8.2013 - modified to use jQuery datepicker\r\n    var oD;\r\n    if (typeof (sDate) == 'string')\r\n        oD = $.datepicker.parseDate($.datepicker._defaults.dateFormat, sDate);\r\n    else\r\n        oD = sDate;\r\n    var s = $.datepicker.formatDate('yy-mm-dd', oD);\r\n    if (sAdd != '')\r\n        s += sAdd;\r\n    return s;\r\n    //alert('sDate=' + sDate + ' ' + typeof(sDate));\r\n    if (typeof (sDate) == 'string') { // 31.5.2008\r\n        var i, y, m, d;\r\n        i = sDate.indexOf('-');\r\n        d = sDate.substr(0, i);\r\n        sDate = sDate.substr(i + 1);\r\n        //alert('d=' + d + ' sDate=' + sDate);\r\n        i = sDate.indexOf('-');\r\n        m = sDate.substr(0, i);\r\n        y = sDate.substr(i + 1);\r\n        if (d * 1 > 1000) { // 15.9.2008 - swap day and year\r\n            var t = d;\r\n            d = y;\r\n            y = t;\r\n        }\r\n        //alert('m=' + m + ' y=' + y);\r\n        if (m.length == 1)\r\n            m = '0' + m;\r\n        if (d.length == 1)\r\n            d = '0' + d;\r\n        if (typeof (sAdd) == 'undefined' || sAdd == null || sAdd == '')\r\n            return y + '-' + m + '-' + d;\r\n        else // 23.1.2008\r\n            return y + '-' + m + '-' + d + sAdd;\r\n    }\r\n    else {// 31.5.2008 - new functionality\r\n        if (typeof (sAdd) == 'undefined' || sAdd == null || sAdd == '')\r\n            return sDate.getFullYear() + '-' + (sDate.getMonth() + 1) + '-' + sDate.getDate();\r\n        else\r\n            return sDate.getFullYear() + '-' + (sDate.getMonth() + 1) + '-' + sDate.getDate() + sAdd;\r\n    }\r\n}\r\n/**\r\n* http://www.netspade.com/articles/2005/11/16/javascript-cookies/\r\n* Cookie with the given name and value.\r\n*\r\n* name       Name of the cookie\r\n* value      Value of the cookie\r\n* [expires]  Expiration date of the cookie (default: end of current session)\r\n* [path]     Path where the cookie is valid (default: path of calling document)\r\n* [domain]   Domain where the cookie is valid\r\n*              (default: domain of calling document)\r\n* [secure]   Boolean value indicating if the cookie transmission requires a\r\n*              secure transmission\r\n*/\r\nfunction setCookie(name, value, expires, path, domain, secure) {\r\n    if (typeof (expires) == 'undefined' || expires == 'undefined') { // 15.12.2011\r\n        expires = new Date();\r\n        expires.setDate(expires.getDate() + 365);\r\n    }\r\n    //alert('setCookie(' + name + ',' + value + ',' + expires + ',' + path + ',' + domain + ')');\r\n    var oDoc; // 28.8.2008\r\n    if (parent)\r\n        oDoc = parent.document;\r\n    else\r\n        oDoc = document;\r\n    var s = name + \"=\" + escape(value) +\r\n        ((expires) ? \"; expires=\" + expires.toGMTString() : \"\") +\r\n        ((path) ? \"; path=\" + path : \"\") +\r\n        ((domain) ? \"; domain=\" + domain : \"\") +\r\n        ((secure) ? \"; secure\" : \"\");\r\n    oDoc.cookie = s;\r\n}\r\n\r\n/**\r\n* Gets the value of the specified cookie.\r\n*\r\n* name  Name of the desired cookie.\r\n*\r\n* Returns a string containing value of specified cookie,\r\n*   or null if cookie does not exist.\r\n*/\r\nfunction getCookie(name) {\r\n    var dc;\r\n    if (parent) { // 28.8.2008 - check cookie from parent\r\n        dc = parent.document.cookie;\r\n        //alert('getCookie - parent - ' + dc);\r\n    }\r\n    else\r\n        dc = document.cookie;\r\n    var prefix = name + \"=\";\r\n    var begin = dc.indexOf(\"; \" + prefix);\r\n    if (begin == -1) {\r\n        begin = dc.indexOf(prefix);\r\n        if (begin != 0) return null;\r\n    } else {\r\n        begin += 2;\r\n    }\r\n    // 12.2.2013 - VBA error\r\n    // var end = document.cookie.indexOf(\";\", begin);\r\n    var end = dc.indexOf(\";\", begin);\r\n    if (end == -1) {\r\n        end = dc.length;\r\n    }\r\n    //alert('getCookie(' + name + ')=' + dc.substring(begin + prefix.length, end));\r\n    var value = dc.substring(begin + prefix.length, end);\r\n    if (value.indexOf(';') != -1) // 28.8.2008\r\n        value = value.substr(0, value.indexOf(';'));\r\n    //alert('getCookie(' + name + ')=' + value);\r\n    return unescape(value);\r\n}\r\n\r\n/**\r\n* Deletes the specified cookie.\r\n*\r\n* name      name of the cookie\r\n* [path]    path of the cookie (must be same as path used to create cookie)\r\n* [domain]  domain of the cookie (must be same as domain used to create cookie)\r\n*/\r\nfunction deleteCookie(name, path, domain) {\r\n    if (getCookie(name)) {\r\n        document.cookie = name + \"=\" +\r\n            ((path) ? \"; path=\" + path : \"\") +\r\n            ((domain) ? \"; domain=\" + domain : \"\") +\r\n            \"; expires=Thu, 01-Jan-70 00:00:01 GMT\";\r\n    }\r\n}\r\n\r\nfunction getElementLeft(Elem) {\r\n    var elem, xPos;\r\n    if (typeof (Elem) == 'object') { // 8.1.2013\r\n        elem = Elem;\r\n    }\r\n    else if (document.getElementById) {\r\n        elem = document.getElementById(Elem);\r\n    } else if (document.all) {\r\n        elem = document.all[Elem];\r\n    }\r\n    xPos = elem.offsetLeft;\r\n    tempEl = elem.offsetParent;\r\n    while (tempEl != null) {\r\n        xPos += tempEl.offsetLeft;\r\n        tempEl = tempEl.offsetParent;\r\n    }\r\n    return xPos;\r\n}\r\n\r\nfunction getElementRight(Elem) { // 16.8.2012\r\n    var xPos = getElementLeft(Elem);\r\n    var elem;\r\n    if (typeof (Elem) == 'object') { // 8.1.2013\r\n        elem = Elem;\r\n    }\r\n    else if (document.getElementById) {\r\n        elem = document.getElementById(Elem);\r\n    } else if (document.all) {\r\n        elem = document.all[Elem];\r\n    }\r\n    xPos = xPos + 1.0 * elem.style.width.replace('px', '');\r\n    return xPos;\r\n}\r\n\r\n\r\nfunction getElementTop(Elem) {\r\n    var elem;\r\n    if (typeof (Elem) == 'object') { // 8.1.2013\r\n        elem = Elem;\r\n    }\r\n    else if (document.getElementById) {\r\n        elem = document.getElementById(Elem);\r\n    } else if (document.all) {\r\n        elem = document.all[Elem];\r\n    }\r\n    yPos = elem.offsetTop;\r\n    tempEl = elem.offsetParent;\r\n    while (tempEl != null) {\r\n        yPos += tempEl.offsetTop;\r\n        tempEl = tempEl.offsetParent;\r\n    }\r\n    return yPos;\r\n}\r\n\r\n\r\nfunction getElementLeft1(elem) {\r\n    try {\r\n        var xPos;\r\n        xPos = elem.offsetLeft;\r\n        tempEl = elem.offsetParent;\r\n        while (tempEl != null) {\r\n            xPos += tempEl.offsetLeft;\r\n            tempEl = tempEl.offsetParent;\r\n        }\r\n        return xPos;\r\n    } catch (e) { alert('getElementLeft1 ' + elem.id + ' >>> ' + e.message); }\r\n}\r\n\r\n\r\nfunction getElementTop1(elem) {\r\n    try {\r\n        yPos = elem.offsetTop;\r\n        tempEl = elem.offsetParent;\r\n        //alert(elem.id + ' ' + elem.innerHTML + ' ' + yPos + ' ' + tempEl);\r\n        while (tempEl != null) {\r\n            yPos += tempEl.offsetTop;\r\n            tempEl = tempEl.offsetParent;\r\n            //alert(yPos + ' ' + tempEl);\r\n        }\r\n        return yPos;\r\n    } catch (e) { alert('getElementTop1 ' + elem.id + ' >>> ' + e.message); }\r\n}\r\n\r\nfunction EXsetFieldFocus(field) {\r\n    //setTimeout('_EXsetFieldFocus(\\'' + field + '\\')', 50); // 9.1.2009 - timeout to ensure focus is set correctly\r\n    setTimeout('_EXsetFieldFocus(\\'' + field + '\\')', 150); // 21.3.2011 - IT Case 2018 - timeout to 100, 24.4.2015 100 to 150\r\n}\r\nfunction _EXsetFieldFocus(field) {\r\n    try {\r\n        var oEle = document.getElementById(field);\r\n        if (oEle != null) {\r\n            oEle.focus();\r\n            //alert('DEBUG\\n' + field + ' ' + oEle);\r\n        }\r\n    } catch (e) { }\r\n}\r\n/********************************************************************\r\n*                                                                  *\r\n* Document Library functions                                       *\r\n*                                                                  *\r\n********************************************************************/\r\n\r\nfunction EXgetSiteAreaURL(url) {\r\n    try {\r\n        var i, s, j;\r\n        i = url.indexOf('/sites/');\r\n        j = url.substr(i + 8).indexOf('/');\r\n        return url.substr(0, i + 8 + j);\r\n    } catch (e) { alert('EXgetSiteAreaURL(' + url + ') >>> ' + e.message); }\r\n}\r\nfunction EXgetDocLibName(url) {\r\n    try {\r\n        var i, s, j, k;\r\n        i = url.indexOf('/sites/');\r\n        j = url.substr(i + 8).indexOf('/');\r\n        k = url.substr(i + 8 + j + 1).indexOf('/');\r\n        return url.substr(i + 8 + j + 1, k);\r\n    } catch (e) { alert('EXgetDocLibName(' + url + ') >>> ' + e.message); }\r\n}\r\nfunction EXgetSPSDocLibType(url) {\r\n    try {\r\n        var sURL;\r\n        if (url == null || url == '')\r\n            sURL = '' + window.location;\r\n        else\r\n            sURL = url;\r\n        var SPSDocLibName = EXgetDocLibName(sURL);\r\n        if (SPSDocLibName == 'EX_SQLSVC' || SPSDocLibName == 'EX_SPSSVC')\r\n            return '';\r\n        var SPSSiteAreaURL = EXgetSiteAreaURL(sURL);\r\n\r\n        var sWhere = 'SPS_SiteAreaURL = \\'' + SPSSiteAreaURL + '\\' AND SPS_ListName=\\'' + SPSDocLibName + '\\'';\r\n        //alert(sWhere);\r\n        var oXML = getEntityData('SPS_SiteAreaCollectionView', sWhere, '');\r\n        //alert(oXML.xml);\r\n        s = getsafe(oXML, '//SPS_ListTypeForeign');\r\n        oXML = null;\r\n        return s;\r\n    } catch (e) { alert('EXgetSPSDocLibType ' + e.message); }\r\n}\r\nfunction EXSubmitUploadForm() {\r\n    // Don't do anything for folders\r\n    if (queryString(\"Type\") == \"1\")\r\n        return true;\r\n\r\n    // Try to modify filename (target) only\r\n    // Will it work - would be great\r\n    var oField;  // = document.getElementById('urn:schemas-microsoft-com:office:office#FileLeafRef');\r\n    oField = document.getElementById('onetidIOFile');\r\n    var s, i;\r\n    s = oField.value;\r\n    i = s.lastIndexOf('\\\\');\r\n    s = s.substring(0, i) + '\\\\gnyf.pdf';\r\n\r\n    var b, bDocID;\r\n    // DocumentID can be empty - we need to set a value before we invoke validate\r\n    var EXDocumentID = EXgetField('EXDocumentID'); //document.getElementById('urn:schemas-microsoft-com:office:office#EXDocumentID');\r\n    bDocID = false;\r\n    if (EXDocumentID.value == '') {\r\n        EXDocumentID.value = '000000001';\r\n        bDocID = true;\r\n    }\r\n    // Don't do anything unless the form is valid\r\n    b = exfrm.FValidate(true);\r\n    if (bDocID) {\r\n        EXDocumentID.value = '';\r\n    }\r\n    if (!b)\r\n        return false;\r\n\r\n    // Exformatics Validation of fields\r\n    b = EXValidateForm();\r\n    if (!b)\r\n        return false;\r\n\r\n    // Does the file already exists?\r\n    if (FileName == '')\r\n        b = EXFileExists();\r\n    else\r\n        b = true;\r\n\r\n    b = EXSetID(FileName, b);\r\n    if (b) {\r\n    };\r\n    if (!b) {\r\n        alert('EXSubmitUploadForm - error in submission - please fix');\r\n        return false;\r\n    }\r\n\r\n    //oField.value = s; // Doesn't work - cannot change value of INPUT in javascript\r\n\r\n    //  return true; // stuff below doesn't work  \r\n    if (oEXDocLibFunction.EXSubmitFormCustom != null)\r\n        return oEXDocLibFunction.EXSubmitFormCustom();\r\n    else\r\n        return true;\r\n}\r\n\r\nfunction EXgetFormFieldNames() {\r\n    try {\r\n        var ifld;\r\n        var fld;\r\n        var stName;\r\n        var oField;\r\n        var s = \"\";\r\n        for (ifld = 0; ifld < exfrm.ifldMax; ifld++) {\r\n            fld = exfrm.rgfld[ifld];\r\n            if (s != \"\")\r\n                s = s + \",\";\r\n            stName = fld.stName;\r\n            s = s + stName;\r\n        }\r\n        return s;\r\n    } catch (e) { alert('EXgetFormFieldNames ' + e.message); }\r\n}\r\nfunction EXInitializeEditDlg() {\r\n    try {\r\n        exfrm = frm;\r\n        EXSetID('', false);\r\n        EXProtectEXDocumentID(0);\r\n        //if (window['EXaddDropDownList']) {\r\n        if (oEXDocLibFunction.bAddDropDownList != null) {\r\n            EXaddDropDownList(EXaddDropDownFields());\r\n        }\r\n        /*\r\n        //if (window['EXgetCustomFileName']) {\r\n        if (oEXDocLibFunction.EXgetCustomFileName != null) {\r\n        var oEle = document.getElementById('onetidIOFile');\r\n        oEle.readOnly = true;\r\n        }\r\n        */\r\n        if (oEXDocLibFunction.EXCustomFieldHandling != null) {\r\n            var ifld;\r\n            var fld;\r\n            var stName;\r\n            var oField;\r\n            for (ifld = 0; ifld < exfrm.ifldMax; ifld++) {\r\n                fld = exfrm.rgfld[ifld];\r\n                stName = fld.stName;\r\n                oField = EXgetField(stName);\r\n                // if (window['EXcustomFieldHandling']) {\r\n                oEXDocLibFunction.EXCustomFieldHandling(stName, oField);\r\n            } // for\r\n        }\r\n    } catch (e) { alert('EXInitializeEditDlg ' + e.message); }\r\n}\r\n\r\nfunction EXInitializeEditForm() {\r\n    try {\r\n        exfrm = frm;\r\n        // 25/10-2006 - if DocumentId is empty - add a value NOW\r\n        var EXDocumentID = EXgetField('EXDocumentID');\r\n        if (EXDocumentID == null) {\r\n            alert('EXDocumentID not found - retry');\r\n            return false;\r\n        }\r\n        if (EXDocumentID.value == '') {\r\n            EXDocumentID.value = getEXDocumentID(0);\r\n        }\r\n        EXProtectEXDocumentID(0);\r\n        //if (window['EXaddDropDownList']) {\r\n        if (oEXDocLibFunction.bAddDropDownList != null) {\r\n            EXaddDropDownList(EXaddDropDownFields());\r\n        }\r\n\r\n        //if (window['EXgetCustomFileName']) {\r\n        if (oEXDocLibFunction.EXgetCustomFileName != null) {\r\n            var oEle = document.getElementById('onetidIOFile');\r\n            oEle.readOnly = true;\r\n        }\r\n\r\n        var oSubmit = document.getElementById('diidIOSaveItem');\r\n        if (oSubmit == null)\r\n            alert('oSubmit is null');\r\n        else {\r\n            /* Unfortunately this doesn't work - href cannot be updated dynamically\r\n            // add validation event\r\n            var href = oSubmit.href;\r\n            var i;\r\n            i=href.indexOf(':');\r\n            href = href.substr(0,i) + ':alert(\\'hej\\');' + href.substr(i+1);\r\n            // alert(href);\r\n            oSubmit.href = href;\r\n            //      alert('oSubmit validate? ' + oSubmit.outerHTML);\r\n            //      alert('oSubmit validate? ' + oSubmit.innerHTML);\r\n            */\r\n        }\r\n        if (oEXDocLibFunction.EXCustomFieldHandling != null) {\r\n            var ifld;\r\n            var fld;\r\n            var stName;\r\n            var oField;\r\n            for (ifld = 0; ifld < exfrm.ifldMax; ifld++) {\r\n                fld = exfrm.rgfld[ifld];\r\n                stName = fld.stName;\r\n                oField = EXgetField(stName);\r\n                // if (window['EXcustomFieldHandling']) {\r\n                oEXDocLibFunction.EXCustomFieldHandling(stName, oField);\r\n            } // for\r\n        }\r\n    } catch (e) { alert('EXInitializeEditForm ' + e.message); }\r\n}\r\nfunction EXInitializeUploadForm() {\r\n    //try {\r\n    FileName = queryString('File');\r\n    EXProtectEXDocumentID(0);\r\n    exfrm = frm;\r\n    //  if (window['EXAddExtraUploadButton']) {\r\n    if (oEXDocLibFunction == null)\r\n        alert('oEXDocLibFunction is null');\r\n    if (oEXDocLibFunction.bAddExtraUploadButton) {\r\n        EXAddExtraUploadButton(0);\r\n    }\r\n    //if (window['EXaddDropDownList']) {\r\n    if (oEXDocLibFunction.bAddDropDownList) {\r\n        var s = EXgetFormFieldNames();\r\n        EXaddDropDownList(s);\r\n    }\r\n    var oXML;\r\n    if (FileName == '') {\r\n        // Retrieve document default values?\r\n        oXML = null;\r\n        //if (window['EXgetDefaultValues'])\r\n        if (oEXDocLibFunction.EXgetDefaultValues != null) {\r\n            //alert('EXgetDefaultValues - will be invoked');\r\n            oXML = oEXDocLibFunction.EXgetDefaultValues(EXgetFormFieldNames());\r\n        }\r\n    }\r\n    else {\r\n        oXML = EXgetDocumentMetaData(getAbsoluteURL(FileName));\r\n    }\r\n    if (oXML != null) {\r\n        // Retrieve attributes from existing file and place on form\r\n        var oProp;\r\n        var ifld;\r\n        var fld;\r\n        var stName;\r\n        var oField;\r\n        var s\r\n        for (ifld = 0; ifld < exfrm.ifldMax; ifld++) {\r\n            fld = exfrm.rgfld[ifld];\r\n            stName = fld.stName;\r\n            //oField = document.getElementById('urn:schemas-microsoft-com:office:office#' + stName);\r\n            oField = EXgetField(stName);\r\n            // if (window['EXcustomFieldHandling']) {\r\n            if (oEXDocLibFunction.EXCustomFieldHandling != null) {\r\n                if (oField.value != '') {\r\n                    oEXDocLibFunction.EXCustomFieldHandling(stName, oField);\r\n                }\r\n            }\r\n            oProp = oXML.selectSingleNode(\"//\" + stName);\r\n\r\n            if (oProp == null) {\r\n                s = '';\r\n            }\r\n            else {\r\n                s = oProp.text;\r\n            }\r\n            if ((oField != null) && (s != '')) {\r\n                oField.value = s;\r\n            } // if\r\n\r\n        } // for\r\n    } // if FileName\r\n\r\n    // } catch (e) {alert('EXInitializeUploadForm - ' + e.message);}\r\n} // EXInitializeUploadForm\r\n\r\nfunction EXPrintSpecial(title, bTR, sDiv) {\r\n    var sMessage = 'start';\r\n    if (sDiv == '' || sDiv == null)\r\n        sDiv = \"EXprintPart\";\r\n    try {\r\n        var html = '<HTML>\\n<HEAD>\\n';\r\n        if (document.getElementsByTagName != null) {\r\n            var headTags = document.getElementsByTagName(\"head\");\r\n            if (headTags.length > 0) {\r\n                html += headTags[0].innerHTML;\r\n            }\r\n        }\r\n\r\n        if (bTR) {\r\n            html += '<style>tr {height: 70px;}</style>';\r\n        }\r\n\r\n        html = html.replace('src=\"/', 'src=' + EXgetSVCURL() + '/');\r\n        html = html.replace('src=\"/', 'src=' + EXgetSVCURL() + '/');\r\n        html = html.replace('src=\"/', 'src=' + EXgetSVCURL() + '/');\r\n        html = html.replace('src=\"/', 'src=' + EXgetSVCURL() + '/');\r\n        html = html.replace('LINK href=\"/', 'LINK href=\"' + EXgetSVCURL() + '/');\r\n        html = html.replace('LINK href=\"/', 'LINK href=\"' + EXgetSVCURL() + '/');\r\n        html += '\\n</HEAD>\\n<BODY>\\n';\r\n        var ii, jj;\r\n        // replace title\r\n        sMessage = 'title';\r\n\r\n        if (title != null) {\r\n            var t = prompt(LEX_PrintEnterTitle, title);\r\n            if (t == null)\r\n                return;\r\n            title = t;\r\n            ii = html.indexOf('<TITLE');\r\n            if (ii == -1)\r\n                ii = html.indexOf('<title');\r\n            sMesage = \"ii=\" + ii;\r\n            jj = html.substr(ii).indexOf('</TITLE>');\r\n            if (jj == -1)\r\n                jj = html.substr(ii).indexOf('</title>');\r\n            sMessage = \"jj=\" + jj;\r\n            html = html.substr(0, ii - 1) + '<TITLE>' + title + '</TITLE>' + html.substr(ii + jj + 8);\r\n        }\r\n\r\n        // remove browseris\r\n        sMessage = \"html\";\r\n        ii = html.indexOf('browseris.mac');\r\n        if (ii > 0) {\r\n            jj = html.substr(ii).indexOf('/SCRIPT>');\r\n            if (jj == -1)\r\n                jj = html.substr(ii).indexOf('/script>');\r\n            ii = ii - 13; // <script start\r\n            html = html.substr(0, ii - 1) + html.substr(ii + jj + 13 + 7 + 1);\r\n        }\r\n\r\n        var printReadyElem = document.getElementById(sDiv);\r\n        if (printReadyElem != null) {\r\n            var sHtml;\r\n            sHtml = RemoveHREF(printReadyElem.innerHTML);\r\n            html += RemoveOnClick(sHtml);\r\n\r\n        }\r\n        else {\r\n            sMessage = 'Unknown';\r\n            alert(LEX_PrintUnknownDiv.format(sDiv));\r\n            return;\r\n        }\r\n\r\n        html += '\\n</BODY>\\n</HTML>';\r\n\r\n        //var printwin = window.showModalDialog('','PrintSpecial','dialogWidth:800px;dialogHeight:800px;toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,copyhistory=no,resizable=no,modal=yes'); \r\n        sMessage = \"printWin\";\r\n        var printWin = window.open(\"\", \"printSpecial\");\r\n        if (printWin == null) {\r\n            alert('Kan ikke printe - pop-up blocker?');\r\n            return;\r\n        }\r\n        printWin.document.open();\r\n        printWin.document.write(html);\r\n        printWin.document.close();\r\n        sMessage = \"printWin print\";\r\n        printWin.print();\r\n    } catch (e) { alert('EXPrintSpecial(' + title + ',' + bTR + ',' + sDiv + ') - ' + sMessage + ' >>> ' + e.message); }\r\n}\r\n\r\nfunction EXFixGenericPath(URL, FolderParams) {\r\n    try {\r\n        //var FolderParams;\r\n        if (FolderParams == null || FolderParams == '')\r\n            FolderParams = queryString('DL_FolderParams');\r\n        //alert('FolderParams=' + FolderParams);\r\n        var i, j, SiteG, DocLibG, FolderPG;\r\n        i = FolderParams.indexOf('/');\r\n        if (i > 0) {\r\n            SiteG = FolderParams.substr(0, i);\r\n        }\r\n        else {\r\n            SiteG = '';\r\n        }\r\n        // alert(i);\r\n        DocLibG = FolderParams.substr(i + 1);\r\n        j = DocLibG.indexOf('/');\r\n        // alert(j + ' ' + DocLibG);\r\n        FolderPG = DocLibG.substr(j + 1);\r\n        DocLibG = DocLibG.substr(0, j);\r\n        //alert(URL + ' %0=' + SiteG + ' %1=' + DocLibG + ' %2=' + FolderPG);\r\n        URL = URL.replace(/%0%/g, SiteG);\r\n        URL = URL.replace(/%1%/g, DocLibG);\r\n        URL = URL.replace(/#1#/g, DocLibG);\r\n        URL = URL.replace(/%2%/g, FolderPG);\r\n        //alert('EXFixGenericPath ' + URL);\r\n        if (false) { // LO specific code to create folder\r\n            // alert('URL=' + URL);\r\n            var sURL, i;\r\n            i = URL.indexOf('RootFolder=');\r\n            if (i != -1) {\r\n                sURL = URL.substr(i);\r\n                i = sURL.indexOf('=');\r\n                sURL = getAbsoluteURL(sURL.substr(i + 1));\r\n            }\r\n            else\r\n                sURL = URL;\r\n            // alert('EXFixGenericPath - now check URL ' + sURL);\r\n            if (!EXURLExists(sURL)) {\r\n                // alert(sURL + ' does not exists');\r\n                var oXML;\r\n                var DLEntity, DLId;\r\n                DLEntity = '';\r\n                DLId = queryString('DL_Case');\r\n                if (DLId != '') {\r\n                    DLEntity = 'DL_Case';\r\n                }\r\n                else {\r\n                    DLId = queryString('DL_Meeting');\r\n                    if (DLId != '') {\r\n                        DLEntity = 'DL_Meeting';\r\n                    }\r\n                    else {\r\n                        DLId = queryString('DL_Transmittal');\r\n                        if (DLId != '') {\r\n                            DLEntity = 'DL_Transmittal';\r\n                        }\r\n                        else {\r\n                            DLId = queryString('DL_News');\r\n                            if (DLId != '') {\r\n                                DLEntity = 'DL_News';\r\n                            }\r\n                            else {\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                if (DLEntity != '') {\r\n                    //        alert('EXCreateFolder(' + DLEntity + ',' + DLId + ') started');\r\n                    if (!EXCreateFolder(DLEntity, DLId)) {\r\n                        alert('EXCreateFolder(' + DLEntity + ',' + DLId + ') failed');\r\n                    }\r\n                }\r\n            }\r\n        } // if false\r\n        return URL;\r\n    } catch (e) { alert('EXFixGenericPath(' + URL + ') failed ' + e.message); }\r\n\r\n}\r\nfunction EXOpenGenericURL(URL, DLFolderParams, appendparam) {\r\n    //alert('EXOepnGenericURL(' + URL + ',' + DLFolderParams + ',' + appendparam + ') started');\r\n    URL = EXFixGenericPath(URL);\r\n    if (typeof (appendparam) != 'undefined' && appendparam != '' && appendparam != null) {\r\n        if (URL.indexOf('?') == -1)\r\n            URL = URL + '?' + appendparam;\r\n        else\r\n            URL = URL + '&amp;' + appendparam;\r\n    }\r\n    window.open(URL);\r\n}\r\n\r\n\r\nfunction EXCopyToClipboard(value) {\r\n    try {\r\n        if (value == '') {\r\n            windows.clipboardData.clearData();\r\n        }\r\n        else {\r\n            window.clipboardData.setData(\"Text\", value);\r\n        }\r\n    }\r\n    catch (e) { alert('EXCopyToClipboard' + e.message); }\r\n}\r\n\r\nfunction EXgetDocLibFromURL(sURL) {\r\n    try {\r\n        // alert(sURL);\r\n        var s, i;\r\n        i = sURL.indexOf('/sites/');\r\n        s = sURL.substr(i + 6 + 1);\r\n        // alert(s);\r\n        i = s.indexOf('/');\r\n        s = s.substr(i + 1);\r\n        // alert(s);\r\n        i = s.indexOf('/');\r\n        s = s.substr(0, i);\r\n        // alert(s);\r\n        return s;\r\n    }\r\n    catch (e) { alert('EXgetDocLibFromURL' + e.message); }\r\n}\r\n//alert('exformatics.js loaded');\r\n\r\nfunction EXInitDate(sDate) {\r\n    var oEle = document.getElementById(sDate);\r\n    if (oEle == null)\r\n        return;\r\n    if (oEle.value == '')\r\n        oEle.value = EXGetTodaysDateDK();\r\n}\r\nfunction EXSetDate(sDateFrom, sDateTo) {\r\n    //alert('EXSetDate');\r\n    var oEleFrom = document.getElementById(sDateFrom);\r\n    var oEleTo = document.getElementById(sDateTo);\r\n    if (oEleFrom == null || oEleTo == null)\r\n        return;\r\n    oEleTo.value = oEleFrom.value;\r\n}\r\nfunction EXCheckTime(sPropName) {\r\n    try {\r\n        var oEle = document.getElementById('TIME' + sPropName);\r\n        var s = oEle.value;\r\n        s = s.replace('.', ':');\r\n        var i = s.length;\r\n        //if (i > 2)\r\n        //\ts = s.substr(0, i-2) + ':' + s.substr(i-2,2);\r\n        if (s.indexOf(':') == -1)\r\n            if (i > 2)\r\n                s = s.substr(0, i - 2) + ':' + s.substr(i - 2, 2);\r\n            else\r\n                s = s + ':00';\r\n        oEle.value = s;\r\n        if (sPropName == 'DL_Date' && (document.getElementById('TIMEDL_DateTimeEnd'))) {\r\n            var oEle2 = document.getElementById('TIMEDL_DateTimeEnd');\r\n            i = s.indexOf(':');\r\n            var h = 1 * s.substring(0, i);\r\n            var m = 1 * s.substring(i + 1, s.length);\r\n            //alert(h + ' ' + m);\r\n            m = 1 * m + 60;\r\n            if (m >= 60) {\r\n                h = h + 1;\r\n                m = m - 60;\r\n            }\r\n            if (h > 23) {\r\n                oEle = document.getElementById('DL_DateTimeEnd');\r\n                try {\r\n                    //var date = new Date(oEle.value).addDay(1);\r\n                    //oEle.value = EXFormatDate(date);\r\n                } catch (e) { alert('Date ' + e.message); }\r\n                h = h - 24;\r\n            }\r\n            if (m < 10)\r\n                oEle2.value = '' + h + ':0' + m;\r\n            else\r\n                oEle2.value = '' + h + ':' + m;\r\n            oEle2.focus();\r\n        }\r\n    } catch (e) { }\r\n}\r\nfunction EXhandleDLMeetingDate() {\r\n    var oEle1 = document.getElementById('DL_Date');\r\n    var oEle2 = document.getElementById('DL_DateTimeEnd');\r\n    //alert('EXhandleDLMeetingDate ' + oEle1.value + ' ' + oEle2.value);\r\n    if (oEle2.value == '')\r\n        oEle2.value = oEle1.value;\r\n    try { // DOesn't work at the moment\r\n        var oD1 = new Date(oEle1.value);\r\n        var oD2 = new Date(oEle2.value);\r\n        if (oD1 > oD2)\r\n            oEle2.value = oEle1.value;\r\n    } catch (e) { alert('EXhandleDLMeetingDate ' + e.message); }\r\n}\r\nfunction EXGetTodaysDate() {\r\n    try {\r\n        var oToday = new Date();\r\n        var year = oToday.getFullYear();\r\n        var month = oToday.getMonth() + 1;\r\n        var day = oToday.getDate();\r\n        //return '' + year + '-' + month + '-' + day;\r\n        return '' + year + '-' + (month < 10 ? '0' : '') + month + '-' + day; // 25.4.2010\r\n    } catch (e) { alert('EXGetTodaysDate ' + e.message); }\r\n}\r\nfunction EXFormatDate(date) {\r\n    // 2.8.2013 - format date using jQuery datepicker - to support any language format\r\n    var s;\r\n    s = $.datepicker.formatDate($.datepicker._defaults.dateFormat, date);\r\n    return s;\r\n    var year = date.getFullYear();\r\n    var month = date.getMonth() + 1;\r\n    var day = date.getDate();\r\n    return '' + day + '-' + month + '-' + year;\r\n}\r\nfunction EXFormatDateTime(date) {\r\n    var s = EXFormatDate(date);\r\n    var hour = date.getHours();\r\n    var minute = date.getMinutes();\r\n    if (minute < 10)\r\n        minute = '0' + minute;\r\n    return s + ' ' + hour + ':' + minute;\r\n}\r\nDate.prototype.addDays = function (days) { this.setDate(this.getDate() + days); } // 14.10.2010\r\n//2.8.2013 now work in ANY language - EXForamtDate return date in proper format\r\nfunction EXGetTodaysDateDK(iDays) { // 14.10.2010 - iAdd added\r\n    if (typeof (iDays) == 'undefined')\r\n        iDays = 0;\r\n    try {\r\n        var oToday = new Date();\r\n        //alert(iDays + ' ' + oToday);\r\n        if (iDays != 0)\r\n            oToday.addDays(1 * iDays);\r\n        //alert(iDays + ' ' + oToday);\r\n        return EXFormatDate(oToday);\r\n    } catch (e) { alert('EXGetTodaysDateDK ' + e.message); }\r\n}\r\nfunction EXGetTodaysYear() {\r\n    try {\r\n        var oToday = new Date();\r\n        var year = oToday.getFullYear();\r\n        return '' + year;\r\n    } catch (e) { alert('EXGetTodaysYear ' + e.message); }\r\n}\r\nfunction EXGetTodaysYearMonth() {\r\n    try {\r\n        var oToday = new Date();\r\n        var year = oToday.getFullYear();\r\n        var month = oToday.getMonth() + 1;\r\n        if (month < 10)\r\n            month = '0' + month;\r\n        return '' + year + month;\r\n    } catch (e) { alert('EXGetTodaysYearMonth ' + e.message); }\r\n}\r\n\r\nfunction EXDLFixDate(sDate) { // yyyy-mm-dd --\x3e dd-mm-yy\r\n    if (sDate.length < 10)\r\n        return '';\r\n    return sDate.substr(8, 2) + '-' + sDate.substr(5, 2) + '-' + sDate.substr(2, 2);\r\n}\r\nfunction EXDKDate2SQLDate(sDate) { // dd-mm-yyyy --\x3e yyyy-mm-dd\r\n    try {\r\n        // 2.8.2013 - now use jQUery datepicker\r\n        var date = $.datepicker.parseDate($.datepicker._defaults.dateFormat, sDate);\r\n        var s = $.datepicker.formatDate('yy-mm-dd', date);\r\n        return s;\r\n        var d, m, y, i;\r\n        i = sDate.indexOf('-');\r\n        d = sDate.substring(0, i);\r\n        sDate = sDate.substring(i + 1, sDate.length);\r\n        i = sDate.indexOf('-');\r\n        m = sDate.substring(0, i);\r\n        y = sDate.substring(i + 1, sDate.length);\r\n        sDate = '' + y + '-' + m + '-' + d;\r\n        //alert('EXDKDate2SQLDate ' + sDate);\r\n        return sDate;\r\n    } catch (e) { alert('EXDKDate2SQLDate ' + e.message); }\r\n}\r\nfunction EXgetDocumentURL(URLDocument, DocumentVersion, EXDocumentID) {\r\n    try {\r\n        var oMeta = EXgetDocumentMetaData(URLDocument);\r\n        var oVersion = getsafe(oMeta, 'owshiddenversion');\r\n        if (oVersion == DocumentVersion) {\r\n            return URLDocument;\r\n        }\r\n        else {\r\n            var i, j, s1, s2;\r\n            i = URLDocument.indexOf('/sites');\r\n            j = URLDocument.substr(i + 7).indexOf('/');\r\n            s1 = URLDocument.substr(0, i + 7 + j + 1);\r\n            s2 = URLDocument.substr(i + 7 + j);\r\n            // alert('s1=' + s1 + ' s2=' + s2);\r\n            URLDocument = s1 + '_vti_history/' + DocumentVersion + s2;\r\n            // alert('URLDocument=' + URLDocument);\r\n            return URLDocument;\r\n        }\r\n    } catch (e) { alert('EXgetDocumentURL(' + URLDocument + ', ' + DocumentVersion + ', ' + EXDocumentID + ') ' + e.message); }\r\n}\r\n\r\nfunction IsNumeric(sText) {\r\n    var ValidChars = \"0123456789.\";\r\n    var IsNumber = true;\r\n    var Char;\r\n\r\n    for (i = 0; i < sText.length && IsNumber == true; i++) {\r\n        Char = sText.charAt(i);\r\n        if (ValidChars.indexOf(Char) == -1) {\r\n            IsNumber = false;\r\n            return IsNumber;\r\n        }\r\n    }\r\n    return IsNumber;\r\n}\r\n\r\n\r\n// Workflow functionality\r\nfunction EXwfInitDIV(sWFDIV) {\r\n    try {\r\n        var oEle = document.getElementById(sWFDIV);\r\n        var formLength = document.all.testSelect.length;\r\n        var s, i;\r\n        s = \"<table id='EXwftable'><tr>\";\r\n        for (i = 0; i < formLength; i++) {\r\n            if (document.all.testSelect[i].selected) {\r\n                s = s + \"<a onmouseover='javascript:EXwfover(\" + i + \")' onmouseout='javascript:EXwfout(\" + i + \")' onclick='javascript:EXwfchange(\" + i + \")'><td align='center' id='EXwftd\" + i + \"' class='EXwfselect' height='29' width='50'>\" + document.all.testSelect[i].name + \"</td></a>\";\r\n            }\r\n            else {\r\n                s = s + \"<a onmouseover='javascript:EXwfover(\" + i + \")' onmouseout='javascript:EXwfout(\" + i + \")' onclick='javascript:EXwfchange(\" + i + \")'><td align='center' id='EXwftd\" + i + \"' class='EXwfunselect' height='29' width='50' >\" + document.all.testSelect[i].name + \"</td></a>\";\r\n            }\r\n        } // for\r\n\r\n        s = s + '</tr></table>';\r\n        oEle.innerHTML = s;\r\n    } catch (e) { alert('EXwfInitDIV ' + e.message); }\r\n} // EXwfInitDIV\r\nfunction EXwfover(i) {\r\n    try {\r\n        var oEle = document.getElementById('EXwftd' + i);\r\n        oEle.className = 'EXwfover';\r\n    } catch (e) { alert('EXwfselectover ' + i + ' ' + e.message); }\r\n}\r\nfunction EXwfout(i) {\r\n    try {\r\n        var oEle = document.getElementById('EXwftd' + i);\r\n        if (document.all.testSelect[i].selected)\r\n            oEle.className = 'EXwfselect';\r\n        else\r\n            oEle.className = 'EXwfunselect';\r\n    } catch (e) { alert('EXwfselectover ' + i + ' ' + e.message); }\r\n}\r\n\r\nfunction EXwfDoOverOut(b) {\r\n    try {\r\n        var oEle = document.all.testSelect;\r\n        if (b)\r\n            oEle.style.display = '';\r\n        else\r\n            oEle.style.display = 'none';\r\n    } catch (e) { alert('EXwfDoOverOut ' + e.message); }\r\n}\r\nfunction EXwfchange1() {\r\n    try {\r\n        //alert(document.all.testSelect.value);\r\n        //alert(document.all.testSelect.options[document.all.testSelect.selectedIndex].name + ' ' + document.all.testSelect.selectedIndex);\r\n        var formLength = document.all.testSelect.length;\r\n        var i, iSelect, oEle;\r\n        iSelect = -1;\r\n        for (i = 0; i < formLength; i++) {\r\n            oEle = document.getElementById('EXwftd' + i);\r\n            if (oEle.className == 'EXwfselect') {\r\n                iSelect = i;\r\n                break;\r\n            }\r\n        }\r\n        EXwfchange(document.all.testSelect.selectedIndex, iSelect);\r\n    } catch (e) { alert('EXwfchange1 ' + e.message); }\r\n}\r\nfunction EXwfchange(i, iSelect) {\r\n    try {\r\n        var s, ii;\r\n        if ((iSelect == null) || (iSelect == undefined))\r\n            iSelect = document.all.testSelect.selectedIndex;\r\n        //alert('EXwfchange ' + i + ' ' + iSelect + ' invoked');\r\n        if (i == iSelect)\r\n            return;\r\n\r\n        if (iSelect == -1)\r\n            s = LEX_WFChangeStatusTo.format(document.all.testSelect.options[i].name);\r\n        else\r\n            s = LEX_WFChangeStatusFromTo.format(document.all.testSelect.options[iSelect].name, document.all.testSelect.options[i].name);\r\n        if (confirm(s)) {\r\n            var j;\r\n            var oEle = document.getElementById('EXwftable');\r\n            var oEle2 = oEle.getElementsByTagName('TD');\r\n            for (j = 0; j < oEle2.length; j++) {\r\n                if (j == i)\r\n                    oEle2[j].className = 'EXwfselect';\r\n                else\r\n                    oEle2[j].className = 'EXwfunselect';\r\n            }\r\n            oEle = document.getElementById('testSelect');\r\n            oEle.value = i;\r\n            EXwfupdate();\r\n            //window.location.href = window.location.href;\r\n        }\r\n    } catch (e) { alert('EXwfchange - ' + e.message); }\r\n    return false;\r\n}\r\nfunction EXwfupdate() {\r\n    try {\r\n        var oCase, oState, i;\r\n        oCase = queryString('LO_PCase');\r\n        i = document.all.testSelect.selectedIndex;\r\n        oState = document.all.testSelect.options[i].value;\r\n        //alert('now update ' + oCase + ' to value ' + oState);\r\n        var oXML;\r\n        oXML = getEntityData('LO_PCase', 'DL_Id=' + oCase, '');\r\n        SetEntityItemValue('LO_PCase', oCase, getsafe(oXML, '//DL_Modified'), 'LO_PCaseState', oState);\r\n        window.location.href = window.location.href;\r\n    } catch (e) { alert('EXwfupdate ' + e.message); }\r\n}\r\nfunction EXwfSet(i) {\r\n    try {\r\n        if ((i == undefined) || (i == -1) || (i == ''))\r\n            return;\r\n        //alert('EXwfSet ' + i + ' invoked');\r\n        var s, ii;\r\n\r\n        var j;\r\n        var oEle = document.getElementById('EXwftable');\r\n        var oEle2 = oEle.getElementsByTagName('TD');\r\n        for (j = 0; j < oEle2.length; j++) {\r\n            if (j == i)\r\n                oEle2[j].className = 'EXwfselect';\r\n            else\r\n                oEle2[j].className = 'EXwfunselect';\r\n        }\r\n        oEle = document.getElementById('testSelect');\r\n        oEle.value = i;\r\n    } catch (e) { alert('EXwfSet - ' + e.message); }\r\n    return false;\r\n}\r\n\r\n\r\nfunction trim(sString) {\r\n    while (sString.substring(0, 1) == ' ') {\r\n        sString = sString.substring(1, sString.length);\r\n    }\r\n    while (sString.substring(sString.length - 1, sString.length) == ' ') {\r\n        sString = sString.substring(0, sString.length - 1);\r\n    }\r\n    return sString;\r\n}\r\n\r\nfunction EXAddToFavorites(DLEntity, DLId, DLTitle) {\r\n    try {\r\n        var oXML;\r\n        // Already a favorites\r\n        oXML = getEntityData('DL_Favorites', 'DL_CreatedBy = %WUSER% AND DL_EntityNameForeign = \\'' + DLEntity + '\\' AND DL_EntityId = ' + DLId, '');\r\n        if (oXML.selectSingleNode('//DL_ENTITYDATA/DL_Favorites') == null) {\r\n            oXML = getEntityData(DLEntity, 'DL_Id = ' + DLId, '');\r\n            var sTitle = '';\r\n\r\n            if ((DLTitle != '') && (DLTitle != null)) {\r\n                sTitle = getsafe(oXML, '//' + DLTitle);\r\n            }\r\n            else {\r\n                switch (DLEntity) {\r\n                    case 'DL_Person': sTitle = getsafe(oXML, '//DL_Name'); if (sTitle == '') sTitle = getsafe(oXML, '//DL_FullName'); break;\r\n                    case 'DL_Organisation': sTitle = getsafe(oXML, '//DL_Company'); break;\r\n                    case 'LO_PMeeting': sTitle = getsafe(oXML, '//LO_PMeetingType') + ' ' + getsafe(oXML, '//DL_Date').substr(0, 10); break;\r\n                    case 'DL_ProjectDefinition': sTitle = getsafe(oXML, '//DL_ProjectID') + ' ' + getsafe(oXML, '//DL_ProjectName'); break;\r\n                    case 'EX_Project': sTitle = getsafe(oXML, '//DL_ProjectID') + ' ' + getsafe(oXML, '//DL_ProjectName'); break; // 29.1.2012\r\n                    case 'DL_sAMAccountName': sTitle = getsafe(oXML, '//DL_FullName'); break;\r\n                    case 'DL_BRMConfig': sTitle = getsafe(oXML, '//DL_Company'); break;\r\n                    case 'BRM_Case': sTitle = getsafe(oXML, '//DL_Title'); break;\r\n                    case 'IT_Case': sTitle = getsafe(oXML, '//DL_Title'); break;\r\n                    default: sTitle = getsafe(oXML, '//DL_CaseNo') + ' ' + getsafe(oXML, '//DL_Title'); break;\r\n                }\r\n            }\r\n\r\n            // Add object to DL_Favorites\r\n            var xOps = '<DL_Favorites><DELETE/><UPDATE/><INSERT>';\r\n            xOps = '';\r\n            xOps = xOps + '<Row><DL_EntityNameForeign>' + DLEntity + '</DL_EntityNameForeign><DL_EntityId>' + DLId + '</DL_EntityId><DL_Title>' + MakeXMLSafe(sTitle) + '</DL_Title>'; // 29.12.2010 - MakeXMLSafe added\r\n            xOps = xOps + '</Row>';\r\n            //xOps = xOps + '</INSERT></DL_Favorites>';\r\n            //alert(xOps);\r\n            //setEntity('DL_Favorites', xOps);\r\n            var DLId = setEntityDetail('DL_Favorites', xOps);\r\n            //var DLId = getsafe(oX, '//DL_Favorites/DL_Id');\r\n            loadentity('DL_Favorites', DLId); // 4.12.2009\r\n            //alert(sTitle + LEX__FavoritesObjectAdded + ' ' + DLId);\r\n        }\r\n        else {\r\n            //    function loadentity(entity, id, appendparam, keyname, title, bFirstFieldFocus, bReloadOnChange)\r\n            loadentity('DL_Favorites', getsafe(oXML, '//DL_Id'), '', '', LEX_FavoritesAlreadyExists); // 30.12.2009\r\n            //alert(LEX_FavoritesAlreadyExists);\r\n        }\r\n    } catch (e) { alert('EXAddToFavorites ' + e.message); }\r\n    return false; // 24.2.2009\r\n}\r\n\r\n//alert('exforamtics.js loaded');\r\n\r\n\r\nfunction EXvalidateLength50(oSrc, args) { _EXvalidateLength(oSrc, args, 50); }\r\nfunction EXvalidateLength100(oSrc, args) { _EXvalidateLength(oSrc, args, 100); }\r\nfunction EXvalidateLength200(oSrc, args) { _EXvalidateLength(oSrc, args, 200); }\r\nfunction EXvalidateLength256(oSrc, args) { _EXvalidateLength(oSrc, args, 256); }\r\nfunction _EXvalidateLength(oSrc, args, iLen) {\r\n    //alert(oSrc.id + ' ' + iLen + ' ' + args.Value);\r\n    args.IsValid = (args.Value.length <= iLen);\r\n}\r\n\r\nfunction EXGotoDictionaryObject(DLPropDictionaryForeign, DLEntityKeyText) {\r\n    var oXML = getEntityData('DL_D620', 'DL_PropDictionaryForeign = \\'' + DLPropDictionaryForeign + '\\'', '');\r\n    var DLEntityNameForeign = getsafe(oXML, '//DL_EntityNameForeign');\r\n    var DLPropName = getsafe(oXML, '//DL_PropNameForeign');\r\n    var sWhere = DLPropName + ' = \\'' + DLEntityKeyText + '\\'';\r\n    //alert('EXGotoDictionaryObject ' + sWhere);\r\n    EXGotoObject(DLEntityNameForeign, null, false, sWhere);\r\n}\r\n\r\nfunction EXOpenTask(DLEntity, DLId, BPMResponsible) {\r\n    try {\r\n        var oXML = getEntityData('DL_sAMAccountName', 'DL_sAMAccountName = %DL_sAMAccountName%', '');\r\n        var DLsAMAccountName = getsafe(oXML, '//DL_sAMAccountName/DL_sAMAccountName');\r\n        //alert('DEBUG\\nEXOpenTask ' + DLsAMAccountName + ' ' + BPMResponsible);\r\n        if (DLsAMAccountName.toLowerCase() == BPMResponsible.toLowerCase()) // 14.9.2008 - added toLowerCase\r\n            try {\r\n                DLopentask(DLEntity, DLId);\r\n            } catch (e) { loadentity(DLEntity, DLId); }\r\n        else\r\n            loadentity(DLEntity, DLId);\r\n    } catch (e) { alert('EXOpenTask ' + e.message); }\r\n}\r\nfunction EXSeenTask(DLEntity, DLId, DLModified) { // 14.12.2010\r\n    if (EXGetUserRole() == 0) { // 3.11.2009\r\n        alert(LEX_UserNoAccessCannotCloseTask);\r\n        return;\r\n    }\r\n    SetEntityItemValue(DLEntity, DLId, DLModified, 'DL_SeenByUser', '1');\r\n    var oEle = document.getElementById('EXSeenTask' + DLId);\r\n    if (oEle == null)\r\n        alert('Could not find \"EXSeenTask' + DLId + '\"');\r\n    else\r\n        oEle.style.display = 'none'; // Once seen don't do anything\r\n}\r\nfunction EXCloseTaskX(DLEntity, DLId, DLModified, DLENF, DLEId) { // used in the front page web part\r\n    EXCloseTask(DLEntity, DLId, DLModified);\r\n}\r\nfunction EXCloseTask(DLEntity, DLId, DLModified, bNotApplicable, iApprovalStatus) { // 9.8.2011 bNotApplicable added\r\n    if (typeof (iApprovalStatus) == 'undefined')\r\n        iApprovalStatus = 0;\r\n    if (typeof (bNotApplicable) == 'string') // 21.10.2013 - IT Case 4229\r\n        bNotApplicable = false;\r\n    if (typeof (bNotApplicable) == 'undefined')\r\n        bNotApplicable = false;\r\n    if (EXGetUserRole() == 0) { // 3.11.2009\r\n        alert(LEX_UserNoAccessCannotCloseTask);\r\n        return;\r\n    }\r\n    if (iApprovalStatus > 0) { // 21.8.2013\r\n        var sUser = GetEntityItemWhere('DL_sAMAccountName', 'DL_sAMAccountName=%DL_sAMAccountName%', 'DL_sAMAccountName');\r\n        var sResponsible = GetEntityItemValue('DL_ApprovalTasks', DLId, 'BPM_Responsible');\r\n        if (sResponsible.toLowerCase() != sUser.toLowerCase()) {\r\n            return;\r\n        }\r\n        //SetEntityItemValue(DLEntity,DLId,DLModified,'BPM_PctComplete',1,'BPM_ClosedOnPortal',1,'BPM_ApprovalStatus',iApprovalStatus);\r\n        SetEntityItemValue(DLEntity, DLId, DLModified, 'BPM_Status', 2, 'BPM_ClosedOnPortal', 1, 'BPM_ApprovalStatus', iApprovalStatus);\r\n    }\r\n    else if (bNotApplicable) // 9.8.2011\r\n        SetEntityItemValue(DLEntity, DLId, DLModified, 'BPM_PctComplete', 1, 'BPM_ClosedOnPortal', 1, 'BPM_Status', 5);\r\n    else\r\n        SetEntityItemValue(DLEntity, DLId, DLModified, 'BPM_PctComplete', 1, 'BPM_ClosedOnPortal', 1, 'BPM_Status', 2); // 24.4.2008 - CorpNordic\r\n    try {\r\n        var oEle = document.getElementById('BPMPctComplete' + DLId);\r\n        if (oEle != null)\r\n            oEle.innerHTML = '100%';\r\n        oEle = document.getElementById('EXCloseTask' + DLId); // Close on task image, 21.2.2008\r\n        if (oEle == null) // 14.8.2009\r\n            oEle = document.getElementById('tr' + DLEntity + DLId); // EXDynWP\r\n        else\r\n            oEle = oEle.parentNode.parentNode.parentNode;\r\n        if (oEle != null) // 19-04-2008/JRD: Tilføjet if-omkring\r\n        {\r\n            oEle.style.textDecoration = 'line-through';\r\n        }\r\n    } catch (e) { alert('EXCloseTask(' + DLEntity + ',' + DLId + ',' + DLModified + ') ' + e.message); }\r\n    if (typeof (EXDynWPRefresh) == 'function') // 16.8.2009 - dynamic reload\r\n        EXDynWPRefresh(DLEntity);\r\n}\r\nfunction EXAssignTaskToCase(DLId) { // 12.5.2008\r\n    alert('EXAssignTaskToCase(' + DLId + ') not implemented yet');\r\n    var xTask = getEntityData('DL_Tasks', 'DL_Id = ' + DLId, '');\r\n    // 2 drop down lister - een med Sagsgrene - og een med recent objekter - skal det være muligt at tilføje helt generelt?\r\n}\r\nfunction EXModifyWPTitle(oEle, sText) {\r\n    //alert('EXModifyWPTitle');\r\n    var oDiv = oEle.parentNode;\r\n    var s = '' + oDiv.id;\r\n    s = s.replace('WebPartWP', 'WebPartTitleWP');\r\n    oDiv = document.getElementById(s);\r\n    /*\r\n    var tblTR = oDiv.getElementsByTagName('div');\r\n    for (var i=0; i<tblTR.length;i++) {\r\n    var trElm = tblTR(i);\r\n    if (trElm.className == 'ms-WPTitle') {\r\n    trElm.innerHTML = trElm.innerHTML + ' hejsa';\r\n    return;\r\n    }\r\n    }\r\n    */\r\n    if (oDiv != null) {\r\n        oEle = oDiv.childNodes[0];\r\n        if (oEle != null)\r\n            oEle = oEle.childNodes[0];\r\n        if (oEle != null)\r\n            oEle = oEle.childNodes[0];\r\n        if (oEle != null)\r\n            oEle.innerHTML = oEle.innerHTML + ' ' + sText;\r\n    }\r\n}\r\n// Clipboard functionality\r\nfunction EXgetClipboardDataTypeAsText() {\r\n    var i;\r\n    i = EXgetClipboardDataType();\r\n    switch (i) {\r\n        case -200: return '#ERROR: Exformatics Windows Extension not installed - please install';\r\n        case -100: return '#ERROR: Internal exception - please contact system administrator';\r\n        case -1: return 'Clipboard is empty';\r\n        case 1: return 'Text';\r\n        case 2: return 'File';\r\n        case 3: return 'File attachment';\r\n        case 4: return 'Bitmap';\r\n        default: return '';\r\n    }\r\n}\r\nfunction EXgetClipboardDataType() {\r\n    var oX = getEXUtilities();\r\n    if (!oX)\r\n        return -200;\r\n    var s = oX.getClipboardDataType();\r\n    oX = null;\r\n    return s;\r\n}\r\nfunction EXgetClipboardFileName() {\r\n    var oX = getEXUtilities();\r\n    if (!oX)\r\n        return;\r\n    var s = oX.getClipboardFileName();\r\n    oX = null;\r\n    return s;\r\n}\r\nfunction EXUploadClipboardToDocLib(sServer, DL_Entity, DL_Id, DL_FolderType, sProperties) {\r\n    var oX = getEXUtilities();\r\n    if (!oX)\r\n        return;\r\n    var s = oX.UploadClipboardToDocLib(sServer, DL_Entity, DL_Id, DL_FolderType, sProperties);\r\n    oX = null;\r\n    return s;\r\n}\r\nfunction EXhandlePasteFile(sEle, sServer, DL_Entity, DL_FolderType, DL_Id, sProperties) {\r\n    try {\r\n        var oX = getEXUtilities();\r\n        if (!oX)\r\n            return;\r\n\r\n        if (DL_Id == null)\r\n            DL_Id = queryString(DL_Entity);\r\n        //window.event.returnValue = false; // block further values\r\n\r\n        var sFile = oX.getClipboardFileName();\r\n        if (sFile == '') {\r\n            alert(LEX_ClipboardNoFile);\r\n            return;\r\n        }\r\n        if (confirm(LEX_UploadFileToServer.format(sFile))) {\r\n            var oEle = null;\r\n            var sHTML = '';\r\n            if (sEle != null) {\r\n                oEle = document.getElementById(sEle);\r\n                sHTML = oEle.innerHTML;\r\n                oEle.innerHTML = 'ZZ';\r\n                oEle = null;\r\n                if (sEle != '') {\r\n                    oEle = document.getElementById(sEle);\r\n                    oEle.innerHTML = 'Please wait' + ' ';\r\n                }\r\n            }\r\n            if (sProperties == '')\r\n                sProperties = '<Props/>';\r\n            sFile = oX.UploadClipboardToDocLib(sServer, DL_Entity, DL_Id, DL_FolderType, sProperties);\r\n            oX = null; // 6.12.2008 - release object\r\n            if (sFile == '#ERROR') {\r\n                alert(LEX_UploadFilesFailed.format(sFile));\r\n                if (oEle != null) oEle.innerHTML = sHTML;\r\n            }\r\n            else {\r\n                if (oEle != null) oEle.innerHTML = LEX_UploadFilesCompleted.format(sFile);\r\n                alert('File uploaded ' + sFile);\r\n                EXReload();\r\n            }\r\n        }\r\n    } catch (e) { alert('EXhandlePasteFile ' + e.message); }\r\n    return;\r\n}\r\nfunction EXClipboardToEntity(sServer, DLEntity, DLFolderParams, DLFolderType) {\r\n    alert('EXClipboardToEntity - not implemented yet!');\r\n}\r\n\r\nfunction DLLinkObject2Object(DLEntity, sVars, sValues, message, errmsg, bDelay, bDontLoad) {\r\n    try {\r\n        var i;\r\n        var aVars = sVars.split(\",\");\r\n        var aValues = sValues.split(\",\");\r\n        if (aVars.length != aValues.length) {\r\n            alert('DLLinkObject2Object length issue ' + sVars + ':' + sValues);\r\n            return;\r\n        }\r\n        var sWhere = '';\r\n        for (i = 0; i < aVars.length; i++) {\r\n            if (i > 0)\r\n                sWhere = sWhere + ' AND ';\r\n            sWhere = sWhere + ' ' + aVars[i] + ' = \\'' + aValues[i] + '\\'';\r\n        }\r\n        //alert(sWhere);\r\n        var oXML = getEntityData2('count(*)', DLEntity, sWhere, '');\r\n        var c = getsafe(oXML, '//' + DLEntity);\r\n        if (1 * c > 0) {\r\n            alert(errmsg); // 19.8.2008 + ' #=' + c);\r\n            return;\r\n        }\r\n        if (bDelay) {\r\n            newentity2(DLEntity, sKeys, sValues, '');\r\n        }\r\n        else {\r\n            var xOps;\r\n            xOps = '<' + DLEntity + '>';\r\n            for (i = 0; i < aVars.length; i++) {\r\n                xOps = xOps + '<' + aVars[i] + '>' + aValues[i] + '</' + aVars[i] + '>';\r\n            }\r\n            xOps = xOps + '</' + DLEntity + '>';\r\n            var DLId = setEntityDetail(DLEntity, xOps);\r\n            if (message)\r\n                alert(message);\r\n            if (!bDontLoad)\r\n                loadentity(DLEntity, DLId);\r\n        }\r\n    } catch (e) { alert('DLLinkObject2Object ' + e.message); }\r\n}\r\nfunction DLLinkObject2Object2(DLEntity, sVars, sValues, message, errmsg, bDelay, bDontLoad) { // 8.9.2011 - new version of above - no alerts - but empty string if ok\r\n    try {\r\n        var i;\r\n        var aVars = sVars.split(\",\");\r\n        var aValues = sValues.split(\",\");\r\n        if (aVars.length != aValues.length) {\r\n            alert('DLLinkObject2Object length issue ' + sVars + ':' + sValues);\r\n            return;\r\n        }\r\n        var sWhere = '';\r\n        for (i = 0; i < aVars.length; i++) {\r\n            if (i > 0)\r\n                sWhere = sWhere + ' AND ';\r\n            sWhere = sWhere + ' ' + aVars[i] + ' = \\'' + aValues[i] + '\\'';\r\n        }\r\n        var oXML = getEntityData2('count(*)', DLEntity, sWhere, '');\r\n        var c = getsafe(oXML, '//' + DLEntity);\r\n        if (1 * c > 0) {\r\n            return (errmsg);\r\n        }\r\n        if (bDelay) {\r\n            newentity2(DLEntity, sKeys, sValues, '');\r\n        }\r\n        else {\r\n            var xOps;\r\n            xOps = '<' + DLEntity + '>';\r\n            for (i = 0; i < aVars.length; i++) {\r\n                xOps = xOps + '<' + aVars[i] + '>' + aValues[i] + '</' + aVars[i] + '>';\r\n            }\r\n            xOps = xOps + '</' + DLEntity + '>';\r\n            var DLId = setEntityDetail(DLEntity, xOps);\r\n            if (!bDontLoad)\r\n                loadentity(DLEntity, DLId);\r\n        }\r\n        return '';\r\n    } catch (e) { return ('DLLinkObject2Object2 ' + e.message); }\r\n}\r\nfunction EXApproveDocumentProcess(DLEntityNameForeign, DLEntityId) { // 30.1.2012\r\n    var oXML = ExecuteProcedure('EXApproveDocumentProcess @DLEntityNameForeign=\\'' + DLEntityNameForeign + '\\',@DLEntityId=' + DLEntityId + ',@WUser=%WUSER%');\r\n    //alert(oXML.xml);\r\n    var url = getsafe(oXML, '//Url');\r\n    //alert(url);\r\n    if (url != '')\r\n        eval(url);\r\n    else {\r\n        EXDocBasketRefresh();\r\n    }\r\n}\r\n// 23-9-2007 - code moved from LO --\x3e general (FTF,Symphogen)\r\nfunction EXDocBasketToEntity(DLEntity, DLId, bFromDocBasket, bSilence) { // 17.9.2008\r\n    if (typeof (bSilence) == 'undefined')\r\n        bSilence = false;\r\n    if (typeof (bFromDocBasket) == 'undefined') // 17.9.2008\r\n        bFromDocBasket = false;\r\n    if (DLId == '') return; // 1.4.2008\r\n    if (DLEntity == 'DL_Transmittal') {\r\n        EXMoveDocBasketToTransmittal(DLId);\r\n        EXReload();\r\n    }\r\n    else {\r\n        //alert('EXDocBasketToEntity(' + DLEntity + ',' + DLId + ') not implemented yet!');\r\n        ExecuteProcedure('dbo.EXMoveDocBasket2Entity @DLEntityNameForeign=\\'' + DLEntity + '\\', @DLEntityId=' + DLId + ', @WUser = %WUSER%'); // 27.2.2008\r\n        //ExecuteProcedure('dbo.EXCopyDocBasket2Entity @DLEntityNameForeign=\\'' + DLEntity + '\\', @DLEntityId=' + DLId + ', @WUser = %WUSER%');\r\n        //EXDocBasketRefresh(); // 15.4.2008 - update document basket\r\n        //try {EXWPLoadLinkedDocuments('Linked Documents'); } catch (e) {}\r\n        if (bFromDocBasket) { // 17.9.2008\r\n            try {\r\n                EXWPLoadLinkedDocuments(LEX_LinkedDocuments);\r\n            } catch (e) { }\r\n            if (!bSilence)\r\n            //var LEX_DocBasketLinkedCompleted = 'Dokumenter linked til sagen';\r\n                alert(LEX_DocBasketLinkedCompleted);\r\n            EXDocBasketRefresh(); // 2.2.2010\r\n        }\r\n        else\r\n            EXReload();\r\n    }\r\n}\r\n\r\nfunction EXDocBasket2Copy(DLEntity, DLEntityIdParam) { // 06-07-2011 BH IT-Case 679 - 23.6.2012 - UNCLEAR WHAT THIS DOES\r\n    loadcontent2('/ex_resources/EXCopyFiles.html?destination=' + oExBasketFolder, 'Copying!');\r\n}\r\n\r\nfunction EXMoveDocBasketToTransmittal(DL_Transmittal) {\r\n    var oEle = document.getElementById('%WUser%');\r\n    var sUser = '';\r\n    if (oEle != null) {\r\n        sUser = oEle.innerHTML\r\n        //alert(sUser);\r\n    }\r\n    ExecuteProcedure('dbo.EXMoveDocBasketToTransmittal @DLEntityId = ' + DL_Transmittal + ', @WUser = \\'' + sUser + '\\'');\r\n}\r\n\r\nfunction EXDocBasketNotify() {\r\n    window.open(getAbsoluteURL('/EX_Resources/EXNotify.html'));\r\n}\r\n\r\nfunction EXDocBasket2TransmittalCallback(DLId) { // 11.12.2012 - click action below must point to this function - DL_TitleUnique has this value\r\n    SetRecentValue('DL_Transmittal', DLId);\r\n\r\n    EXMoveDocBasketToTransmittal(DLId);\r\n    EXGotoObject('DL_Transmittal', DLId);\r\n    //displayentity2('DL_Transmittal',DLId,'Dokumentpakke...');\r\n}\r\nfunction EXDocBasket2Transmittal(EntityNameForeign, EntityId) {\r\n    // alert('EXDocBasket2Transmittal');\r\n    var DL_Transmittal, title;\r\n    title = LEX_DocBasketTransmittalTitle.format(queryString('DL_CaseNo'));\r\n    newentity2('DL_Transmittal', 'DL_EntityNameForeign,DL_EntityId', EntityNameForeign + ',' + EntityId, '&Action=1390', title); // check 1390 in DL_Action\r\n    return;\r\n    DL_Transmittal = _EXnewTransmittal(EntityNameForeign, EntityId, title);\r\n    SetRecentValue('DL_Transmittal', DL_Transmittal);\r\n\r\n    // Flyt alle dokumenterne i kurven til forsendelsen\r\n    EXMoveDocBasketToTransmittal(DL_Transmittal);\r\n    if (true) { // 3.1.2010\r\n        displayentity2('DL_Transmittal', GetRecentValue('DL_Transmittal'), 'Dokumentpakke...');\r\n    }\r\n    else {\r\n        alert(LEX_DocBasketTransmittalCreated.format(title));\r\n        //EXGotoObject('DL_Transmittal',GetRecentValue('DL_Transmittal')); // 1.4.2008 - FKIL\r\n        EXReload();\r\n    }\r\n}\r\n\r\nfunction EXLinkToCase(DLEntity, DLId) { // 29.5.2008\r\n    //alert('EXLinkToCase(' + DLEntity + ',' + DLId + ') invoked');\r\n    if (DLEntity == '' || DLId == '' || DLId == 0)\r\n        return;\r\n    var DLEntity2 = queryString('ForeignEntity', true);\r\n    var DLEntityId2 = queryString('ForeignId', true);\r\n    //alert(DLEntity2 + ' ' + DLEntityId2);\r\n    if (DLEntity2 == '' || DLEntityId2 == '')\r\n        return;\r\n    var xOps = '<DL_Case2Case>';\r\n    xOps = xOps + '<DL_EntityNameForeign2>' + DLEntity + '</DL_EntityNameForeign2><DL_EntityId2>' + DLId + '</DL_EntityId2><DL_EntityNameForeign>' + DLEntity2 + '</DL_EntityNameForeign><DL_EntityId>' + DLEntityId2 + '</DL_EntityId><DL_IsHierarchyLink>1</DL_IsHierarchyLink>';\r\n    xOps = xOps + '</DL_Case2Case>';\r\n    //alert(xOps);\r\n    var DLCase2Case = setEntityDetail('DL_Case2Case', xOps);\r\n    //alert('EXLinkToCase - Linked to case ' + DLCase2Case + ' now EXGotoObject(' + DLEntity + ',' + DLId + '1 )');\r\n    EXGotoObject(DLEntity, DLId); // Goto page after link\r\n    //alert('EXGotoObject - completed - strange');\r\n    //return false; // Do we really need this?\r\n}\r\nvar sEXEntity; // 6.6.2010\r\nvar sEXEntityId;\r\nfunction EXInitMainEntity(DLEntity, DLAction, DLEntityIdParam, DLParams, DLTask, appendparams, bDoNotLoad, bDisplayEntity, bShowCaseLog, DLCaseProtected) { // 3.6.2008 -  bDisplayEntity added - used in meeting // 18.8.2008  bShowCaseLog added\r\n    if (typeof (DLCaseProtected) == 'undefined' || DLCaseProtected == null) // 12.8.2009\r\n        DLCaseProtected = '0';\r\n    if (typeof (bShowCaseLog) == 'undefined' || bShowCaseLog == null)\r\n        bShowCaseLog = false;\r\n    if (bDoNotLoad == null || bDoNotLoad == 'undefined')\r\n        bDoNotLoad = false;\r\n    if (appendparams == null || typeof (appendparams) == 'undefined')\r\n        appendparams = '';\r\n    if (typeof (bDisplayEntity) == 'undefined')\r\n        bDisplayEntity = false;\r\n    sEXEntity = DLEntity; // 6.6.2010\r\n    //alert('DEBUG\\nEXInitMainEnttiy(' + DLEntity + ',' + DLAction + ',' + DLEntityIdParam + ',' + DLParams + ',' + DLTask + ',' + bDoNotLoad + ',' + bDisplayEntity + ',' + bShowCaseLog + ')');\r\n    var bOK = true;\r\n    //alert(DLParams);\r\n    if (appendparams == '')\r\n        appendparams = 'Action=50';\r\n    if (DLParams != '') {\r\n        var oParams = DLParams.split(',');\r\n        for (var i = 0; i < oParams.length; i++) {\r\n            if (queryString(oParams[i]) == '') {\r\n                bOK = false;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    var DLId = queryString(DLEntityIdParam);\r\n    sEXEntityId = DLId;\r\n    if (typeof (EXSetUserRole) == 'function') { // 3.11.2009\r\n        EXSetUserRole(DLEntity, DLId);\r\n    }\r\n    if (typeof (EXUserLastSeen) == 'function') // 21.8.2010\r\n        EXUserLastSeen();\r\n    if (DLId == '')\r\n        bOK = false;\r\n    if (!bOK) {\r\n        //alert(DLId);\r\n        //if (DLId == '')\r\n        //\tDLId = '0';\r\n        //EXGotoObject(DLEntity, DLId);\r\n        if (DLAction == 'new') {\r\n            var sForeignEntity = trim(queryString('ForeignEntity')); // 19.8.2008\r\n            var sForeignId = trim(queryString('ForeignId'));\r\n            var DLENF = '';\r\n            var DLEId = '';\r\n            if (sForeignEntity != '') {\r\n                DLENF = 'DL_DenormEntityNameForeignAndId,DL_EntityNameForeign,DL_EntityId';\r\n                DLEId = '1,' + sForeignEntity + ',' + sForeignId;\r\n            }\r\n            var sDLWFCaseType = queryString('DLWFCaseType'); // 31.1.2010 - Tele logic\r\n            var sTitle = '';\r\n            if (sDLWFCaseType != '') {\r\n                // 11.3.2011 - opret ny sag vælger rigtige objekt\r\n                var oCaseType = getEntityData('DL_WFCaseType', 'DL_Id = ' + sDLWFCaseType, '');\r\n                var DLWFCaseEntityData = getsafe(oCaseType, '//DL_WFCaseEntityData');\r\n                if (DLWFCaseEntityData != '') { // 29.8.2012 - default values won't work if workflow specific data\r\n                    //if (1 == 0) { // 25.2.2012 - use default values rather than foreign keys\r\n                    if (DLENF != '') {\r\n                        DLENF += ',';\r\n                        DLEId += ',';\r\n                    }\r\n                    DLENF += 'DL_WFCaseType';\r\n                    DLEId += sDLWFCaseType;\r\n                }\r\n                else {\r\n                    if (appendparams == 'undefined' || typeof (appendparams) == 'undefined')\r\n                        appendparams = '';\r\n                    if (appendparams != '')\r\n                        appendparams += '&';\r\n                    appendparams += 'DefaultKeys=DL_WFCaseType&DefaultValues=' + sDLWFCaseType; // 25.2.2012\r\n                }\r\n                //alert(oCaseType.xml + ' ' + DLWFCaseEntityData);\r\n                if (DLWFCaseEntityData != '')\r\n                    DLEntity += 'WF' + DLWFCaseEntityData;\r\n                sTitle = LEX_CreateNew + ' ' + getsafe(oCaseType, '//DL_Title'); // 25.2.2012\r\n            }\r\n            //alert('DEBUG\\n' + sDLWFCaseType + ' ' + DLENF + ':' + DLEId + '\\nDLEntity=' + DLEntity);\r\n            if (1 == 0 && (DLEntity == 'DL_Activities' || DLEntity == 'DL_EmployeeCase'))\r\n                newentity2(DLEntity, '', '', 'view=ADD:DL_CaseProtected,DL_SecurityPersons,DL_ADSecurityGroups&' + appendparams);\r\n            //\t\t\telse if (DLEntity == 'DL_ProjectDefinition')\r\n            //\t\t\t\tnewentity2(DLEntity,'','','Action=159',sTitle);\r\n            else\r\n                newentity2(DLEntity, DLENF, DLEId, appendparams, sTitle);\r\n        }\r\n        else {\r\n            //EXLoadQuickSearch(DLEntity);\r\n            EXLoadQuickSearch(DLEntity, false, null, null, null, true); // 1.9.2008\r\n        }\r\n    }\r\n    else {\r\n        //\t\talert('DLAction=' + DLAction + 'lll');\r\n        if (DLAction == 'new') { // add parameters\r\n            var sForeignEntity = queryString('ForeignEntity');\r\n            var sForeignId = queryString('ForeignId');\r\n            var DLENF = '';\r\n            var DLEId = '';\r\n            if (sForeignEntity != '') {\r\n                DLENF = 'DL_DenormEntityNameForeignAndId,DL_EntityNameForeign,DL_EntityId';\r\n                DLEId = '1,' + sForeignEntity + ',' + sForeignId;\r\n            }\r\n            //alert(DLENF + ':' + DLEId);\r\n            newentity2(DLEntity, DLENF, DLEId, appendparams);\r\n        }\r\n        else {\r\n            //alert('Correct');\r\n            SetRecentValue(DLEntityIdParam, DLId);\r\n            if (true) { // 19.5.2009 - browserens titel sættes til sagsnr og sagstitel\r\n                //var oXX = getEntityData('DL_CMAllView',\"DL_EntityNameForeign = '\" + DLEntity + \"' AND DL_EntityId=\" + DLId,'');\r\n                var oXX = getEntityData(DLEntity, 'DL_Id=' + DLId, ''); // 7.11.2011 - IT Case 2703 - faster retrieval of title\r\n                var sTitle, sCaseNo;\r\n                sTitle = getsafe(oXX, '//DL_Title');\r\n                sCaseNo = getsafe(oXX, '//DL_CaseNo');\r\n                if (DLEntity == 'DL_ProjectDefinition' || DLEntity == 'EX_Project') { // 29.1.2012\r\n                    sTitle = getsafe(oXX, '//DL_ProjectName');\r\n                    sCaseNo = getsafe(oXX, '//DL_ProjectID');\r\n                }\r\n                //alert('DEBUG\\n ' + sTitle);\r\n                document.title = getsafe(oXX, '//DL_EntityDescription') + ' ' + sCaseNo + ' ' + sTitle;\r\n            }\r\n            if (DLTask != '')\r\n                loadentity('DL_Tasks', DLTask);\r\n            else\r\n                if (!bDoNotLoad && (DLEntity == 'DL_BRMConfig' || DLEntity == '_DL_BRMConfig') || bShowCaseLog) { // 1.4.2008 - FKIL\r\n                    //loadcontent2(getAbsoluteURL('/EX_SQLSVC/DynamicList.html?DLEntity=DL_CaseDocuments&DLView=DL_CaseNotesView&Where=DL_EntityNameForeign=\\'DL_BRMConfig\\' AND DL_EntityId = ' + DLId + '&OrderBy=DL_Modified DESC&PropList=DL_Title&Action=none'),LEX_Notes);\r\n                    //loadcontent2(getAbsoluteURL('/EX_SQLSVC/DynamicList.html?DLEntity=DL_CaseDocuments&DLView=DL_HTMLNotesView&Where=DL_EntityNameForeign=\\'' + DLEntity + '\\' AND DL_EntityId = ' + DLId + '&OrderBy=DL_Modified DESC&PropList=DL_Title&Action=none'),LEX_Notes);\r\n                    //var sUrl = getAbsoluteURL('/EX_Resources/EXExformation.html?DL_EntityNameForeign=' + DLEntity + '&DL_EntityId=' + DLId);\r\n                    //var sL = \"loadcontent2('\" + sUrl + \"','\" + LEX_Notes + \"')\";\r\n                    //var LEX_KnowledgeExchanges = 'Aktivitetsstr\\370m...'; // 'Knowledge exchanges...';\r\n                    //var sL = \"loadcontent2('\" + sUrl + \"','\" + LEX_KnowledgeExchanges + \"')\";\r\n                    //setTimeout(sL,1);\r\n                    //loadcontent2(sUrl,LEX_Notes);\r\n                    //loadcontent2(sUrl, LEX_KnowledgeExchanges);\r\n\t\t\t\t\tvar s1 = 'EXLoadActivityStream(\\''+DLEntity+'\\', '+DLId+')';\r\n\t\t\t\t\tsetTimeout(s1,1000); // 6.3.2017\r\n                    //EXLoadActivityStream(DLEntity, DLId);\r\n                }\r\n                else if (!bDoNotLoad) { // 18.8.2008 - else statement added\r\n                    var sL;\r\n                    if (bDisplayEntity)\r\n                        displayentity(DLEntity, DLId);\r\n                    //sL = \"displayentity('\" + DLEntity + \"', \" + DLId + \")\";\r\n                    else\r\n                        loadentity(DLEntity, DLId, appendparams);\r\n                    //sL = \"loadentity('\" + DLEntity + \"', \" + DLId + \",'\" + appendparams + \"')\";\r\n                    //setTimeout(sL,1);\r\n                }\r\n        }\r\n    }\r\n    // 15.8.2009 - EXDynWP - AJAX web parts\r\n    //alert(EXDynWPPageInit);\r\n    if (typeof (EXDynWPPageInit) == 'function') {\r\n        //alert('EXDynWPPageInit now start');\r\n        EXDynWPPageInit(DLEntity, DLEntityIdParam + ',' + DLParams);\r\n    }\r\n    //else\r\n    //\talert('EXDynWPPageInit not found');\r\n    // 8.6.2008\r\n    if (typeof (EXDoInitFolderDocsBasket) == 'function') {\r\n        //alert('DEBUG\\nEXDoInitFolderDocsBasket starts now');\r\n        try {\r\n            //setTimeout(\"EXDoInitFolderDocsBasket()\",1);\r\n            EXDoInitFolderDocsBasket();\r\n        } catch (e) { alert('DEBUG\\nEXDoInitFolderDocsBasket >>> ' + e.message); }\r\n    }\r\n    //else alert('EXDoInitFolderDocBsket not defined');\r\n    // 26.2.2007 - AJAXDocumentBasket\r\n    var oBasket = document.getElementById('AJAXDocumentBasket');\r\n    //if (oBasket != null)\r\n    //\tEXInitAJAXDocumentBasket(DLEntity, DLEntityIdParam);\r\n    //alert('type=' + typeof(InitAJAXDocumentBasket));\r\n    if (typeof (InitAJAXDocumentBasket) == 'function') {\r\n        //alert('Function');\r\n        ///setTimeout(\"InitAJAXDocumentBasket()\",1);\r\n        InitAJAXDocumentBasket();\r\n    }\r\n    // 13.4.2008 - Floating document basket\r\n    if (typeof (InitAJAXFloatingDocumentBasket) == 'function') {\r\n        //setTimeout(\"InitAJAXFloatingDocumentBasket()\",1);\r\n        InitAJAXFloatingDocumentBasket();\r\n    }\r\n    // 23.5.2010 - add function keys\r\n    if (typeof (EXInitFunctionKeys) == 'function') {\r\n        //setTimeout(\"EXInitFunctionKeys()\",1);\r\n        EXInitFunctionKeys();\r\n    }\r\n    // 12.2.2015 - ensure parent web part works\r\n    var oPE = document.getElementById('EXParentObject');\r\n    if (oPE != null) {\r\n        var a = oPE.innerHTML.split(':');\r\n        var x = getEntityData(a[0], 'DL_Id=' + a[1], '');\r\n        var s = getsafe(x, '//DL_Title');\r\n        if (s != '')\r\n            oPE.innerHTML = s;\r\n    }\r\n    return true;\r\n}\r\n\r\n// Buttons\r\n//  01 - Empty document basket button\r\n//  02 - Notify document basket\r\n//  04 - Create transmittal based on document basket\r\n//  08 - Create new email with document basket documents contained\r\n//  16 - Copy document basket to actual business object as linked documents\r\n//  32 - Export document basket to desktop\r\n//  64 - EXMoveCopyDocuments action\r\n// 128 - Convert to PDF\r\n// 256 - paste to folder ???\r\n// 512 - Create document approval process (similar to transmittal - but runs a SQL sp - customize)\r\n\r\nvar sEXAJAXDocBasketDiv;\r\nvar sEXDocBasketFooter; // 18.12.2009\r\nfunction EXInitAJAXDocumentBasket(DLEntity, DLEntityIdParam, iButtons) { // 26.2.2008\r\n    try {\r\n        if (DLEntityIdParam == null || DLEntityIdParam == '')\r\n            DLEntityIdParam = DLEntity;\r\n        var sHeader = _EXInitAJAXDocumentBasketHeader(DLEntity, DLEntityIdParam, iButtons);\r\n        //alert(sHeader);\r\n        var sEXDocBasketFooter = _EXInitAJAXDocumentBasketFooter(DLEntity, DLEntityIdParam, iButtons); // 18.12.2009\r\n        //alert('EXInitAJAXDocumentBasket(' + DLEntity + ',' + DLEntityIdParam + ',' + iButtons + ')=\\n' + sHeader);\r\n        var oBasketHeader = document.getElementById('AJAXDocumentBasketHeader');\r\n        oBasketHeader.innerHTML = sHeader;\r\n        sEXAJAXDocBasketDiv = 'AJAXDocumentBasket';\r\n        var oBasket = document.getElementById(sEXAJAXDocBasketDiv);\r\n        EXDocBasketRefresh();\r\n    } catch (e) { alert('EXInitAJAXDocumentBasket ' + e.message); }\r\n}\r\nfunction EXDocBasketExport() {// 21.12.2009\r\n    window.open(getAbsoluteURL('/EX_Resources/EXDownloadCase.html?Type=1'), '', 'width=530,height=360,toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=auto,copyhistory=no,resizable=yes');\r\n}\r\nfunction EXBatchPrint() {\r\n    window.open(getAbsoluteURL('/EX_Resources/EXBatchPrint.html'), '', 'width=530,height=360,toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=auto,copyhistory=no,resizable=yes');\r\n}\r\nfunction EXDocBasketJoinSort() { // 4.1.2013\r\n    //loadcontent(getAbsoluteURL('/EX_Resources/EXDocumentBasket.html?ToPDF=true&MergePDF=true&DLEntityNameForeign=' + EXDWPFolderEntityName));\r\n    var bToPDF = 'false';\r\n    if (PDFConverterInstalled())\r\n        bToPDF = 'true';\r\n    loadcontent2(getAbsoluteURL('/EX_Resources/EXDocumentBasket.html?ToPDF=' + bToPDF + '&MergePDF=true&ShowBasket=true&MergePath=RETRIEVE&DLEntityNameForeign=' + EXDWPFolderEntityName), LEX_DocumentBasketSortPDF);\r\n}\r\nfunction EXDocBasketToStream(DLEntityNameForeign, DLEntityId) { // 15.1.2013\r\n    ExecuteProcedure('EXDocBasketToStream @DLEntityNameForeign=\\'' + DLEntityNameForeign + '\\',@DLEntityId=' + DLEntityId + ',@WUSER=%WUSER%');\r\n    EXLoadActivityStream(DLEntityNameForeign, DLEntityId);\r\n}\r\nfunction EXHandleBasketDo(oEle, DLEntity, DLEntityIdParam) { // 18.12.2009\r\n    if (oEle.selectedIndex == 0)\r\n        return;\r\n\r\n    switch (oEle.value) {\r\n        case 'EXDocBasketEmpty': EXDocBasketEmpty(); EXInitDocBasket(); break; //5.2.17 update button counter after reset\r\n        case 'EXDocBasketNotify': EXDocBasketNotify(); break;\r\n        case 'EXDocBasket2Transmittal': EXDocBasket2Transmittal(DLEntity, queryString(DLEntityIdParam)); EXDocBasketRefresh(); break;\r\n        case 'EXBRMCreateMail': EXDocBasketCreateMail(DLEntity, queryString(DLEntityIdParam));\r\n            if (typeof (bEXClearBasket) != 'undefined') // 10.1.2013\r\n                if (bEXClearBasket) {\r\n                    EXDocBasketEmpty();\r\n                    EXDocBasketRefresh();\r\n                }\r\n            break; // 16.8.2010 EXBRMCreateMail('','','DL_sAMAccountName',0,'',false); break;\r\n        case 'EXDocBasketExport': EXDocBasketExport(); break;\r\n        case 'EXConvertBasket2PDF': EXConvertBasket2PDF(); break;\r\n        case 'EXDocBasketJoinSort': EXDocBasketJoinSort(); break; // 4.1.2013\r\n        case 'EXDocBasketToStream': EXDocBasketToStream(DLEntity, queryString(DLEntityIdParam)); break; // 15.1.2013\r\n        case 'EXApproveDocumentProcess': EXApproveDocumentProcess(DLEntity, queryString(DLEntityIdParam)); break; // 30.1.2012\r\n        case 'EXDocBasketToEntity': EXDocBasketToEntity(DLEntity, queryString(DLEntityIdParam), false, false);EXInitDocBasket(); break; // 3.1.2010 and EXInitDocBasket(); added to refresh Basked Button Counter 12-FEB-2016\r\n        case 'EXPasteDocuments': EXDocBasket2Copy(DLEntity, queryString(DLEntityIdParam)); EXDocBasketRefresh(); break;\r\n        case 'EXBatchPrint': EXBatchPrint(); EXDocBasketRefresh(); break;\r\n        default: alert('EXHandleBasketDo(' + oEle.value + ',' + DLEntity + ',' + DLEntityIdParam + ') not defined!!!'); break;\r\n    }\r\n    oEle.selectedIndex = 0;\r\n}\r\n\r\nfunction PDFConverterInstalled() {\r\n    //18-11-2011 BH IT-Case 2679\r\n    // return true for Backward compatibility\r\n    try {\r\n        DebugAlert('custPDFConverterInstalled: ' + custPDFConverterInstalled, 100, 'EX_Resources.js.Exformatics.js.PDFConverterInstalled');\r\n        return custPDFConverterInstalled;\r\n    }\r\n    catch (e) {\r\n        DebugAlert('Fejl: ' + e, 50, 'EX_Resources.js.Exformatics.js.PDFConverterInstalled');\r\n        return true;\r\n    }\r\n    return true;\r\n}\r\n\r\nfunction _EXInitAJAXDocumentBasketFooter(DLEntity, DLEntityIdParam, iButtons) { // 18.12.2009\r\n    //28.11.2011 BH: Added iButtonNames\r\n    //var sSel = '&nbsp;<img border=\"0\" src=\"/EX_Resources/gif/16x16/Wizard.gif\"></img><select onchange=\"EXHandleBasketDo(this,\\'' + DLEntity + '\\',\\'' + DLEntityIdParam + '\\')\"><options><option value=\"\">' +  LEX_BasketSelectAction + '</option>';\r\n    var sSel = '&nbsp;<select onchange=\"EXHandleBasketDo(this,\\'' + DLEntity + '\\',\\'' + DLEntityIdParam + '\\')\"><options><option value=\"\">' + LEX_BasketSelectAction + '</option>';\r\n    if (iButtons & iButtonDelete) // Delete document basket\r\n        sSel += '<option value=\"EXDocBasketEmpty\">' + LEX_EmptyDocumentBasket + '</option>';\r\n    if (iButtons & iButtonNotify) // Notify\r\n        sSel += '<option value=\"EXDocBasketNotify\">' + LEX_NotifyDocumentBasket + '</option>';\r\n    if (iButtons & iButtonTransmittal) // Transmittal - document \r\n        sSel += '<option value=\"EXDocBasket2Transmittal\">' + LEX_CreateTransmittal + '</option>';\r\n    if (iButtons & iButtonCreateEmail) // Create email\r\n        sSel += '<option value=\"EXBRMCreateMail\">' + LEX_MailFromDocumentBasket + '</option>';\r\n    if (iButtons & iButtonLink) // Link\r\n        sSel += '<option value=\"EXDocBasketToEntity\">' + LEX_LinkDocumentsToEntity + '</option>';\r\n    if (iButtons & iButtonExportBasket) // Export basket to desktop\r\n        sSel += '<option value=\"EXDocBasketExport\">' + LEX_ExportDocumentBasket + '</option>';\r\n    if (iButtons & iButtonConvert2PDF) // 13.3.2009 - Convert 2 PDF // 20.6.2009 - ensure logic is ok\r\n    {\r\n        DebugAlert('test ' + PDFConverterInstalled(), 10, 'test');\r\n        //18-11-2011 BH IT-Case 2679\r\n        if (PDFConverterInstalled()) {\r\n            sSel += '<option value=\"EXConvertBasket2PDF\">' + LEX_DocumentBasket2PDF + '</option>';\r\n        }\r\n    }\r\n    if (iButtons & iButtonJoinBasket) { // 4.1.2013 - Join basket into one document\r\n        //sSel += '<option value=\"EXDocBasketJoinSort\">Sorter kurv, saml til PDF</option>';\r\n        sSel += '<option value=\"EXDocBasketJoinSort\">' + LEX_DocumentBasketSortPDF + '</option>';\r\n    }\r\n    if (1 == 1 || iButtons & iButtonToStream) { // 15.1.2013 - Add basket to activity stream\r\n        sSel += '<option value=\"EXDocBasketToStream\">' + LEX_BasketToStream + '</option>';\r\n    }\r\n    if (iButtons & iButtonCreateDocumentApproval) // 30.1.2012\r\n        sSel += '<option value=\"EXApproveDocumentProcess\">Start document approval</option>';\r\n    if (iButtons & iButtonPasteDocuments) { // 13.3.2009 - Convert 2 PDF // 20.6.2009 - ensure logic is ok\r\n        //var  LEX_DocumentBasketPasteDocuments = 'LEX_DocumentBasketPasteDocuments'; // 30.1.2012 - move to EXLanguage.js ASAP\r\n        sSel += '<option value=\"EXPasteDocuments\">' + LEX_DocumentBasketPasteDocuments + '</option>'; // 30.1.2012 ' around LEX variable removed\r\n    }\r\n    if (iButtons & iButtonPrint)\r\n    //sSel += '<option value=\"EXBatchPrint\">Print basket</option>';\r\n        sSel += '<option value=\"EXBatchPrint\">' + LEX_DocumentBasketPrintDocuments + '</option>';\r\n\r\n\r\n    sSel += '</options></select>';\r\n    return sSel;\r\n}\r\nfunction _EXInitAJAXDocumentBasketHeader(DLEntity, DLEntityIdParam, iButtons) { // 13.4.2008\r\n    try {\r\n        if (DLEntityIdParam == '') // 14.4.2008\r\n            DLEntityIdParam = DLEntity;\r\n        var sHeader = '<h3 class=\"ms-standardheader ms-WPTitle\"><nobr><span>' + LEX_DocumentBasket + '&nbsp;';\r\n        sHeader = '<span style=\"color:white;font-size:12pt;font-family:Arial;font-weight:bold;\" ondblclick=\"void(0);\" onmouseover=\"EXMoveover=true;\" onmouseout=\"EXMoveover=false;\" style=\"cursor:move;height:18px\">' + LEX_DocumentBasket + '&nbsp;'; // 9.8.2012\r\n        //sHeader = LEX_DocumentBasket + '&nbsp;';\r\n        //alert(iButtons);\r\n        //\tiButtons = 31 // - 4; //127; // MUST BE REMOVED\r\n        if (true) { // 18.12.2009 - use a drop down menu instead of icons\r\n            var sSel = '&nbsp;<img border=\"0\" src=\"/EX_Resources/gif/16x16/Wizard.gif\"></img><select onchange=\"EXHandleBasketDo(this,\\'' + DLEntity + '\\',\\'' + DLEntityIdParam + '\\')\"><options><option value=\"\">' + LEX_BasketSelectAction + '</option>';\r\n            if (iButtons & 1) // Delete document basket\r\n                sSel += '<option value=\"EXDocBasketEmpty\">' + LEX_EmptyDocumentBasket + '</option>';\r\n            if (iButtons & 2) // Notify\r\n                sSel += '<option value=\"EXDocBasketNotify\">' + LEX_NotifyDocumentBasket + '</option>';\r\n            if (iButtons & 4) // Transmittal - document \r\n                sSel += '<option value=\"EXDocBasket2Transmittal\">' + LEX_CreateTransmittal + '</option>';\r\n            if (iButtons & 8) // Create email\r\n                sSel += '<option value=\"EXBRMCreateMail\">' + LEX_MailFromDocumentBasket + '</option>';\r\n            if (iButtons & 16) // Link\r\n                sSel += '<option value=\"EXDocBasketToEntity\">' + LEX_LinkDocumentsToEntity + '</option>';\r\n            if (iButtons & 32) // Export files\r\n                sSel += '<option value=\"EXDocBasketExport\">' + LEX_ExportDocumentBasket + '</option>';\r\n            //if (iButtons & 128) // 13.3.2009 - Convert 2 PDF // 20.6.2009 - ensure logic is ok\r\n            sSel += '<option value=\"EXConvertBasket2PDF\">' + LEX_DocumentBasket2PDF + '</option>';\r\n            if (iButtons & iButtonCreateDocumentApproval) // 30.1.2012\r\n                sSel += '<option value=\"EXApproveDocumentProcess\">Start document approval</option>';\r\n            sSel += '</options></select>';\r\n            //sHeader += sSel;\r\n        }\r\n        else {\r\n            if (iButtons & 1) // Delete document basket\r\n                sHeader = sHeader + '<a href=\"javascript:EXDocBasketEmpty()\"><img border=\"0\" alt=\"' + LEX_EmptyDocumentBasket + '\" src=\"/EX_Resources/gif/16x16/Delete from cart.gif\"></img></a>';\r\n            if (iButtons & 2) // Notify\r\n                sHeader = sHeader + '<a href=\"javascript:EXDocBasketNotify()\">&nbsp;<img border=\"0\" alt=\"' + LEX_NotifyDocumentBasket + '\" src=\"/EX_Resources/gif/16x16/send mail.gif\"></img>&nbsp;</a>';\r\n            if (iButtons & 4) // Transmittal - document package\r\n                sHeader = sHeader + '<a href=\"javascript:EXDocBasket2Transmittal(\\'' + DLEntity + '\\', queryString(\\'' + DLEntityIdParam + '\\'))\"><img border=\"0\" alt=\"' + LEX_CreateTransmittal + '\" src=\"/EX_Resources/gif/16x16/parcel.gif\"></img></a>&nbsp;';\r\n            if (iButtons & 8) // Create email\r\n            //sHeader = sHeader + '<a href=\"javascript:EXBRMCreateMail(\\'\\',\\'\\',\\'DL_sAMAccountName\\',0,\\'\\',false)\"><img border=\"0\" alt=\"' + LEX_MailFromDocumentBasket + '\" src=\"/EX_Resources/gif/16x16/email attachment.gif\"></img></a>&nbsp;'; // 24.4.2008 - fixed function and alt text\r\n                sHeader = sHeader + '<a href=\"javascript:EXDocBasketCreateMail(\\'' + DLEntity + '\\', queryString(\\'' + DLEntityIdParam + '\\'))\"><img border=\"0\" alt=\"' + LEX_MailFromDocumentBasket + '\" src=\"/EX_Resources/gif/16x16/email attachment.gif\"></img></a>&nbsp;'; // 24.4.2008 - fixed function and alt text\r\n            if (iButtons & 16) // Link\r\n                sHeader = sHeader + '<a href=\"javascript:EXDocBasketToEntity(\\'' + DLEntity + '\\', queryString(\\'' + DLEntityIdParam + '\\'),true)\"><img border=\"0\" alt=\"' + LEX_LinkDocumentsToEntity + '\" src=\"/EX_Resources/gif/16x16/link.gif\"></img></a>&nbsp;'; // 24.4.2008 - fixed function // 17.9.2008 - true tilføjet\r\n            //\tif (true) // 10.12.2008 - add\r\n            //\t\tsHeader = sHeader + '<a href=\"javascript:EXDWPNewTask(\\'' + DLEntity + '\\', queryString(\\'' + DLEntityIdParam + '\\'))\"><img border=\"0\" alt=\"' + // LEX_CreateTaskDocBasket  + '\" src=\"/EX_Resources/gif/16x16/Tasks.gif\"></img></a>&nbsp;';\r\n            if (iButtons & 32) // Export files\r\n                sHeader = sHeader + '<a href=\"javascript:EXDocBasketExport()\"><img border=\"0\" alt=\"' + LEX_ExportDocumentBasket + '\" src=\"/EX_Resources/gif/16x16/Blue arrow right.gif\"></img></a>&nbsp;';\r\n            //if (iButtons & 128) // 13.3.2009 - Convert 2 PDF // 20.6.2009 - ensure logic is ok\r\n            sHeader = sHeader + '<a href=\"javascript:EXConvertBasket2PDF()\"><img border=\"0\" alt=\"' + LEX_DocumentBasket2PDF + '\" src=\"/_layouts/images/pdf.gif\"></img></a>&nbsp;';\r\n            // 14.4.2008 - this functionality is moved into AjaxDocuments\r\n            //\tif (iButtons & 64) // EXMoveCopyDocuments - 26.3.2008\r\n            //\t\tsHeader = sHeader + '<a href=\"javascript:EXMoveCopyDocBasket2Entity(\\'' + DLEntity + '\\', queryString(\\'' + DLEntityIdParam + '\\'))\"><img border=\"0\" alt=\"' + LEX_MoveCopyBasketJob + '\" src=\"/EX_Resources/gif/16x16/shopping cart.gif\"></img></a>&nbsp;';\r\n            //sHeader = sHeader + '</span><span id=\"WebPartCaptionWPQ10ADB\"></span></nobr></h3>';\r\n        }\r\n        if (iButtons & iButtonShowIcons) { // 9.8.2012\r\n            if (iButtons & 1)\r\n                sHeader += '<a href=\"javascript:EXDocBasketEmpty()\"><img border=\"0\" title=\"' + LEX_EmptyDocumentBasket + '\" alt=\"' + LEX_EmptyDocumentBasket + '\" src=\"/EX_Resources/gif/16x16/Delete from cart.gif\"></img></a>';\r\n            if (iButtons & 8) // Create email\r\n                sHeader = sHeader + '<a href=\"javascript:EXDocBasketCreateMail(\\'' + DLEntity + '\\', queryString(\\'' + DLEntityIdParam + '\\'))\"><img border=\"0\" title=\"' + LEX_MailFromDocumentBasket + '\" alt=\"' + LEX_MailFromDocumentBasket + '\" src=\"/EX_Resources/gif/16x16/email attachment.gif\"></img></a>&nbsp;';\r\n            if (iButtons & 128)\r\n                sHeader = sHeader + '<a href=\"javascript:EXConvertBasket2PDF()\"><img border=\"0\" title=\"' + LEX_DocumentBasket2PDF + '\" alt=\"' + LEX_DocumentBasket2PDF + '\" src=\"/EX_Resources/img/pdf.gif\"></img></a>&nbsp;';\r\n        }\r\n        sHeader = sHeader + '</span>'; // 9.8.2012\r\n        //\tsHeader = sHeader + '</span></nobr></h3>'; // 28.9.2009\r\n        //alert(sHeader);\r\n        //EXCopyToClipboard(sHeader); // 18.12.2009\r\n        return sHeader;\r\n    } catch (e) { alert('Header >>> ' + e.message); }\r\n}\r\nfunction EXDocBasketCreateMail(DLEntityNameForeign, DLEntityId) { // IT Case 1289 - add subject - if any\r\n    var subject = '';\r\n    var sFunction = 'EXDocBasketGetTitle' + DLEntityNameForeign;\r\n    if (typeof (sFunction) == 'funcion') {\r\n        sFunction += '(' + DLEntityId + ')';\r\n        try {\r\n            subject = eval(sFunction);\r\n        } catch (e) { subject = ''; }\r\n    }\r\n    //alert(subject);\r\n    return EXBRMCreateMail('', subject, 'DL_sAMAccountName', 0, '', false);\r\n}\r\nfunction EXDWPNewTask(DLEntityNameForeign, DLEntityId) { // 19.5.2009\r\n    newentity('DL_Tasks', 'DL_EntityNameForeign,DL_EntityId', DLEntityNameForeign + ',' + DLEntityId, 'Action=546');\r\n}\r\nfunction EXDocBasketRefresh() { // 26.2.2008\r\n    //EXshowListData('AJAXDocumentBasket','DL_CaseDocuments','DL_ModifiedBy = %WUSER%','DL_Id','img:../../gif/16x16/delete document 1.gif,DL_Title:DL_URLDocument','','','331');\r\n    // 29.3.2009 - image now in right column\r\n    //\tvar oEle = document.getElementById(sEXAJAXDocBasketDiv);\r\n    //alert('DEBUG\\nEXDocBasketRefresh - Div=' + sEXAJAXDocBasketDiv + ' ' + oEle);\r\n\t\r\n    if (sEXAJAXDocBasketDiv == 'AJAXDocumentBasket')\r\n        EXshowListData(sEXAJAXDocBasketDiv, 'DL_CaseDocuments', 'DL_EntityNameForeign = \\'DL_sAMAccountName\\' AND DL_ModifiedBy = %WUSER%', 'isnull(DL_SequenceNo,DL_Id)', 'icon,DL_Title:DL_URLDocument,img:../../gif/16x16/delete document 1.gif', '', '', '0,,331', true, 'DL_Id', '', LEX_BasketIsEmpty); // 22.12.2009 - true added - hide header\r\n    else {\r\n        EXshowListData('EXFDB', 'DL_CaseDocuments', 'DL_EntityNameForeign = \\'DL_sAMAccountName\\' AND DL_ModifiedBy = %WUSER%', 'isnull(DL_SequenceNo,DL_Id)', 'icon,DL_Title:DL_URLDocument,img:../../gif/16x16/delete document 1.gif', '', '', '0,,331', true, 'DL_Id', '', LEX_BasketIsEmpty); // 22.12.2009 - true added - hide header\r\n    }\r\n\tif (typeof(EXInitDocBasket) == 'function') // 25.6.2017\n\tEXInitDocBasket(false);\n\t//EXInitDocBasket();\r\n    //\tvar oDiv = document.getElementById(sEXAJAXDocBasketDiv);\r\n    //alert(sEXDocBasketFooter + '\\n' + oDiv.innerHTML);\r\n    //\toDiv.innerHTML = oDiv.innerHTML.substr(0,oDiv.innerHTML.length-8) + '<tr><td colspan=\"99\">' + sEXDocBasketFooter + '</td></tr></table>'; // 18.12.2009\r\n}\r\nfunction EXDocBasketEmpty() { // 26.2.2008\r\n    //var LEX_DocBasketEmpty = 'Delete all documents from basket?';\r\n    if (!confirm(LEX_DocBasketEmpty))\r\n        return;\r\n    ExecuteProcedure('dbo.EXDocBasketEmpty @WUser = %WUSER% ');\r\n    EXDocBasketRefresh();\r\n}\r\n// 26.2.2008 - moved from EXDynamicForm.js\r\nfunction EXshowListData(sDiv, sEntity, sWhere, sOrderBy, sD710s, sLink, sClickAction, sActions, bWOutTitle, XPathDLId, sTop, sEmptyMsg) {\r\n    if (typeof (sEmptyMsg) == 'undefined') // 22.4.2013\r\n        sEmptyMsg = '';\r\n    if (typeof (sTop) == 'undefined') // 21.8.2010\r\n        sTop = '';\r\n    if (typeof (XPathDLId) == 'undefined') // 8.8.2010\r\n        XPathDLId = 'DL_Id';\r\n    if (typeof (bWOutTitle) == 'undefined') // 22.12.2009\r\n        bWOutTitle = false;\r\n    var oDiv = document.getElementById(sDiv);\r\n    if (oDiv == null) // 30.3.2009\r\n        oDiv = parent.document.getElementById(sDiv);\r\n    if (oDiv == null) // 24.4.2008 - backward compatability\r\n        return;\r\n    oDiv.innerHTML = ''; // 15.4.2008\r\n    oDiv.innerHTML = _EXshowListData(sEntity, sWhere, sOrderBy, sD710s, sLink, sClickAction, sActions, bWOutTitle, XPathDLId, sTop, sEmptyMsg);\r\n    oDiv = null;\r\n}\r\nfunction _EXshowListData(sEntity, sWhere, sOrderBy, sD710s, sLink, sClickAction, sActions, bWOutTitle, XPathDLId, sTop, sEmptyMsg) {\r\n    if (typeof (sEmptyMsg) == 'undefined') // 22.4.2013\r\n        sEmptyMsg = '';\r\n    if (typeof (sTop) == 'undefined') // 21.8.2010\r\n        sTop = '';\r\n    if (typeof (XPathDLId) == 'undefined' || XPathDLId == '') // 8.8.2010\r\n        XPathDLId = 'DL_Id';\r\n    if (typeof (bWOutTitle) == 'undefined') // 22.12.2009\r\n        bWOutTitle = false;\r\n    //var startTime, endTime; // 15.3.2009\r\n    //startTime = new Date().getTime();// 15.3.2009\r\n    var xData;\r\n    if (typeof (sActions) == 'undefined')\r\n        sActions = '';\r\n    var oEXEntity;\r\n    if (false) {\r\n        xData = getEntityData(sEntity, sWhere, sOrderBy);\r\n        oEXEntity = getEntity(sEntity, 'DL_Id = 0', ''); // 15.9.2008 - retrieve information\r\n    }\r\n    else {\r\n        if (sTop == '') {\r\n            oEXEntity = getEntity(sEntity, sWhere, sOrderBy);\r\n            xData = oEXEntity.selectSingleNode('//DL_ENTITYDATA');\r\n        }\r\n        else {\r\n            xData = getEntityData2('TOP ' + sTop + ' *', sEntity, sWhere, sOrderBy);\r\n            oEXEntity = getEntity(sEntity, 'DL_Id = 0', '');\r\n        }\r\n    }\r\n    //alert('DEBUG\\ngetEntityData(' + sEntity + ',' + sWhere + ',' + sOrderBy + ' ) sD710s=' + sD710s + '\\n' + xData.xml);\r\n    var oD710s = sD710s.split(\",\");\r\n    var sTable;\r\n    var xActions = null;\r\n    var DLPropName, sLinks;\r\n    var ForeignKeys, ForeignValues; // 27.11.2008\r\n    ForeignKeys = queryString('ForeignKeys');\r\n    ForeignValues = queryString('ForeignValues');\r\n    if (sActions != '') { // 18.2.2008\r\n        xActions = getEntityData('DL_Action', 'DL_Id in (' + sActions.replace(',,', ',') + ')', ''); // 29.3.2009 - replace added\r\n        sLink = '';\r\n    }\r\n    sLinks = sActions.split(','); // 30.3.2009 - move out\r\n    sTable = '<table style=\"border-color:#A7B4CE;border-width:1px;border-style:solid;\" width=\"100%\" bgcolor=\"white\">';\r\n    if (bWOutTitle)\r\n        sTable = '<table border=\"0\" width=\"100%\">';\r\n    /*\r\n    var sW = ''; //'DL_PropName in (';\r\n    for(var i=0; i < oD710s.length; i++) {\r\n    if (sW != '') // 26.2.2008\r\n    sW = sW + ',';\r\n    DLPropName = oD710s[i];\r\n    if (DLPropName.indexOf(':') > 0)\r\n    DLPropName = DLPropName.substring(0,DLPropName.indexOf(':'));\r\n    if (DLPropName.indexOf('img') == -1 && DLPropName.indexOf('icon') == -1 && DLPropName != '') {\r\n    if (DLPropName.indexOf(':') > 0)\r\n    DLPropName = DLPropName.substring(0, DLPropName.indexOf(':'));\r\n    sW = sW + '\\'' + DLPropName + '\\'';\r\n    }\r\n    }\r\n    sW = 'DL_PropName in (' + sW + ')';\r\n    //alert('getEntityData ' + sW);\r\n    var xD710 = getEntityData('DL_D710',sW,'');\r\n    */\r\n    var DLPropType, DLPropDisplayName, sValue;\r\n    // Build header\r\n    if (!bWOutTitle) { // 22.12.2009\r\n        sTable = sTable + '<tr valign=\"top\">';\r\n        var DLPropDictionary;\r\n        for (var i = 0; i < oD710s.length; i++) {\r\n            DLPropName = oD710s[i];\r\n            if (DLPropName.indexOf(':') > 0)\r\n                DLPropName = DLPropName.substring(0, DLPropName.indexOf(':'));\r\n            if (DLPropName == 'checkbox') {\r\n                sTable = sTable + '<th class=\"ms-vh\" align=\"left\"><input id=\"cbAll\" type=\"checkbox\" onclick=\"javascript:EXDSCheckAll()\"></th>';\r\n            }\r\n            else if (DLPropName == 'input') { // 12.1.2010\r\n                sTable = sTable + '<th class=\"ms-vh\" align=\"left\"></th>';\r\n            }\r\n            else if (DLPropName == '') // 19.8.2009\r\n                sTable = sTable + '<th class=\"ms-vh\"></th>';\r\n            else if (DLPropName == 'icon') { // 13.4.2008\r\n                sTable = sTable + '<th class=\"ms-vh\" width=\"16px\" align=\"left\"></th>';\r\n            }\r\n            else {\r\n                DLPropDisplayName = getsafe(oEXEntity, \"//DL_ENTITYCOLS/DL_D610D710[DL_PropNameForeign='\" + DLPropName + \"']/DL_PropDisplayName\");\r\n                //alert(i + ' ' + DLPropDisplayName + oEXEntity.xml);\r\n                if (DLPropDisplayName == '')\r\n                //DLPropDisplayName = getsafe(xD710, \"//DL_D710[DL_PropName='\" + DLPropName + \"']/DL_PropDisplayName\");\r\n                    DLPropDisplayName = getsafe(oEXEntity, \"//DL_COLFORMATS/DL_D710[DL_PropName='\" + DLPropName + \"']/DL_PropDisplayName\");\r\n                if (DLPropName == 'DL_TableIcon' || DLPropName == 'BPM_ImgState') // 15.4.2008 + 25.6.2008\r\n                    DLPropDisplayName = '';\r\n                //sTable = sTable + '<th class=\"ms-vh\" width=\"29\">' + DLPropDisplayName + '</th>';\r\n                var sWidth = '';\r\n                if (oD710s[i].indexOf('img:') == 0)\r\n                    sWidth = ' width=\"16px\" ';\r\n                sTable = sTable + '<th class=\"ms-vh\"' + sWidth + '>' + DLPropDisplayName + '</th>'; // 13.4.2008 - width removed!\r\n            }\r\n        }\r\n        sTable = sTable + '</tr>';\r\n    }\r\n    //alert(sTable);\r\n    // Build data\r\n    //var xNodes = xData.childNodes[1].childNodes;\r\n    var xNodes, iNodes;\r\n    if (xData == null) {\r\n        xNodes = null;\r\n        iNodes = 0;\r\n    }\r\n    else {\r\n        xNodes = xData.selectNodes('//DL_ENTITYDATA/' + sEntity);\r\n        iNodes = xNodes.length;\r\n    }\r\n    //alert('#nodes=' + xNodes.length);\r\n    //return;\r\n    if (iNodes == 0) {\r\n        if (sEmptyMsg == 'EMPTY')\r\n            sTable = sTable;\r\n        else if (sEmptyMsg == '')\r\n            sTable = sTable + '<tr><td class=\"ms-vb\" colspan=\"' + (oD710s.length + 1) + '\">' + LEX_SearchNoRowsFound + '</td></tr>'; // 26.2.2008\r\n        else\r\n            sTable = sTable + '<tr><td class=\"ms-vb\" colspan=\"' + (oD710s.length + 1) + '\">' + sEmptyMsg + '</td></tr>';\r\n    }\r\n    else {\r\n        var iMax = iNodes;\r\n        var DLPropDictionary, DLPropNameLink;\r\n        if (iMax > 100)\r\n            iMax = 100;\r\n        var sLinkSaved = sLink; // 18.5.2008\r\n        var aFKeys, aFValues; // 27.11.2008\r\n        aFKeys = ForeignKeys.split(',');\r\n        aFValues = ForeignValues.split(',');\r\n        //alert('DEBUG\\n' + iMax);\r\n        for (var j = 0; j < iMax; j++) {\r\n            sLink = sLinkSaved; // 18.5.2008\r\n            if (mod(j, 2) == 0)\r\n                sTable = sTable + '<tr class=\"ms-alternating\">'; //'<tr class=\"dltablealtenaterow\">';\r\n            else\r\n                sTable = sTable + '<tr>'; // '<tr class=\"dltablerow\">';\r\n            for (var i = 0; i < oD710s.length; i++) {\r\n                DLPropName = oD710s[i];\r\n                if (DLPropName.indexOf(':') > 0 && DLPropName.indexOf('img:') == -1) // 15.3.2009 - img: added\r\n                    DLPropName = DLPropName.substring(0, DLPropName.indexOf(':'));\r\n                DLPropNameAlt = '';\r\n                if (DLPropName.indexOf(':') > 0 && DLPropName.indexOf('img:') != 0) {\r\n                    DLPropNameAlt = DLPropName.substring(DLPropName.indexOf(':') + 1);\r\n                    DLPropName = DLPropName.substring(0, DLPropName.indexOf(':'));\r\n                }\r\n                //alert('Node ' + j + ' Prop=' + i + ' DLPropName=' + DLPropName + '-' + DLPropNameAlt + ' sLink=' + sLink);\r\n                if (DLPropName.indexOf('img:') == 0) {\r\n                    sValue = '';\r\n                    DLPropType = '';\r\n                }\r\n                else if (DLPropName == '') // 19.8.2009\r\n                    sValue = '';\r\n                else if (DLPropName == 'DL_TableIcon')\r\n                // sValue = '<img border=\"0\" src=\"/EX_Resources/gif/16x16/' + sValue + '\"></img>';\r\n                // 15.4.2011\r\n                    sValue = '<img border=\"0\" src=\"/EX_Resources/gif/16x16/' + getsafe(xNodes[j], DLPropName) + '\"></img>';\r\n                else if (DLPropName == 'BPM_ImgState') {\r\n                    sValue = '<img border=\"0\" src=\"/EX_Resources/gif/16x16/flag ' + sValue + '.gif\"></img>';\r\n                }\r\n                else {\r\n                    sValue = getsafe(xNodes[j], DLPropName);\r\n                    for (var z = 0; z < aFKeys.length; z++)\r\n                        sValue = sValue.replace('%' + aFKeys[z] + '%', aFValues[z]);\r\n\r\n                    //if (j == 3) alert('DLPropName=' + DLPropName + ' ' + sValue + xNodes[j].xml);\r\n                    //DLPropType = getsafe(xD710, \"//DL_D710[DL_PropName='\" + DLPropName + \"']/DL_PropType\");\r\n                    //DLPropDictionary = getsafe(xD710, \"//DL_D710[DL_PropName='\" + DLPropName + \"']/DL_PropDictionary\");\r\n                    DLPropType = getsafe(oEXEntity, \"//DL_COLFORMATS/DL_D710[DL_PropName='\" + DLPropName + \"']/DL_PropType\");\r\n                    DLPropDictionary = getsafe(oEXEntity, \"//DL_COLFORMATS/DL_D710[DL_PropName='\" + DLPropName + \"']/DL_PropDictionary\");\r\n                    //alert('i=' + i + ' j=' + j + ' ' + sValue + ' ' + DLPropType + ' ' + DLPropDictionary + ' ' + xNodes[j].xml + ' ' + sLink);\r\n                }\r\n                //\tif (DLPropDictionary != '')\r\n                //\t\tsValue = DLPropDictionary + sValue;\r\n                if (i == 0 && sLink != '') {\r\n                    // 23.1.2008 - we must support several ids\r\n                    //var sLinkNew = EXReplaceGeneric(sLink, xNodes[j]);\r\n                    //alert('EXReplaceGeneric ' + sLink);\r\n                    var sLinkNew = EXReplaceGeneric(EXReplaceGeneric(sLink, xNodes[j]), xNodes[j]);\r\n                    if (sLinkNew.indexOf('javascript:') == 0) // 21.8.2010\r\n                        sTable = sTable + '<td class=\"ms-vb\"><a href=\"javascript:\" onclick=\"' + sLinkNew.substr(11) + '\">' + EXformatData(DLPropName, DLPropType, sValue) + '</a></td>';\r\n                    else\r\n                        sTable = sTable + '<td class=\"ms-vb\"><a href=\"' + sLinkNew + '\">' + EXformatData(DLPropName, DLPropType, sValue) + '</a></td>';\r\n                }\r\n                else if (DLPropName == 'icon') { // 13.4.2008\r\n                    var sUrl = getsafe(xNodes[j], 'DL_URLDocument');\r\n                    var ii = sUrl.lastIndexOf('.');\r\n                    var szExt = sUrl.substr(ii + 1);\r\n                    var sIconImg = '/_layouts/images/' + MapToAll('', szExt, '@Value');\r\n                    //alert('icon ' + szExt + ' ' + sIconImg);\r\n                    // 22.12.2009 - sTable = sTable + '<td class=\"ms-vb\"><a href=\"' + sUrl + '\"><img border=\"0\" src=\"' + sIconImg + '\"></a></td>';\r\n                    sTable = sTable + '<td class=\"ms-vb\" width=\"16px\"><a href=\"' + sUrl + '\"><img border=\"0\" src=\"' + sIconImg + '\"></a></td>';\r\n                }\r\n                else if (DLPropName == 'checkbox')\r\n                    sTable = sTable + '<td class=\"ms-vb\"><input id=\"cbDF' + getsafe(xNodes[j], XPathDLId) + '\" type=\"checkbox\"></td>';\r\n                else if (DLPropName == 'input') // 12.1.2010\r\n                    sTable = sTable + '<td class=\"ms-vb\"><input id=\"tbDF' + getsafe(xNodes[j], XPathDLId) + '\" type=\"text\"></td>';\r\n                else if (DLPropName == 'DL_LastSeen') { // 21.1.2010\r\n                    var sAgo;\r\n                    if (sValue == '')\r\n                        sAgo = '';\r\n                    else {\r\n                        var oD = new Date;\r\n                        oD.setISO8601(sValue);\r\n                        sAgo = dateAgo(oD);\r\n                    }\r\n                    sTable = sTable + '<td class=\"ms-vb\">' + sAgo + '</td>';\r\n                }\r\n                else {\r\n                    sLink = '';\r\n                    //alert('123 - ' + i);\r\n                    if (sLinks != null && i < sLinks.length) {\r\n                        if (sLinks[i] != '') {\r\n                            var xA = xActions.selectSingleNode('//DL_Action[DL_Id=' + sLinks[i] + ']');\r\n                            //alert('DEBUG\\nsLinks[i]=' + sLinks[i] + ' xA=' + xA);\r\n                            if (xA != null)\r\n                                sLink = getsafe(xA, 'DL_Action');\r\n                            if (sLink != '')\r\n                                sLink = EXReplaceGeneric(EXReplaceGeneric(sLink, xNodes[j]), xNodes[j]); // 23.1.2013 - VF fix\r\n                        }\r\n                    }\r\n                    //alert(DLPropNameAlt);\r\n                    if (DLPropNameAlt != '' && sLink == '') {\r\n                        sLink = \"javascript:loadcontent('\" + getsafe(xNodes[j], DLPropNameAlt) + \"');\";\r\n                        //alert(DLPropNameAlt + ' ' + sLink);\r\n                    }\r\n                    //if (j == 0 && i == 1)\r\n                    //alert('DEBUG\\nDLPropname=' + DLPropName + ':' + DLPropType + ' sLink=' + sLink + ' sValue=' + sValue + ' sLinks.length=' + sLinks.length);\r\n                    if (sLink == '') {\r\n                        if (DLPropType == 'DL_Money')\r\n                            sTable = sTable + '<td class=\"ms-vb\" align=\"right\">' + EXformatData(DLPropName, DLPropType, sValue) + '</td>';\r\n                        else\r\n                            sTable = sTable + '<td class=\"ms-vb\">' + EXformatData(DLPropName, DLPropType, sValue) + '</td>';\r\n                    }\r\n                    else {\r\n                        //alert('DEBUG\\nif - ' + i + ' ' + DLPropName + ' ' + sValue);\r\n                        if (DLPropName.indexOf('img:') == 0) {\r\n                            var sImgSrc = DLPropName.substring(4); // 15.3.2009\r\n                            if (sImgSrc.indexOf('/') != 0)\r\n                                sImgSrc = '/EX_Resources/img/16x16/' + sImgSrc;\r\n                            //alert('DEBUG\\nImage DLPropName=' + DLPropName + ' sImgSrc=' + sImgSrc);\r\n                            // 22.12.2009 - sTable = sTable + '<td class=\"ms-vb\"><a href=\"' + sLink + '\"><img border=\"0\" src=\"' + sImgSrc + '\"></a></td>';\r\n                            sTable = sTable + '<td class=\"ms-vb\" width=\"16px\"><a href=\"' + sLink + '\"><img border=\"0\" src=\"' + sImgSrc + '\"></a></td>';\r\n                        }\r\n                        else {\r\n                            //alert(sLink + '\\n' + sLink.substr(11));\r\n                            if (sLink.indexOf('javascript:') == 0) // 21.8.2010\r\n                                sTable = sTable + '<td class=\"ms-vb\"><a href=\"javascript:\" onclick=\"' + sLink.substr(11) + '\">' + EXformatData(DLPropName, DLPropType, sValue) + '</a></td>';\r\n                            else\r\n                                sTable = sTable + '<td class=\"ms-vb\"><a href=\"' + sLink + '\">' + EXformatData(DLPropName, DLPropType, sValue) + '</a></td>';\r\n                        }\r\n                    }\r\n                    sLink = '';\r\n                    //alert('3' + sTable);\r\n                }\r\n            }\r\n            sTable = sTable + '</tr>';\r\n        }\r\n    } // if\r\n    if (sClickAction != '') {\r\n        var xAction = getEntityData('DL_Action', 'DL_Id = ' + sClickAction, '');\r\n        var sTitle = getsafe(xAction, '//DL_Tooltip');\r\n        //alert(sClickAction + ' ' + sTitle + ' ' + getsafe(xAction, '//DL_Action/DL_Action'));\r\n        sTable = sTable + '<tr><td aclass=\"ms-vb\" lign=\"center\" colspan=\"' + (oD710s.length + 1) + '\"><input type=\"button\" value=\"' + sTitle + '\" onclick=\"' + getsafe(xAction, '//DL_Action/DL_Action') + '\"></td></tr>';\r\n    }\r\n    sTable = sTable + '</table>';\r\n    //alert(sTable);\r\n    //endTime = new Date().getTime();// 15.3.2009\r\n    //alert('OLD ' + sEntity + ' Time elapsed=' + (endTime-startTime)); // 15.3.2009\r\n    xData = null; xNodes = null;\r\n    return sTable;\r\n}\r\nNumber.prototype.formatMoney = function (c, d, t) { // 15.7.2010 http://stackoverflow.com/questions/149055/how-can-i-format-numbers-as-money-in-javascript\r\n    var n = this, c = isNaN(c = Math.abs(c)) ? 2 : c, d = d == undefined ? \",\" : d, t = t == undefined ? \".\" : t, s = n < 0 ? \"-\" : \"\", i = parseInt(n = Math.abs(+n || 0).toFixed(c)) + \"\", j = (j = i.length) > 3 ? j % 3 : 0;\r\n    return s + (j ? i.substr(0, j) + t : \"\") + i.substr(j).replace(/(\\d{3})(?=\\d)/g, \"$1\" + t) + (c ? d + Math.abs(n - i).toFixed(c).slice(2) : \"\");\r\n};\r\n// 30.3.2009 - Moved from EXDynamicForm.js\r\nfunction EXformatData(DLPropName, DLPropType, s1) {\r\n    //alert('EXformatData(' + DLPropName + ',' + DLPropType + ',' + s1 + ')');\r\n    if (DLPropName == 'DL_DocumentExtension') {\r\n        var sIconImg = '/_layouts/images/' + MapToAll('', s1, '@Value');\r\n        return '<img alt=\"\" border=\"0\" src=\"' + sIconImg + '\">';\r\n    }\r\n    else if (DLPropName == 'DL_Modified') // 20.2.2008\r\n        return s1.substring(0, 10);\r\n    else if (DLPropName == 'DL_ModifiedBy') // 20.2.2008\r\n        return s1.substring(s1.indexOf('\\\\') + 1);\r\n    else if (DLPropType == 'DL_Date')\r\n        return s1.substr(0, 10);\r\n    else if (DLPropType == 'DL_Image') {\r\n        return '<img alt=\"' + s1 + '\" title=\"' + s1 + '\" src=\"' + s1 + '\">';\r\n    }\r\n    else if (DLPropType == 'DL_Money') { // 15.7.2010\r\n        var f = 1.0 * s1;\r\n        //alert('EXformatData(' + DLPropName + ',' + DLPropType + ',' + s1 + ') f=' + f);\r\n        return f.formatMoney(2, ',', '.');\r\n    }\r\n    else if (DLPropType == 'DL_Float') { // 7.9.2010\r\n        var f = 1.0 * s1;\r\n        //alert('EXformatData(' + DLPropName + ',' + DLPropType + ',' + s1 + ') f=' + f);\r\n        return f.formatMoney(2, ',', '.');\r\n    }\r\n    else if (DLPropType == 'DL_TextBox') { // 13.1.2009\r\n        return s1.replace('\\n', '<P>');\r\n    }\r\n    else if (DLPropType == 'DL_Email') {\r\n        if (s1 == '')\r\n            return '';\r\n        return '<a href=\"mailto:' + s1 + '\">' + s1 + '</a>';\r\n    }\r\n    else\r\n        return s1; // + DLPropType;\r\n}\r\n\r\nfunction EXReplaceGeneric(sData, xNode, sDelimiter) { // 26.2.2008 - moved from EXDynamicForm.js // 24.3.2011 sDelimiter added\r\n    if (typeof (sDelimiter) == 'undefined')\r\n        sDelimiter = '%';\r\n    return _EXReplaceGeneric(sData, xNode, sDelimiter, 1, ''); // 21.8.2012 - 0 --\x3e 1\r\n}\r\nfunction _EXReplaceGeneric(sData, xNode, sDelimiter, iMax, sPrefix, xExtra, xExtra2) { // 26.2.2008 - moved from EXDynamicForm.js // 24.3.2011 sDelimiter added\r\n    try {\r\n        if (typeof (xExtra) == 'undefined') xExtra = null;\r\n        if (typeof (xExtra2) == 'undefined') xExtra2 = null;\r\n        var i, j, XPath;\r\n        i = sData.indexOf(sDelimiter);\r\n        if (i == -1)\r\n            return sData;\r\n        j = sData.substr(i + 1).indexOf(sDelimiter);\r\n        XPath = sData.substr(i + 1, j);\r\n        if (XPath.indexOf(' ') > -1) XPath = 'UNKNOWN' + XPath.replace(/ /g, ''); // 24.3.2011 - avoid errors\r\n        //alert(XPath);\r\n        try { sValue = getsafe(xNode, sPrefix + XPath); } catch (e) { sValue = ''; }\r\n        if (sValue == '' && xExtra != null)\r\n            try { sValue = getsafe(xExtra, sPrefix + XPath); } catch (e) { sValue = ''; }\r\n        if (sValue == '' && xExtra2 != null)\r\n            try { sValue = getsafe(xExtra2, sPrefix + XPath); } catch (e) { sValue = ''; }\r\n        //alert(sValue + ' ' + XPath + ' xml=' + xNode);\r\n        sData = sData.replace(sDelimiter + XPath + sDelimiter, sValue);\r\n        sData = sData.replace(sDelimiter + XPath + sDelimiter, sValue); // 14.8.2009 - replace 3 times\r\n        sData = sData.replace(sDelimiter + XPath + sDelimiter, sValue);\r\n        if (iMax > 0) {\r\n            j = j - sDelimiter.length - XPath.length - sDelimiter.length + sValue.length + 1;\r\n            j = sData.substr(j + 1).indexOf(sDelimiter);\r\n            if (j > 0)\r\n                sData = _EXReplaceGeneric(sData, xNode, sDelimiter, iMax - 1, sPrefix, xExtra, xExtra2);\r\n        }\r\n        return sData;\r\n    } catch (e) { alert('_EXReplaceGeneric(' + sData.substr(0, 50) + ', ' + xNode.xml.substr(0, 50) + ',' + sDelimiter + ') failed >>> ' + e.message); return ''; }\r\n}\r\n\r\nfunction EXSetCaseSecurity(DL_SecurityDictionary, DL_SecurityDictionaryId) {\r\n    EXGotoUrl(getAbsoluteURL('/IT-SITE/Pages/ManageCaseSecurity.aspx?DL_SecurityDictionary=' + DL_SecurityDictionary + '&DL_SecurityDictionaryId=' + DL_SecurityDictionaryId));\r\n}\r\n\r\nvar oEXDocIcon = null;\r\nfunction EXCheckDocIcon() {\r\n    if (oEXDocIcon == null) {\r\n        try {\r\n            if (true) { // 17.5.2010 - prepare for multi browser support\r\n                var objXMLHTTP = EXXMLHTTP();\r\n                objXMLHTTP.open('get', getAbsoluteURL('/EX_Resources/DOCICON.xml'), false);\r\n                objXMLHTTP.send();\r\n                oEXDocIcon = objXMLHTTP.responseXML;\r\n                objXMLHTTP = null;\r\n            }\r\n            else {\r\n                oEXDocIcon = EXDOMDocument(); //new ActiveXObject('MSXML2.DOMDocument');\r\n                oEXDocIcon.async = false;\r\n                oEXDocIcon.load(getAbsoluteURL('/EX_Resources/DOCICON.xml'));\r\n            }\r\n            //alert('CheckDocIcon ' + oEXDocIcon.xml);\r\n            return true;\r\n        } catch (e) { alert('EXCheckDocIcon ' + e.message); }\r\n        oEXDocIcon = null;\r\n    }\r\n    else\r\n        return true;\r\n    return false;\r\n}\r\nfunction MapToAll(szProgId, szExt, XPath1) {\r\n    if (!EXCheckDocIcon()) return szExt;\r\n    var XPath;\r\n    if (szExt.indexOf('htm') == 0) szExt = 'htm'; // 24.2.2015 fix\r\n    if (szProgId == '') // 29.4.2011\r\n        XPath = \"//ByExtension/Mapping[@Key='\" + szExt.toLowerCase() + \"']\";\r\n    else\r\n        XPath = \"//ByProgID/Mapping[@Key='\" + szProgId + \"']\"; // 29.4.2011\r\n    var xNode = oEXDocIcon.selectSingleNode(XPath);\r\n    if (xNode == null) {\r\n        //alert('MapToAll(' + szProgId + ',' + szExt + ') failed ' + XPath);\r\n        if (XPath1 == '@Value')\r\n            return 'icgen.gif';\r\n        else if (XPath1 == '' || XPath1 == null)\r\n            return 'icgen.gif||';\r\n        else\r\n            return '';\r\n    }\r\n    else\r\n        if (XPath1 == '' || XPath1 == null)\r\n            return getsafe(xNode, '@Value') + '|' + getsafe(xNode, '@EditText') + '|' + getsafe(xNode, '@OpenControl');\r\n        else\r\n            return getsafe(xNode, XPath1);\r\n}\r\nfunction EXCheckSetCaseSecurityR810(DLEntityNameForeign, DLEntityId) {\r\n    //alert('EXCheckSetCaseSecurityR810(' + DLEntityNameForeign + ',' + DLEntityId + ')');\r\n    ExecuteProcedure('EXCheckSetCaseSecurityR810 @DLEntityNameForeign = ' + DLEntityNameForeign + ', @DLEntityId = ' + DLEntityId);\r\n    var sWhere = 'DL_SecurityDictionary = \\'' + DLEntityNameForeign + '\\' and DL_SecurityDictionaryId = ' + DLEntityId;\r\n    var oXML = getEntityData('DL_R810', sWhere, '');\r\n    var DLId = getsafe(oXML, '//DL_Id');\r\n    var oDiv = document.getElementById('DL_Information');\r\n    //alert('DL_R810 ' + DLId + ' ' + sWhere + ' ' + oXML.xml + ' ' + oDiv);\r\n    // FOR SOME STRANGE REASON WE CANNOT ACCESS loadentity - DL_Information is not present at load time???\r\n    setTimeout('loadentity(\\'DL_R810\\',' + DLId + ')', 100);\r\n    //alert('done');\r\n}\r\nfunction EXCaseSecurityMenu(DLSecurityDictionary, DLSecurityDictionaryId) {\r\n    var s = '<table><tr><td><a href=\"javascript:loadentity(\\'' + DLSecurityDictionary + ' \\',' + DLSecurityDictionaryId + ')\">show</a></td></tr>';\r\n    var sWhere = 'DL_SecurityDictionary = \\'' + DLSecurityDictionary + '\\' and DL_SecurityDictionaryId = ' + DLSecurityDictionaryId;\r\n    var oXML = getEntityData('DL_R810', sWhere, '');\r\n    var DLId = getsafe(oXML, '//DL_Id');\r\n    if (DLId != '') {\r\n        s = s + '<tr><td><a href=\"javascript:loadentity(\\'DL_R810\\', ' + DLId + ')\">rule</td></tr>';\r\n    }\r\n    s = s + '<tr><td><a href=\"javascript:EXGotoObject(\\'' + DLSecurityDictionary + '\\', ' + DLSecurityDictionaryId + ');\">return to case</td></tr>';\r\n    s = s + '</table>';\r\n    //alert('EXCaseSecurityMenu ' + DLId + '\\n' + s);\r\n    return s;\r\n}\r\n\r\nfunction EXGotoDocument(url, EXDocumentID) {\r\n    if (url.indexOf('http') != 0)\r\n        url = getAbsoluteURL(url);\r\n    var i = url.lastIndexOf('/');\r\n    url = url.substr(0, i);\r\n    EXGotoUrl(url + '?FilterField1=DocumentId&FilterValue1=8%5F' + EXDocumentID);\r\n}\r\n\r\nfunction pasteClipboardToEntity(sServer, DL_Entity, DL_FolderParams, DL_FolderType, bReturnResult) { // 2.9.2009 - bReturnResult added\r\n    if (typeof (bReturnResult) == 'undefined')\r\n        bReturnResult = false;\r\n    try {\r\n        if (DL_FolderParams == '' || DL_FolderParams == '//0')\r\n            return;\r\n\r\n        var oX = getEXUtilities();\r\n        if (!oX)\r\n            return;\r\n        //oX.prtSC(); // Capture current screen\r\n        //alert('pasteClipboardToEntity - prtSC completed');\r\n        var sResult = oX.pasteClipboardToEntity(sServer, DL_Entity, DL_FolderParams, DL_FolderType);\r\n        //var ITCase = queryString('IT_Case');\r\n        //var sResult = oX.pasteClipboardToEntity(getAbsoluteURL(''),'IT_Case','//' + ITCase,'10'); // 10 is foldertype for pictures\r\n        if (sResult.indexOf('#ERROR') == 0)\r\n            alert('pasteClipboardToEntity = ' + sResult);\r\n        else if (sResult == '')\r\n            alert('Clipboard is empty - please selet a picture');\r\n        else if (!bReturnResult) // 14.1.2010 - wrong spelling - fixed\r\n            alert('Picture added to case: ' + sResult);\r\n        oX = null; // 6.12.2008 - release object\r\n        if (bReturnResult)\r\n            return sResult;\r\n    } catch (e) { alert('pasteClipboardToEntity ' + e.message); }\r\n}\r\n\r\nfunction EXReportITCase(title, bPrtSc, bGoto) {\r\n    alert('Currently not supported'); // 3.8.2011 - avoid reporting IT cases through this channel\r\n    return;\r\n    try {\r\n        var oX;\r\n        if (bPrtSc) {\r\n            oX = getEXUtilities();\r\n            if (!oX)\r\n                bPrtSc = false;\r\n        }\r\n        else\r\n            oX = null;\r\n        if (bPrtSc) oX.prtSC(); // Capture current screen\r\n        if (title == '' || title == null || title == 'null')\r\n            return;\r\n        var oXML = getEntityData('DL_sAMAccountName', 'DL_sAMAccountName = %DL_sAMAccountName%', '');\r\n        var sLocation = window.location.href;\r\n        var xOps = '<IT_Case>';\r\n        xOps = xOps + '<DL_Title>' + MakeXMLSafe(title.substr(0, 45)) + '</DL_Title><DL_Severity>3</DL_Severity><DL_SeverityType>3</DL_SeverityType><DL_TextBox>' + MakeXMLSafe(title) + '\\nLocation: ' + MakeXMLSafe(sLocation) + '</DL_TextBox><DL_Responsible>' + getsafe(oXML, '//DL_sAMAccountName/DL_sAMAccountName') + '</DL_Responsible>';\r\n        xOps = xOps + '</IT_Case>';\r\n        var ITCase = setEntityDetail('IT_Case', xOps);\r\n        if (ITCase == '') {\r\n            alert(LEX_ITCaseCouldNotCreate);\r\n            return;\r\n        }\r\n        xOps = '<DL_Exformation>';\r\n        xOps += '<DL_Description>@' + getsafe(oXML, '//DL_sAMAccountName/DL_sAMAccountName') + '  Tak for din besked. Vi ser p\\345 det snarest</DL_Description>';\r\n        xOps += '<DL_EntityNameForeign>IT_Case</DL_EntityNameForeign>';\r\n        xOps += '<DL_EntityId>' + ITCase + '</DL_EntityId>';\r\n        xOps += '<DL_sAMAccountNameForeign>support</DL_sAMAccountNameForeign>';\r\n        xOps += '</DL_Exformation>';\r\n        setEntityDetail('DL_Exformation', xOps);\r\n        //var sResult = oX.prtSCToEntity(getAbsoluteURL(''),'IT_Case','//' + ITCase,'10'); // 10 is foldertype for pictures\r\n        var sResult = '';\r\n        if (bPrtSc) sResult = oX.pasteClipboardToEntity(getAbsoluteURL(''), 'IT_Case', '//' + ITCase, '10'); // 10 is foldertype for pictures\r\n        if (sResult.indexOf('#ERROR') == 0)\r\n            alert('Could not upload picture ' + sResult);\r\n        //alert('EXReportITCase ' + sResult + ' ITCase=' + ITCase);\r\n        var sConfig;\r\n        //sConfig = oX.saveMachineConfiguration(); // Produces an xml file\r\n        oX = null;\r\n        if (bGoto) EXGotoObject('IT_Case', ITCase);\r\n    } catch (e) { alert('EXReportITCase ' + e.message); }\r\n}\r\n\r\nfunction EXCloseExformation() {\r\n    var oDiv = document.getElementById('EXExformation');\r\n    if (oDiv != null)\r\n        oDiv.style.display = 'none';\r\n    //alert(oDiv.innerHTML);\r\n}\r\nfunction EXSaveExformation(sEle, bReload) { // 22.1.2011 - bReload added\r\n    if (typeof (bReload) == 'undefined')\r\n        bReload = true;\r\n    if (typeof (sEle) == 'undefined')\r\n        sEle = '';\r\n    if (sEle == '')\r\n        sEle = 'txtExformation';\r\n    EXCloseExformation();\r\n    var DLEntityNameForeign = queryString('DL_EntityNameForeign');\r\n    var DLEntityId = queryString('DL_EntityId');\r\n    //alert('EXSaveExformation ' + DLEntityNameForeign + ':' + DLEntityId);\r\n    //var s = window.location.search;\r\n    var s = window.location.href; // 12.7.2011 - modified - IT Case 2367 - cross-browser support\r\n    //alert('window.location.search=' + s);\r\n    var i = s.indexOf('?');\r\n    //alert('i=' + i);\r\n    /*\r\n    if (i>-1)\r\n    s = s.substr(i+1);\r\n    i = s.indexOf('&');\r\n    if (i>0)\r\n    s = s.substr(0,i);\r\n    //alert(s);\r\n    i = s.indexOf('=');\r\n    if (i>0) {\r\n    DLEntityNameForeign = s.substr(0,i);\r\n    DLEntityId = s.substr(i+1);\r\n    }\r\n    */\r\n    var oEle = document.getElementById(sEle);\r\n    if (oEle.value == '')\r\n        return;\r\n    s = '<a>';\r\n    var oXML = getEntityData('DL_sAMAccountName', 'DL_sAMAccountName = %DL_sAMAccountName%', '');\r\n    s += '<DL_sAMAccountNameForeign>' + getsafe(oXML, '//DL_sAMAccountName/DL_sAMAccountName') + '</DL_sAMAccountNameForeign>';\r\n    s += '<DL_Description>' + MakeXMLSafe(EXExpandHREF(oEle.value)) + '</DL_Description>'; // 16.8.2011 - EXExpandHREF added\r\n    if (i > 0) {\r\n        //alert(DLEntityNameForeign + ':' + DLEntityId);\r\n        if (DLEntityNameForeign != 'undefined' && DLEntityNameForeign != '') {\r\n            s += '<DL_EntityNameForeign>' + DLEntityNameForeign + '</DL_EntityNameForeign>';\r\n            s += '<DL_EntityId>' + DLEntityId + '</DL_EntityId>';\r\n        }\r\n    }\r\n    else {\r\n        if (oEle.DLEntityNameForeign != '' && typeof (oEle.DLEntityNameForeign) != 'undefined') {\r\n            DLEntityNameForeign = oEle.DLEntityNameForeign;\r\n            DLEntityId = oEle.DLEntityId;\r\n            if (DLEntityNameForeign != 'undefined' && DLEntityNameForeign != '') {\r\n                s += '<DL_EntityNameForeign>' + oEle.DLEntityNameForeign + '</DL_EntityNameForeign>';\r\n                s += '<DL_EntityId>' + oEle.DLEntityId + '</DL_EntityId>';\r\n            }\r\n        }\r\n    }\r\n    var oInstr = document.getElementById('DLExformationTypeInstruction');\r\n    if (oInstr != null)\r\n        if (oInstr.checked) {\r\n            s += '<DL_ExformationType>2</DL_ExformationType>';\r\n        }\r\n    // 12.7.2011 - cross-browser support\r\n    var newexf = oEle.id.replace('newexformation', '');\r\n    //if (oEle.DLId != '' && typeof(oEle.DLId) != 'undefined')\r\n    //s += '<DL_ProfileParent>' + oEle.DLId + '</DL_ProfileParent>';\r\n    if (newexf != '')\r\n        s += '<DL_ProfileParent>' + newexf + '</DL_ProfileParent>';\r\n    //alert('Exformation ' + newexf + ' - ' + s + '\\n' + oEle.outerHTML + ' ' + oEle.dlid);\r\n    //return;\r\n    s += '</a>';\r\n    //alert(oEle.outerHTML + ' ' + queryString('DL_EntityNameForeign'));\r\n    //alert(s);\r\n    setEntityDetail('DL_Exformation', s);\r\n    if (bReload) {\r\n        if (window.location.href.indexOf('/EXExformation.html') > 0)\r\n            window.location.href = window.location.href;\r\n        else {\r\n            loadcontent2(getAbsoluteURL('/EX_Resources/EXExformation.html?DL_EntityNameForeign=' + DLEntityNameForeign + '&DL_EntityId=' + DLEntityId), LEX_Notes);\r\n        }\r\n    }\r\n    //alert(window.location.href);\r\n}\r\nfunction EXExpandHREF(s) { // 16.8.2011 - replace http://www.abc.def --\x3e <a href=\"...\" target=\"new\">url</a>\r\n    if (s.indexOf('<img') != -1) // 25.8.2011 - don't modify pictures\r\n        return s;\r\n    //var res = s.replace(/(http:\\/\\/[^ ]+)/g,'<a href=\"$1\" target=\"new\">$1</a>/');\r\n    //var res = res.replace(/(https:\\/\\/[^ ]+)/g,'<a href=\"$1\" target=\"new\">$1</a>/'); // 18.8.2011\r\n    var res = s.replace(/(http:\\/\\/[^ \\r\\n<]+)/g, '<a href=\"$1\" target=\"new\">$1</a>'); // 12.9.2011 - remove trailing /\r\n    res = res.replace(/(https:\\/\\/[^ \\r\\n<]+)/g, '<a href=\"$1\" target=\"new\">$1</a>');\r\n    return res;\r\n}\r\nfunction EXShowAddExformation(oEle, DLId, DLModified, DLEntityNameForeign, DLEntityId, sValue) {\r\n    if (typeof (sValue) == 'undefined') // 4.8.2010\r\n        sValue = '';\r\n    if (typeof (DLEntityNameForeign) == 'undefined') {\r\n        DLEntityNameForeign = ''; DLEntityId = 0;\r\n    }\r\n    if (parent) {\r\n        //parent.EXShowAddExformation(oEle,DLId,DLModified,DLEntityNameForeign,DLEntityId);\r\n        //return;\r\n        DLId = DLId;\r\n    }\r\n    if (DLEntityNameForeign == '') {\r\n        if (typeof (parent.sEXEntity) != 'undefined') {\r\n            DLEntityNameForeign = parent.sEXEntity;\r\n            DLEntityId = parent.sEXEntityId;\r\n        }\r\n        else {\r\n            if (typeof (sEXEntity) != 'undefined') {\r\n                DLEntityNameForeign = sEXEntity;\r\n                DLEntityId = sEXEntityId;\r\n            }\r\n        }\r\n    }\r\n    var oDiv = document.getElementById('EXExformation');\r\n    if (oDiv == null) {\r\n        oDiv = document.createElement('DIV');\r\n        oDiv.id = 'EXExformation';\r\n        //20100825: BH Added class\r\n        oDiv.className = 'exf-exformation-pad';\r\n        oDiv.style.zIndex = 6;\r\n        //20100825: BH removed style\r\n        //oDiv.style.height = \"440px\"; // 300px\r\n        //oDiv.style.width = \"360px\"; // 400\r\n        oDiv.style.visibility = \"\";\r\n        oDiv.style.display = 'none';\r\n        document.body.appendChild(oDiv);\r\n        oDiv = document.getElementById('EXExformation');\r\n    }\r\n    oDiv.style.display = '';\r\n    oDiv.style.position = \"absolute\";\r\n    var left, top;\r\n    if (oEle == null) {\r\n        var evt = window.event;\r\n        left = -20 + evt.clientX + (document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft);\r\n        top = -20 + evt.clientY + (document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop);\r\n    }\r\n    else {\r\n        left = getElementLeft1(oEle) + 40;\r\n        top = getElementTop1(oEle);\r\n    }\r\n    //alert(left + ' ' + top);\r\n    if (left < 10)\r\n        left = 10;\r\n    if (top < 10)\r\n        top = 10;\r\n    if ((left + 380) > document.width)\r\n        left = document.width - 380;\r\n    if ((left + 380) > document.body.offsetWidth)\r\n        left = document.body.offsetWidth - 380;\r\n    if ((top + 460) > document.height)\r\n        top = document.height - 460;\r\n    //alert(left + ' ' + top);\r\n    oDiv.style.left = left;\r\n    oDiv.style.top = top;\r\n    var sInstruction = '';\r\n    //var LEX_Instruction = 'Instruktion';\r\n    if (DLEntityNameForeign != '')\r\n        sInstruction = '<input type=\"checkbox\" id=\"DLExformationTypeInstruction\"> ' + LEX_Instruction + DLEntityNameForeign;\r\n    //20100825 BH Altered\r\n    //var sTable = '<table width=\"100%\" border=\"0\" bgcolor=\"#cccccc\" zz=\"#efefef\"><tr><td class=\"ms-vb\"></td><td class=\"ms-vb\" align=\"right\"><a href=\"javascript:\" onclick=\"EXCloseExformation()\"> - </a></td></tr><tr><td class=\"ms-vb\" colspan=\"2\"><textarea id=\"txtExformation\" rows=\"12\" columns=\"180\" style=\"background-color:#F7C65A; width:350px\" DLId=\"' + DLId + '\" DLModified=\"' + DLModified + '\" DLEntityNameForeign=\"' + DLEntityNameForeign + '\" DLEntityId=\"' + DLEntityId + '\"></textarea></td></tr><tr><td class=\"ms-vb\">' + sInstruction + '</td><td class=\"ms-vb\" align=\"right\"><a href=\"javascript:\" onclick=\"EXCloseExformation()\">' + LEX_Close + '</a> <input type=\"button\" value=\"' + LEX_AddComment + '\" onclick=\"EXSaveExformation()\"></td></tr></table>';\r\n    var sTable = '<table width=\"100%\" border=\"0\" bgcolor=\"#cccccc\" zz=\"#efefef\"><tr class=\" ms-WPheader\"><td class=\"ms-vb ms-WPheader\" colspan=\"2\" id=\"dragbar\" align=\"right\" onMousedown=\"initializedrag2(event)\">';\r\n    sTable += '<ilayer width=\"100%\" onSelectStart=\"return false\"><layer width=\"100%\" onMouseover=\"dragswitch=1;if (ns4) drag_dropns(EXExformation)\" onMouseout=\"dragswitch=0\"><font face=\"Verdana\" color=\"#FFFFFF\"><strong><small>Announcement Box</small></strong></font></layer></ilayer>';\r\n    sTable += '<a href=\"javascript:\" onclick=\"EXCloseExformation()\"> - </a></td></tr><tr><td class=\"ms-vb\" colspan=\"2\"><textarea id=\"txtExformation\" rows=\"12\" columns=\"180\" class=\"exf-exformation-postit\" DLId=\"' + DLId + '\" DLModified=\"' + DLModified + '\" DLEntityNameForeign=\"' + DLEntityNameForeign + '\" DLEntityId=\"' + DLEntityId + '\"></textarea></td></tr><tr><td class=\"ms-vb\">' + sInstruction + '</td><td class=\"ms-vb\" align=\"right\"><a href=\"javascript:\" onclick=\"EXCloseExformation()\">' + LEX_Close + '</a> <input class=\"exf-button\" type=\"button\" value=\"' + LEX_AddComment + '\" onclick=\"EXSaveExformation()\"></td></tr></table>';\r\n    //alert(sTable);\r\n    oDiv.innerHTML = sTable;\r\n    var oEle = document.getElementById('txtExformation');\r\n    oEle.value = sValue; // 4.8.2010\r\n    oEle.focus();\r\n    setTimeout(\"EXFocus('txtExformation')\", 200); // ensure it happens\r\n}\r\n\r\n//20100825: BH Added draganddrop\r\n\r\nfunction drag_drop2(e) {\r\n    if (ie4 && dragapproved) {\r\n        crossobj.style.left = tempx + event.clientX - offsetx\r\n        crossobj.style.top = tempy + event.clientY - offsety\r\n        return false\r\n    }\r\n    else if (ns6 && dragapproved) {\r\n        crossobj.style.left = tempx + e.clientX - offsetx + \"px\"\r\n        crossobj.style.top = tempy + e.clientY - offsety + \"px\"\r\n        return false\r\n    }\r\n}\r\n\r\nfunction initializedrag2(e) {\r\n    crossobj = ns6 ? document.getElementById(\"EXExformation\") : document.all.EXExformation\r\n    var firedobj = ns6 ? e.target : event.srcElement\r\n    var topelement = ns6 ? \"html\" : document.compatMode && document.compatMode != \"BackCompat\" ? \"documentElement\" : \"body\"\r\n    while (firedobj.tagName != topelement.toUpperCase() && firedobj.id != \"dragbar\") {\r\n        firedobj = ns6 ? firedobj.parentNode : firedobj.parentElement\r\n    }\r\n\r\n    if (firedobj.id == \"dragbar\") {\r\n        offsetx = ie4 ? event.clientX : e.clientX\r\n        offsety = ie4 ? event.clientY : e.clientY\r\n\r\n        tempx = parseInt(crossobj.style.left)\r\n        tempy = parseInt(crossobj.style.top)\r\n\r\n        dragapproved = true\r\n        document.onmousemove = drag_drop2\r\n    }\r\n}\r\n\r\ndocument.onmouseup = new Function(\"dragapproved=false\")\r\n\r\nfunction EXFocus(sEle) {\r\n    var oEle = document.getElementById(sEle);\r\n    oEle.focus();\r\n}\r\n// Function keys\r\n// {'f1':112,'f2':113,'f3':114,'f4':115,'f5':116,'f6':117,'f7':118,'f8':119,'f9':120,'f10':121,'f11':122,'f12':123}\r\nfunction EXHandleFunctionKeys() {\r\n    //alert('EXHandleFunctionKey ' + event.keyCode);\r\n    if (event.keyCode == 119) // 23.5.2010\r\n        EXShowAddExformation(null, '', '');\r\n    if (event.keyCode == 113 || event.keyCode == 117) { // 16.8.2011 - QuickSearch\r\n        if (typeof (sEXEntity) != 'undefined') {\r\n            if (event.keyCode == 113)\r\n                EXLoadQuickSearch(sEXEntity, false, '', '', null, true, '');\r\n            else if (event.keyCode == 117)\r\n                loadcontent2('/EX_Resources/EXExformation.html?DL_EntityNameForeign=' + sEXEntity + '&DL_EntityId=' + sEXEntityId, LEX_KnowledgeExchanges);\r\n        }\r\n    }\r\n    //if (event.keyCode == 123) // 27.10.2010 - remove\r\n    //\tEXReportITCase();\r\n}\r\nfunction EXInitFunctionKeys() {\r\n    var oEle = document;\r\n    if (oEle.addEventListener) { // IT Case 2367 - 12.7.2011\r\n        oEle.addEventListener('keydown', EXHandleFunctionKeys, false);\r\n    }\r\n    else\r\n        oEle.attachEvent('onkeydown', EXHandleFunctionKeys);\r\n}\r\n// EXInitFunctionKeys();\r\n\r\n\r\nfunction EXLoadSearch(DLId, sTitle) {\r\n    try {\r\n        //loadcontent2(getAbsoluteURL('/EX_SQLSVC/DynamicList.html?DLId=' + DLId + \"&EXcheck=\" + Math.random()), sTitle); // 15.4.2008 - Math.random added\r\n        loadcontent2(getAbsoluteURL('/EX_SQLSVC/DynamicSearch.html?D410=' + DLId + \"&EXcheck=\" + Math.random()), sTitle); // 15.9.2008 - modified to DynamicSearch\r\n    } catch (e) { alert('EXLoadSearch(' + DLId + ') failed ' + e.message); }\r\n}\r\nfunction mod(div, base) {\r\n    return Math.round(div - (Math.floor(div / base) * base));\r\n}\r\n\r\nfunction EXApproveMeeting(entity, id, modified, bApprove) {\r\n    if (typeof (bApprove) == 'undefined') bApprove = true;\r\n    var oXML = getEntityData(entity, 'DL_Id = ' + id, '');\r\n    modified = getsafe(oXML, '//DL_Modified');\r\n    //alert('EXApproveMeeting ' + id + ' ' + modified);\r\n    //SetEntityItemValue(entity,id, modified, 'DL_CaseApproved', 1, 'DL_AgendaNo','X');\r\n    ExecuteProcedure('EXApproveRejectDLCaseMeetings @DLId=' + id + ',@Approved=' + (bApprove ? '1' : '0'));\r\n    if (bApprove) {\r\n        SetEntityItemValue(entity, id, modified, 'DL_CaseApproved', 1); // 11.9.2008\r\n    }\r\n    else {\r\n        EXdeleteentity(entity, id);\r\n    }\r\n    //alert('done');\r\n    EXReload();\r\n}\r\nfunction EXUnApproveMeeting(entity, id, modified) {\r\n    var oXML = getEntityData(entity, 'DL_Id = ' + id, '');\r\n    modified = getsafe(oXML, '//DL_Modified');\r\n    //alert('EXApproveMeeting ' + id + ' ' + modified);\r\n    ExecuteProcedure('EXApproveRejectDLCaseMeetings @DLId=' + id + ',@Approved=0');\r\n    SetEntityItemValue(entity, id, modified, 'DL_CaseApproved', 0);\r\n    //alert('done');\r\n    EXReload();\r\n}\r\nfunction EXSearchEntityDocuments(DLEntityNameForeign, DLFolderParams) { // 10.4.2008\r\n    var oD810 = getEntityData('DL_D810FolderView', 'DL_EntityNameForeign = \\'' + DLEntityNameForeign + '\\'', '');\r\n    var xNodes = oD810.selectNodes('//DL_D810FolderView');\r\n    var path = '';\r\n    var sURL;\r\n    for (var i = 0; i < xNodes.length; i++) {\r\n        sURL = getsafe(xNodes[i], 'DL_URLFolder');\r\n        sURL = EXReplaceFolderParams(sURL, DLFolderParams);\r\n        if (path != '')\r\n            path = path + ',';\r\n        path = path + sURL;\r\n    }\r\n    // oEXDWPURL\r\n    loadcontent2(getAbsoluteURL('/EX_Resources/EXSiteDocumentSearch.html?Path=' + escape(path)), LEXSearchCaseDocuments); // 18.8.2008 26.8.2008\r\n}\r\n\r\n// 20111101 BH Added function IT_Case 2558\r\nfunction SPVersion() {\r\n    try {\r\n        return EXSPSVersion;\r\n    }\r\n    catch (e) {\r\n        return 12;\r\n    }\r\n}\r\n\r\nfunction Query(freetext, SearchPath) {\r\n    try {\r\n        if (typeof (SearchPath) == 'undefined')\r\n            SearchPath = '';\r\n        //var queryXml = '<?xml version=\"1.0\" encoding=\"utf-8\" ?><QueryPacket xmlns=\"urn:Microsoft.Search.Query\" Revision=\"1000\"><Query domain=\"QDomain\"><SupportedFormats><Format>urn:Microsoft.Search.Response.Document.Document</Format></SupportedFormats><Context><QueryText language=\"en-US\" type=\"MSSQLFT\">' + freetext + '</QueryText></Context><Range><StartAt>1</StartAt><Count>5</Count></Range></Query></QueryPacket>';\r\n        //var queryXml = \"<QueryPacket xmlns='urn:Microsoft.Search.Query'><Query><SupportedFormats><Format revision='1'>urn:Microsoft.Search.Response.Document:Document</Format></SupportedFormats><Context><QueryText language='da-DK' type='STRING'>\" + freetext + \"</QueryText></Context><Range><StartAt>1</StartAt><Count>20</Count></Range></Query></QueryPacket>\";\r\n        var sCount = '40';\r\n        var sProperties = '<Properties><Property name=\"Title\"/><Property name=\"Path\"/><Property name=\"description\"/><Property name=\"Write\"/><Property name=\"Rank\"/><Property name=\"Size\"/><Property name=\"FileType\"/><Property name=\"Created\"/><Property name=\"Author\"/></Properties>';\r\n        //sProperties = '';\r\n        //var queryXml = '<QueryPacket xmlns=\"urn:Microsoft.Search.Query\"><Query><SupportedFormats><Format>urn:Microsoft.Search.Response.Document:Document</Format></SupportedFormats><Context><QueryText type=\"STRING\" language=\"en-us\">' + freetext + '</QueryText></Context><Range><StartAt>1</StartAt><Count>' + sCount + '</Count></Range>' + sProperties + '<EnableStemming>true</EnableStemming><TrimDuplicates>true</TrimDuplicates><IgnoreAllNoiseQuery>false</IgnoreAllNoiseQuery><ImplicitAndBehavior>true</ImplicitAndBehavior><IncludeRelevanceResults>true</IncludeRelevanceResults><IncludeSpecialTermResults>true</IncludeSpecialTermResults><IncludeHighConfidenceResults>true</IncludeHighConfidenceResults></Query></QueryPacket>';\r\n        // 10.4.2008 - modified to SQL search\r\n        var queryXml;\r\n        if (SearchPath == '')\r\n        // 090215, JRD changed freetext to contains \r\n        //\tqueryXml = '<QueryPacket xmlns=\"urn:Microsoft.Search.Query\"><Query><SupportedFormats><Format>urn:Microsoft.Search.Response.Document:Document</Format></SupportedFormats><Context><QueryText type=\"MSSQLFT\" language=\"en-us\">select Size,FileType,Rank,Path,Author,Title,description,hithighlightedsummary from scope() where freetext(\\'' + freetext + '\\')</QueryText></Context><Range><StartAt>1</StartAt><Count>' + sCount + '</Count></Range>' + sProperties + '<EnableStemming>true</EnableStemming><TrimDuplicates>true</TrimDuplicates><IgnoreAllNoiseQuery>true</IgnoreAllNoiseQuery><ImplicitAndBehavior>true</ImplicitAndBehavior><IncludeRelevanceResults>true</IncludeRelevanceResults><IncludeSpecialTermResults>true</IncludeSpecialTermResults><IncludeHighConfidenceResults>true</IncludeHighConfidenceResults></Query></QueryPacket>';\r\n            queryXml = '<QueryPacket xmlns=\"urn:Microsoft.Search.Query\"><Query><SupportedFormats><Format>urn:Microsoft.Search.Response.Document:Document</Format></SupportedFormats><Context><QueryText type=\"MSSQLFT\" language=\"en-us\">select Size,FileType,Rank,Path,Author,Title,description,hithighlightedsummary from scope() where Contains(\\'\"' + freetext + '*\"\\') and \"scope\" = \\'All Sites\\'</QueryText></Context><Range><StartAt>1</StartAt><Count>' + sCount + '</Count></Range>' + sProperties + '<EnableStemming>true</EnableStemming><TrimDuplicates>true</TrimDuplicates><IgnoreAllNoiseQuery>false</IgnoreAllNoiseQuery><ImplicitAndBehavior>true</ImplicitAndBehavior><IncludeRelevanceResults>true</IncludeRelevanceResults><IncludeSpecialTermResults>true</IncludeSpecialTermResults><IncludeHighConfidenceResults>true</IncludeHighConfidenceResults></Query></QueryPacket>';\r\n        else {\r\n            var aPath = SearchPath.split(',');\r\n            // 090215, JRD changed freetext to contains \r\n            //\t\tqueryXml = '<QueryPacket xmlns=\"urn:Microsoft.Search.Query\"><Query><SupportedFormats><Format>urn:Microsoft.Search.Response.Document:Document</Format></SupportedFormats><Context><QueryText type=\"MSSQLFT\" language=\"en-us\">select Size,FileType,Rank,Path,Author,Title,description,hithighlightedsummary,Write from scope() where freetext(\\'' + freetext + '\\') and (';\r\n            queryXml = '<QueryPacket xmlns=\"urn:Microsoft.Search.Query\"><Query><SupportedFormats><Format>urn:Microsoft.Search.Response.Document:Document</Format></SupportedFormats><Context><QueryText type=\"MSSQLFT\" language=\"en-us\">select Size,FileType,Rank,Path,Author,Title,description,hithighlightedsummary,Write from scope() where Contains(\\'\"' + freetext + '*\"\\') and \"scope\" = \\'All Sites\\' and (';\r\n            for (var i = 0; i < aPath.length; i++) {\r\n                if (i > 0)\r\n                    queryXml += ' OR ';\r\n                // 20111101 BH Added function IT_Case 2558\r\n                if (SPVersion() == 12) {\r\n                    queryXml += ' Path like \\'' + aPath[i] + '%\\' ';\r\n                }\r\n                else {\r\n                    queryXml += ' Contains(Path, \\'' + aPath[i] + '\\') ';\r\n                }\r\n            }\r\n            queryXml += ')</QueryText></Context><Range><StartAt>1</StartAt><Count>' + sCount + '</Count></Range>' + sProperties + '<EnableStemming>true</EnableStemming><TrimDuplicates>true</TrimDuplicates><IgnoreAllNoiseQuery>false</IgnoreAllNoiseQuery><ImplicitAndBehavior>true</ImplicitAndBehavior><IncludeRelevanceResults>true</IncludeRelevanceResults><IncludeSpecialTermResults>true</IncludeSpecialTermResults><IncludeHighConfidenceResults>true</IncludeHighConfidenceResults></Query></QueryPacket>';\r\n        }\r\n\r\n        var d1, d2;\r\n        d1 = new Date();\r\n        var xNode = QueryEx(queryXml);\r\n        d2 = new Date(); // 10.4.2008 - now figure out how long time it took\r\n        var difference = d2.getTime() - d1.getTime();\r\n\r\n        var sDocs = getsafe(xNode, '//QueryResult');\r\n        //    var fso = new ActiveXObject(\"Scripting.FileSystemObject\");\r\n        //    var s = fso.CreateTextFile(\"C:\\\\test.txt\", true);\r\n        //    s.WriteLine(sDocs);\r\n        //    s.Close();\r\n        var xmlDoc = EXDOMDocument();\r\n        xmlDoc.loadXML(sDocs);\r\n        var xNodes = xmlDoc.selectNodes('//Results/Document');\r\n        var szTotal = getsafe(xmlDoc, '//TotalAvailable');\r\n        var s = '#matches: ' + szTotal + '. Your search took ' + difference / 1000 + ' seconds.<br><table style=\"border-color:#A7B4CE;border-width:1px;border-style:solid;\" width=\"100%\" bgcolor=\"white\">';\r\n        //var s = '#matches: ' + szTotal + '. Din s\\370gning tog ' + difference/1000 + ' sekunder.<br><table style=\"border-color:#A7B4CE;border-width:1px;border-style:solid;\" width=\"100%\" bgcolor=\"white\">';\r\n        //s += '<tr><th class=\"ms-vh\">#</th><th class=\"ms-vh\"></th><th class=\"ms-vh\">Author</th><th class=\"ms-vh\">Titel</th></tr>';\r\n        var szExt, szSize, sIconImg;\r\n        for (var i = 0; i < xNodes.length; i++) {\r\n            if (i % 2 == 0)\r\n                s = s + '<tr class=\"dltablerow\">';\r\n            else\r\n                s = s + '<tr class=\"dltablealtenaterow\">';\r\n            //szExt = getsafe(xNodes(i), 'Action/LinkUrl/@fileExt');\r\n            //szSize = getsafe(xNodes(i), 'Action/LinkUrl/@size');\r\n            szExt = getPropValue(xNodes(i), 'FileType');\r\n            szSize = getPropValue(xNodes(i), 'Size');\r\n            if (szExt == '')\r\n                if (szSize == '0')\r\n                    sIconImg = '/EX_Resources/img/16x16/folder.gif';\r\n                else\r\n                    sIconImg = '';\r\n            else\r\n                sIconImg = '/_layouts/images/' + MapToAll('', szExt, '@Value');\r\n            if (i == 8433) {\r\n                alert('Title=' + getPropValue(xNodes(i), 'Title') + ' Node=' + xNodes(i).xml);\r\n                //alert(szExt + ' ' + szSize + ' ' + sIconImg);\r\n            }\r\n            var sAction = getsafe(xNodes(i), 'Action/LinkUrl');\r\n            s = s + '<td class=\"ms-vb\" title=\"View ...\"><a href=\"' + sAction + '\" onclick=\"javascript:loadcontent2(\\'' + sAction + '\\',\\'' + sTitle + '\\')\"><img border=\"0\" src=\"' + sIconImg + '\"></img></a></td>';\r\n            var sAuthor = getPropValue(xNodes(i), 'Author');\r\n            var sSize = getPropValue(xNodes(i), 'Size');\r\n            var sModified = getPropValue(xNodes(i), 'Write');\r\n            s = s + '<td class=\"ms-vb\" title=\"Goto ...\"><a href=\"';\r\n            var ii = sAction.lastIndexOf('/');\r\n            var HitHighlightedSummary = getPropValue(xNodes(i), 'HitHighlightedSummary');\r\n            var sAction1;\r\n            if ((szSize == '0' && szExt == '') || sAction.indexOf('.aspx') > 0 || ii == sAction.length)\r\n                sAction1 = sAction;\r\n            else\r\n                sAction1 = sAction.substr(0, ii);\r\n            s = s + sAction1;\r\n            var sTitle;\r\n            sTitle = getPropValue(xNodes(i), 'Title');\r\n            s = s + '\" onclick=\"javascript:EXTryGotoURL(\\'' + sAction1 + '\\');return false;\">' + sTitle;\r\n            s = s + '</a></td></tr>';\r\n            var sDesc = getPropValue(xNodes(i), 'description');\r\n            sDesc = HitHighlightedSummary; // 10.4.2008\r\n            var ii; // 15.9.2008 - fix strange error\r\n            ii = sDesc.indexOf(';#');\r\n            if (ii > 0) sDesc = sDesc.substr(ii + 2);\r\n\r\n            if (sDesc == sAuthor)\r\n                sDesc = '';\r\n            s += '<tr><td colspan=\"2\" class=\"ms-vb\">';\r\n            if (sDesc != '') {\r\n                sDesc = sDesc.replace('<c0>', '<b>');\r\n                sDesc = sDesc.replace('</c0>', '</b>');\r\n                //s = s + '<tr><td colspan=\"3\" class=\"ms-vb\">' + sDesc + '</td></tr>';\r\n                s += sDesc + '<br>';\r\n            }\r\n            s += '<a href=\"' + sAction + '\" target=\"_blank\" title=\"Open document ...\">' + sAction + '</a> - ' + Math.round(sSize / 1024) + 'KB - ' + sAuthor + ' - ' + sModified.substring(0, 10) + '</td></tr>';\r\n            //s += '<a href=\"' + sAction + '\" target=\"_blank\" title=\"\\305bn dokumentet ...\">' + sAction + '</a> - ' + Math.round(sSize/1024) + 'KB - ' + sAuthor + ' - ' + sModified.substring(0,10) + '</td></tr>';\r\n        }\r\n        s = s + '</table>';\r\n        //alert('Query(' + freetext + ') = ' + s);\r\n        return s;\r\n    } catch (e) { alert('Query(' + freetext + ') >>> ' + e.message); }\r\n    return '';\r\n}\r\nfunction getPropValue(xNode, name) {\r\n     //var xN = xNode.selectSingleNode('Properties/Property[Name=\\'' + name.toUpperCase() + '\\']/Value'); // 10.4.2008 - toUpper needed for MSSQLFT\r\n\tvar xN = xNode.selectSingleNode('Properties/Property[Name=\\'' + name + '\\']/Value'); // 12-01-2016 [sak] - original case needed for VF SP2013\r\n    if (xN == null)\r\n        return '';\r\n    //alert('getPropValue ' + xN.xml + ' ' + xN.text);\r\n    return xN.text;\r\n}\r\nfunction QueryEx(queryXml) {\r\n    try {\r\n        var xmldoc, FeedbackHTTP;\r\n        xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n        xmldoc = xmldoc + '<Query xmlns=\"urn:Microsoft.Search\">';\r\n        xmldoc = xmldoc + '<queryXml>' + MakeXMLSafe(queryXml) + '</queryXml>';\r\n        xmldoc = xmldoc + '</Query>';\r\n        xmldoc = xmldoc + '</soap:Body></soap:Envelope>';\r\n        FeedbackHTTP = EXXMLHTTP()\r\n        FeedbackHTTP.open(\"Post\", getAbsoluteURL('/_vti_bin/search.asmx'), false);\r\n        //\t\tFeedbackHTTP.Open(\"Post\", getAbsoluteURL('/ITSupport/_vti_bin/search.asmx'), false); \r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"Content-Length\", xmldoc.length);\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", 'urn:Microsoft.Search/Query');\r\n        FeedbackHTTP.send(xmldoc);\r\n        if (FeedbackHTTP.status == 400)\r\n            alert('bad request ' + xmldoc);\r\n        else if (FeedbackHTTP.status != 200)\r\n            alert(xmldoc + ' ' + xmldoc.length + ' ' + FeedbackHTTP.status + ' ' + FeedbackHTTP.responseText);\r\n        var oXML = FeedbackHTTP.responseXML;\r\n        FeedbackHTTP = null;\r\n        return oXML;\r\n    } catch (e) { alert('QueryEx(' + queryXml + ') Exception >>> ' + e.message); }\r\n}\r\nfunction EXTryGotoURL(s) {\r\n    s = s.replace('%20', ' ');\r\n    s = s.replace('%20', ' ');\r\n    s = s.replace('%20', ' ');\r\n    if (s.lastIndexOf('/') != s.length - 1) {\r\n        //alert(s.lastIndexOf('/') + ' ' + s.length);\r\n        s = s + '/';\r\n    }\r\n    var oD810 = getEntityData('DL_D810FolderView', '', '');\r\n    var xNodes = oD810.selectNodes('//DL_D810FolderView');\r\n    var sEX;\r\n    for (var i = 0; i < xNodes.length; i++) {\r\n        var sURL = getsafe(xNodes[i], 'DL_URLFolder');\r\n        //sEX = sURL.replace('%1%','(?<DocLib>\\\\d+)');\t\r\n        sEX = sURL.replace('%0%', '(\\\\w+)');  // 17.9.2008\r\n        sEX = sEX.replace('%1%', '(\\\\w+)');\r\n        //sEX = sEX.replace('%2%','(?<CaseNo>(\\\\w|-)+)');\r\n        sEX = sEX.replace('%2%', '((\\\\w|-| )+)');\r\n        //alert(i + ' ' + sURL + ' - ' + sEX);\r\n        var rex = new RegExp(sEX, 'i');\r\n        var sResult = rex.exec(s);\r\n        if (sResult != null) {\r\n            var DLEntityNameForeign = getsafe(xNodes[i], 'DL_EntityNameForeign');\r\n            var DLPropNameForeign = getsafe(xNodes[i], 'DL_PropNameForeign');\r\n            if (DLPropNameForeign == '')\r\n                alert('Match found - DL_PropNameForeign must be set to key in DL_D810 table ' + xNodes[i].xml);\r\n            else {\r\n                var DLId, key;\r\n                if (sURL.indexOf('%0%') > 0 & sURL.indexOf('%1%') > 0 & sURL.indexOf('%2%') > 0)\r\n                    key = sResult[3];\r\n                else if (sURL.indexOf('%1%') > 0 & sURL.indexOf('%2%') > 0)\r\n                    key = sResult[2];\r\n                else\r\n                    key = sResult[1];\r\n                //alert('DEBUG\\nsResult = ' + sResult + ' ' + sResult[1] + ' > ' + key + ' ' + DLEntityNameForeign + ' ' + DLPropNameForeign);\r\n                if (DLPropNameForeign == 'DL_Id')\r\n                    DLId = key;\r\n                else {\r\n                    var sWhere = DLPropNameForeign + ' = \\'' + key + '\\'';\r\n                    var oObject = getEntityData(DLEntityNameForeign, sWhere, '');\r\n                    DLId = getsafe(oObject, '//DL_Id');\r\n                }\r\n                //alert('*** MATCH FOUND *** ' + sEX + ' match ' + s + ' >' + DLEntityNameForeign + ':' + DLId + '<');\t\r\n                if (IsNumeric(DLId)) {\r\n                    EXGotoObject(DLEntityNameForeign, DLId);\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    alert('EXTryGotoURL - Could not find URL ' + s);\r\n    //alert('EXTryGotoURL - Kunne ikke finde en sag der matcher URL\\'en ' + s);\r\n}\r\n// 16.1.2008 - Dynamic menu\r\nvar bEXSubMenuRunning = false;\r\nvar EXSubMenuTimer;\r\nfunction EXActionSubMenu(DLEntityNameForeign, DLEntity, DLId) {\r\n    try {\r\n        if (window.event == null)\r\n            return;\r\n        var oEle = window.event.srcElement; // requires onclick=..., href= doesn't work\r\n        if (oEle == null)\r\n            return;\r\n        var xActions = getEntityData('DL_Action', 'DL_EntityNameForeign = \\'' + DLEntityNameForeign + '\\'', 'DL_SequenceNo');\r\n        var xNodes = xActions.selectNodes('//DL_ENTITYDATA/DL_Action');\r\n        var sTable, iRows;\r\n        iRows = xNodes.length;\r\n        sTable = '<table onclick=\"EXSubMenuHide()\" bg1color=\"#ccccff\" width=\"180px\" height=\"' + (iRows * 20) + 'px\" border=\"0\" bgcolor=\"#F0F0F0\" background-color=\"#F0F0F0\">';\r\n        var sTitle, sAction, sImage;\r\n        for (var i = 0; i < iRows; i++) {\r\n            sTitle = getsafe(xNodes[i], 'DL_Tooltip');\r\n            sAction = getsafe(xNodes[i], 'DL_Action');\r\n            sAction = sAction.replace('#DL_Entity#', DLEntity);\r\n            sAction = sAction.replace('#DL_Id#', DLId);\r\n            sAction = sAction.replace('#DL_Id#', DLId);\r\n            sImage = getsafe(xNodes[i], 'DL_TableIcon');\r\n            if (sImage.indexOf('http') == 0) // 19.8.2009\r\n                sTable = sTable + '<tr><td class=\"ms-vb\"><img border=\"0\" src=\"' + trim(sImage) + '\"></img></td><td class=\"ms-vb\"><a href=\"' + sAction + '\">' + sTitle + '</a></td></tr>'; // 16.2.2009 - img --\x3e gif\r\n            else\r\n                sTable = sTable + '<tr><td class=\"ms-vb\"><img border=\"0\" src=\"/EX_Resources/gif/' + trim(sImage) + '\"></img></td><td class=\"ms-vb\"><a href=\"' + sAction + '\">' + sTitle + '</a></td></tr>'; // 16.2.2009 - img --\x3e gif\r\n        }\r\n        sTable = sTable + '</table>';\r\n        var oDiv = document.getElementById('EXSubMenuDIV');\r\n        if (oDiv == null) {\r\n            oDiv = document.createElement('DIV');\r\n            oDiv.id = 'EXSubMenuDIV';\r\n            oDiv.style.zIndex = 6;\r\n            oDiv.style.width = \"180px\";\r\n\t\t\toDiv.style.backgroundColor = \"white\"; //\"#F0F0F0\";\r\n            document.body.appendChild(oDiv);\r\n            //\t\t\toEle.parentElement.appendChild(oDiv);\r\n            oDiv = document.getElementById('EXSubMenuDIV');\r\n        }\r\n        oDiv.style.height = (iRows * 20 +  20) + \"px\";\r\n        oDiv.style.position = \"absolute\";\r\n        oDiv.style.left = getElementLeft1(oEle) + \"px\";\r\n        oDiv.style.top = getElementTop1(oEle) + \"px\";\r\n        //oDiv.onmouseout = EXSubMenuHide;\r\n        //alert(sTable);\r\n        oDiv.innerHTML = sTable;\r\n        oDiv.style.visibility = \"visible\";\r\n        if (bEXSubMenuRunning)\r\n            clearTimeout(EXSubMenuTimer);\r\n        //alert('EXActionSubMenu(' + DLEntityNameForeign + ',' + DLEntity + ',' + DLId + ') invoked');\r\n        EXSubMenuTimer = setTimeout('EXSubMenuHide()', 8000); // 8 seconds before we hide DIV\r\n        bEXSubMenuRunning = true;\r\n        window.event.preventDefault?window.event.preventDefault:window.event.returnValue = false;\n\t\t//window.event.preventDefault();\r\n\t\treturn true;\r\n    } catch (e) { alert('EXActionSubMenu ' + e.message); }\r\n}\r\nfunction EXSubMenuHide() {\r\n    //alert('EXSubMenuHide bEXSubMenuRunning=' + bEXSubMenuRunning);\r\n    clearTimeout(EXSubMenuTimer);\r\n    bEXSubMenuRunning = false;\r\n    var oDiv = document.getElementById('EXSubMenuDIV');\r\n    if (oDiv == null)\r\n        return;\r\n    oDiv.style.visibility = \"hidden\";\r\n}\r\nfunction EXPositionSubMenu() { // 19.8.2009\r\n    var EXSubMenu = document.getElementById('EXSubMenuDIV');\r\n    var rightedge = document.body.clientWidth - event.clientX;\r\n    var bottomedge = document.body.clientHeight - event.clientY;\r\n    if (rightedge < EXSubMenu.offsetWidth)\r\n        EXSubMenu.style.left = document.body.scrollLeft + event.clientX - EXSubMenu.offsetWidth;\r\n    else\r\n        EXSubMenu.style.left = document.body.scrollLeft + event.clientX;\r\n    if (bottomedge < EXSubMenu.offsetHeight)\r\n        EXSubMenu.style.top = document.body.scrollTop + event.clientY - EXSUbMenu.offsetHeight;\r\n    else\r\n        EXSubMenu.style.top = document.body.scrollTop + event.clientY;\r\n    EXSubMenu.style.visibility = \"visible\";\r\n}\r\n\r\nfunction EXinitDLMoveCopyStatus() {\r\n    var oEle = document.getElementById('DL_MoveCopyStatus');\r\n    if (oEle.value == '')\r\n        oEle.value = '0';\r\n    // SELECT\r\n}\r\nfunction EXinitDLFolderPathForeign() {\r\n    var aFK = queryString('ForeignKeys');\r\n    var aFV = queryString('ForeignValues');\r\n    var oEle = document.getElementById('DL_FolderPathForeign');\r\n    //FillDropDown(sEle, sDictionary, sPropCodeKey, sPropCodeDecode, sDictKey, sDictValue, sDefault\r\n    var DLEntityNameForeign = aFV.split(',')[0];\r\n    FillDropDown('DL_FolderPathForeign', 'DL_D810View', 'DL_Id', 'DL_Title2', 'DL_EntityNameForeign', DLEntityNameForeign, oEle.value);\r\n}\r\nfunction EXMoveCopyDocumentsDisplay(DLId) {\r\n    loadcontent2(getAbsoluteURL(\"/EX_SQLSVC/DynamicList.html?DLEntity=DL_SyncDocuments&DLView=DL_SyncDocumentsView&Where=DL_EntityNameForeign='DL_MoveCopyDocuments' AND DL_EntityId=\" + DLId + \"&PropList=DL_Title,DL_SyncActionDecode,DL_SyncMessage&Action=none\", \"Move Copy Documents Status\"));\r\n}\r\nfunction EXMoveCopyDocBasket2Entity(DLEntityNameForeign, DLEntityId) {\r\n    newentity('DL_MoveCopyDocuments', 'DL_EntityNameForeign,DL_EntityId', DLEntityNameForeign + ',' + DLEntityId, 'Action=320', 'Move basket to current entity');\r\n}\r\nfunction EXMoveCopyDocBasket2EntityDWP(DLEntityNameForeign, iType, subfolder) { // 12.9.2009 subfolder added\r\n    if (typeof (subfolder) == 'undefined')\r\n        subfolder = '';\r\n    if (iType == 0) {\r\n        alert('EXMoveCopyDocBasket2EntityDWP - please select a folder (maybe again) in order to paste documents');\r\n        return;\r\n    }\r\n    var oXML = getEntityData('DL_D617', 'DL_EntityNameForeign  = \\'' + DLEntityNameForeign + '\\'', '');\r\n    var DLEntityIdParam = getsafe(oXML, '//DL_PropNameForeign');\r\n    if (DLEntityIdParam == '')\r\n        DLEntityIdParam = DLEntityNameForeign;\r\n    var DLEntityId = queryString(DLEntityIdParam);\r\n    if (DLEntityId == '') {\r\n        alert('EXMoveCopyDocBasket2EntityDWP(' + DLEntityNameForeign + ') no entity selected');\r\n        return;\r\n    }\r\n    // Now create DL_MoveCopyDocuments entity - then copy basket to area, then execute EXMoveCopyDocuments action\r\n    var oD810 = getEntityData('DL_D810FolderView', 'DL_Id = ' + iType, '');\r\n    var oDate = new Date();\r\n    var sTitle = 'Copied from basket to folder ' + getsafe(oD810, '//DL_Title') + ' at ' + oDate;\r\n    var xOps = '<DL_MoveCopyDocuments>';\r\n    xOps += '<DL_Title>' + sTitle + '</DL_Title><DL_MoveCopyAction>20</DL_MoveCopyAction><DL_MoveCopyStatus>0</DL_MoveCopyStatus><DL_IncludeVersions>1</DL_IncludeVersions><DL_FolderPathForeign>' + iType + '</DL_FolderPathForeign>';\r\n    xOps += '<DL_EntityNameForeign>' + DLEntityNameForeign + '</DL_EntityNameForeign><DL_EntityId>' + DLEntityId + '</DL_EntityId>';\r\n    xOps += '<DL_SubFolder>' + subfolder + '</DL_SubFolder>'; // 12.9.2009\r\n    xOps += '</DL_MoveCopyDocuments>';\r\n    var DLId = setEntityDetail('DL_MoveCopyDocuments', xOps);\r\n    //alert('DL_MoveCopyDocuments created \\n' + DLId + '\\n' + xOps);\r\n    var sUser = 'EXF\\\\' + GetEntityItemWhere('DL_sAMAccountName', 'DL_sAMAccountName = %DL_sAMAccountName%', 'DL_sAMAccountName');\r\n    ExecuteProcedure('dbo.EXMoveDocBasket2SyncDocuments @WUser=\\'' + sUser + '\\',@DLEntity=\\'DL_MoveCopyDocuments\\', @DLEntityID = ' + DLId);\r\n    //alert('Documents copied from basket for user ' + sUser);\r\n    EXMoveCopyDocumentsRetry(DLId);\r\n    //alert('Documents copied into folder');\r\n}\r\nfunction EXMoveCopyDocumentsRetry(DLId) {\r\n    if (MoveCopyDocuments(DLId))\r\n        EXMoveCopyDocumentsDisplay(DLId);\r\n    else {\r\n        alert('Could not move documents safely');\r\n    }\r\n}\r\nfunction EXMoveCopyDocBasket2EntityDoIt(WUser, DLId) {\r\n    //alert('EXMoveCopyDocBasket2EntityDoIt(' + WUser + ',' + DLId + ') started');\r\n    ExecuteProcedure('dbo.EXMoveDocBasket2SyncDocuments @WUser=\\'' + WUser + '\\',@DLEntity=\\'DL_MoveCopyDocuments\\', @DLEntityID = ' + DLId);\r\n    EXReload();\r\n}\r\nfunction MoveCopyDocuments(DLId) {\r\n    try {\r\n        var xmldoc;\r\n        xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n        xmldoc = xmldoc + '<MoveCopyDocuments xmlns=\"http://exformatics.net/SharePointServices\">';\r\n        xmldoc = xmldoc + '<DL_Id>' + DLId + '</DL_Id>';\r\n        xmldoc = xmldoc + '</MoveCopyDocuments>';\r\n        xmldoc = xmldoc + '</soap:Body></soap:Envelope>';\r\n\r\n        FeedbackHTTP = EXXMLHTTP()\r\n        FeedbackHTTP.open(\"POST\", '/EX_SPSSVC/svcSharePoint.asmx?op=MoveCopyDocuments', false);\r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", 'http://exformatics.net/SharePointServices/MoveCopyDocuments');\r\n        FeedbackHTTP.send(xmldoc);\r\n        return (getsafe(FeedbackHTTP.responseXML, '//MoveCopyDocumentsResult') == 'true');\r\n    } catch (e) { alert('MoveCopyDocuments(' + DLId + ') failed ' + e.message); }\r\n}\r\n\r\nfunction EXActivitiesRollout(DLEntityNameForeign, DLEntityId) {\r\n    var oEle = document.getElementById('DL_D310');\r\n    if (oEle == null)\r\n        return;\r\n    if (oEle.value == '' || oEle.value == 'undefined')\r\n        return;\r\n    var DLD310 = oEle.value;\r\n    if (!confirm('Rollout activities from ' + DLD310 + ' template?'))\r\n        return;\r\n    ExecuteProcedure('EXActivitiesRollout @DLEntityNameForeign = \\'' + DLEntityNameForeign + '\\', @DLEntityId = ' + DLEntityId + ', @DLD310=\\'' + DLD310 + '\\'');\r\n    EXReload();\r\n}\r\nfunction EXNewYearlyPlanning() {\r\n    alert('EXNewYearlyPlanning ' + EXDSgetIDs());\r\n    ExecuteProcedure('dbo.EXNewYearlyPlanning @Ids=\\'' + EXDSgetIDs() + '\\'');\r\n    //EXReload();\r\n    alert('Done');\r\n}\r\n\r\n//alert('exformatics.js loaded');\r\n\r\n\r\n//DHTML Window script- Copyright Dynamic Drive (http://www.dynamicdrive.com)\r\n//For full source code, documentation, and terms of usage,\r\n//Visit http://www.dynamicdrive.com/dynamicindex9/dhtmlwindow.htm\r\n\r\nvar dragapproved = false\r\nvar minrestore = 0\r\nvar initialwidth, initialheight\r\nvar ie5 = document.all && document.getElementById\r\nvar ns6 = document.getElementById && !document.all\r\n\r\nfunction iecompattest() {\r\n    return (!window.opera && document.compatMode && document.compatMode != \"BackCompat\") ? document.documentElement : document.body\r\n}\r\n\r\nfunction drag_drop(e) {\r\n    if (ie5 && dragapproved && event.button == 1) {\r\n        document.getElementById(\"dwindow\").style.left = tempx + event.clientX - offsetx + \"px\"\r\n        document.getElementById(\"dwindow\").style.top = tempy + event.clientY - offsety + \"px\"\r\n    }\r\n    else if (ns6 && dragapproved) {\r\n        document.getElementById(\"dwindow\").style.left = tempx + e.clientX - offsetx + \"px\"\r\n        document.getElementById(\"dwindow\").style.top = tempy + e.clientY - offsety + \"px\"\r\n    }\r\n}\r\n\r\nfunction initializedrag(e) {\r\n    offsetx = ie5 ? event.clientX : e.clientX\r\n    offsety = ie5 ? event.clientY : e.clientY\r\n    document.getElementById(\"dwindowcontent\").style.display = \"none\" //extra\r\n    tempx = parseInt(document.getElementById(\"dwindow\").style.left)\r\n    tempy = parseInt(document.getElementById(\"dwindow\").style.top)\r\n\r\n    dragapproved = true\r\n    document.getElementById(\"dwindow\").onmousemove = drag_drop\r\n}\r\n\r\nfunction loadwindow(url, width, height) {\r\n    if (!ie5 && !ns6)\r\n        window.open(url, \"\", \"width=width,height=height,scrollbars=1\")\r\n    else {\r\n        document.getElementById(\"dwindow\").style.display = ''\r\n        document.getElementById(\"dwindow\").style.width = initialwidth = width + \"px\"\r\n        document.getElementById(\"dwindow\").style.height = initialheight = height + \"px\"\r\n        document.getElementById(\"dwindow\").style.left = \"30px\"\r\n        document.getElementById(\"dwindow\").style.top = ns6 ? window.pageYOffset * 1 + 30 + \"px\" : iecompattest().scrollTop * 1 + 30 + \"px\"\r\n        document.getElementById(\"cframe\").src = url\r\n    }\r\n}\r\n\r\nfunction maximize() {\r\n    if (minrestore == 0) {\r\n        minrestore = 1 //maximize window\r\n        document.getElementById(\"maxname\").setAttribute(\"src\", \"restore.gif\")\r\n        document.getElementById(\"dwindow\").style.width = ns6 ? window.innerWidth - 20 + \"px\" : iecompattest().clientWidth + \"px\"\r\n        document.getElementById(\"dwindow\").style.height = ns6 ? window.innerHeight - 20 + \"px\" : iecompattest().clientHeight + \"px\"\r\n    }\r\n    else {\r\n        minrestore = 0 //restore window\r\n        document.getElementById(\"maxname\").setAttribute(\"src\", \"max.gif\")\r\n        document.getElementById(\"dwindow\").style.width = initialwidth\r\n        document.getElementById(\"dwindow\").style.height = initialheight\r\n    }\r\n    document.getElementById(\"dwindow\").style.left = ns6 ? window.pageXOffset + \"px\" : iecompattest().scrollLeft + \"px\"\r\n    document.getElementById(\"dwindow\").style.top = ns6 ? window.pageYOffset + \"px\" : iecompattest().scrollTop + \"px\"\r\n}\r\n\r\nfunction closeit() {\r\n    document.getElementById(\"dwindow\").style.display = \"none\"\r\n}\r\n\r\nfunction stopdrag() {\r\n    dragapproved = false;\r\n    document.getElementById(\"dwindow\").onmousemove = null;\r\n    document.getElementById(\"dwindowcontent\").style.display = \"\" //extra\r\n}\r\n\r\nfunction EXRolloutEmployeeCase(DLEntityNameForeign, DLEntityId) {\r\n    var oXML = getEntityData(DLEntityNameForeign, 'DL_Id=' + DLEntityId, '');\r\n    var DLWFCaseType = getsafe(oXML, '//DL_WFCaseType');\r\n    var DLDueDate = getsafe(oXML, '//DL_EndDate');\r\n    var DLWFCasePhase = getsafe(oXML, '//DL_CaseLongState');\r\n    if (DLDueDate != '') {\r\n        DLDueDate = ',@DLDueDate=\\'' + DLDueDate.substring(0, 10) + '\\'';  // 14.7.2008 - comma removed, syntax error\r\n    }\r\n    if (DLWFCasePhase != '')\r\n        DLWFCasePhase = ',@DLWFCasePhase = ' + DLWFCasePhase;\r\n    //alert('EXRolloutEmployeeCase(' + DLEntityNameForeign + ',' + DLEntityId + ') @DLWFCaseType=' + DLWFCaseType + DLDueDate + DLWFCasePhase + ' ');\r\n    ExecuteProcedure('dbo.DoDLWFCaseTasksRollout @DLEntityNameForeign=\\'' + DLEntityNameForeign + '\\',@DLId=' + DLEntityId + DLDueDate + DLWFCasePhase + ',@DLWFCaseType=' + DLWFCaseType);\r\n    alert('Tasks rolled out');\r\n    EXReload();\r\n}\r\n\r\nfunction EXOpenPickFacet(DLEntityNameForeign, DLEntityId, bDynWPReload, sDefaultDimension) { // 17.7.2008\r\n    try {\r\n        if (EXGetUserRole() == 0) { // 3.11.2009\r\n            alert(LEX_UserNoAccessCannotAddFacet);\r\n            return;\r\n        }\r\n        if (typeof (sDefaultDimension) == 'undefined') //\r\n            sDefaultDimension = '';\r\n        if (typeof (bDynWPReload) == 'undefined')\r\n            bDynWPReload = false;\r\n        /*\r\n        if (window.location.href.indexOf(getAbsoluteURL('/Activities/Pages/activity.aspx?DL_Activities=')) == 0) {\r\n        loadcontent('/EX_Resources/EXFacetPlanNew.html?DL_EntityNameForeign=' + DLEntityNameForeign + '&DL_EntityId=' + DLEntityId,null,'V\\346lg facetter');\r\n        return;\r\n        }\r\n        */\r\n        // 23.4.2013 - use jQUery dialog instead\r\n        var oDiv = document.getElementById('EXDialog');\r\n        if (oDiv == null) {\r\n            var oDiv = document.createElement('DIV');\r\n            oDiv.id = 'EXDialog';\r\n            oDiv.innerHTML = '<IFRAME id=\"IFRAMEFACET\" frameboder=\"0\" width=\"100%\" height=\"660px\"></IFRAME>';\r\n            document.body.appendChild(oDiv);\r\n        }\r\n        loadcontent('/EX_Resources/EXFacetplan.html?DL_EntityNameForeign=' + DLEntityNameForeign + '&DL_EntityId=' + DLEntityId + '&DynWPReload=' + bDynWPReload + '&Dimension=' + sDefaultDimension, 'IFRAMEFACET', '');\r\n        $(\"#EXDialog\").dialog({\r\n            resizable: true,\r\n            autoOpen: true,\r\n            modal: true,\r\n            width: 848,\r\n            height: 808,\r\n            title: LEX_SelectFacetter,\r\n            buttons: {\r\n                'Close': function () {\r\n                    $(this).dialog('close');\r\n                }\r\n            }//end buttons\r\n        }); //end dialog\r\n\r\n        return;\r\n        //var oEleDenorm = document.getElementById('DL_FacetDenorm');\r\n        //oEleDenorm.value = '';\r\n        var oFacetIFrame = document.getElementById('IFRAMEFACET');\r\n        if (oFacetIFrame == null) {\r\n            var oIFrame = document.createElement('IFRAME');\r\n            oIFrame.id = 'IFRAMEFACET';\r\n            oIFrame.style.width = '200px';\r\n            oIFrame.style.height = '200px';\r\n            oIFrame.style.zIndex = '3';\r\n            oIFrame.style.position = 'absolute';\r\n            oIFrame.frameborder = 0;\r\n            document.body.appendChild(oIFrame);\r\n            oIFrame = null;\r\n            oFacetIFrame = document.getElementById('IFRAMEFACET');\r\n        }\r\n        oFacetIFrame.style.display = '';\r\n        var oEle = document.getElementById('LABELDL_Facet');\r\n        if (oEle == null) {\r\n            oEle = document.getElementById('EXPickFacetImage');\r\n            if (oEle == null) { // 28.8.2011\r\n                oEle = document.getElementById('EXMailImage');\r\n            }\r\n            if (oEle != null) {\r\n                oEle = oEle.parentNode; // A\r\n                oEle = oEle.parentNode; // TD\r\n                oEle = oEle.parentNode; // TR\r\n            }\r\n        }\r\n        var iLeft = getElementLeft1(oEle) - 100;\r\n        if (iLeft < 5) // 29.7.2008 - avoid out of bound issues\r\n            iLeft = 5;\r\n        oFacetIFrame.style.left = iLeft;\r\n        oFacetIFrame.style.top = getElementTop1(oEle) - 20;\r\n        var oEle = document.getElementById('DL_Facet');\r\n        oFacetIFrame.src = getAbsoluteURL('/EX_Resources/EXFacetplan.html?DL_EntityNameForeign=' + DLEntityNameForeign + '&DL_EntityId=' + DLEntityId + '&DynWPReload=' + bDynWPReload + '&Dimension=' + sDefaultDimension);\r\n        EXPickFacetResize(800, 800);\r\n        //alert('EXPickFacet done - visible? ' + oFacetIFrame.src + ' ' + oFacetIFrame.innerHTML);\r\n        //oEleDenorm.value = '...';\r\n    } catch (e) { alert(e.message); }\r\n}\r\nfunction EXPickFacetResize(width, height) {\r\n    //alert(width + ' ' + height);\r\n    var oFacetIFrame = document.getElementById('IFRAMEFACET');\r\n    if (oFacetIFrame != null) { // 29.7.2008 - only resize of IFRAME is found\r\n        oFacetIFrame.style.width = width;\r\n        oFacetIFrame.style.height = height;\r\n    }\r\n}\r\nfunction EXPickFacetCancel() {\r\n    // 23.4.2013 - close jQuery dialog\r\n    $(\"#EXDialog\").dialog('close');\r\n    return;\r\n    var oFacetIFrame = document.getElementById('IFRAMEFACET');\r\n    oFacetIFrame.style.display = 'none';\r\n    oFacetIFrame.style.width = \"10px\";\r\n    oFacetIFrame.style.height = \"10px\";\r\n}\r\nfunction EXFillWFCaseType(DLEntityNameForeign) { // 18.8.2008 - 15.9.2009 - it cASE 748 Kritisk fejl rettet\r\n    //alert('EXFillWFCaseType ' + DLEntityNameForeign);\r\n    //FillDropDown('DL_WFCaseType','DL_WFCaseType','DL_Id','DL_Title','DL_WFCaseEntity',DLEntityNameForeign);\r\n    var oWFCaseType = document.getElementById('DL_WFCaseType');\r\n    var sWFCaseType;\r\n    if (oWFCaseType.options.length > 0)\r\n        sWFCaseType = oWFCaseType.options[oWFCaseType.selectedIndex].value;\r\n    else\r\n        sWFCaseType = '';\r\n    var oEle = document.getElementById('DL_Process'); // 9.9.2008 - but how do we use this value - isnull(DL_Process, 0) in (0, oEle.value)\r\n    var sProcess;\r\n    if (oEle == null)\r\n        sProcess = '';\r\n    else\r\n        sProcess = oEle.value;\r\n    var sWhere = 'DL_WFCaseEntity = \\'' + DLEntityNameForeign + '\\'';\r\n    if (sProcess == '')\r\n        sWhere += ' AND isnull(DL_Process,0) = 0';\r\n    else\r\n        sWhere += ' AND isnull(DL_Process,0) in (0,' + sProcess + ')';\r\n    if (sWFCaseType != '')\r\n        sWhere += ' OR DL_Id = ' + sWFCaseType;\r\n    oEle = oWFCaseType;\r\n    var sValue = sWFCaseType;\r\n    var oXML = getEntityData2('DISTINCT DL_Id as DL_PropCodeKey,DL_Title as DL_PropCodeDecode', 'DL_WFCaseType', sWhere, 'DL_Title'); // 18.4.2011 - DISTINCT added - Tele Greenland\r\n    //alert('DEBUG\\n' + sWhere + '\\n' + oXML.xml);\r\n    //FillDropDown('DL_WFCaseType','DL_WFCaseType','DL_Id','DL_Title','DL_WFCaseEntity',DLEntityNameForeign);\r\n    var xNodes = oXML.selectNodes('//DL_WFCaseType');\r\n    var i = xNodes.length;\r\n    //alert(i);\r\n    var arr = new Array(i + 1);\r\n    // Add empty element initially - handling of default values?\r\n    arr[0] = \"<OPTION></OPTION>\";\r\n    //alert('DEBUG\\n' + xNodes.length);\r\n    oEle.options.length = 0; // 15.9.2009 - 15.7.2011 - moved two lines up - before the if statement\r\n    if (xNodes.length == 0)\r\n        oEle.disabled = true;\r\n    else {\r\n        oEle.disabled = false;\r\n        var oP;\r\n        oP = document.createElement('option');\r\n        oP.text = '';\r\n        oP.value = '';\r\n        oEle.add(oP);\r\n        for (i = 0; i < xNodes.length; i++) {\r\n            xNode = xNodes[i];\r\n            var DL_PropCodeKey = getsafe(xNode, \"DL_PropCodeKey\");\r\n            var DL_PropCodeDecode = getsafe(xNode, \"DL_PropCodeDecode\");\r\n            if (DL_PropCodeDecode == '')\r\n                DL_PropCodeDecode = DL_PropCodeKey;\r\n            if (false) {\r\n                s = '<OPTION value=\"' + DL_PropCodeKey + '\"';\r\n                if (sValue != null && sValue != '' && sValue == DL_PropCodeKey)\r\n                    s = s + ' SELECTED ';\r\n                s = s + '>' + DL_PropCodeDecode + '</OPTION>';\r\n                arr[i + 1] = s;\r\n            }\r\n            oP = document.createElement('option');\r\n            oP.text = DL_PropCodeDecode;\r\n            oP.value = DL_PropCodeKey;\r\n            if (sValue != null && sValue != '' && sValue == DL_PropCodeKey)\r\n                oP.selected = true;\r\n            oEle.add(oP);\r\n        };\r\n        //alert('DEBUG\\n' + oEle.outerHTML);\r\n        if (false) {\r\n            var ss, s1;\r\n            var oParent;\r\n            oParent = oEle.parentElement;\r\n            s = oEle.outerHTML;\r\n            alert('DEBUG\\n' + s);\r\n            //oEle.options.length = 0;\r\n            //alert('DEBUG\\n' + oEle.outerHTML);\r\n            i = s.toLowerCase().indexOf('<option');\r\n            if (i == -1)\r\n                i = s.toLowerCase().indexOf('</select>');\r\n            ss = s.substr(0, i);\r\n            ss = ss + arr.join('');\r\n            i = s.toLowerCase().indexOf('</select>');\r\n            ss = ss + s.substr(i, s.length);\r\n            oParent.innerHTML = ss;\r\n            alert('DEBUG\\n' + oParent.innerHTML);\r\n        }\r\n    }\r\n    if (sWFCaseType == '') {\r\n        if (queryString('DL_Action', true) == 'new') {\r\n            sWFCaseType = queryString('DLWFCaseType', true);\r\n            if (sWFCaseType != '') {\r\n                //alert('new case with case type ' + sWFCaseType);\r\n                oWFCaseType = document.getElementById('DL_WFCaseType');\r\n                for (var i = 0; i < oWFCaseType.options.length; i++)\r\n                    if (oWFCaseType.options[i].value == sWFCaseType) {\r\n                        oWFCaseType.selectedIndex = i;\r\n                        EXhandleDLWFCaseTypeChange();\r\n                        break;\r\n                    }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n// EXAdvDrop - 3.9.2008\r\nvar EXAdvDroptestString = \"\";\r\nvar oEXAdvDropold;\r\n\r\nfunction EXAdvDropaddChar(oEle, e, bAnywhere) {\r\n    if (typeof (bAnywhere) == 'undefined') // 9.9.2008 - new parameter\r\n        bAnywhere = false;\r\n    if (oEXAdvDropold != oEle) {\r\n        oEXAdvDropold = oEle;\r\n        EXAdvDroptestString = \"\";\r\n    }\r\n    var code = 0; // 23.10.2008\r\n    if (e.keyCode) {\r\n        code = e.keyCode;\r\n    }\r\n    else if (e.which) {\r\n        code = e.which;\r\n    }\r\n\r\n    if (code == 38 || code == 40) return; // 23.10.2008\r\n    if (code == 8) {\r\n        EXAdvDroptestString = EXAdvDroptestString.replace(/.$/, \"\");\r\n    }\r\n    else {\r\n        if (code == 222)\r\n            EXAdvDroptestString += '&#248;';\r\n        else\r\n            EXAdvDroptestString += String.fromCharCode(code);\r\n    }\r\n    //EXAdvDroptestString = EXAdvDroptestString.replace('\\248','&#248;');\r\n\r\n    if (bAnywhere)\r\n        re = new RegExp(EXAdvDroptestString);\r\n    else\r\n        re = new RegExp(\"^\" + EXAdvDroptestString);\r\n    var matched = false;\r\n\r\n    var s;\r\n    // 9.1.2009 - hvis intialer skal prioriteres højere end dropdown listen så skal nedenstående byttes om\r\n    for (i = 0; i < oEle.options.length; i++) {\r\n        if (oEle.options[i].text.match(re)) {\r\n            if (document.forms.length == 0) {\r\n                s = 'document.all.' + oEle.id + '.selectedIndex';\r\n            }\r\n            else\r\n                s = 'document.' + document.forms[0].name + '.' + oEle.id + '.selectedIndex';\r\n            setTimeout(s + \" = i\", 50);\r\n            matched = true;\r\n            break;\r\n        }\r\n    }\r\n    if (!matched) {\r\n        for (i = 0; i < oEle.options.length; i++) {\r\n            if (oEle.options[i].value.match(re)) {\r\n                if (document.forms.length == 0) {\r\n                    s = 'document.all.' + oEle.id + '.selectedIndex';\r\n                }\r\n                else\r\n                    s = 'document.' + document.forms[0].name + '.' + oEle.id + '.selectedIndex';\r\n                setTimeout(s + \" = i\", 50);\r\n                matched = true;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    if (!matched) {\r\n        EXAdvDroptestString = EXAdvDroptestString.replace(/.*(.)$/, \"$1\");\r\n        //EXAdvDroptestString = \"\";\r\n    }\r\n}\r\nfunction EXCaseAddressSearch(DLCaseAddressType, DLId) {\r\n    if (DLCaseAddressType == -2)\r\n        DLId = GetEntityItemValue('DL_Contacts', DLId, 'DLContactID');\r\n    var sUrl = 'http://www.dr.dk';\r\n    sUrl = getAbsoluteURL('/EX_SQLSVC/DynamicSearch.html?DLEntity=DL_CMAllView&DLView=DL_CMAllContactsView&SearchParameters=DL_Title&DisplayParameters=DL_CaseNo,DL_Title,DL_Responsible,DL_CaseState&SearchOnLoad=true&WhereExtra=DL_Contacts=' + DLId);\r\n    loadcontent(sUrl, 'DL_Information2');\r\n}\r\nfunction EXHTMLNote(oEle, DLId) {\r\n    oEle.onmouseover = function () { };\r\n    oEle.onmouseout = function () { };\r\n    var oHTMLNote = getEntityData('DL_HTMLNotes', 'DL_Id=' + DLId, '');\r\n    var s = HTML2Text(getsafe(oHTMLNote, '//DL_HTMLText'));\r\n    oEle.title = s;\r\n    //alert('EXHTMLNote ' + s);\r\n    //alert(oEle.outerHTML + ' ' + bOverOut + ' ' + oEle.innerText + ' ' + DLId);\r\n}\r\nfunction HTML2Text(HTML) {\r\n    try {\r\n        var s = HTML;\r\n        s = s.replace(/&#230;/g, '\\346'); // æ\r\n        s = s.replace(/&#198;/g, '\\306'); // Æ\r\n        s = s.replace(/&#248;/g, '\\370'); // ø\r\n        s = s.replace(/&#216;/g, '\\330'); // Ø\r\n        s = s.replace(/&#229;/g, '\\345'); // å\r\n        s = s.replace(/&#197;/g, '\\305'); // Å\r\n        s = s.replace(/&nbsp;/g, ' ');\r\n        s = s.replace(/&#198;/g, '\\306'); // Æ\r\n        s = s.replace(/&amp;#198;/g, '\\306'); // Æ\r\n        s = s.replace(/<(?:[^>'\"]*|(['\"]).*?\\1)*>/g, \"\");\r\n        // Very strange - we need to replace here - doesn't work above - strange!!!\r\n        s = s.replace(/&#198;/g, '\\306'); // Æ\r\n        s = s.replace(/&#216;/g, '\\330'); // Ø\r\n        s = s.replace(/&#197;/g, '\\305'); // Å\r\n        //s = s.replace(/&amp;/g,'&');\r\n        s = s.substr(0, 800);\r\n        return s;\r\n    } catch (e) { alert('HTML2Text(' + HTML + ') >>> ' + e.message); }\r\n}\r\n\r\nfunction EXhandleDLWFCaseTypeChange() { // 9.9.2008 - default functionality\r\n\tvar oEle = document.getElementById('DL_WFCaseType');\r\n\tvar DLId = oEle.options[oEle.selectedIndex].value;\r\n\tif (queryString('new') != 'true' && DLId == '') // 31.7.2010 - DLId logic added (requested by Tele Greenland - Charlotte)\r\n\t\treturn;\r\n\tif (DLId == '') // 31.7.2010 - added\r\n\t\treturn;\r\n\tif (document.getElementById('DL_CaseLongState') != null)  { // 27.9.2016 - IT Case 6381\r\n\t\tFillDropDown('DL_CaseLongState','DL_WFCaseTypePhase','DL_SequenceNo','DL_Title','DL_WFCaseType',DLId,'0','','','','',false,'','DL_SequenceNo'); \r\n\t}\r\n\tif (document.getElementById('DL_CaseProtected') == null) // 14.6.2012 - if no protection exists - ignore\r\n\t\treturn;\r\n\tvar oXML = getEntityData('DL_WFCaseType', 'DL_Id = ' + DLId,''); \r\n\tvar DLCaseProtected = getsafe(oXML, '//DL_CaseProtected');\r\n\tif (DLCaseProtected == '')\r\n\t\tDLCaseProtected = '0';\r\n\tvar DLSecurityPersons = getsafe(oXML, '//DL_SecurityPersons');\r\n\tvar DLADSecurityGroups = getsafe(oXML, '//DL_ADSecurityGroups');\r\n\tEXSetField('DL_CaseProtected', DLCaseProtected, true);\r\n\tEXSetField('DL_SecurityPersons', DLSecurityPersons, false);\r\n\tEXSetField('DL_ADSecurityGroups', DLADSecurityGroups, false);\r\n\toEle = document.getElementById('DL_CaseProtected');\r\n\tEXhandleDLCaseProtected(oEle);\r\n\toEle = null;\r\n}\r\n\r\nfunction EXhandleDLWFCaseTypeChangeXX() { // 9.9.2008 - default functionality\r\n    var oEle = document.getElementById('DL_WFCaseType');\r\n    var DLId = oEle.options[oEle.selectedIndex].value;\r\n    if (queryString('new') != 'true' && DLId == '') // 31.7.2010 - DLId logic added (requested by Tele Greenland - Charlotte)\r\n        return;\r\n    if (DLId == '') // 31.7.2010 - added\r\n        return;\r\n    if (document.getElementById('DL_CaseProtected') == null) // 14.6.2012 - if no protection exists - ignore\r\n        return;\r\n    var oXML = getEntityData('DL_WFCaseType', 'DL_Id = ' + DLId, '');\r\n    var DLCaseProtected = getsafe(oXML, '//DL_CaseProtected');\r\n    if (DLCaseProtected == '')\r\n        DLCaseProtected = '0';\r\n    var DLSecurityPersons = getsafe(oXML, '//DL_SecurityPersons');\r\n    var DLADSecurityGroups = getsafe(oXML, '//DL_ADSecurityGroups');\r\n    EXSetField('DL_CaseProtected', DLCaseProtected, true);\r\n    EXSetField('DL_SecurityPersons', DLSecurityPersons, false);\r\n    EXSetField('DL_ADSecurityGroups', DLADSecurityGroups, false);\r\n    oEle = document.getElementById('DL_CaseProtected');\r\n    EXhandleDLCaseProtected(oEle);\r\n    oEle = null;\r\n}\r\nfunction EXSetField(sEle, sValue, bOverwrite) {\r\n    var oEle = document.getElementById(sEle);\r\n    if (oEle == null) {\r\n        alert('Configuration error\\nEXSetField(' + sEle + ',' + sValue + ',' + bOverwrite + ').\\nPlease contact administrator.');\r\n        return;\r\n    }\r\n    if (oEle.value == '' || bOverwrite && sValue != '')\r\n        oEle.value = sValue;\r\n}\r\n\r\nfunction EXDisplayEmployee(DLsAMAccountName) {\r\n    var oXML = getEntityData('DL_sAMAccountName', 'DL_sAMAccountName = \\'' + DLsAMAccountName + '\\'', '');\r\n    displayentity('DL_sAMAccountName', getsafe(oXML, '//DL_Id'));\r\n}\r\nfunction EXGotoEmployee(DLsAMAccountName) {\r\n    var oXML = getEntityData('DL_Employee', 'DL_sAMAccountName = \\'' + DLsAMAccountName + '\\'', '');\r\n    var DLId = getsafe(oXML, '//DL_Id');\r\n    if (DLId == '') {\r\n        oXML = getEntityData('DL_sAMAccountName', 'DL_sAMAccountName = \\'' + DLsAMAccountName + '\\'', '');\r\n        EXGotoObject('DL_sAMAccountName', DLId);\r\n    }\r\n    else\r\n        EXGotoObject('DL_Employee', DLId);\r\n    //\tloadcontent('http://inussuk/DK/Organisation/S%c3%b8geresultat+Person.htm?name=&inits=' + DLsAMAccountName);\r\n}\r\n\r\nfunction EXCaseAddressesGetEmails(DLEntityNameForeign, DLEntityId, bWarnIfNotAll) { // 23.6.2012\r\n    if (typeof (bWarnIfNotAll) == 'undefined') bWarnIfNotAll = true;\r\n    var oXML = getEntityData('DL_CaseAddresses', 'DL_EntityId=' + DLEntityId + ' AND DL_EntityNameForeign = \\'' + DLEntityNameForeign + '\\'', '');\r\n    var sRes = '';\r\n    var sWarn = '';\r\n    var xNodes = oXML.selectNodes('//DL_CaseAddresses');\r\n    for (var i = 0; i < xNodes.length; i++) {\r\n        var Email = getsafe(xNodes[i], 'DL_Email');\r\n        if (Email == '')\r\n            sWarn += ';' + getsafe(xNodes[i], 'DL_Attention');\r\n        else\r\n            sRes += ';' + Email;\r\n    }\r\n    if (sWarn != '') {\r\n        sWarn = LEX_WarnNotAllEmailsFound.replace('%0%', sWarn.substr(1));\r\n        if (bWarnIfNotAll) alert(sWarn);\r\n        //sRes = sWarn + '\\n' + sRes.substr(1);\r\n        sRes = sRes.substr(1);\r\n    }\r\n    else\r\n        sRes = sRes.substr(1);\r\n    return sRes;\r\n}\r\nfunction EXCaseContactsLoad(DLEntity, DLKey, DLXPath) {\r\n    if (typeof (DLXPath) == 'undefined')\r\n        DLXPath = '';\r\n    if (DLXPath == '')\r\n        DLXPath = 'DL_Id';\r\n    if (DLEntity == 'DL_Contacts')\r\n        DLXPath = 'DLContactID';\r\n    var sWhere;\r\n    if (DLXPath == 'DL_Id')\r\n        sWhere = 'DL_Id = ' + DLKey;\r\n    else\r\n        sWhere = DLXPath + '= \\'' + DLKey + '\\'';\r\n    var oXML = getEntityData(DLEntity, sWhere, '');\r\n    var sRole = queryString('Role');\r\n    var sCaseType = queryString('CaseType'); // Critical parameter set in DynamicSearch\r\n    //alert('DEBUG\\nEXCaseContactsLoad ' + DLEntity + ':'+ DLKey + ' Role=' + sRole + ' CaseType=' + sCaseType);\r\n    var sKeys = queryString('ForeignKeys');\r\n    var sValues = queryString('ForeignValues');\r\n    var sAppendParam = '&CaseType=' + sCaseType + '&Role=' + sRole + '&DLEntity=' + DLEntity + '&DLKey=' + DLKey;\r\n    var sTitle;\r\n    if (DLEntity == 'DL_Contacts')\r\n        sTitle = 'Opret ' + getsafe(oXML, '//DL_Contacts/EX_cn') + ' som ' + LEXCaseAddress;\r\n    else\r\n        sTitle = 'Opret ' + getsafe(oXML, '//DL_sAMAccountName/DL_FullName') + ' som ' + LEXCaseAddress;\r\n    parent.newentity2('DL_CaseAddresses', sKeys, sValues, sAppendParam, sTitle);\r\n}\r\nfunction EXLoadNewDocument(DLEntity, DLId, Flags, subfolder, sTitle, DLFolderParams) { // 25.2.2012 sTitle added 17.5.2012 DLFolderParams added\r\n    if (typeof (DLFolderParams) == 'undefined')\r\n        DLFolderParams = '';\r\n    if (typeof (sTitle) == 'undefined')\r\n        sTitle = '';\r\n    if (typeof (subfolder) == 'undefined')\r\n        subfolder = '';\r\n    if (EXGetUserRole() == 0) {// 3.11.2009\r\n        alert(LEX_UserNoAccessCannotCreateDocuments);\r\n        return;\r\n    }\r\n\r\n    var sUrl = getAbsoluteURL('/EX_Resources/EXNewDocument.html?DL_EntityNameForeign=' + DLEntity + '&Flags=' + Flags + '&subfolder=' + subfolder);\r\n    if (sTitle == '')\r\n        sTitle = LEX_OpenCreateNewDocument;\r\n    if (DLFolderParams != '')\r\n        sUrl += '&DL_FolderParams=' + DLFolderParams;\r\n    if (DLId != '')\r\n        sUrl += '&QueryParam=' + DLId;\r\n    loadcontent2(sUrl, sTitle);\r\n}\r\nfunction EXTaskDocsToBasket(entity, id) { // 10.12.2008\r\n    //\tExecuteProcedure('dbo.EXMoveEntityToDocBasket @DLEntityNameForeign = \\'' + entity + '\\', @DLEntityId=' + id + ', @WUSER = %WUSER%');\r\n    ExecuteProcedure('dbo.EXTaskDocsToBasket @DLEntityNameForeign = \\'' + entity + '\\', @DLEntityId=' + id + ', @WUSER = %WUSER%'); // 26.4.2009\r\n    EXDocBasketRefresh();\r\n}\r\nfunction EXShowPropView(DLEntityOrViewName, DLPropRecent, DLEntityNameForeign) { // 9.1.2009\r\n    if (typeof (DLEntityNameForeign) == 'undefined')\r\n        DLEntityNameForeign = '';\r\n    //alert('EXShowPropView(' + DLEntityOrViewName + ',' + DLPropRecent + ',' + DLEntityNameForeign + ') started');\r\n    if (DLPropRecent == '') {\r\n        if (DLEntityNameForeign == '') // 13.6.2012\r\n            DLEntityNameForeign = DLEntityOrViewName.replace('PropView', '');\r\n        var oXML = getEntityData('DL_D617', 'DL_EntityNameForeign = \\'' + DLEntityNameForeign + '\\'', '');\r\n        //DLPropRecent = getsafe(oXML, '//DL_PropNameForeign');\r\n        DLPropRecent = getsafe(oXML, '//DL_Href');\r\n        //alert(DLPropRecent + ' ' + oXML.xml)\r\n    }\r\n    //var sUrl = '/EX_Resources/EXDisplayEntity.html?DL_ENTITY=' + DLEntityOrViewName + '&amp;SYSOBJECTS=true&amp;';\r\n    var sUrl = '/EX_Resources/EXDisplayQuickPart.html?DL_ENTITY=' + DLEntityOrViewName + '&amp;SYSOBJECTS=true&amp;'; // 4.8.2011\r\n    if (DLPropRecent == 'DL_AuthorInitials')\r\n        sUrl += 'Where=DL_sAMAccountName=%DL_sAMAccountName%';\r\n    else if (DLPropRecent == 'DL_CaseAddresses') {\r\n        var oXML = getEntityData2('TOP 2 *', 'DL_CaseAddresses', '', '');\r\n        sUrl += 'DL_Id=' + getsafe(oXML, '//DL_Id');\r\n    }\r\n    else\r\n        sUrl += 'DL_Id=' + GetRecentValue(DLPropRecent);\r\n    //alert(sUrl);\r\n    sUrl = getAbsoluteURL(sUrl);\r\n    loadcontent(sUrl, 'NEW', '');\r\n}\r\nfunction EXBRMUpdateAddress(DLId) { // 2.6.2009\r\n    //alert('EXBRMUpdateAddress ' + DLId);\r\n    var LEX_BRM_UpdateAllContacts = 'Address modified. Do you wish to modify all BRM contacts to reflect the new address? It takes quite a while.';\r\n    if (confirm(LEX_BRM_UpdateAllContacts)) {\r\n        try {\r\n            var objAddin;\r\n            objAddin = getOutlookAddIn();\r\n            var sResult;\r\n            if (objAddin == null) {\r\n                sResult = \"\";\r\n            }\r\n            else {\r\n                sResult = objAddin.object.EXBRMUpdateAddress(DLId);\r\n            }\r\n            if (sResult == \"\") {\r\n                var LEX_BRM_UpdateAllContactsError = 'Could not update all contacts for busines unit {0}';\r\n                alert(LEX_BRM_UpdateAllContactsError.format(DLId));\r\n            }\r\n            else\r\n                alert(sResult + ' contacts updated');\r\n            objAddin = null;\r\n        }\r\n        catch (e) { alert('EXBRMUpdateAddress failed ' + e.message); }\r\n    }\r\n}\r\nfunction EXTable2CSV(oDiv, bSkipLast) { // 7.9.2009 - bSkipLast added - used in DynamicSearch\r\n    var arr = new Array();\r\n    var oTRs = oDiv.getElementsByTagName('tr');\r\n    var s;\r\n    for (var i = 0; i < oTRs.length - (bSkipLast ? 1 : 0); i++) {\r\n        s = '';\r\n        var oTDs = oTRs[i].getElementsByTagName('td');\r\n        if (oTDs.length == 0 && i == 0)\r\n            oTDs = oTRs[i].getElementsByTagName('th');\r\n        for (var j = 0; j < oTDs.length; j++) {\r\n            if (j > 0)\r\n                s += ';';\r\n            s += oTDs[j].innerText.replace(/;/g, ' ');\r\n        }\r\n        //s += '\\\\\\n';\r\n        arr[arr.length] = s;\r\n    }\r\n    s = arr.join(\"\\r\\n\");\r\n    return s;\r\n}\r\n// 2.9.2009 - copied from EXDocs.js - profiling now general\r\nvar EXUserOnMouseTimer = null;\r\nfunction EXUserOnMouseOut(element, event, bSet) { // 2.9.2009 - Fix child element on mouse out - http://webmaster-forums.code-head.com/showthread.php?t=854\r\n    return; // 28.4.2013 - remove logic\r\n    //alert('EXUserOnMouseOut(' + element + ',' + event + ',' + bSet + ') invoked');\r\n    try {\r\n        if (EXUserOnMouseTimer != null) {\r\n            clearTimeout(EXUserOnMouseTimer);\r\n            EXUserOnMouseTimer = null;\r\n        }\r\n        if (bSet) { // 2.9.2009\r\n            var current_mouse_target = null;\r\n            if (event.toElement) {\r\n                current_mouse_target = event.toElement;\r\n            } else if (event.relatedTarget) {\r\n                current_mouse_target = event.relatedTarget;\r\n            }\r\n            bSet = false;\r\n            if (!is_child_of(element, current_mouse_target) && element != current_mouse_target) {\r\n                bSet = true;\r\n            }\r\n        }\r\n        if (bSet)\r\n            EXUserOnMouseTimer = setTimeout('EXUserOnMouseOutHide()', 300) // 26.6.2009 - 1000 --\x3e 300\r\n    } catch (e) { window.status = 'EXUserOnMouseOut(' + bSet + ') >>> ' + e.message; }\r\n}\r\nfunction is_child_of(parent, child) { // 20.8.2010 - moved to this location from EXDocs.js\r\n    if (child != null) {\r\n        while (child.parentNode) {\r\n            if ((child = child.parentNode) == parent) {\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n    return false;\r\n}\r\nfunction EXUserOnMouseOutHide() {\r\n    var oUserDIV = document.getElementById('EXUserDIV');\r\n    if (oUserDIV != null) {\r\n        //oUserDIV.style.top = 0;\r\n        //oUserDIV.style.left = 0;\r\n        //oUserDIV.zIndex = '0';\r\n        oUserDIV.style.display = 'none';\r\n    }\r\n}\r\nvar bIn = false;\r\nfunction EXGotoEmpl(sAMAccountName) {\r\n    var oXML = getEntityData('DL_D617', 'DL_EntityNameForeign = \\'DL_sAMAccountName\\'', ''); // 11.6.2010\r\n    var sUrl = getsafe(oXML, '//DL_URLPortal');\r\n    if (sUrl != '') {\r\n        var xUser = getEntityData('DL_sAMAccountName', 'DL_sAMAccountName = \\'' + sAMAccountName + '\\'', '');\r\n        sUrl = sUrl.replace('%DL_Id%', getsafe(xUser, '//DL_Id'));\r\n        sUrl = sUrl.replace('%DL_sAMAccountName%', sAMAccountName);\r\n        sUrl = sUrl.replace('%DL_FolderParams%', getsafe(xUser, '//DL_FolderParams'));\r\n        EXGotoUrl(sUrl);\r\n        //EXGotoUrl(getAbsoluteURL('/HR/Pages/default.aspx?User=' + sAMAccountName));\r\n    }\r\n}\r\nfunction EXUserOnMouseOver(oEle, sAMAccountName, DLId, DLModified, DLEntityNameForeign, DLEntityId) {\r\n    try {\r\n        if (typeof (DLId) == 'undefined') { // 4.8.2010\r\n            DLId = ''; DLModified = ''; DLEntityNameForeign = ''; DLEntityId = '';\r\n        }\r\n        //alert('DEBUG\\nEXUserOnMouseOver(' + oEle + ',' + sAMAccountName + ') started'); // 18.12.2009 - debug\r\n        if (typeof (oEle) == 'undefined')\r\n            alert('EXUserOnMouserOver(<UNDEFINED>,' + sAMAccountName + ') invoked - SERIOUS ERROR');\r\n        if (oEle == null)\r\n            alert('EXUserOnMouseOver(null, ' + sAMAccountName + ') element must be provided');\r\n        //\t\talert('EXUserOnMouserOver(' + oEle.innerHTML + ',' + sAMAccountName + ') invoked');\r\n        if (sAMAccountName == '') {\r\n            alert('EXUserOnMouserOver(' + oEle.innerHTML + ',' + sAMAccountName + ') invoked');\r\n            sAMAccountName = 'mmq';\r\n        }\r\n        if (bIn) return;\r\n        bIn = true;\r\n        var oUserDIV = document.getElementById('EXUserDIV');\r\n        if (oUserDIV == null) {\r\n            var oDiv = document.createElement('DIV');\r\n            oDiv.id = 'EXUserDIV';\r\n            oDiv.className = 'exf-authorballoon'; // 30.9.2009\r\n            //oDiv.style.width = '200px';\r\n            //oDiv.style.height = '200px';\r\n            oDiv.style.position = 'absolute';\r\n            //oDiv.frameborder = 0;\r\n            document.body.appendChild(oDiv);\r\n            oDiv = null;\r\n            oUserDIV = document.getElementById('EXUserDIV');\r\n            if (oUserDIV == null)\r\n                alert('oUserDIV not defined - STRANGE');\r\n        }\r\n        oUserDIV.style.zIndex = '3';\r\n        oUserDIV.style.display = '';\r\n        var xUser = getEntityData('DL_sAMAccountName', \"DL_sAMAccountName='\" + sAMAccountName + \"'\", '');\r\n        var sDoing = getsafe(xUser, '//DL_Description');\r\n        var sPhone = getsafe(xUser, '//DL_Phone');\r\n        var sURLImg = getsafe(xUser, '//DL_URLImage');\r\n        //alert(sAMAccountName + ' ' + sDoing);\r\n        var sTitle = '';\r\n        if (oEle.title != null)\r\n            sTitle = oEle.title;\r\n        if (sTitle == '')\r\n            sTitle = getsafe(xUser, '//DL_Name');\r\n        if (sTitle == '')\r\n            sTitle = getsafe(xUser, '//DL_Fullname');\r\n        if (sTitle == '')\r\n            sTitle = 'Init: ' + sAMAccountName;\r\n        var sImg;\r\n        if (sURLImg == '')\r\n            sImg = '<img src=\"/EX_Resources/gif/48x48/User 1.gif\" width=\"48px\" height=\"48px\"></img>';\r\n        else\r\n            sImg = '<img src=\"' + sURLImg + '\" width=\"40px\" height=\"48px\"></img>';\r\n        //alert(sImg);\r\n        var sDoing1;\r\n        if (sDoing.length > 24) {\r\n            sDoing1 = sDoing.substr(0, 25);\r\n            var jj = sDoing1.lastIndexOf(' ');\r\n            if (jj > 15)\r\n                sDoing1 = sDoing1.substr(0, jj);\r\n            sDoing1 += '...';\r\n        }\r\n        else\r\n            sDoing1 = sDoing;\r\n        var sAuthorAction = '<td class=\"exf-authoraction\" title=\"Skriv besked...\"><a href=\"javascript:\" onclick=\"EXExformationNewMessage(\\'' + sAMAccountName + '\\', \\'' + DLId + '\\',\\'' + DLModified + '\\',\\'' + DLEntityNameForeign + '\\',\\'' + DLEntityId + '\\')\"><img border=\"0\" src=\"/EX_Resources/gif/16x16/Exclamation Green.gif\"></img></a></td>';\r\n        var sPhoneLine = '<tr><td colspan=\"2\">' + sPhone + '</td></tr>';\r\n        oUserDIV.innerHTML = '<div onmouser1over=\"EXUserOnMouseOut(this, event, false)\" onmouseout=\"EXUserOnMouseOut(this, event, true)\" oncli1ck=\"EXGotoEmpl(\\'' + sAMAccountName + '\\')\"><table cellspacing=\"0\" cellpadding=\"0\" class=\"exf-authorballoon\"><tr><td class=\"exf-authorimage\">' + sImg + '</td><td><table><tr>' + sAuthorAction + '<td class=\"exf-authorname\" onclick=\"EXGotoEmpl(\\'' + sAMAccountName + '\\')\">' + sTitle + '</td></tr><tr><td colspan=\"2\" class=\"exf-authordoing\" title=\"' + sDoing + '\">' + sDoing1 + '</td></tr>' + sPhoneLine + '</table></td></tr></table></div>';\r\n        //alert(oUserDIV.outerHTML);\r\n        //window.status = 'EXUserOnMouseOver ' + sAMAccountName;\r\n        var ii = getElementTop1(oEle);\r\n        if (ii < 2) ii = 2; // 4.8.2010\r\n        //alert('getElementTop ' + ii);\r\n        oUserDIV.style.top = ii;\r\n        ii = getElementLeft1(oEle) - 50;\r\n        if (ii < 12) ii = 12; // 4.8.2010\r\n        //alert('getElementLeft ' + ii);\r\n        oUserDIV.style.left = ii;\r\n        //alert('EXUserOnMouseOver ' + sAMAccountName + ' ' + oEle);\r\n    } catch (e) { alert('EXUserOnMouseOver ' + e.message); }\r\n    bIn = false;\r\n}\r\n\r\n// 29.08.2010 BH TEST EXEntityOnMouseOver\r\n//function EXEntityOnMouseOver(oEle, sAMAccountName, DLId, DLModified, DLEntityNameForeign, DLEntityId) {\r\nfunction EXEntityOnMouseOver(oEle, DLEntityNameForeign, DLEntityId) {\r\n    try {\r\n        //\tif (typeof(DLId) == 'undefined') { // 4.8.2010\r\n        //\t\tDLId = ''; DLModified = ''; DLEntityNameForeign = ''; DLEntityId = '';\r\n        //\t}\r\n        //alert('DEBUG\\nEXUserOnMouseOver(' + oEle + ',' + sAMAccountName + ') started'); // 18.12.2009 - debug\r\n        if (typeof (oEle) == 'undefined')\r\n            alert('EXEntityOnMouseOver(<UNDEFINED>,' + DLEntityNameForeign + ') invoked - SERIOUS ERROR');\r\n        if (oEle == null)\r\n            alert('EXEntityOnMouseOver(null, ' + sAMAccountName + ') element must be provided');\r\n        //\t\talert('EXUserOnMouserOver(' + oEle.innerHTML + ',' + sAMAccountName + ') invoked');\r\n        //\tif (sAMAccountName == '') {\r\n        //\t\talert('EXEntityOnMouseOver(' + oEle.innerHTML + ',' + sAMAccountName + ') invoked');\r\n        //\t\tsAMAccountName='mmq';\r\n        //\t}\r\n        if (bIn) return;\r\n        bIn = true;\r\n        var oUserDIV = document.getElementById('EXUserDIV');\r\n        if (oUserDIV == null) {\r\n            var oDiv = document.createElement('DIV');\r\n            oDiv.id = 'EXUserDIV';\r\n            oDiv.className = 'exf-authorballoon'; // 30.9.2009\r\n            //oDiv.style.width = '200px';\r\n            //oDiv.style.height = '200px';\r\n            oDiv.style.position = 'absolute';\r\n            //oDiv.frameborder = 0;\r\n            document.body.appendChild(oDiv);\r\n            oDiv = null;\r\n            oUserDIV = document.getElementById('EXUserDIV');\r\n            if (oUserDIV == null)\r\n                alert('EXUserDIV not defined - STRANGE');\r\n        }\r\n        oUserDIV.style.zIndex = '3';\r\n        oUserDIV.style.display = '';\r\n        var xUser = getEntityData(DLEntityNameForeign, \"DL_Id=\" + DLEntityId + \"\", '');\r\n        //\talert(DLEntityNameForeign + xUser.xml);\r\n        var sDoing = getsafe(xUser, '//DL_Description');\r\n        if (sDoing == '')\r\n            sDoing = getsafe(xUser, '//DL_ProjectName');\r\n        if (sDoing == '')\r\n            sDoing = getsafe(xUser, '//DL_TextBox');\r\n        var sPhone = getsafe(xUser, '//DL_Phone');\r\n        var sURLImg = getsafe(xUser, '//DL_URLImage');\r\n        //alert(sAMAccountName + ' ' + sDoing);\r\n        var sTitle = '';\r\n        if (oEle.title != null)\r\n            sTitle = oEle.title;\r\n        if (sTitle == '')\r\n            sTitle = getsafe(xUser, '//DL_Name');\r\n        if (sTitle == '')\r\n            sTitle = getsafe(xUser, '//DL_Fullname');\r\n        if (sTitle == '')\r\n            sTitle = getsafe(xUser, '//DL_Title');\r\n        if (sTitle == '')\r\n            sTitle = getsafe(xUser, '//DL_ProjectID');\r\n        var sImg;\r\n        if (sURLImg == '')\r\n            sImg = '<img src=\"/EX_Resources/gif/48x48/User 1.gif\" width=\"48px\" height=\"48px\"></img>';\r\n        else\r\n            sImg = '<img src=\"' + sURLImg + '\" width=\"40px\" height=\"48px\"></img>';\r\n        sImg = '';\r\n        //alert(sImg);\r\n        var sDoing1;\r\n        if (sDoing.length > 24) {\r\n            sDoing1 = sDoing.substr(0, 25);\r\n            var jj = sDoing1.lastIndexOf(' ');\r\n            if (jj > 15)\r\n                sDoing1 = sDoing1.substr(0, jj);\r\n            sDoing1 += '...';\r\n        }\r\n        else\r\n            sDoing1 = sDoing;\r\n        var sAuthorAction = '<td class=\"exf-authoraction\" title=\"Skriv besked...\">' + '' + '</td>';\r\n        //<a href=\"javascript:\" onclick=\"EXExformationNewMessage(\\'' + sAMAccountName + '\\', \\'' + DLId + '\\',\\'' + DLModified + '\\',\\'' + DLEntityNameForeign + '\\',\\'' + DLEntityId + '\\')\"><img border=\"0\" src=\"/EX_Resources/gif/16x16/Exclamation Green.gif\"></img></a></td>';\r\n        var sPhoneLine = '<tr><td colspan=\"2\">' + sPhone + '</td></tr>';\r\n        oUserDIV.innerHTML = '<div onmouser1over=\"EXUserOnMouseOut(this, event, false)\" onmouseout=\"EXUserOnMouseOut(this, event, true)\" oncli1ck=\"EXGotoEmpl(\\'' + sAMAccountName + '\\')\"><table cellspacing=\"0\" cellpadding=\"0\" class=\"exf-authorballoon\"><tr><td class=\"exf-authorimage\">' + sImg + '</td><td><table><tr>' + sAuthorAction + '<td class=\"exf-authorname\" on1click=\"EXGotoEmpl(\\'' + sAMAccountName + '\\')\" on2click=\"alert(\\'123\\');EXGotoObject(\\'' + DLEntityNameForeign + '\\', ' + DLEntityId + ')\"><a href=\"javascript:EXGotoObject(\\'' + DLEntityNameForeign + '\\', ' + DLEntityId + ')\">' + sTitle + '</a></td></tr><tr><td colspan=\"2\" class=\"exf-authordoing\" title=\"' + sDoing + '\">' + sDoing1 + '</td></tr>' + sPhoneLine + '</table></td></tr></table></div>';\r\n        //alert(oUserDIV.outerHTML);\r\n        //window.status = 'EXUserOnMouseOver ' + sAMAccountName;\r\n        var ii = getElementTop1(oEle);\r\n        if (ii < 2) ii = 2; // 4.8.2010\r\n        //alert('getElementTop ' + ii);\r\n        oUserDIV.style.top = ii;\r\n        ii = getElementLeft1(oEle) - 50;\r\n        if (ii < 12) ii = 12; // 4.8.2010\r\n        //alert('getElementLeft ' + ii);\r\n        oUserDIV.style.left = ii;\r\n        //alert('EXUserOnMouseOver ' + sAMAccountName + ' ' + oEle);\r\n    } catch (e) { alert('EXUserOnMouseOver ' + e.message); }\r\n    bIn = false;\r\n}\r\nfunction EXExformationNewMessage(sAMAccountName, DLId, DLModified, DLEntityNameForeign, DLEntityId) { // 4.8.2010\r\n    //function \r\n    var oUserDIV = document.getElementById('EXUserDIV');\r\n    if (oUserDIV != null)\r\n        oUserDIV.style.display = 'None';\r\n    alert('EXExforamtionNewMessage ' + sAMAccountName + DLId + ' ' + DLModified + ' ' + DLEntityNameForeign + ' ' + DLEntityId);\r\n    EXShowAddExformation(window.event.srcElement, DLId, DLModified, DLEntityNameForeign, DLEntityId, '@' + sAMAccountName + ' ');\r\n}\r\nfunction EXEditTask(DLId) { // 3.9.2009\r\n    var sUrl = '/EX_SQLSVC/DynamicForm.aspx?DL_ENTITY=DL_Tasks&where=DL_Id=' + DLId + '&update=true&EXcheck=' + Math.random();\r\n    //window.showModalDialog(sUrl,'','dialogWidth:530px;dialogHeight:560px;toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,copyhistory=no,resizable=no,modal=yes');\r\n    window.open(sUrl, '', 'width=530,height=560,toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,copyhistory=no,resizable=no'); // 26.11.2009 - Tele Greenland modification\r\n}\r\n\r\nfunction RemoveHREF(htmlstring) {\r\n    var s = _RemoveString('&lt;A href=\"javascript:', '\"&gt;', htmlstring);\r\n    //alert(s);\r\n    s = _RemoveString('&lt;a href=\"javascript:', '\"&gt;', s);\r\n    //alert(s);\r\n    s = _RemoveString('href=\"javascript:', '\"', s);\r\n    //alert(s);\r\n\r\n    s = s.replace(/<A >/gi, '<A>');\r\n    s = s.replace(/<A  >/gi, '<A>');\r\n    return s;\r\n}\r\n\r\n\r\nfunction _RemoveString(searchstring, endstring, htmlstring) {\r\n    var sHtml = htmlstring;\r\n    var i = sHtml.indexOf(searchstring);\r\n    var j = 0;\r\n    //alert('searchstring : ' + searchstring + '\\r\\n\\r\\nendstring: ' + endstring + '\\r\\n\\r\\nhtmlstring :' + htmlstring)\r\n    while (i > -1) {\r\n        var sTemp = '';\r\n        j = sHtml.indexOf(endstring, i + 15);\r\n        sTemp = sHtml.substr(i, j - i + endstring.length);\r\n        sHtml = sHtml.replace(sTemp, '');\r\n        i = sHtml.indexOf(searchstring);\r\n    }\r\n    return sHtml;\r\n}\r\n\r\nfunction HTML2PDF(urlBase, htmlString, filename) {\r\n    try {\r\n        //htmlString='hej med <b>dig</b>';\r\n\r\n        var sHtml = RemoveHREF(htmlString);\r\n\r\n        setRecentValueXML('EXHTML2PDF', '<a><urlBase>' + MakeXMLSafe(urlBase) + '</urlBase><htmlString>' + MakeXMLSafe(sHtml) + '</htmlString><filename>' + MakeXMLSafe(filename) + '</filename></a>');\r\n        window.open(getAbsoluteURL('/EX_SPSSVC/EXPDF.aspx'));\r\n        return;\r\n        //alert('HTML2PDF(' + urlBase + ',' + htmlString + ') started');\r\n        var xmldoc;\r\n        xmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n        xmldoc = xmldoc + '<HTML2PDF xmlns=\"http://exformatics.net/SharePointServices\">';\r\n        xmldoc = xmldoc + '<urlBase>' + MakeXMLSafe(urlBase) + '</urlBase>';\r\n        xmldoc = xmldoc + '<htmlString>' + MakeXMLSafe(htmlString) + '</htmlString>';\r\n        xmldoc = xmldoc + '</HTML2PDF>';\r\n        xmldoc = xmldoc + '</soap:Body></soap:Envelope>';\r\n\r\n        FeedbackHTTP = EXXMLHTTP()\r\n        FeedbackHTTP.open(\"POST\", getAbsoluteURL('/EX_SPSADMSVC/svcSharePoint.asmx?op=HTML2PDF'), false);\r\n        FeedbackHTTP.setRequestHeader(\"Content-Type\", \"text/xml; charset=utf-8\");\r\n        FeedbackHTTP.setRequestHeader(\"SOAPAction\", 'http://exformatics.net/SharePointServices/HTML2PDF');\r\n        FeedbackHTTP.send(xmldoc);\r\n        //alert(FeedbackHTTP.status + ' ' + FeedbackHTTP.responseText);\r\n        FeedbackHTTP = null;\r\n        return;\r\n        return (getsafe(FeedbackHTTP.responseXML, '//CreateFolderResult') == 'true');\r\n    } catch (e) { alert('HTML2PDF(' + urlBase + ',' + htmlString.substring(0, 100) + ') failed\\n' + e.message); }\r\n}\r\nfunction EXTable2XML(oDiv, bSkipLast) { // 7.9.2009 - bSkipLast added - used in DynamicSearch\r\n    var arr = new Array();\r\n    var oTRs = oDiv.getElementsByTagName('tr');\r\n    var s;\r\n    for (var i = 0; i < oTRs.length - (bSkipLast ? 1 : 0); i++) {\r\n        s = '<row>';\r\n        var oTDs = oTRs[i].getElementsByTagName('td');\r\n        if (oTDs.length == 0 && i == 0)\r\n            oTDs = oTRs[i].getElementsByTagName('th');\r\n        for (var j = 0; j < oTDs.length; j++) {\r\n            s += '<E' + j + '>' + oTDs[j].innerText.replace(/;/g, ' ') + '</E' + j + '>';\r\n        }\r\n        s += '</row>';\r\n        arr[arr.length] = s;\r\n    }\r\n    s = '<rows' > +arr.join(\"\\r\\n\") + '</rows>';\r\n    return s;\r\n}\r\nfunction HTML2XLSX(oDiv, title) { // 29.11.2009\r\n    var xml = EXTable2XML(oDiv, false);\r\n    setRecentValueXML('EXXML2XLS', '<a><Name></Name><Subject></Subject><Comments></Comments><filename></filename><xml>' + xml + '</xml></a>');\r\n}\r\nfunction EXShowWFCaseTypeInfo(DLWFCaseType) { // 7.9.2009 - 25.7.2011 - modified\r\n    var oEle = document.getElementById('DL_WFCaseType');\r\n    if (oEle == null)\r\n        return;\r\n    var oXML = getEntityData('DL_WFCaseType', 'DL_Id=' + DLWFCaseType, '');\r\n    var DLsAMAccountNameForeign = getsafe(oXML, '//DL_sAMAccountNameForeign');\r\n    var xOwner = getEntityData('DL_sAMAccountName', 'DL_sAMAccountName = \\'' + DLsAMAccountNameForeign + '\\'', '');\r\n    var DLURLImage = getsafe(xOwner, '//DL_URLImage');\r\n    var DLName = getsafe(xOwner, '//DL_Name');\r\n\r\n    sTable = '<table>';\r\n    sTable += AddTableRow(LEX_Title, '<a href=\"javascript:\" onclick=\"loadentity(\\'DL_WFCaseType\\', ' + DLWFCaseType + ')\">' + getsafe(oXML, '//DL_Title') + '</a>');\r\n    sTable += AddTableRow(LEX_WF_ProcessOwner, DLName + (DLURLImage == '' ? '' : '<img border=\"0\" src=\"' + DLURLImage + '\" width=\"32px\"></img>'));\r\n    var sDesc = getsafe(oXML, '//DL_HTMLText');\r\n    sDesc = sDesc.replace('PHASEDESCRIPTION', '');\r\n    if (sDesc != '')\r\n        sTable += '<tr><td class=\"ms-vb\" colspan=\"2\">' + sDesc + '</td></tr>';\r\n    sTable += '</table>';\r\n    oEle.innerHTML = sTable;\r\n\r\n    //alert('EXShowWFCaseTypeInfo ' + oEle.value);\r\n}\r\nfunction AddTableRow(label, content) { // 25.7.2011 - retrieved from Exformatics_cust.js\r\n    var s;\r\n    s = '<tr>';\r\n    if (label != '')\r\n        s += '<td class=\"ms-vb\"><b>' + label + '</b></td>';\r\n    if (content != '')\r\n        s += '<td class=\"ms-vb\">' + content + '</td>';\r\n    s += '</tr>';\r\n    return s;\r\n}\r\nfunction EXTaskSendBack(DLId) { // 7.10.2009 // 3.10.2012 - send opgaver tilbage hvis du har skabt dem - dvs tag ejerskab for dem!\r\n    //alert('EXTaskSendBack(' + DLId + ')');\r\n    var oXML = getEntityData('DL_Tasks', 'DL_Id = ' + DLId, '');\r\n    var oUser = getEntityData('DL_sAMAccountName', 'DL_sAMAccountName = %DL_sAMAccountName%', '');\r\n    var sAMAccountName = getsafe(oUser, '//DL_sAMAccountName/DL_sAMAccountName');\r\n    if (sAMAccountName != getsafe(oXML, '//BPM_Responsible') && sAMAccountName != getsafe(oXML, '//DL_TaskFrom')) {\r\n        //var LEX_TaskSendBackCanOnlyChangeOwn = 'Du kan kun sende egne opgaver tilbage.';\r\n        alert(LEX_TaskSendBackCanOnlyChangeOwn);\r\n        return;\r\n    }\r\n    if (getsafe(oXML, '//DL_TaskFrom') == getsafe(oXML, '//BPM_Responsible'))\r\n        return;\r\n    //var LEX_TaskSendBackQuestion = 'Vil du sende opgaven fra {0} tilbage?';\r\n    if (confirm(LEX_TaskSendBackQuestion.format(getsafe(oXML, '//DL_TaskFrom')))) {\r\n        //var LEX_TaskSendBackReason = 'Venligst angiv årsagen';\r\n        //var LEX_TaskSendBackExplanation = 'Jeg mener ikke denne task skal løses af mig fordi ...';\r\n        var s = prompt(LEX_TaskSendBackReason, LEX_TaskSendBackExplanation);\r\n        if (s == null)\r\n            return;\r\n        var HTML = s + '<BR>' + getsafe(oXML, '//DL_HTMLText');\r\n        SetEntityItemValue('DL_Tasks', DLId, getsafe(oXML, '//DL_Modified'), 'BPM_Responsible', getsafe(oXML, '//DL_TaskFrom'), 'DL_HTMLText', MakeXMLSafe(HTML));\r\n        if (parent)\r\n            parent.loadentity('DL_Tasks', DLId);\r\n        else\r\n            window.location = window.location;\r\n    }\r\n}\r\nfunction EXAddWFCaseTypeToProcess(DLProcess, DLWFCaseType) {\r\n    //alert('EXAddWFCaseTypeToProcess(' + DLProcess + ',' + DLWFCaseType + ')');\r\n    setEntityDetail('DL_WFCaseTypeProcess', '<a><DL_WFCaseType>' + DLWFCaseType + '</DL_WFCaseType><DL_Process>' + DLProcess + '</DL_Process></a>');\r\n    EXReload();\r\n}\r\n// 3.11.2009 - security model added\r\nvar _EXUserRole = null; // set in function EXSetUserRole found in Exformatics_cust.js\r\nvar EXUseRoleSecurity; // set in Exformatics_cust.js\r\nvar EXECMMemberGroup; // set in Exformatics_cust.js\r\nfunction EXGetUserRole() { // 0=read-only,1=Access\r\n    if (!EXUseRoleSecurity)\r\n        return 1;\r\n    if (_EXUserRole == null)\r\n        EXSetUserRole();\r\n    return _EXUserRole;\r\n}\r\nfunction EXShowSubscription(DLId) { // 4.12.2009\r\n    loadcontent('/EX_SQLSVC/DynamicList.html?DLEntity=DL_SubscriptionNotification&Where=DL_Favorites=' + DLId + '&PropList=DL_Modified,DL_Digest&OrderBy=DL_Id desc');\r\n}\r\nfunction EXWFSearchCases(DLWFCaseType) { // 13.2.2010\r\n    var oXML = getEntityData('DL_WFCaseType', 'DL_Id = ' + DLWFCaseType, '');\r\n    var DLEntityNameForeign = getsafe(oXML, '//DL_WFCaseEntity');\r\n    var DLWFCaseEntityData = getsafe(oXML, '//DL_WFCaseEntityData'); // 13.3.2011\r\n    //EXLoadQuickSearch(DLEntityNameForeign,false,'DL_WFCaseType',DLWFCaseType,null,true);\r\n    var sWhere = 'DL_EntityNameForeign = \\'' + DLEntityNameForeign + '\\'';\r\n    if (DLWFCaseEntityData != '')\r\n        sWhere = 'DL_EntityNameForeign = \\'' + DLEntityNameForeign + 'WF' + DLWFCaseEntityData + '\\'';\r\n    var oXML1 = getEntityData('DL_D617', sWhere, '');\r\n    var url = getsafe(oXML1, '//DL_QuickSearch');\r\n    if (url.indexOf('DL_WFCaseType') > 0 && url.indexOf('DL_WFCaseType') != url.indexOf('DL_WFCaseType=')) { // 16.3.2011 - only add default value if not = specific value in QuickSearch URL\r\n        var i = url.indexOf('DL_WFCaseType');\r\n        url = url.substr(0, i + 13) + ':' + DLWFCaseType + url.substr(i + 13);\r\n    }\r\n    loadcontent2(url, LEX_QuickSearchTitle + EXgetEntityTitle(DLEntityNameForeign) + ' ' + getsafe(oXML, '//DL_Title'));\r\n}\r\n\r\nfunction RemoveOnClick(sHtml) {\r\n    var s = _RemoveString('onclick=\"javascript:', '\"', sHtml);\r\n    s = s.replace(/<A >/gi, '<A>');\r\n    s = s.replace(/<A  >/gi, '<A>');\r\n    return s;\r\n}\r\n\r\nfunction _GetAnchor(htmlstring) {\r\n    var sHtml = htmlstring.toLowerCase(); ;\r\n    var i = sHtml.indexOf('<a');\r\n    var j = sHtml.indexOf('</a>');\r\n    var s;\r\n    var k = 3;\r\n\r\n    /*if(i == -1)\r\n    {\r\n    i = sHtml.indexOf('<a>');\r\n    if(i == -1)\r\n    {\r\n    return '';\r\n    }\r\n\t\t\r\n    k = 3;\r\n    }*/\r\n\r\n    //alert('i: ' + i + '\\r\\nj: ' + j + '\\r\\nk: ' +k);\r\n\r\n    s = htmlstring.substr(i + k, j - i - k);\r\n\r\n    return s;\r\n}\r\n\r\nfunction _GetString(searchstring, endstring, htmlstring) {\r\n    var sHtml = htmlstring.toLowerCase();\r\n    var i = sHtml.indexOf(searchstring.toLowerCase());\r\n    var j = sHtml.indexOf(endstring.toLowerCase());\r\n    var s;\r\n\r\n    //alert('i: ' + i + '\\r\\n\\r\\nj: ' + j);\r\n\r\n    if (i == -1 || j == -1) {\r\n        return '';\r\n    }\r\n\r\n    s = htmlstring.substr(i, j - i + endstring.length);\r\n\r\n    return s;\r\n}\r\n\r\nfunction _GetString2(searchstring, endstring, htmlstring) {\r\n    var sHtml = htmlstring.toLowerCase();\r\n    var i = sHtml.indexOf(searchstring.toLowerCase());\r\n    var j = sHtml.indexOf(endstring.toLowerCase());\r\n    var s;\r\n\r\n    //alert('i: ' + i + '\\r\\n\\r\\nj: ' + j);\r\n    i++;\r\n\r\n    s = htmlstring.substr(i, j - i);\r\n\r\n    return s;\r\n}\r\n\r\nfunction EXHTML2XLS(sEXDSDLView, sEXWhere, sEXOrderBy, EXDSDisplayParameters, oEXDSXML) {\r\n    try {\r\n        var sHtml;\r\n        var xPath;\r\n\r\n        var xls = new ActiveXObject(\"Excel.Application\");\r\n        xls.visible = true;\r\n        var newBook = xls.Workbooks.Add;\r\n\r\n        newBook.Worksheets(1).Activate;\r\n\r\n        newBook.Worksheets(1).Name = \"Generated by Exformatics ECM\";\r\n\r\n        var sHtml;\r\n        var iCell = 1;\r\n        var iRow = 1;\r\n\r\n        var _EXDSDisplayParameters;\r\n\r\n        _EXDSDisplayParameters = EXDSDisplayParameters.split(',');\r\n\r\n        newBook.Worksheets(1).Cells(iRow, iCell).EntireRow.Font.Bold = true;\r\n\r\n        for (var i = 0; i < _EXDSDisplayParameters.length; i++) {\r\n            var sColumn;\r\n            //var iWidth;\r\n            //var xNode;\r\n            var xPath;\r\n\r\n            if (_EXDSDisplayParameters[i].indexOf(':') != -1) {\r\n                _EXDSDisplayParameters[i] = _EXDSDisplayParameters[i].substr(0, _EXDSDisplayParameters[i].indexOf(':'));\r\n            }\r\n\r\n            xPath = \"//DL_ENTITYCOLS/DL_D610D710[DL_PropNameForeign='\" + _EXDSDisplayParameters[i] + \"']\";\r\n            sColumn = getsafe(oEXDSXML, xPath + '/DL_PropDisplayName ');\r\n\r\n            xPath = \"//DL_COLFORMATS/DL_D710[DL_PropName='\" + _EXDSDisplayParameters[i] + \"']\";\r\n\r\n            if (sColumn == '') {\r\n                //sColumn = getsafe(oEXDSXML,xPath + '/DL_PropDisplayNameDK');\r\n                sColumn = getsafe(oEXDSXML, xPath + '/DL_PropDisplayName');\r\n            }\r\n\r\n            newBook.Worksheets(1).Columns(iCell).NumberFormat = '@';\r\n\r\n            newBook.Worksheets(1).Cells(iRow, iCell).value = sColumn;\r\n            newBook.Worksheets(1).Cells(iRow, iCell).Interior.ColorIndex = 15;\r\n            newBook.Worksheets(1).Cells(iRow, iCell).BorderAround(1, 2);\r\n\r\n            iCell++;\r\n        }\r\n\r\n        newBook.Worksheets(1).Range(newBook.Worksheets(1).Cells(iRow, 1), newBook.Worksheets(1).Cells(iRow, iCell - 1)).BorderAround(1, 3);\r\n\r\n        //Get Data\r\n        var sEXParams = ''; //_EXDSDisplayParameters[0]; 3.2.1015\r\n\r\n        for (var k = 0; k < _EXDSDisplayParameters.length; k++) {\r\n            var xPath = \"//DL_COLFORMATS/DL_D710[DL_PropName='\" + _EXDSDisplayParameters[k] + \"']\";\r\n            var oRow;\r\n            if (XPath == '')\r\n                oRow = null;\r\n            else\r\n                oRow = oEXDSXML.selectSingleNode(xPath);\r\n            var DLPropType = getsafe(oRow, 'DL_PropType'); // 15.6.2012  mmq\r\n            if (DLPropType == 'DL_Date1')\r\n                sEXParams += ',' + 'CONVERT(nvarchar,' + _EXDSDisplayParameters[k] + ',105) AS ' + _EXDSDisplayParameters[k];\r\n            else if (DLPropType == 'DL_DateTime1')\r\n                sEXParams += ',' + 'CONVERT(nvarchar,' + _EXDSDisplayParameters[k] + ',105) + \\' \\' + SUBSTRING(CONVERT(nvarchar,' + _EXDSDisplayParameters[k] + ',114),1,5)  AS ' + _EXDSDisplayParameters[k];\r\n            else\r\n                sEXParams += ',' + _EXDSDisplayParameters[k];\r\n\r\n        }\r\n        sEXParams = sEXParams.substr(1);\r\n\r\n        var oXML = getEntityData2(sEXParams, sEXDSDLView, sEXWhere, sEXOrderBy);\r\n        //alert(sEXParams + ' ' + sEXDSDLView + ' ' + sEXWhere + ' ' + sEXOrderBy);\r\n        //alert(oXML);\r\n        //EXCopyToClipboard(oXML.xml);\r\n        //alert(oXML.xml);\r\n\r\n        iRow++;\r\n        iCell = 1;\r\n\r\n        xNodes = oXML.selectNodes('//DL_ENTITYDATA/' + sEXDSDLView); // 28.3.2012 - s added\r\n        if (xNodes.length == 0) // 28.3.2012\r\n            xNodes = oXML.selectNodes('//' + sEXDSDLView);\r\n        //alert(xNodes.length + ' ' + sEXDSDLView);\r\n        for (var i = 0; i < xNodes.length; i++) {\r\n            for (var j = 0; j < _EXDSDisplayParameters.length; j++) {\r\n                var sValue, XPath;\r\n\r\n                if (_EXDSDisplayParameters[j] == '') {\r\n                    sValue = '';\r\n                    XPath = '';\r\n                }\r\n                else {\r\n                    sValue = getsafe(xNodes[i], _EXDSDisplayParameters[j]);\r\n                    xPath = \"//DL_COLFORMATS/DL_D710[DL_PropName='\" + _EXDSDisplayParameters[j] + \"']\";\r\n                }\r\n\r\n                var oRow;\r\n                if (XPath == '')\r\n                    oRow = null;\r\n                else\r\n                    oRow = oEXDSXML.selectSingleNode(xPath);\r\n                if (oRow != null) {\r\n                    var sDLPropDictionary = getsafe(oRow, 'DL_PropDictionary');\r\n                    var sDLPropDictionaryType = getsafe(oRow, 'DL_PropDictionaryType'); //7.6.2012  mb\r\n                    var sDLPropDictionaryDecode = getsafe(oRow, 'DL_PropCodeDecode'); //7.6.2012  mb\r\n                    var sDLPropType = getsafe(oRow, 'DL_PropType'); //13.5.2014  mmq\r\n                    if (sDLPropDictionary != '' && (_EXDSDisplayParameters[j] == 'DL_WFCaseEntity' || getsafe(oRow, 'DL_PropType') == 'DL_Int' || getsafe(oRow, 'DL_PropType') == 'DL_Boolean')) {\r\n\r\n                        xPath = '//' + _EXDSDisplayParameters[j] + '/' + sDLPropDictionary + '[DL_PropCodeKey=\\'' + sValue + '\\']';\r\n\r\n                        if (_EXDSDisplayParameters[j] == 'DL_CaseLongState') {\r\n                            var oDict;\r\n\r\n                            if (sValue == '') {\r\n                                sValue = '0';\r\n                            }\r\n\r\n                            if (oEXDSCaseLongState == null) {\r\n                                oEXDSCaseLongState = getEntityData2('DL_SequenceNo AS DL_PropCodeKey,DL_Title AS DL_PropCodeDecode,DL_WFCaseType', 'DL_WFCaseTypePhase', '', 'DL_WFCaseType,DL_SequenceNo');\r\n                            }\r\n\r\n                            var sWFCaseType = getsafe(oRow, 'DL_WFCaseType');\r\n                            if (sWFCaseType == '') sWFCaseType = getWFCaseType();\r\n                            if (sWFCaseType == '') sWFCaseType = '0'; // 28.3.2012\t\t\t\t\t\t\t\t\t\r\n                            XPath = './/DL_WFCaseTypePhase[DL_WFCaseType=' + sWFCaseType + '][DL_PropCodeKey=' + sValue + ']';\r\n                            oDict = oEXDSCaseLongState.selectSingleNode(XPath);\r\n                        }\r\n                        else if (sDLPropDictionaryType == '100') //7.6.2012  mb // 4.9.2012 - ==\r\n                        {\r\n                            var oDict2 = getEntityData2(sDLPropDictionaryDecode, sDLPropDictionary, 'DL_Id=' + sValue, '');\r\n                            sValue = getsafe(oDict2, '//' + sDLPropDictionaryDecode);\r\n                            //alert(sValue);\r\n                            oDict = null;\r\n                        }\r\n                        else {\r\n                            oDict = oEXDSXML.selectSingleNode(xPath);\r\n                        }\r\n\r\n                        if (oDict != null) {\r\n                            sValue = getsafe(oDict, 'DL_PropCodeDecode');\r\n                        }\r\n                    }\r\n                    if (sDLPropType == 'DL_Date') sValue = sValue.substr(0, 10);\r\n                }\r\n                // 7.8.2015 - format numbers\r\n                if (sDLPropType == 'DL_Int')\r\n                    newBook.Worksheets(1).Cells(iRow, iCell).NumberFormat = '0';\r\n                else if (sDLPropType == 'DL_Float')\r\n                //newBook.Worksheets(1).Cells(iRow,iCell).NumberFormat = '0.00E+00';\r\n                    newBook.Worksheets(1).Cells(iRow, iCell).NumberFormat = '#,##0.00';\r\n                else if (sDLPropType == 'DL_Money')\r\n                //newBook.Worksheets(1).Cells(iRow,iCell).NumberFormat = '_($* #,##0.00_);_($* (#,##0.00);_($* \"-\"??_);_(@_)';\r\n                    newBook.Worksheets(1).Cells(iRow, iCell).NumberFormat = '_( #,##0.00_);_( (#,##0.00);_( \"-\"??_);_(@_)';\r\n                else if (sDLPropType == 'DL_Date') {\r\n                    newBook.Worksheets(1).Cells(iRow, iCell).NumberFormat = 'dd/mm/yyyy';\r\n                    sValue = sValue.substr(0, 10); // 15.5.2016\r\n                }\r\n                else if (sDLPropType == 'DL_DateTime')\r\n                    newBook.Worksheets(1).Cells(iRow, iCell).NumberFormat = 'dd/mm/yyyy h:mm';\r\n                if (sDLPropType == 'DL_HyperLink') { // 2.5.2016\r\n                    newBook.Worksheets(1).Cells(iRow, iCell).value = sValue;\r\n                    var xCell = newBook.Worksheets(1).Cells(iRow, iCell);\r\n                    newBook.Worksheets(1).Hyperlinks.Add(xCell, sValue);\r\n                }\r\n                else\r\n                    newBook.Worksheets(1).Cells(iRow, iCell).value = sValue;\r\n\r\n                if (iRow % 2 != 0) {\r\n                    newBook.Worksheets(1).Cells(iRow, iCell).Interior.ColorIndex = 20;\r\n                }\r\n\r\n                iCell++;\r\n            }\r\n\r\n            iRow++;\r\n            iCell = 1;\r\n        }\r\n\r\n        newBook.Worksheets(1).Cells.EntireColumn.AutoFit();\r\n    }\r\n    catch (e) {\r\n        alert('EXHTML2XLS() failed\\n' + e.message);\r\n    }\r\n}\r\nfunction EXShowAction(stype, DLId, bVisible) { // flyttes til exformatics.js\r\n    //alert('EXShowAction ' + stype + ' ' + DLId + ' ' + bVisible);\r\n    var oEle = document.getElementById('action' + stype + DLId);\r\n    if (oEle != null)\r\n        oEle.style.visibility = (bVisible ? 'visible' : 'hidden');\r\n    //else\r\n    //\talert('action' + stype + '' + DLId + ' not found');\r\n\r\n}\r\n\r\n\r\nfunction getInternetExplorerVersion() {\r\n    var rv = -1; // Return value assumes failure.\r\n    if (navigator.appName == 'Microsoft Internet Explorer') {\r\n        var ua = navigator.userAgent;\r\n        var re = new RegExp(\"MSIE ([0-9]{1,}[\\.0-9]{0,})\");\r\n        if (re.exec(ua) != null)\r\n            rv = parseFloat(RegExp.$1);\r\n    }\r\n    else if (navigator.appName == 'Netscape') {\r\n        //Fix for IE-11\r\n        var ua = navigator.userAgent;\r\n        var re = new RegExp(\"Trident/.*rv:([0-9]{1,}[\\.0-9]{0,})\");\r\n        if (re.exec(ua) != null)\r\n            rv = parseFloat(RegExp.$1);\r\n    }\r\n    return rv;\r\n}\r\nfunction checkVersion() {\r\n    var msg = \"You're not using Windows Internet Explorer.\";\r\n    var ver = getInternetExplorerVersion();\r\n    if (ver > -1) {\r\n        if (ver >= 8.0)\r\n            msg = \"You're using a recent copy of Windows Internet Explorer.\"\r\n        else\r\n            msg = \"You should upgrade your copy of Windows Internet Explorer.\";\r\n    }\r\n    alert(msg);\r\n}\r\nfunction EXResetAllFavorites() { // 16.4.2011\r\n    var oTable = document.getElementById('MyFavoritesTable');\r\n    if (oTable == null)\r\n        return;\r\n    var oEles = oTable.getElementsByTagName(\"a\");\r\n    for (var x = 0; x < oEles.length; x++) {\r\n        if (oEles[x].id.indexOf('fava') == 0) {\r\n            _EXResetFavorite(oEles[x].id.replace('fava', ''));\r\n        }\r\n        else if (oEles[x].id.indexOf('MenuLink_Favorites') == 0) {\r\n            _EXResetFavorite(oEles[x].id.replace('MenuLink_Favorites', ''));\r\n        }\r\n    }\r\n    //var oEle = window.event.srcElement;\r\n    //oEle.style.display = 'none';\r\n}\r\nfunction EXResetFavorite(DLId) {\r\n    _EXResetFavorite(DLId);\r\n    loadentity('DL_Favorites', DLId);\r\n}\r\nfunction _EXResetFavorite(DLId) {\r\n    var oEle = document.getElementById('fava' + DLId);\r\n    if (oEle == null) oEle = document.getElementById('MenuLink_Favorites' + DLId);\r\n    if (oEle != null) // 10.10.2012 - 'fava...' removed - no ! anymore\r\n        oEle.style.display = 'none';\r\n    var oEle = document.getElementById('trDLFavorites' + DLId);\r\n    if (oEle != null) {\r\n        for (var i = 0; i < oEle.childNodes.length; i++) {\r\n            if (oEle.childNodes[i].className == 'dltablemarkrow')\r\n                oEle.childNodes[i].className = 'ms-vb';\r\n        }\r\n    }\r\n    ExecuteProcedure('EXResetFavorite @DLId = ' + DLId);\r\n}\r\n\r\n\r\nfunction EXLoadObjs() {\r\n    if (!document.getElementById)\r\n        return\r\n\r\n    for (i = 0; i < arguments.length; i++) {\r\n        var file = arguments[i]\r\n        var fileref = \"\"\r\n        if (loadedobjects.indexOf(file) == -1) { //Check to see if this object has not already been added to page before proceeding\r\n            if (file.indexOf(\".js\") != -1) { //If object is a js file\r\n                fileref = document.createElement('script')\r\n                fileref.setAttribute(\"type\", \"text/javascript\");\r\n                fileref.setAttribute(\"src\", file);\r\n            }\r\n            else if (file.indexOf(\".css\") != -1) { //If object is a css file\r\n                fileref = document.createElement(\"link\")\r\n                fileref.setAttribute(\"rel\", \"stylesheet\");\r\n                fileref.setAttribute(\"type\", \"text/css\");\r\n                fileref.setAttribute(\"href\", file);\r\n            }\r\n        }\r\n        if (fileref != \"\") {\r\n            document.getElementsByTagName(\"head\").item(0).appendChild(fileref)\r\n        }\r\n    }\r\n}\r\nfunction EXSetFavorite(DLEntityNameForeign, DLEntityId, sDiv) {\r\n    //alert('Favorite ' + DLEntityNameForeign + ' ' + DLEntityId + ' ' + sDiv);\r\n    var oDiv = document.getElementById(sDiv);\r\n    if (oDiv == null)\r\n        return;\r\n    var oXML = getEntityData('DL_Favorites', 'DL_CreatedBy = %WUSER% AND DL_EntityNameForeign = \\'' + DLEntityNameForeign + '\\' AND DL_EntityId = ' + DLEntityId, '');\r\n    //alert(oXML);\r\n    if (getsafe(oXML, '//DL_Id') == '') {\r\n        oDiv.innerHTML = '<a href=\"#\" onclick=\"EXMakeFavorite(\\'' + DLEntityNameForeign + '\\', ' + DLEntityId + ',\\'' + sDiv + '\\', 1)\"><img border=\"0\" src=\"/EX_Resources/gif/png16x16/favoriteoff.png\"></img></a>';\r\n    }\r\n    else {\r\n        oDiv.innerHTML = '<a href=\"#\" onclick=\"EXMakeFavorite(\\'' + DLEntityNameForeign + '\\', ' + DLEntityId + ',\\'' + sDiv + '\\', 0)\"><img border=\"0\" src=\"/EX_Resources/gif/png16x16/favoriteon.png\"></img></a>';\r\n    }\r\n}\r\nfunction EXMakeFavorite(DLEntityNameForeign, DLEntityId, sDiv, bMake) {\r\n    var oXML = getEntityData('DL_Favorites', 'DL_CreatedBy = %WUSER% AND DL_EntityNameForeign = \\'' + DLEntityNameForeign + '\\' AND DL_EntityId = ' + DLEntityId, '');\r\n    var sId = getsafe(oXML, '//DL_Id');\r\n    if (!bMake && sId == '') // 23.4.2013\r\n        bMake = true;\r\n    if (bMake) {\r\n        EXAddToFavorites(DLEntityNameForeign, DLEntityId);\r\n    }\r\n    else {\r\n        var xOps;\r\n        xOps = '<DL_Favorites><DELETE><row><DL_Id>' + getsafe(oXML, '//DL_Id') + '</DL_Id></row></DELETE></DL_Favorites>';\r\n        setEntity('DL_Favorites', xOps);\r\n        loadcontent2('/EX_Resources/EXShowMessage.html?Message=LEXFavoriteDeleted', LEXFavoriteDeleted); // 18.4.2013\r\n    }\r\n    EXSetFavorite(DLEntityNameForeign, DLEntityId, sDiv);\r\n}\r\nfunction EXAsXML(FK, FV) {\r\n    var aK = FK.split(',');\r\n    var aV = FV.split(',');\r\n    var s = '';\r\n    for (var i = 0; i < aK.length; i++) {\r\n        s += '<' + aK[i] + '>' + MakeXMLSafe(aV[i]) + '</' + aK[i] + '>';\r\n    }\r\n    return s;\r\n}\r\nfunction EXLazyLoadDictionaries(DLPropNames) { // 20.4.2010 - 11-0330\r\n    //alert('EXLazyLoadDictionaries(' + DLPropNames + ') started');\r\n    var s = DLPropNames.split(',');\r\n    for (var i = 0; i < s.length; i++) {\r\n        var oEle = document.getElementById(s[i]);\r\n        oEle.attachEvent('onfocus', EXhandleONFOCUS);\r\n    }\r\n}\r\nfunction EXhandleONFOCUS() {\r\n    var oEle = window.event.srcElement;\r\n    var DLPropName = oEle.id;\r\n    var xD710 = getEntityData('DL_D710', 'DL_PropName = \\'' + DLPropName + '\\'', '');\r\n    FillDropDown(DLPropName, getsafe(xD710, '//DL_PropDictionary'), getsafe(xD710, '//DL_PropCodeKey'), getsafe(xD710, '//DL_PropCodeDecode'), getsafe(xD710, '//DL_PropDictKey1'), getsafe(xD710, '//DL_PropDictValue1'), oEle.value);\r\n    //alert('FOCUS ' + oEle.id);\r\n    oEle.attachEvent('onfocus', null);\r\n}\r\nvar xEXMenuAction = null;\r\nvar aEXMenuAction;\r\nfunction EXWPMenuGet(sMenu, DLEntityNameForeign, DLEntityId, xActionExtra) { // 9.8.2011 7.8.2012 - xActionExtra added\r\n    if (typeof (xActionExtra) == 'undefined')\r\n        xActionExtra = null;\r\n    try {\r\n        var oLink = document.getElementById('MenuLink_' + sMenu);\r\n        if (oLink != null) { // 18.12.2012 - modify background color for function button\r\n            //alert(oLink.outerHTML);\r\n            oLink = oLink.parentNode.parentNode.parentNode; // TD\r\n            //alert(oLink.outerHTML);\r\n            //oLink.className = 'ms-standardheader';\r\n            oLink.style.backgroundColor = 'rgb(102,136,168)';\r\n            //oLink.style.paddingRight = '0px';\r\n            //alert(oLink.outerHTML);\r\n        }\r\n        //alert('EXWPMenuGet(' + sMenu + ',' + DLEntityNameForeign + ',' + DLEntityId + ',' + xActionExtra + ') started');\r\n        if (xEXMenuAction == null) {\r\n            xEXMenuAction = getEntityData2('DL_Id,DL_Tooltip,DL_Action,DL_EntityNameForeign,DL_TableIcon', 'DL_Action', 'DL_EntityNameForeign LIKE \\'EXMenu%\\'', 'DL_EntityNameForeign,DL_SequenceNo');\r\n            aEXMenuAction = new Array();\r\n        }\r\n\r\n        if (typeof aEXMenuAction == 'undefined') // 14.8.2011 - as used several places\r\n            aEXMenuAction = new Array();\r\n\r\n        //if (typeof aEXMenuAction[sMenu] == 'undefined') {\r\n        if (xActionExtra != null) { // 7.8.2012 - workflow actions\r\n            var xNodes = xEXMenuAction.selectNodes('//DL_Action[DL_EntityNameForeign=\\'' + sMenu + '\\']');\r\n            oMenu = new Array();\r\n            EXWPMenuCreate(oMenu, xNodes, DLEntityNameForeign, DLEntityId, false);\r\n            var o = {};\r\n            o = $.contextMenu.separator;\r\n            oMenu.push(o);\r\n            if (typeof (xActionExtra) == 'string') { // 10.10.2012 - used in MyBookmarks\r\n                xNodes = xEXMenuAction.selectNodes('//DL_Action[DL_EntityNameForeign=\\'' + xActionExtra + '\\']');\r\n                EXWPMenuCreate(oMenu, xNodes, DLEntityNameForeign, DLEntityId, false);\r\n            }\r\n            else {\r\n                xNodes = xActionExtra.selectNodes('//DL_WFCaseTypeAction');\r\n                EXWPMenuCreate(oMenu, xNodes, DLEntityNameForeign, DLEntityId, true);\r\n            }\r\n            return oMenu;\r\n        }\r\n        if (typeof aEXMenuAction[(sMenu + DLEntityNameForeign + DLEntityId)] == 'undefined') { // 5.9.2011 - added DLEntityNameForeign+DLEntityId\r\n            var xNodes = xEXMenuAction.selectNodes('//DL_Action[DL_EntityNameForeign=\\'' + sMenu + '\\']');\r\n            oMenu = new Array();\r\n            EXWPMenuCreate(oMenu, xNodes, DLEntityNameForeign, DLEntityId, false);\r\n            //aEXMenuAction[sMenu] = oMenu;\r\n            aEXMenuAction[(sMenu + DLEntityNameForeign + DLEntityId)] = oMenu;\r\n            //if (sMenu == 'EXMenuTask')\r\n            //alert('EXWPMenuGet - Added menu ' + sMenu + DLEntityNameForeign + DLEntityId + ' length = ' + oMenu.length);\r\n        }\r\n        //alert(sMenu + DLEntityNameForeign + DLEntityId + ' retrieved ' + aEXMenuAction[sMenu + DLEntityNameForeign + DLEntityId].length);\r\n        //return aEXMenuAction[sMenu];\r\n        return aEXMenuAction[sMenu + DLEntityNameForeign + DLEntityId];\r\n    } catch (e) {\r\n        alert('EXWPMenuGet(' + sMenu + ',' + DLEntityNameForeign + ',' + DLEntityId + ',' + xActionExtra + ') >>> ' + e.message);\r\n    }\r\n}\r\n\r\nfunction EXWPMenuCreate(oMenu, xNodes, DLEntityNameForeign, DLEntityId, bWorkflow) {\r\n    var DLId;\r\n    for (var i = 0; i < xNodes.length; i++) {\r\n        var tooltip = getsafe(xNodes[i], (bWorkflow ? '@' : '') + 'DL_Tooltip');\r\n        var DLAction = getsafe(xNodes[i], (bWorkflow ? '@' : '') + 'DL_Action');\r\n        var o = {};\r\n        var bAdd = true;\r\n        //if (tooltip == 'SEPARATOR') {\r\n        if (DLAction == 'SEPARATOR') { // 5.6.2012\r\n            o = $.contextMenu.separator;\r\n        }\r\n        else {\r\n            DLId = getsafe(xNodes[i], (bWorkflow ? '@' : '') + 'DL_Id');\r\n            img = getsafe(xNodes[i], (bWorkflow ? '@' : '') + 'DL_TableIcon');\r\n            if (img != '')\r\n                img = '/EX_Resources/gif/' + img;\r\n            bAdd = DLAction.indexOf('#') == -1;\r\n            if (!bAdd)\r\n                bAdd = DLEntityNameForeign != '' && DLEntityId != '' && DLEntityId != '0' && DLEntityId != '-1'; // 30.10.2011 + 17.5.2012\r\n            if (!bAdd)\r\n                bAdd = DLEntityNameForeign != '' && (DLAction.replace(/#DL_Entity#/g, 'ZZ').indexOf('#') == -1);\r\n            //alert(DLAction + ' bAdd=' + bAdd);\r\n            if (bAdd) {\r\n                if (tooltip == 'SEPARATOR')\r\n                    o = $.contextMenu.separator;\r\n                else {\r\n                    var fct = {};\r\n                    //fct['onclick'] = function() {EXWPMenuClick(''+DLId,''+DLEntityNameForeign,''+DLEntityId);};\r\n                    var sFct = \"EXWPMenuClick(\" + DLId + \",'\" + DLEntityNameForeign + \"','\" + DLEntityId + \"',false);\"\r\n                    if (bWorkflow)\r\n                        sFct = \"EXWPMenuClick(\" + DLId + \",'\" + DLEntityNameForeign + \"','\" + DLEntityId + \"',true);\"\r\n                    fct['onclick'] = new Function(sFct);\r\n                    fct['icon'] = img;\r\n                    o[tooltip] = fct;\r\n                }\r\n            }\r\n        }\r\n        if (bAdd)\r\n            oMenu.push(o);\r\n    }\r\n    return oMenu;\r\n}\r\nfunction EXWPMenuClick(DLId, DLEntityNameForeign, DLEntityId, bWorkflow) {\r\n    //alert('EXWPMenuClick ' + DLId + ' ' + DLEntityNameForeign + ':' + DLEntityId);\r\n    var sAction;\r\n    if (typeof (bWorkflow) == 'undefined')\r\n        bWorkflow = false;\r\n    if (bWorkflow) {\r\n        sAction = GetEntityItemValue('DL_WFCaseTypeAction', DLId, 'DL_Action');\r\n    }\r\n    else {\r\n        if (xEXMenuAction == null) // 9.8.2011 - strange xEXMenuAction turns out to be null sometimes!\r\n            sAction = GetEntityItemValue('DL_Action', DLId, 'DL_Action');\r\n        else\r\n            sAction = getsafe(xEXMenuAction, '//DL_Action[DL_Id=' + DLId + ']/DL_Action');\r\n    }\r\n    //alert('EXWPMenuClick ' + DLId + ' Action=' + sAction + ' ' + DLEntityNameForeign + ':' + DLEntityId + ',' + bWorkflow);\r\n    //alert(xEXMenuAction.xml);\r\n    sAction = sAction.replace(/#DL_Entity#/g, DLEntityNameForeign); // 18.4.2013 - global change\r\n    sAction = sAction.replace(/#DL_Id#/g, DLEntityId);\r\n    sAction = sAction.replace('javascript:', '');\r\n    try {\r\n        eval(sAction);\r\n    }\r\n    catch (e) { alert('EXWPMenuClick - Could not execute action=' + sAction + '\\n' + e.message); }\r\n}\r\nfunction EXWPMenuTest() { // 9.8.2011 - retrieves all menu's on page\r\n    var s = '';\r\n    var key;\r\n    var oTD, oTR;\r\n    oMenu = new Array();\r\n    for (key in aEXMenuAction) {\r\n        s += '\\n';\r\n\r\n        var xNodes = xEXMenuAction.selectNodes('//DL_Action[DL_EntityNameForeign=\\'' + key + '\\']');\r\n        oTD = document.getElementById(key);\r\n        oTR = oTD.parentNode;\r\n        oTD = oTR.firstChild.firstChild.firstChild.firstChild; // Get web part title SPAN\r\n        s += oTD.innerHTML + '\\n'; ;\r\n        var o1 = {}; // header\r\n        var fct1 = {};\r\n        tooltip = oTD.innerHTML;\r\n        o1[tooltip] = fct1;\r\n        oMenu.push(o1);\r\n        for (var j = 0; j < xNodes.length; j++) {\r\n            var tooltip = getsafe(xNodes[j], 'DL_Tooltip');\r\n            var o = {};\r\n            if (tooltip == 'SEPARATOR') {\r\n                o = $.contextMenu.separator;\r\n            }\r\n            else {\r\n                DLId = getsafe(xNodes[j], 'DL_Id');\r\n                img = getsafe(xNodes[j], 'DL_TableIcon');\r\n                if (img != '')\r\n                    img = '/EX_Resources/gif/' + img;\r\n                var DLAction = getsafe(xNodes[j], 'DL_Action');\r\n                var bAdd;\r\n                bAdd = DLAction.indexOf('#') == -1;\r\n                if (!bAdd)\r\n                    bAdd = DLEntityNameForeign != '' && DLEntityId != '';\r\n                if (bAdd) {\r\n                    var fct = {};\r\n                    //fct['onclick'] = function() {EXWPMenuClick(''+DLId,''+DLEntityNameForeign,''+DLEntityId);};\r\n                    var sFct = \"EXWPMenuClick(\" + DLId + \",'\" + DLEntityNameForeign + \"','\" + DLEntityId + \"');\"\r\n                    fct['onclick'] = new Function(sFct);\r\n                    fct['icon'] = img;\r\n                    o[tooltip] = fct;\r\n                }\r\n            }\r\n            oMenu.push(o);\r\n\r\n            s += '- ' + getsafe(xNodes[j], 'DL_Tooltip') + '\\n';\r\n        }\r\n        o = {};\r\n        o = $.contextMenu.separator;\r\n        oMenu.push(o);\r\n    }\r\n    var oEle = document.getElementById('EXMenuTotal');\r\n    if (oEle == null) {\r\n        var oObject = document.createElement('DIV');\r\n        oObject.id = 'EXMenuTotal';\r\n        document.body.appendChild(oObject);\r\n        oObject = null;\r\n    }\r\n    if (oMenu.length > 0) {\r\n        $('#EXMenuTotal').contextMenu(oMenu,\r\n   \t\t\t{ theme: 'vista', openOnLeftClick: true }\r\n\t\t);\r\n        $('#EXMenuTotal').click();\r\n    } else {\r\n        $('#EXMenuTotal').hide();\r\n    }\r\n    //\talert(s);\r\n}\r\nfunction EXUnknownSetDictionaries(sPropNames) { // 21.8.2011\r\n    var aPropNames = sPropNames.split(',');\r\n    var s = '';\r\n    for (var i = 0; i < aPropNames.length; i++) {\r\n        if (s != '') s += ',';\r\n        s += '\\'' + aPropNames[i] + '\\'';\r\n    }\r\n    s = 'DL_PropName in (' + s + ')';\r\n    var oD710 = getEntityData('DL_D710', s, '');\r\n    //alert(oD710.xml);\r\n    var DLPropName;\r\n    for (var i = 0; i < aPropNames.length; i++) {\r\n        DLPropName = aPropNames[i];\r\n        var oXML = oD710.selectSingleNode('//DL_D710[DL_PropName=\\'' + DLPropName + '\\']');\r\n        //alert(oXML.xml);\r\n        var oEle = document.getElementById(DLPropName);\r\n        var DLPropDictionaryExtra = getsafe(oXML, 'DL_PropDictionaryExtra');\r\n        var DLPropCodeKey = getsafe(oXML, 'DL_PropCodeKey');\r\n        var DLPropCodeDecode = getsafe(oXML, 'DL_PropCodeDecode');\r\n        var j = DLPropDictionaryExtra.indexOf('Former:');\r\n        if (j > -1) {\r\n            //alert(DLPropName + ' ' + DLPropDictionaryExtra);\r\n            var sFormer = DLPropDictionaryExtra.substr(j + 7);\r\n            //alert(sFormer);\r\n            //alert(oEle.options.length );\r\n            var sValue = oEle.options[oEle.options.length - 1].value;\r\n            //alert(sValue);\r\n            //var sValue = 'jw';\r\n            var sNewValue = GetEntityItemWhere(sFormer, DLPropCodeKey + '=\\'' + sValue + '\\'', DLPropCodeDecode);\r\n            //alert(sNewValue);\r\n            oEle.options[oEle.options.length - 1].text = sNewValue;\r\n            //oEle.options[oEle.options.length-1].style.background =  'orange';\r\n        }\r\n    }\r\n    //alert('EXUnknownSetDictionaries ' + sPropNames);\r\n}\r\nfunction EXLoadTask(DLId, DLWFCaseTypeStep, DLEntityNameForeign, DLEntityId, DLTaskType, appendparams) { // 26.7.2011 - 25.3.2012 DLTaskType added\r\n    if (DLWFCaseTypeStep != '') {\r\n        var DLAction = GetEntityItemValue('DL_WFCaseTypeStep', DLWFCaseTypeStep, 'DL_Action');\r\n        if (DLAction != '') {\r\n            //alert(DLAction);\r\n            try {\r\n                DLAction = DLAction.replace('#DL_Entity#', DLEntityNameForeign);\r\n                DLAction = DLAction.replace('#DL_Id#', DLEntityId);\r\n                eval(DLAction);\r\n            }\r\n            catch (e) { alert('Invalid action ' + DLAction + '\\n' + e.message); }\r\n            return;\r\n        }\r\n    }\r\n    if (DLTaskType == '1')\r\n        loadentity('DL_MilestoneTask', DLId, appendparams);\r\n    else if (DLTaskType == '2') // 21.5.2012 - not yet implemented - 24.7.2012 - now it should work\r\n        loadentity('DL_ApprovalTasks', DLId, appendparams);\r\n    else\r\n        loadentity('DL_Tasks', DLId, appendparams);\r\n}\r\n\r\nfunction EXLoadEvent(DLEntityName, DLId, DLWFCaseTypeStep, DLEntityNameForeign, DLEntityId, DLTaskType, DLResponsible, appendparams) { // 26.7.2011 - 25.3.2012 DLTaskType added\r\n    if (DLWFCaseTypeStep != '') {\r\n        var DLAction = GetEntityItemValue('DL_WFCaseTypeStep', DLWFCaseTypeStep, 'DL_Action');\r\n        if (DLAction != '') {\r\n            //alert(DLAction);\r\n            try {\r\n                DLAction = DLAction.replace('#DL_Entity#', DLEntityNameForeign);\r\n                DLAction = DLAction.replace('#DL_Id#', DLEntityId);\r\n                eval(DLAction);\r\n            }\r\n            catch (e) { alert('Invalid action ' + DLAction + '\\n' + e.message); }\r\n            return;\r\n        }\r\n    }\r\n    if (DLTaskType == '1')\r\n        loadentity('DL_MilestoneTask', DLId, appendparams);\r\n    else if (DLTaskType == '2') // 21.5.2012 - not yet implemented - 24.7.2012 - now it should work\r\n        loadentity('DL_ApprovalTasks', DLId, appendparams);\r\n    else {\r\n        //alert(DLEntityName + ' ' + DLResponsible + ' ' + EXEventsUser);\r\n        if (DLEntityName == 'DL_DCREventTaskPersonal' && DLResponsible != EXEventsUser && DLResponsible != '')\r\n            displayentity(DLEntityName, DLId, appendparams);\r\n        else\r\n            loadentity(DLEntityName, DLId, appendparams);\r\n    }\r\n}\r\n\r\n\r\n// 20111109 BH: Added IT_Case 2750\r\nfunction getECMVersion() {\r\n    try {\r\n        // if this is set in Exformatics_cust the version is post 6.7;\r\n        return EXECMVersion;\r\n    }\r\n    catch (e) {\r\n        // otherwise its pre 6.7\r\n        return '6.7';\r\n    }\r\n\r\n}\r\n// 21.1.2012\r\nfunction EXgetViewPortDimensions() {\r\n\r\n    var viewportwidth;\r\n    var viewportheight;   // the more standards compliant browsers (mozilla/netscape/opera/IE7) use window.innerWidth and window.innerHeight   \r\n\r\n    if (typeof window.innerWidth != 'undefined') {\r\n        viewportwidth = window.innerWidth;\r\n        viewportheight = window.innerHeight;\r\n    }\r\n    // IE6 in standards compliant mode (i.e. with a valid doctype as the first line in the document)  \r\n    else if (typeof document.documentElement != 'undefined' && typeof document.documentElement.clientWidth != 'undefined'\r\n\t\t\t\t\t\t&& document.documentElement.clientWidth != 0) {\r\n        viewportwidth = document.documentElement.clientWidth;\r\n        viewportheight = document.documentElement.clientHeight;\r\n    }\r\n    // older versions of IE   \r\n    else {\r\n        viewportwidth = document.getElementsByTagName('body')[0].clientWidth;\r\n        viewportheight = document.getElementsByTagName('body')[0].clientHeight;\r\n    }\r\n\r\n    var dim = {};\r\n    dim.width = viewportwidth;\r\n    dim.height = viewportheight;\r\n    return dim;\r\n}\r\n\r\nfunction EXsetBounded() {\r\n    try {\r\n        var qw = queryString('width');\r\n        var w;\r\n\r\n        if (typeof (qw) != 'undefined' && qw) {\r\n            w = qw;\r\n        }\r\n        else {\r\n            w = new String(EXgetViewPortDimensions().width / 5);\r\n            var ix = w.indexOf('.');\r\n\r\n            if (ix > -1) {\r\n                w = w.substring(0, ix);\r\n            }\r\n        }\r\n\r\n        $('.bounded').css('width', function () {\r\n            return w + 'px';\r\n        });\r\n    } catch (e) { }\r\n}\r\nfunction EXLoadScreenr(ITCase) {\r\n    var oIFrame = document.getElementById('ScreenrIFRAME');\r\n    if (oIFrame == null) {\r\n        oIFrame = document.createElement('IFRAME');\r\n        oIFrame.id = 'ScreenrIFRAME';\r\n        oIFrame.style.width = '200px';\r\n        oIFrame.style.height = '50px';\r\n        oIFrame.style.zIndex = '3';\r\n        oIFrame.style.position = 'absolute';\r\n        oIFrame.frameborder = 0;\r\n        document.body.appendChild(oIFrame);\r\n    }\r\n    oIFrame.src = getAbsoluteURL('/EX_Custom/Screenr.html?IT_Case=' + ITCase);\r\n}\r\nfunction EXWFShowStatistics(DLWFCaseType) {\r\n    var oXML = getEntityData('DL_WFCaseType', 'DL_Id=' + DLWFCaseType, '');\r\n    loadcontent2('/EX_Resources/EXWFPhaseStatistics.html?DL_WFCaseType=' + DLWFCaseType, getsafe(oXML, '//DL_Title'));\r\n    //loadcontent2('/EX_Resources/EXJWFStatistics.html?DL_EntityNameForeign=' + getsafe(oXML, '//DL_WFCaseEntity') + '&DL_WFCaseType=' + DLWFCaseType,getsafe(oXML, '//DL_Title'));\r\n}\r\nfunction EXDictBinaryAnd(DLPropName, DLPropDictionary, DLPropCodeKey, DLPropCodeDecode) {\r\n    var oEle = document.getElementById(DLPropName);\r\n    var sWhere = 'DL_PropName=\\'' + DLPropName + '\\'';\r\n    var xD710 = getEntityData('DL_D710', sWhere, '');\r\n    //alert(sWhere + '\\n' + xD710.xml);\r\n    var DLPropDisplayName = getsafe(xD710, '//DL_PropDisplayName');\r\n    var DLDocumentation = getsafe(xD710, '//DL_Documentation');\r\n    if (DLDocumentation == '')\r\n        DLDocumentation = getsafe(xD710, '//DL_TextBox');\r\n    //alert(DLDocumentation);\r\n    var xDict = getDictionaryData(DLPropDictionary, DLPropCodeKey, DLPropCodeDecode);\r\n    //var xDict = getEntityData2(DLPropCodeKey + ' AS DL_PropCodeKey, ' + DLPropCodeDecode + ' as DL_PropCodeDecode','DL_D760','DL_PropDictionary = \\'' + DLPropDictionary + '\\'', 'cast(DL_PropCodeKey as int)');\r\n    //alert(xDict.xml);\r\n    var xNodes = xDict.selectNodes('//DL_D760/' + DLPropDictionary);\r\n    //\tvar xNodes = xDict.selectNodes('//DL_D760');\r\n    //\talert(xNodes.length);\r\n    var sTable = '<table>';\r\n    if (DLDocumentation != '')\r\n        sTable += '<tr><td colspan=\"3\"><b>' + DLDocumentation + '</b></td></tr>';\r\n    sTable += '<tr><td/><td/><td/></tr>';\r\n    var iNodes = xNodes.length;\r\n    for (var i = 0; i < xNodes.length; i++) {\r\n        var value = 1.0 * getsafe(xNodes[i], 'DL_PropCodeKey');\r\n        //if (i == 0) alert(value + '\\n' + xNodes[i].xml);\r\n        sTable += '<tr>';\r\n        sTable += '<td><input type=\"checkbox\" onclick=\"EXDictBinaryAndModifyTotal(\\'' + DLPropName + '\\',this)\" value=\"' + value + '\"' + (oEle.value * 1.0 & value ? 'checked=true' : '') + '></td>';\r\n        sTable += '<td>' + value + '</td>';\r\n        sTable += '<td>' + getsafe(xNodes[i], 'DL_PropCodeDecode') + '</td>';\r\n        sTable += '</tr>';\r\n    }\r\n    sTable += '<tr><td>X</td><td id=\"EXDictTotal' + DLPropName + '\">' + oEle.value + '</td><td>Total</td></tr>';\r\n    sTable += '</table>';\r\n    var oDiv = document.getElementById('EXDictBinarySaveDiv');\r\n    if (oDiv == null) {\r\n        oDiv = document.createElement('DIV');\r\n        oDiv.id = 'EXDictBinarySaveDiv';\r\n        oDiv.style.display = 'None';\r\n        oDiv.style.overflow = 'auto';\r\n        document.appendChild(oDiv);\r\n    }\r\n    var iHeight = 200;\r\n    oDiv.style.height = iHeight;\r\n    oDiv.innerHTML = sTable;\r\n    $(\"#EXDictBinarySaveDiv\").dialog({\r\n        resizable: false,\r\n        height: iHeight,\r\n        width: 480,\r\n        modal: true,\r\n        title: DLPropDisplayName,\r\n        open: function (event, ui) {\r\n            //$(\"input\").val([EXDWPShowCreatedModified]);\r\n        },\r\n        buttons: {\r\n            \"OK\": function () {\r\n                var oEle = document.getElementById(DLPropName);\r\n                var oTotal = document.getElementById('EXDictTotal' + DLPropName);\r\n                oEle.value = oTotal.innerHTML;\r\n                $(this).dialog(\"close\");\r\n            },\r\n            Cancel: function () {\r\n                $(this).dialog(\"close\");\r\n            }\r\n        }\r\n    });\r\n}\r\nfunction EXDictBinaryAndModifyTotal(DLPropName, oEle) {\r\n    var oTotal = document.getElementById('EXDictTotal' + DLPropName);\r\n    if (oEle.checked)\r\n        oTotal.innerHTML = 1.0 * oTotal.innerHTML + 1.0 * oEle.value;\r\n    else\r\n        oTotal.innerHTML = 1.0 * oTotal.innerHTML - 1.0 * oEle.value;\r\n}\r\n\r\nfunction EXWPHeaderAdd(sTitle, sWPMenu) { // 17.4.2013 added\r\n    var s = '';\r\n    s += '<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tr class=\"ms-WPHeader\"><td style=\"width:100%;\"><h3 class=\"ms-standardheader ms-WPTitle\"><nobr><span>' + sTitle + '</span></nobr></h3></td><td align=\"right\" style=\"padding-right:2px\" id=\"' + sWPMenu + '\">';\r\n    s += '<div style=\"cursor: pointer\" class=\"ms-HoverCellInActive\" onMouseOut=\"this.className=\\'ms-HoverCellInActive\\'\" onMouseOver=\"this.className=\\'ms-HoverCellActiveDark\\'\">';\r\n    s += '    <nobr>';\r\n    s += '\t\t\t<a id=\"MenuLink_' + sWPMenu + '\">';\r\n    s += '            <div class=\"menubutton\">&nbsp;</div>';\r\n    s += '          </a>';\r\n    s += '        </nobr>';\r\n    s += '      </div>';\r\n    s += '</td></tr></table>';\r\n    return s;\r\n}\r\n\r\n//Setting Columns Width\r\ntry {\r\n    $(document).ready(function () {\r\n        if (window.location.href == 'http://intranet/Development/Pages/Forside.aspx')\r\n            return;\r\n        var columns = $('td[id$=\"_invisibleIfEmpty\"][name$=\"_invisibleIfEmpty\"][valign$=\"top\"][height$=\"100%\"]');\r\n        if (columns.length == 0) {\r\n            //FOR SP2013\t\t\r\n            columns = $('.cell-margin.tableCol-33');\r\n        }\r\n        if (columns.length >= 3) {\r\n            $(columns).each(function (index) {\r\n                if (index == 0) {\r\n                    //                $(this).attr(\"style\", \"width: 30%;\");\r\n                    $(this).attr(\"style\", \"width: 23%;\");\r\n                }\r\n                else if (index == 1) {\r\n                    //$(this).attr(\"style\", \"width: 40%; padding: 0px 10px\");\r\n\t\t\t\t\t$(this).attr(\"style\", \"width: 40%; padding: 0px 10px\");\r\n                }\r\n                else if (index == 2) {\r\n\t\t\t\t\t$(this).attr(\"style\", \"width: 34%;\");\r\n                }\r\n            });\r\n        }\r\n\t\t\r\n\t\t//Changes for showing left panel on administration pages\r\n\t\tvar currentPageUrl = window.location.href.split('?')[0];\r\n\t\tif(currentPageUrl.indexOf(\"/_layouts/\") > -1){\r\n\t\t\t$(\"#sideNavBox\").css(\"display\", \"block\");\r\n\t\t\t$(\"#contentBox\").css(\"float\", \"left\");\r\n\t\t}\r\n\r\n        // Hide menus for notifications or tag cloud if user clicked in documnet outside ActivityStream iframe\r\n        $(document).on('click', function (e) {\r\n            if ($('iframe#DL_Information').length > 0) {\r\n                $('iframe#DL_Information').contents().find(\".comment-menu, .divCornerDD\").hide(\"\");\r\n            }\r\n        });\t\t\t\r\n    });\r\n} catch (e) { }\r\n\r\nfunction EXWFDCRGraphOpenInstance(DLWFCaseType, DLEntityNameForeign, DLEntityId) {\r\n    var oXML = getEntityData('DL_WFCaseTypeObject', 'DL_WFCaseType=' + DLWFCaseType + ' AND DL_EntityNameForeign = \\'' + DLEntityNameForeign + '\\' AND DL_EntityId = ' + DLEntityId, '');\r\n    var DLId = getsafe(oXML, '//DL_Id');\r\n    if (DLId == '') {\r\n        alert('Not a Dynamic Condition Response Workflow');\r\n        return;\r\n    }\r\n    var cmdShell = new ActiveXObject(\"WScript.Shell\");\r\n    //\tvar Path = \"C:\\\\Program Files\\\\Exformatics\\\\DCR Modeling Tool\\\\DCRGraphsEditor.exe\";\r\n    var Path = \"C:\\\\Exformatics\\\\DCR Modeling Tool\\\\DCRGraphsEditor.exe\";\r\n    Path += \" DL_WFCaseTypeObject \" + DLId;\r\n    try {\r\n        cmdShell.Run(Path, 1, true);\r\n    } catch (e) {\r\n        alert('Cannot run ' + Path + '\\n' + e.message);\r\n    }\r\n}\r\nfunction CreateOverlay(){\r\n\t\r\n\tif($(\"#exf-overlay\").length){\r\n\t}\r\n\telse{\t\t\r\n\t\tif ( self !== top ) {\r\n\t\t\twindow.parent.CreateOverlay();\r\n\t\t\treturn;\t\t\r\n\t\t}\r\n\t\telse{\r\n\t\t\t$overlayContainer = $(\"body\");\t\r\n\t\t}\r\n\t\t$overlayContainer.prepend(\"<div id='exf-overlay'><img src='/EX_RESOURCES/IMG/loading2.gif' id='img-loading' /></div>\");\r\n\t}\r\n\r\n\t$(\"#exf-overlay\").css({\r\n\t  opacity : 0.5,\r\n\t  top     : $overlayContainer.offset().top,\r\n\t  width   : $overlayContainer.outerWidth(),\r\n\t  height  : $overlayContainer.outerHeight()\r\n\t});\r\n\r\n\t$(\"#img-loading\").css({\r\n\t  top  : ($overlayContainer.height() / 2),\r\n\t  left : ($overlayContainer.width() / 2)\r\n\t});\r\n\t\r\n\t$(\"#exf-overlay\").fadeIn();\r\n}\r\nfunction ExformaticsMovePost(DL_Id, DL_Entity) {\r\n    if (queryString(DL_Entity, true) == DL_Id) {\r\n        alert('This post is already in the selected entity');\r\n        return false;\r\n    }\r\n    var commentId;\r\n    if (typeof ($(\"#commentId\", parent.document.body).val()) != 'undefined') {\r\n        commentId = $(\"#commentId\", parent.document.body).val();\r\n    }\r\n    else if (typeof (window.parent.$('iframe[name=DL_Information]').last().contents().find(\"#commentId\").val()) != 'undefined') {\r\n        commentId = window.parent.$('iframe[name=DL_Information]').last().contents().find(\"#commentId\").val();\r\n    }\r\n    //else if (typeof (window.parent.$('#DL_Information').contents().find(\"#commentId\").val()) != 'undefined') {\r\n    //    commentId = window.parent.$('#DL_Information').contents().find(\"#commentId\").val();\r\n    //}\r\n    else {\r\n        commentId = $('#DL_Information').contents().find(\"#commentId\").val();\r\n    }\r\n\r\n    //UPDATE DL_Exformation SET DL_EntityId = $DL_Id, DL_EntityNameForeign = '$DL_Entity' WHERE DL_ID = $commentId\r\n    var xOps = '<DL_Exformation><DELETE/><UPDATE><row><DL_Id>' + commentId + '</DL_Id><DL_EntityId>' + DL_Id + '</DL_EntityId><DL_EntityNameForeign>' + DL_Entity + '</DL_EntityNameForeign></row></UPDATE></DL_Exformation>';\r\n    setEntity('DL_Exformation', xOps); // setEntity handles SQL query and is defined in this function\r\n    // remove post from current stream\r\n    if (typeof ($(\"#commentId\", parent.document.body).val()) != 'undefined') {\r\n        $(\"#\" + commentId, parent.document.body).remove();\r\n    }\r\n//    else if (typeof (window.parent.$('#DL_Information').contents().find(\"#commentId\").val()) != 'undefined') {\r\n//        window.parent.$('#DL_Information').contents().find(\"#\" + commentId).remove();\r\n    //    }\r\n    else if (typeof (window.parent.$('iframe[name=DL_Information]').last().contents().find(\"#commentId\").val()) != 'undefined') {\r\n        window.parent.$('iframe[name=DL_Information]').last().contents().find(\"#\" + commentId).remove();\r\n    }\r\n    else {\r\n        $('#DL_Information').contents().find(\"#\" + commentId).remove();\r\n    }\r\n\r\n    alert('The post has been moved to the selected Entity');\r\n    // This will close Dialog\r\n    parent.$(\".no-close\", window.parent.document).remove();\r\n    return false;\r\n}\r\n\r\nfunction resizeIframe(obj) {\r\n    try {\r\n        obj.style.height = obj.contentWindow.document.body.scrollHeight + 'px';\r\n    }\r\n    catch (err) {\r\n        //TODO\r\n    }\r\n}\r\nfunction EXAddCaseLink(DLEntityNameForeign, DLEntityId) { // 11.4.2016 - added by MMQ\r\n    var sLink = window.clipboardData.getData('Text');\r\n    if (sLink.indexOf('http') == 0) {\r\n        var sXml = '<a><DL_EntityNameForeign>' + DLEntityNameForeign + '</DL_EntityNameForeign><DL_EntityId>' + DLEntityId + '</DL_EntityId>';\r\n        sXml += '<DL_URLDocument>' + MakeXMLSafe(sLink) + '</DL_URLDocument>';\r\n        var sTitle = 'title';\r\n        var objXMLHTTP = EXXMLHTTP();\r\n        objXMLHTTP.open('get', sLink, false);\r\n        objXMLHTTP.send();\r\n        var content = objXMLHTTP.responseText;\r\n        var re_title = new RegExp(\"<title>[\\n\\r\\s]*(.*)[\\n\\r\\s]*</title>\", \"gmi\");\r\n        sTitle = re_title.exec(content);\r\n        objXMLHTTP = null;\r\n        if (sTitle == null || sTitle == '')\r\n            sTitle = 'Please enter title';\r\n        sXml += '<DL_Title>' + MakeXMLSafe(sTitle) + '</DL_Title>';\r\n        sXml += '</a>';\r\n        var DLId = setEntityDetail('DL_CaseLink', sXml);\r\n        loadentity('DL_CaseLink', DLId);\r\n    }\r\n    else\r\n        newentity('DL_CaseLink', 'DL_EntityNameForeign,DL_EntityId', DLEntityNameForeign + ',' + DLEntityId);\r\n}\r\nfunction EXWFOpenCasesExcel(DLWFCaseType) {\r\n    var oXML = getEntityData('DL_WFCaseType', 'DL_Id=' + DLWFCaseType, '');\r\n    var sEntity;\r\n    var DLWFCaseEntity = getsafe(oXML, '//DL_WFCaseEntity');\r\n    var DLWFCaseEntityData = getsafe(oXML, '//DL_WFCaseEntityData');\r\n    sEntity = DLWFCaseEntity;\r\n    if (DLWFCaseEntityData != '')\r\n        sEntity += 'WF' + DLWFCaseEntityData;\r\n\r\n    loadentityexcel(sEntity, '', 'DL_CaseState', '0', 'DL_WFCaseType', '' + DLWFCaseType, '');\r\n}\r\n\r\n//alert('exformatics.js loaded');\r\n"},KF6U:function(t,e){t.exports=function(t){"undefined"!=typeof execScript?execScript(t):eval.call(null,t)}},Q4jN:function(t,e){t.exports="/********************************************************************\r\n *                                                                  *\r\n * Exformatics SharePoint 2007 javascript functions                 *\r\n *                                                                  *\r\n *  New document                                                    *\r\n *                                                                  *\r\n * Copyright (c) Exformatics.  All rights reserved.                 *\r\n *                                                                  *\r\n ********************************************************************/\r\n// exnewdocument.js\r\n\r\n// Change log\r\n// Date        User  Description\r\n// ==========  ====  =================================================================\r\n// 01-02-2008  mmq   FKIL modifications retrieved. %0% in DL_FolderParams\r\n// 09-04-2008  mmq   Ikon �ndret: Add user 3.gif';\r\n// 25-06-2008  mmq   Function EXOnopen DL_FullName --\x3e DL_Name\t\r\n// 15-08-2008  mmq   Modtager feltet vises ikke hvis der ikke er nogle modtagere\r\n// 18-08-2008  mmq   Plads mellem drop down, HENT og pick ikon\r\n// 06-09-2008  mmq   DL_TemplateType 4:Project now handled\r\n// 06-09-2008  mmq   Standardized code. Now uses Exformatics.js functions rather than inline\r\n// 20-11-2008  mmq   Web part converted to HTML page\r\n// 31-03-2009  mmq   Extra properties handled - see EXNewDocument.html\r\n// 07-10-2009  mmq   Sat op hos LO - mindre fejl rettet her - sPDFId\r\n// 21-11-2009  mmq   EXCreateDocTest modified\r\n// 20-12-2009  mmq   Obligatoriske meta-data\r\n// 16-05-2010  mmq   EXXMLHTTP new function used instead of new ActiveXObject(\"MSXML2.XMLHTTP.3.0\")\r\n// 21-03-2012  mmq   IT Case 3067 - use SQL sp rather than DL_D610StandardLetterView - new procedure is [EXEntityGetStandardLetters]\r\n// 17-05-2012  mmq   12-0598 - if any OpenXML phrases exists - include that in EXDOC xml\r\n// 04-12-2012  mmq   fixdefsave fixed\r\n// 07-01-2013  mmq   Logic for handling DL_StandardLetterCreateAction added\r\n// 17-01-2013  mmq   EXProps logic updated\r\n// 06-08-2013  mmq   EXProps logic - minor bug fix\r\n// 20-11-2015  mmq   Prefix logic\r\n\r\nvar oEXndforminit;\r\nvar oEXndFeedbackHTTP; // 16.5.2010\r\nfunction EXCreateDocTest(DL_Entity, template, defsaveGeneric, oentityview,DLStandardLetter) {\r\n\tvar DL_Id = GetRecentValue(DL_Entity);\r\n\tEXCreateDoc(DL_Entity, DL_Id, template, defsaveGeneric, oentityview, '','','',DLStandardLetter);\r\n}\r\nvar oEXTemplateEntity, oEXTemplateQueryParam;\r\nvar bEXTemplateHTML; // 20.11.2008\r\nfunction EXCreateDoc(newGroup1,DL_Entity, DL_Id, template, defsaveGeneric, oentityview, oXMLOperation,group,sPDFId,DLStandardLetter,DLFileName,DLFolderParams) { // 19.10.2009 - DLStandardLetter added // 7.4.2011 DLFileName added 17.5.2012 - DLFolderParams added\r\ntry {\r\n\tvar sDocNo = '';\r\n\tif (EXECMCustomFileName==1) { // 20.11.2015\r\n\t\tvar oF = document.getElementById('FileName');\r\n\t\tif (oF.value == '') {\r\n\t\t\toF.focus();\r\n\t\t\talert('Filename is mandatory');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tDLFileName = oF.value;\r\n\t\tvar x = ExecuteProcedure('EXGetNextDocNo @DLEntityId='+DL_Id+',@DLEntityNameForeign=\\''+DL_Entity+'\\',@Update=1');\r\n\t\tsDocNo = getsafe(x,'//FileName');\r\n\t\tDLFileName = sDocNo + DLFileName;\r\n        /* 1.3.2016 - IT Case 5869 - AddIn 7.6 already adds extra \"docx\"\r\n\t\tif (newGroup1 == '1') // Word\r\n\t\t\tDLFileName += '.docx';\r\n\t\telse if (newGroup1 == '2') // Excel\r\n\t\t\tDLFileName += '.xlsx';\r\n\t\telse if (newGroup1 == '3') // Powerpoint\r\n\t\t\tDLFileName += '.pptx';\r\n\t\t*/\r\n\t}\r\n\tvar DLStandardLetterCreateAction = ''; // 7.1.2013\r\n\tif (typeof(DLFolderParams) == 'undefined')\r\n\t\tDLFolderParams = '';\r\n\tif (typeof(DLStandardLetter) == 'undefined')\r\n\t\tDLStandardLetter = '';\r\n\tif (typeof(group) == 'undefined') // 21.9.2009 - new paramter - 5=PDF\r\n\t\tgroup = '';\r\n\tif (typeof(DLFileName) == 'undefined') // 5.8.2011 - bugfix\r\n\t\tDLFileName = '';\r\n\r\n//defsaveGeneric = 'C:\\\\debug\\\\';\r\n//alert(\"EXCreateDoc(\" + DL_Entity + \",\" + DL_Id + \",\" + template + \",\" + defsaveGeneric + \",\" + oentityview + \",\" + group + \",\" + DLStandardLetter + \",\" + DLFileName + \")\");\r\n\tif (typeof(sExtraProps) == 'undefined')\r\n\t\tsExtraProps = '';\r\n\tvar oEX;\r\n\tif (oentityview == null) {\r\n\t\toentityview = DL_Entity;\r\n\t}\r\n\tif (oentityview == '') {\r\n\toentityview = DL_Entity;\r\n\t}\r\n\toEX = '<EXDOC><DL_Entity>' + DL_Entity + '</DL_Entity><DL_Id>' + DL_Id + '</DL_Id><DL_EntityOrViewName>' + oentityview + '</DL_EntityOrViewName>';\r\n//alert(\"EXCreateDoc(\" + DL_Entity + \",\" + DL_Id + \",\" + template + \",\" + defsaveGeneric + \",\" + oentityview + \",\" + group + \",\" + DLStandardLetter + \",\" + DLFileName + \",\" + DLFolderParams + \")\");\r\n//return;\r\n\tif (DLStandardLetter != '')\r\n\t\toEX += '<DL_StandardLetter>' + DLStandardLetter + '</DL_StandardLetter><DL_TemplateFile>'+ template + '</DL_TemplateFile>';\r\n//alert(oEX);\r\n//return;\r\n\r\n\tif (DLStandardLetter != '') { // 17.5.2012 - any OpenXML phrases\r\n\t\tvar oCount = getEntityData2('count(*) as Count','DL_StandardLetterPhraseView','DL_StandardLetter = ' + DLStandardLetter + ' AND DL_PhraseType = 10','');\r\n\t\tif (getsafe(oCount, '//Count') != 0) {\r\n\t\t\toEX += EXAddPhases(DLStandardLetter, DL_Entity, DL_Id);\r\n\t\t}\r\n\r\n\t}\r\n//alert('done');\r\n//return;\r\n\tif (oXMLOperation != '')\r\n\t\toEX = oEX + '<DL_XMLOperation>' + oXMLOperation + '</DL_XMLOperation>';\r\n\tvar oProps = document.getElementById('EXProps');\r\n\tif (oProps != null) // 17.1.2013\r\n\t\tif (oProps.value == '')\r\n\t\t\toProps = null;\r\n\tif (oProps == null) { // 31.3.2009\r\n\t\tif (sExtraProps != '') {\r\n\t\t\tfor (var i=0;i<sExtraProps.split(',').length;i++) { // 20.12.2009 - obligatoriske meta-data skal v�re udfyldt\r\n\t\t\t\tif (sPropMandatory.split(',')[i] == '1') {\r\n\t\t\t\t\tvar DLPropName = sExtraProps.split(',')[i];\r\n\t\t\t\t\tvar oEle = document.getElementById('sExtra' + DLPropName);\r\n\t\t\t\t\tif (oEle.value == '') {\r\n\t\t\t\t\t\talert('Feltet ' + sSPSPropDisplayNames.split(',')[i] + ' er obligatorisk.');\r\n\t\t\t\t\t\toEle.focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tsEXProps = '';\r\n\t\t\tfor (var i=0;i<sExtraProps.split(',').length;i++) {\r\n\t\t\t\tvar DLPropName = sExtraProps.split(',')[i];\r\n\t\t\t\tvar SPSPropName = sSPSPropNames.split(',')[i];\r\n\t\t\t\tvar oEle = document.getElementById('sExtra' + DLPropName);\r\n\t\t\t\tif (oEle.value != '') {\r\n\t\t\t\t\tsEXProps += '<' + SPSPropName + '>' + oEle.value + '</' + SPSPropName + '>';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (sEXProps != '') {\r\n\t\t\t\toEX += '<EXProps>' + sEXProps + getDocNoProp(sDocNo) + '</EXProps>';\r\n\t\t\t}\r\n//alert('DEBUG\\n' + oEX);\r\n//return;\r\n\t\t}\r\n\t\telse if (sDocNo != '') // 24.11.2015\r\n\t\t\toEX += '<EXProps>' + getDocNoProp(sDocNo) + '</EXProps>';\r\n\t}\r\n\telse {\r\n\t\tif (oProps.value != '') { // 6.8.2013 . minor bug\r\n\t\t\t//oEX = oEX + '<EXProps>' + MakeXMLSafe(oProps.value) + '</EXProps>';\r\n\t\t\toEX = oEX + '<EXProps>' + oProps.value + getDocNoProp(sDocNo) + '</EXProps>'; // 17.1.2013 - removed MakeXMLSafe\r\n\t\t}\r\n\t}\r\n\t// 7.4.2011 code moved up\r\n\tvar objNewDocs;\r\n\tobjNewDocs = null;\r\n\tvar defsave;\r\n\tif (DLFolderParams == '')\r\n\t\tFolderParams = queryString('DL_FolderParams',bEXTemplateHTML);\r\n\telse\r\n\t\tFolderParams = DLFolderParams;\r\n\tif (FolderParams == '') {\r\n\t\tvar oXML =  getEntityData(DL_Entity, 'DL_Id = ' + DL_Id, '');\r\n\t\tFolderParams = getsafe(oXML, '//DL_FolderParams');\r\n\t}\r\n\tdefsaveGeneric = EXFixGenericPath(defsaveGeneric, FolderParams);\r\n\tdefsave = defsaveGeneric;\r\n\tif (defsaveGeneric.indexOf('%')>=0) {\r\n\t\tdefsave=defsaveGeneric.replace('%DL_Id%',DL_Id);\r\n\t\tif (defsave.indexOf('%') >= 0) {\r\n\t\t\tdefsave = FixDefSave(DL_Entity, DL_Id, defsave);\r\n\t\t}\r\n\t}\r\n\r\n\toProps = document.getElementById('EXAuthor');\r\n\tvar EXAuthor = '%DL_sAMAccountName%';\r\n\tif (oProps != null)\r\n\t\tif (oProps.value != '')\r\n\t\t\tEXAuthor = oProps.value;\r\n\toEX = oEX + '<EXAuthor>' + EXAuthor + '</EXAuthor>';\r\n\tif (DLFileName != '') { // 7.4.2011\r\n\t\tif (DLFileName.indexOf('%')>=0)\r\n\t\t\tDLFileName = FixDefSave(DL_Entity, DL_Id, DLFileName);\r\n\t\toEX = oEX + '<SaveWhenCreated>' + MakeXMLSafe(defsave + '/' + DLFileName) + '</SaveWhenCreated>';\r\n\t\tif (DLStandardLetter != '') {\r\n\t\t\tDLStandardLetterCreateAction = GetEntityItemValue('DL_StandardLetter',DLStandardLetter,'DL_StandardLetterCreateAction');\r\n\t\t}\r\n\r\n\t}\r\n//alert(defsave + '/' + DLFileName);\r\n//return;\r\n\toProps = document.getElementById('DLCaseAddress');\r\n\tif (oProps != null)\r\n\t\tif (oProps.value != '') {\r\n\t\t\toEX = oEX + '<DLCaseAddress>' + oProps.value +  '</DLCaseAddress>';\r\n\t\t}\r\n\toEX = oEX + '</EXDOC>';\r\n\t// 23.5.2012 - remove\r\n\t//SetRecentValue('EXDOC', oEX);\r\n\tsetRecentValueXML('EXDOC', oEX); // 8.12.2010\r\n//alert(oEX);\r\n//return;\r\n\tif (group == 5) { // 21.9.2009\r\n\t\tvar oPDF = document.getElementById('PDF' + sPDFId);\r\n\t\toPDF.style.display = 'none';\r\n\t\tvar oInput = document.getElementById('PDFName' + sPDFId);\r\n\t\tvar sFileName = oInput.value;\r\n\t\tif (sFileName == '')\r\n\t\t\treturn;\r\n\t\tsFileName += '.pdf';\r\n\t\tdefsave = defsave + '/' + sFileName;\r\n//alert('SPSNewDocument(' + defsave + '.' + template + ') started');\r\n//return;\r\n\t\tSPSNewDocument(defsave, template);\r\n\t\tparent.EXDWPRefresh();\r\n\t\twindow.open(defsave);\r\n\t\treturn;\r\n\t}\r\n  //alert('Template ' + template + ' Default save location ' + defsave)\r\n\ttry {\r\n//    alert('now invoke CreateDocument(' + template + ',' + defsave + ')');\r\n    //CreateDocument(template, defsafe);\r\n\t\tCreateDocument(template, defsave); // 19.9.2008 - utroligt at denne fejl har eksisteret s� l�nge!!!\r\n\t\tEXDocPostCreateAction(DLStandardLetterCreateAction, defsave + '/' + DLFileName, DL_Entity, DL_Id); // 7.1.2013\r\n\t\tif (EXECMCustomFileName==1) { // 24.11.2015 - reload \r\n\t\t\tEXNewDocumentInit();\r\n\t\t\tparent.EXDWPRefresh();\r\n\t\t}\r\n\t\treturn;\r\n\t}\r\n\tcatch (e) {/*alert(\"SharePoint.OpenDocuments.2 fails\");*/};\r\n\ttry {\r\n\t\tobjNewDocs = new ActiveXObject('SharePoint.OpenDocuments.3');\r\n\t\tobjNewDocs.CreateNewDocument(template, defsave);\r\n\t\tEXDocPostCreateAction(DLStandardLetterCreateAction, defsave + '/' + DLFileName, DL_Entity, DL_Id); // 7.1.2013\r\n\t\tif (EXECMCustomFileName==1) { // 24.11.2015 - reload \r\n\t\t\tEXNewDocumentInit();\r\n\t\t\tparent.EXDWPRefresh();\r\n\t\t}\r\n\t\treturn;\r\n\t}\r\n\tcatch (e) {alert(e.message);};\r\n\ttry {\r\n\t\tobjNewDocs = new ActiveXObject('SharePoint.OpenDocuments.2');\r\n\t\tobjNewDocs.CreateNewDocument(template, defsave);\r\n\t\tEXDocPostCreateAction(DLStandardLetterCreateAction, defsave + '/' + DLFileName, DL_Entity, DL_Id); // 7.1.2013\r\n\t\tif (EXECMCustomFileName==1) { // 24.11.2015 - reload \r\n\t\t\tEXNewDocumentInit();\r\n\t\t\tparent.EXDWPRefresh();\r\n\t\t}\r\n\t\treturn;\r\n\t}\r\n\tcatch (e) {alert(\"EXCreateDoc - SharePoint.OpenDocuments.2 fails\");};\r\n}\r\ncatch (e) {alert(\"EXCreateDoc - failed \" + e.message);};\r\n}\r\nfunction getDocNoProp(sDocNo) { // 24.11.2015 - dDocNo QuickPart added if created this way - should also be done in Office AddIn - we cannot do this if uploading documents\r\n\tif (sDocNo == '') return '';\r\n\tsDocNo = '<dDocNo>'+sDocNo.substr(0,sDocNo.length-1)+'</dDocNo>';\r\n\treturn sDocNo;\r\n}\r\nfunction EXDocPostCreateAction(DLStandardLetterCreateAction, url, DLEntity, DLId) { // 7.1.2013\r\n\tvar sAction = \"_EXDocPostCreateAction(\"+DLStandardLetterCreateAction+\",'\"+url+\"','\"+DLEntity+\"',\"+DLId+\")\";\r\n//alert(sAction);\r\n\tsetTimeout(sAction, 15000); // 15 seconds for document to be created and saved\r\n}\r\nfunction _EXDocPostCreateAction(DLStandardLetterCreateAction, url, DLEntity, DLId) { // 7.1.2013\r\n//alert('_EXDocPostCreateAction(' + DLStandardLetterCreateAction + ', ' + url + ', ' + DLEntity + ', ' + DLId + ') started');\r\n\tif (DLStandardLetterCreateAction == '')\r\n\t\treturn;\r\n\tvar i;\r\n\tif (url.indexOf('http') == 0) { // https:// - 8 - remove HTTP prefix\r\n\t\ti = url.substr(8).indexOf('/');\r\n\t\turl = url.substr(8+i);\r\n\t}\r\n\tvar xDoc = getEntityData2('TOP 1 *','DL_Documents','DL_URLDocument = \\'' + url + '\\'', 'DL_Id desc');\r\n\tif (getsafe(xDoc, '//DL_Id') != '') {\r\n//alert(xDoc.xml);\r\n\t\tif (DLStandardLetterCreateAction == '10') { // Add document to basket\r\n\t\t\tvar EXDocumentID = getsafe(xDoc,'//DL_DocumentId');\r\n\t\t\ti = url.lastIndexOf('/');\r\n\t\t\tvar Title = url.substr(i+1);\r\n\t\t\ti = Title.lastIndexOf('.');\r\n\t\t\tif (i>0)\r\n\t\t\t\tTitle = Title.substr(0,i);\r\n\t\t\t_EXAddDocumentToTransmittal(false, 'DL_sAMAccountName', 0, EXDocumentID, Title, getAbsoluteURL(url), true, '', '',0, null);\r\n\t\t}\r\n\t\telse if (DLStandardLetterCreateAction == '20') { // Set DL_URLDocument on business object\r\n\t\t\tvar xObject = getEntityData(DLEntity,'DL_Id='+DLId,'');\r\n\t\t\tif (getsafe(xObject,'//DL_Id') == DLId) {\r\n\t\t\t\tSetEntityItemValue(DLEntity,DLId,getsafe(xObject,'//DL_Modified'),'DL_URLDocument',getAbsoluteURL(url));\r\n\t\t\t}\r\n\t\t}\r\n\t\tEXReload();\r\n\t}\r\n}\r\n\r\nfunction EXAddPhases(DLStandardLetter, DL_Entity, DL_Id) { // 17.5.2012\r\n\tvar oXML = getEntityData('DL_StandardLetterPhraseView','DL_StandardLetter = ' + DLStandardLetter,'DL_Bookmark,DL_SequenceNo');\r\n\tvar xNodes = oXML.selectNodes('//DL_StandardLetterPhraseView');\r\n\tvar sWhere = '';\r\n\tfor (var i=0;i<xNodes.length;i++) {\r\n\t\tif (sWhere != '') sWhere += ',';\r\n\t\tsWhere += getsafe(xNodes[i],'DL_Phrase');\r\n\t}\r\n\tsWhere = 'DL_Id in (' + sWhere + ')';\r\n\tvar xPhrases = getEntityData('DL_Phrase',sWhere, '');\r\n\tvar xPhrase;\r\n\tvar sXML = '<Phrases>';\r\n\tfor (var i=0;i<xNodes.length;i++) {\r\n\t\tvar DLId = getsafe(xNodes[i],'DL_Phrase');\r\n\t\tif (getsafe(xNodes[i], 'DL_PhraseType') == '10') { // OpenXML\r\n\t\t\tsXML += '<Phrase Type=\"XML\" Bookmark=\"' + getsafe(xNodes[i], 'DL_Bookmark') + '\">';\t\r\n\t\t\txPhrase = xPhrases.selectSingleNode('//DL_Phrase[DL_Id=' + DLId + ']');\r\n\t\t\tvar sSQLSP = getsafe(xPhrase, 'DL_OpenXMLSQLSP');\r\n//sSQLSP = 'X';\r\n\t\t\tif (sSQLSP != '') {\r\n\t\t\t\tsSQLSP = sSQLSP.replace('%DL_EntityNameForeign%', DL_Entity);\r\n\t\t\t\tsSQLSP = sSQLSP.replace('%DL_EntityId%', DL_Id);\r\n\t\t\t\t//alert(sSQLSP);\r\n//sSQLSP = 'dbo.EXSysTemplateGetChangeLogBullet @AssemblyVersion=\\'6.9.101\\'';\r\n\t\t\t\tvar xOpenXML = ExecuteProcedure(sSQLSP); //.selectSingleNode('//ExecuteProcedureResult').childNodes[0];\r\n//alert(xOpenXML.xml);\r\nvar xOpenXML1 = xOpenXML.selectSingleNode('//OpenXML');\r\n//alert(xOpenXML);\r\n\t\t\t\tif (xOpenXML1 == null) {\r\n\t\t\t\t\t// 20.11.2013 - text nodes\r\nvar xNodesX = xOpenXML.selectNodes('//row/data');\r\nvar s1 = '';\r\nfor (var jj=0;jj<xNodesX.length;jj++)\r\ns1 += xNodesX[jj].text;\r\n//alert(s1);\r\nsetRecentValueXML('ABC','<a>' + s1 + '</a>');\r\n//EXCopyToClipboard(s1);\r\n//\t\t\t\t\tsXML += s1;\r\n\t\t\t\t\tsXML += '<OpenXML>' + s1 + '</OpenXML>';\r\n//\t\t\t\t\tsXML += '<OpenXML />';\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t\tsXML += xOpenXML1.xml;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\tsXML += '<OpenXML />';\r\n\t\t\tsXML += '</Phrase>';\r\n//alert(sXML);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tsXML += '<Phrase ID=\"' + DLId + '\" Bookmark=\"' + getsafe(xNodes[i], 'DL_Bookmark') + '\" URL=\"' + getsafe(xNodes[i], 'DL_URLDocument') + '\" />';\t\r\n\t\t}\r\n\t}\r\n\tsXML += '</Phrases>';\r\n//alert('EXAddPhrases - Phrases retrieved\\n' + sXML);\r\n\treturn sXML;\r\n}\r\nfunction FixDefSave(DL_Entity, DL_Id, defsave) {\r\n\tvar oXML = getEntityData(DL_Entity,'DL_Id = ' + DL_Id, '');\r\n\ttry { // Replace all %<name>% with real value from xmlResponse!\r\n\t\tvar i, j, XPath;\r\n\t\ti = defsave.indexOf('%');\r\n\t\twhile (i > -1) {\r\n\t\t\tj = defsave.substr(i+1).indexOf('%') + i + 1;\r\n\t\t\tXPath = defsave.substring(i + 1, j);\r\n\t\t\tvar v = getsafe(oXML, '//' + XPath);\r\n//alert(XPath + '=' + v + '\\n' + oXML.xml);\r\n\t\t\tdefsave = defsave.replace('%' + XPath + '%', v);\r\n\t\t\ti = defsave.indexOf('%');\r\n//alert(defsave + ' i=' + i);\r\n\t\t}\r\n    //alert(defsave);\r\n\t} catch (e) {alert('FixDefSave2 ' + defsave + ' ' + e.message); };\r\n\treturn defsave;\r\n}\r\n//\r\n// - we probably need to change this to a class - so we can save DL_Entity as well as DL_Id as default save location\r\n// then add a prototype to the class - render - which creates the details\r\n// when clicked - do we need a prototype???\r\nvar oEXNDEntity;\r\nvar oEXNDQueryParam;\r\nvar oEXNDFlags; // 1 == author, 2 == interessent/modtager, 4 ==, 8 == add entity types drop down first\r\nfunction EXgetEntityTemplates(DL_Entity, DL_QueryParam, iFlags, bParent) // 20.11.2008 - bParent added\r\n{\r\n\tif (typeof(bParent) == 'undefined')\r\n\t\tbParent = false;\r\n\tbEXTemplateHTML = bParent;\r\n\ttry {\r\n\t\tif (DL_QueryParam == null || DL_QueryParam == '')\r\n\t\t\toEXNDQueryParam = DL_Entity;\r\n\t\telse\r\n\t\t\toEXNDQueryParam = DL_QueryParam;\r\n\t\toEXNDFlags = iFlags;\r\n\t\tif (oEXNDFlags & 0x8) {\r\n\t\t\tvar oDiv = document.getElementById('myentities');\r\n\r\n\t\t\toDiv.innerHTML = '<table><tr><td><DIV><SELECT id=\"DLCaseEntities\" name=\"DLCaseEntities\"><Option></Option></SELECT></DIV></td><td><INPUT type=\"button\" name=\"EXBTN1\" value=\"' + LEX_Go + '\" onclick=\"EXonclickEntity()\"></tr></table>';\r\n\t\t\tFillDropDown('DLCaseEntities','DL_WFCaseEntity','DL_EntityNameForeign','DL_Title',null,null,'');\r\n\t\t\tvar oZ = document.getElementById('DLCaseEntities');\r\n\t\t\toZ.size = 30;\r\n\talert(oZ.outerHTML);\r\n\t\t}\r\n\t\telse\r\n\t\t\t_EXgetEntityTemplates(DL_Entity);\r\n\r\n\t} catch (e) {alert('EXgetEntityTemplates exception ' + e.message);}\r\n}\r\nfunction _EXgetEntityTemplates(DL_Entity) {\r\n\ttry {\r\n\t\tif (typeof(DL_Entity) == 'undefined') // 10.9.2008\r\n\t\t\tDL_Entity = oEXNDEntity;\r\n\t\toEXNDEntity = DL_Entity;\r\n\t\tif (oEXNDQueryParam == null || oEXNDQueryParam == 'undefined' || oEXNDQueryParam == '')\r\n\t\t\toEXTemplateQueryParam = DL_Entity;\r\n\t\telse\r\n\t\t\toEXTemplateQueryParam = oEXNDQueryParam;\r\n//alert('que' + oEXTemplateQueryParam + queryString('DL_Activities'));\r\n\t\tvar oDiv = document.getElementById(\"myid\");\r\n\t\tvar sId = queryString(oEXTemplateQueryParam,bEXTemplateHTML);\r\n\t\tif (sId == '' && !(oEXNDFlags & 0x8)) {\r\n\t//oDiv.innerHTML = 'No document templates found - please select an object';\r\n\t\t\toDiv.innerHTML = LEX_NoTemplatesFound;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\telse\r\n\t\t\toDiv.innerHTML = '';\r\n\t\tvar oCase = getEntityData(DL_Entity, 'DL_Id = ' + sId, '');\r\n\t\tvar DLWFCaseType = getsafe(oCase, '//DL_WFCaseType');\r\n\t\tvar DLCaseLongState = getsafe(oCase, '//DL_CaseLongState');\r\n//alert(sId + ' ' + DLWFCaseType);\r\n//alert('EXgetEntityTemplates(' + DL_Entity + ',' + oEXNDQueryParam + ') started');\r\n\t\tvar strWhere;\r\n\t\tif (DLWFCaseType == '')\r\n\t\t\tstrWhere = 'DL_EntityNameForeign = \\'' + DL_Entity + '\\'';\r\n\t\telse\r\n\t\t\tstrWhere = 'DL_EntityNameForeign = \\'' + DL_Entity + '\\' AND isnull(DL_WFCaseType,0) in (0,' + DLWFCaseType + ')';\r\n\t\tif (DLCaseLongState != '')\r\n\t\t\tstrWhere += ' AND isnull(DL_CaseLongState,0) in (0, ' + DLCaseLongState + ')';\r\n\r\n\t\t// 21.3.2012 - use standard procedure\r\n\t\t//getEntityData2Async('*','DL_D610StandardLetterView',strWhere,'DL_TemplateType, DL_Title', EXhandleEntityTemplatesResponse);\r\n\t\tvar sProc = '[EXEntityGetStandardLetters] @DLEntityNameForeign = \\'' + DL_Entity + '\\'';\r\n\t\tif (DLWFCaseType != '')\r\n\t\t\tsProc += ',@DLWFCaseType=' + DLWFCaseType;\r\n\t\tif (DLCaseLongState != '')\r\n\t\t\tsProc += ',@DLCaseLongState=' + DLCaseLongState;\r\n//alert(sProc);\r\n\t\tExecuteProcedureAsync(sProc, EXhandleEntityTemplatesResponse);\r\n\t\treturn false;\r\n\r\n\t\tvar xmldoc;\r\n\t\txmldoc = '<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>';\r\n\t\txmldoc = xmldoc + '<getEntityData xmlns=\"http://doclife.net/svcDLEntity\">';\r\n\t\txmldoc = xmldoc + '<DL_Entity>DL_D610StandardLetterView</DL_Entity>';\r\n\t\txmldoc = xmldoc + '<strWhere>' + strWhere + '</strWhere><strOrderBy>DL_TemplateType, DL_Title</strOrderBy>';\r\n\t\txmldoc = xmldoc + '</getEntityData>';\r\n\t\txmldoc = xmldoc + '</soap:Body></soap:Envelope>';\r\n\t\toEXTemplateEntity = DL_Entity;\r\n\t\tSOAPAction = 'http://doclife.net/svcDLEntity/getEntityData';\r\n\t\toEXndFeedbackHTTP = EXXMLHTTP();\r\n\t\toEXndFeedbackHTTP.open(\"POST\", getAbsoluteURL('/ex_sqlsvc/svcDLEntity.asmx?op=getEntityData'), true); \r\n\t\toEXndFeedbackHTTP.setRequestHeader(\"Content-Type\",\"text/xml; charset=utf-8\");\r\n\t\toEXndFeedbackHTTP.setRequestHeader(\"SOAPAction\", SOAPAction);\r\n\t\toEXndFeedbackHTTP.onreadystatechange = EXhandleEntityTemplatesResponse;\r\n\t\toEXndFeedbackHTTP.send(xmldoc);  \r\n\t\treturn false;  //We return false so that the form doesn't attempt to POST or GET\r\n\t} catch (e) {alert('EXgetEntityTemplates exception ' + e.message); };\r\n}\r\nfunction EXhandleEntityTemplatesResponse() {\r\n\ttry {\r\n\t\tif (oEXndFeedbackHTTP.readyState==4) {\r\n\t\t\t// Use responseXML directly\r\n\t\t\t//var xmlResponse = EXDOMDocument(); //new ActiveXObject(\"MSXML2.DOMDocument.3.0\");\r\n\t\t\t//xmlResponse.async=false;\r\n\t\t\t//xmlResponse.loadXML(oEXndFeedbackHTTP.responseText);\r\n      //var oDropDown = document.getElementById(\"EXDropDown\"); //document.createElement(\"SELECT\");\r\n\t\t\tvar oDropDown = document.createElement(\"SELECT\");\r\n\t\t\toDropDown.id = \"EXDOCSELECT\";\r\n//      oDropDown.name = \"EXDropDown\";\r\n\t\t\tif (false) { // xmlResponse == null) {\r\n\t\t\t\talert('empty xmlResponse');\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t//var xNodes = xmlResponse.selectNodes(\"//DL_ENTITYDATA/DL_D610StandardLetterView\");\r\n\t\t\t\tvar xNodes = oEXndFeedbackHTTP.responseXML.selectNodes(\"//DL_ENTITYDATA/DL_D610StandardLetterView\"); // 16.5.2010\r\n\t\t\t\tif (xNodes == null) {\r\n// alert('null');\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tvar optGroup;\r\n\t\t\t\t\tvar oldGroup;\r\n\t\t\t\t\toldGroup = \"\";\r\n\t\t\t\t\tvar i, xN, newGroup;\r\n\t\t\t\t\tvar oDiv = document.getElementById(\"myid\");\r\n// alert(xNodes.length);\r\n\t\t\t\t\tif (xNodes.length == 0) {\r\n\t\t\t\t\t\toDiv.innerHTML = 'No document templates found';\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i=0; i<xNodes.length; i++) {\r\n\t\t\t\t\t\txN = xNodes[i];\r\n\t\t\t\t\t\tvar oOption = document.createElement(\"OPTION\");\r\n\t\t\t\t\t\tnewGroup = getsafe(xN, \"DL_TemplateType\")\r\n\t\t\t\t\t\tif (!(oldGroup == newGroup)) {\r\n              // add Optgroup - Word, Excel, PowerPoint, Project\r\n\t\t\t\t\t\t\tif (!(oldGroup == \"\"))\r\n\t\t\t\t\t\t\t\toDropDown.appendChild(optGroup);\r\n\t\t\t\t\t\t\toptGroup  = document.createElement(\"OPTGROUP\");\r\n\t\t\t\t\t\t\tswitch (newGroup) {\r\n\t\t\t\t\t\t\t\tcase \"1\": optGroup.label = \"Word\"; break;\r\n\t\t\t\t\t\t\t\tcase \"2\": optGroup.label = \"Excel\"; break;\r\n\t\t\t\t\t\t\t\tcase \"3\": optGroup.label = \"PowerPoint\"; break;\r\n\t\t\t\t\t\t\t\tcase \"4\": optGroup.label = \"Project\"; break;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\toptGroup.style.backgroundImage = \"url(img/view.gif)\";\r\n\t\t\t\t\t\t\toldGroup = newGroup;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar s = getsafe(xN, \"DL_Title\")\r\n\t\t\t\t\t\toOption.innerHTML = s;\r\n\t\t\t\t\t\toOption.value = getsafe(xN, \"DL_Id\");\r\n\t\t\t\t\t\toOption.oFile = getsafe(xN, \"DL_TemplateFile\");\r\n\t\t\t\t\t\toOption.oDefSave = getsafe(xN, \"DL_DefSave\");\r\n\t\t\t\t\t\toOption.oXMLOperation = getsafe(xN, \"DL_XMLOperation\");\r\n\t\t\t\t\t\toOption.oEntityView = getsafe(xN, \"DL_EntityOrViewName\");\r\n//alert('view=' + xN.xml);\r\n//oOption.setAttribute(\"value\", s);\r\n\t\t\t\t\t\toptGroup.appendChild(oOption);\r\n\t\t\t\t\t} // for\r\n\t\t\t\t\tif (!(optGroup == null))\r\n\t\t\t\t\t\toDropDown.appendChild(optGroup);\r\n\t\t\t\t}\r\n\t     \t\t}\r\n\t\t\tvar oInput = document.createElement(\"INPUT\");\r\n\t\t\toInput.type = \"BUTTON\";\r\n\t\t\toInput.value = LEX_Go;\r\n\t\t\toInput.name = \"EXBTN\";\r\n\t\t\toInput.onclick = EXonclick;\r\n\t\t\tvar oSpan = document.createElement('SPAN'); // 18.8.2008\r\n\t\t\toSpan.style.width = '2px';\r\n\t\t\toSpan.innerHTML = ' '; // 20.11.2008 - add separator\r\n\t\t\toDiv.appendChild(oSpan);\r\n\t\t\toDiv.appendChild(oDropDown);\r\n\t\t\toSpan = document.createElement('SPAN'); // 18.8.2008\r\n\t\t\toSpan.style.width = '3px';\r\n\t\t\toSpan.innerHTML = '&nbsp;'; // 20.11.2008 - add separator\r\n\t\t\toDiv.appendChild(oSpan);\r\n\t\t\toDiv.appendChild(oInput);\r\n\r\n/*  drop down field for Author */\r\n\t\t\tif (oEXNDFlags > 0 && oEXNDFlags < 4) {\r\n\t\t\t\tvar oInput;\r\n\t\t\t\tif (!bEXTemplateHTML) { // 20.11.2008\r\n\t\t\t\t\toInput = document.createElement(\"IMG\");\r\n      //oInput.type = \"BUTTON\";\r\n\t\t\t\t\toSpan = document.createElement('SPAN'); // 18.8.2008\r\n\t\t\t\t\toSpan.style.width = '5px';\r\n\t\t\t\t\toSpan.innerHTML = '&nbsp;'; // 20.11.2008 - add separator\r\n\t\t\t\t\toDiv.appendChild(oSpan);\r\n\t\t\t\t\toInput.src = '/EX_Resources/gif/16x16/Add user 3.gif';\r\n\t\t\t\t\toInput.alt = LEX_SelectAuthorReceiver;\r\n\t\t\t\t\toInput.style.cursor = 'pointer';\r\n\t\t\t\t\toInput.name = \"EXOPEN\";\r\n\t\t\t\t\toInput.id = \"EXOPEN\";\r\n\t\t\t\t\toInput.onclick = EXonopen;\r\n\t\t\t\t\toDiv.appendChild(oInput);\r\n\t\t\t\t}\r\n\t\t\t\toInput = document.createElement(\"DIV\")\r\n\t\t\t\toInput.id = 'exndform';\r\n\t\t\t\toInput.name = 'exndform';\r\n     //oInput.onclick = EXexndformclick;\r\n\t\t\t\tif (!bEXTemplateHTML)\r\n\t\t\t\t\toInput.style.backgroundColor = 'whitesmoke';\r\n\t\t\t\toInput.style.display = 'none';\r\n     //alert(\"done\");\r\n\t\t\t\toDiv.appendChild(oInput);\r\n\t\t\t\tvar oEle = document.getElementById('exndform');\r\n\t\t\t\tif (oEle == null)\r\n\t\t\t\t\talert('exndform not found');\r\n     //oEle.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\"><tr><td colspan=\"2\">Please pick document recipient</td></tr><tr><td>Person</td><td><input id=\"EXPerson\" type=\"hidden\" onpropertychange=\"javascript:EXPersonChange()\"><input style=\"width:180px\" id=\"EXPersonDenorm\" type=\"text\"><a href=\"javascript:EXPickPerson()\"><img src=\"/EX_Resources/img/16x16/add.gif\" border=\"0\"></a></td></tr><tr><td>Organisation</td><td><input id=\"EXOrganisation\" type=\"hidden\" onpropertychange=\"javascript:EXOrganisationChange()\"><input style=\"width:180px\" id=\"EXOrganisationDenorm\" type=\"text\"><a href=\"javascript:EXPickOrganisation()\"><img src=\"/EX_Resources/img/16x16/add.gif\" border=\"0\"></a></td><tr><td>CVR</td><td><input style=\"width:180px\" id=\"EXCVR\" type=\"text\"><a href=\"javascript:EXPickCVR()\"><img src=\"/EX_Resources/img/16x16/add.gif\" border=\"0\"></a></td></tr></tr><tr><td colspan=\"2\">Debug info only: <input style=\"width:300px\" type=\"text\" id=\"EXProps\" name=\"EXProps\"></td></tr></table>';\r\n\t\t\t\tvar sTable = '<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">';\r\n\t\t\t\tif (oEXNDFlags & 0x1) \r\n\t\t\t\t\tsTable = sTable + '<tr><td align=\"left\"><select name=\"EXAuthor\" id=\"EXAuthor\"><OPTION></OPTION></select></td><td>&nbsp;</td><td class=\"ms-vb\">' + LEX_Author + '</td></tr>';\r\n\t\t\t\tif (oEXNDFlags & 0x2) \r\n\t\t//sTable = sTable + '<tr><td><select name=\"DLCaseAddress\" id=\"DLCaseAddress\"><OPTION></OPTION></select></td><td class=\"ms-vb\">Modtager</td></tr>';\r\n\t\t\t\t\tsTable = sTable + '<tr id=\"trDLCaseAddress\"><td align=\"left\"><select name=\"DLCaseAddress\" id=\"DLCaseAddress\"><OPTION></OPTION></select></td><td>&nbsp;</td><td class=\"ms-vb\">Modtager</td></tr>';\r\n\t\t\t\tsTable = sTable + '</table>';\r\n\t\t\t\toEle.innerHTML = sTable;\r\n     //FillDropDown('EXAuthor','DL_sAMAccountName','DL_sAMAccountName','DL_FullName');\r\n\t\t\t\toEXndforminit = false;\r\n\t\t\t}\r\n//alert(oEle.innerHTML);\r\n/* */\r\n//document.write(oDropDown);\r\n\t\t\tif (bEXTemplateHTML) { // 20.11.2008\r\n\t\t\t\tEXonopen();\r\n\t\t\t\t// Fix width of all SELECT\r\n\t\t\t\tvar oSELECTS = document.getElementsByTagName('SELECT');\r\n\t\t\t\tvar iWidth = 0;\r\n\t\t\t\tvar iOffset = 4000;\r\n\t\t\t\tfor (var i=0;i<oSELECTS.length;i++) {\r\n\t\t\t\t\tif (iWidth < oSELECTS[i].offsetWidth)\r\n\t\t\t\t\t\tiWidth = oSELECTS[i].offsetWidth;\r\n\t\t\t\t\tif (iOffset < oSELECTS[i].offsetLeft)\r\n\t\t\t\t\t\tiWidth = oSELECTS[i].offsetLeft;\r\n\t\t\t\t\t//alert(i + ' ' + oSELECTS[i].offsetLeft + ' ' + oSELECTS[i].offsetWidth);\r\n\t\t\t\t}\r\n\t\t\t\tfor (var i=0;i<oSELECTS.length;i++) {\r\n\t\t\t\t\toSELECTS[i].style.width = iWidth + 'px';\r\n\t\t\t\t\toSELECTS[i].style.left = iOffset + 'px';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t} catch (e) {alert('EXhandleEntityTemplatesResponse ' + e.message); };\r\n}\r\nfunction EXonclickEntity() {\r\n\tvar oEle = document.getElementById('DLCaseEntities')\r\n\tif (oEle.value != '')\r\n\t\t_EXgetEntityTemplates(oEle.value);\r\n}\r\nfunction EXonclick() {\r\n  var oSel = document.getElementById(\"EXDOCSELECT\");\r\n  var i = oSel.selectedIndex;\r\n  var DL_Id = oSel.options[i].value; // DL_Id of DL_Template\r\n  var oFile = oSel.options[i].oFile;\r\n  var odefsave = oSel.options[i].oDefSave;\r\n  var oentityview = oSel.options[i].oEntityView;\r\n  var oXMLOperation = oSel.options[i].oXMLOperation;\r\n  var DL_Entity = oEXTemplateEntity; // Must be saved in unique DIV\r\n  var DL_Id = queryString(oEXTemplateQueryParam,bEXTemplateHTML);\r\n  EXCreateDoc(DL_Entity, DL_Id, oFile, odefsave, oentityview, oXMLOperation);\r\n}\r\nfunction EXonopen() {\r\n\tvar oEle = document.getElementById('EXOPEN');\r\n\tvar oDiv = document.getElementById('exndform');\r\n\tif (oDiv.style.display == 'none') {\r\n\t\tif (!oEXndforminit) {\r\n\t\t\tif (oEXNDFlags & 0x1)\r\n\t\t\t\tFillDropDown('EXAuthor','DL_sAMAccountName','DL_sAMAccountName','DL_Name',null,null,'%DL_sAMAccountName%');\r\n\t\t\tif (oEXNDFlags & 0x2) {\r\n\t\t\t\tvar DLEntityId = queryString(oEXNDQueryParam,bEXTemplateHTML);\r\n\t\t\t\tif (DLEntityId == '')\r\n\t\t\t\t\talert('could not find param ' + oEXNDQueryParam + bEXTemplateHTML);\r\n\t\t\t\telse {\r\n\t\t\t\t\tFillDropDown('DLCaseAddress','DL_CaseAddressView','DL_Id','DL_AddressTitle','DL_EntityNameForeign',oEXNDEntity,null,'DL_EntityId',DLEntityId);\r\n\t\t\t\t\tvar oEle = document.getElementById('DLCaseAddress'); // 15.8.2008\r\n\t\t\t\t\tif (oEle.options.length < 2) {\r\n\t\t\t\t\t\t//alert('Modtager ikke t�ndt');\r\n\t\t\t\t\t\toEle = document.getElementById('trDLCaseAddress');\r\n\t\t\t\t\t\toEle.style.display = 'none';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\toEXndforminit = true;\r\n\t\toDiv.style.display = '';\r\n\t}\r\n\telse {\r\n\t\toDiv.style.display = 'none';\r\n\t}\r\n//alert('EXonopen');\r\n}\r\nfunction EXexndformclick() {\r\nalert('EXexndformclick');\r\n  EXHideForm();\r\n}\r\nfunction EXPickPerson() {\r\n\ttry {\r\n\t\tEXDoDynamicSearch('EXPerson', 'DL_Contacts', null, null, 'EX_cn,DL_EXCompany', '')\r\n\t} catch (e) {alert('EXPickPerson ' + e.message);}\r\n}\r\nfunction EXPersonChange() {\r\n//alert('EXPersonChange');\r\n\tvar oEle = document.getElementById('EXPerson');\r\n\tvar oXML = getEntityData('DL_Contacts','DL_Id=' + oEle.value,'');\r\n//alert(oXML.xml);\r\n\toEle = document.getElementById('EXProps');\r\n\tvar oNode = oXML.selectSingleNode('//DL_ENTITYDATA/DL_Contacts');\r\n\toEle.value = oEle.value + AddNode(oXML, '//DL_EXCompany','Company') + AddNode(oXML, '//EX_cn','Name') + AddNode(oXML, '//EX_street','Street') + AddNode(oXML, '//EX_postalcode','ZIP') + AddNode(oXML, '//EX_l','City');;\r\n}\r\n\r\nfunction EXPickOrganisation() {\r\n\ttry {\r\n\t\tEXDoDynamicSearch('EXOrganisation', 'DL_EXCompany', null, null, 'DL_EXCompany', '')\r\n\t} catch (e) {alert('EXPickOrganisation ' + e.message);}\r\n}\r\nfunction EXOrganisationChange() {\r\n\tvar oEle = document.getElementById('EXOrganisation');\r\n\tvar oXML = getEntityData('DL_EXCompany','DL_Id=' + oEle.value,'');\r\n//alert(oXML.xml);\r\n\toEle = document.getElementById('EXProps');\r\n\toEle.value = oEle.value + AddNode(oXML, '//DL_EXCompany','Company') + AddNode(oXML, '//DL_Street','Street') + AddNode(oXML, '//DL_PostalCode','ZIP') + AddNode(oXML, '//DL_City','City');\r\n}\r\nfunction AddXML(value, tag) {\r\n\treturn '<' + tag + '>' + MakeXMLSafe(value) + '</' + tag + '>';\r\n}\r\nfunction AddNode(oXML, XPath, tag) {\r\n\treturn AddXML(getsafe(oXML,XPath), tag)\r\n}\r\n\r\n// CVR - NNMarkedsdata\r\nfunction EXPickCVR() {\r\n\ttry {\r\n\t\tvar oEle = document.getElementById('EXCVR');\r\n\t\tif (oEle != null) {\r\n\t\t\tif (oEle.value != '') {\r\n\t\t\t\tvar oXML = EXgetCompanyFromCVR(oEle.value);\r\n\t\t\t\toEle = document.getElementById('EXProps');\r\n\t\t\t\toEle.value = oEle.value + AddNode(oXML, '//officialName','Company') + AddNode(oXML, '//street','Street') + AddNode(oXML, '//zipCode','ZIP') + AddNode(oXML, '//district','City');\r\n\t\t\t}\r\n\t\t}\r\n\t} catch (e) {alert('EXPickCVR ' + e.message);}\r\n}\r\n\r\nfunction EXgetCompanyFromCVR(cvrnr) {\r\n\tvar s = '<mns:search xmlns:mns=\"http://com.stibo.net/nne/3.0/NNE\" SOAP-ENV:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"><Question_1 xsi:type=\"ns2:Question\"><cvrNo xsi:type=\"xsd:int\">' + cvrnr + '</cvrNo><district xsi:type=\"xsd:string\"></district><houseNo xsi:type=\"xsd:string\"></houseNo><name xsi:type=\"xsd:string\"></name><nameStartsWith xsi:type=\"xsd:boolean\">1</nameStartsWith><phone xsi:type=\"xsd:string\"></phone><street xsi:type=\"xsd:string\"></street><streetStartsWith xsi:type=\"xsd:boolean\">1</streetStartsWith><tdcId xsi:type=\"xsd:int\">0</tdcId><zipCode xsi:type=\"xsd:int\">0</zipCode></Question_1><int_2 xsi:type=\"xsd:int\">1</int_2><int_3 xsi:type=\"xsd:int\">1</int_3><int_4 xsi:type=\"xsd:int\">1</int_4><String_5 xsi:type=\"xsd:string\">uffe</String_5></mns:search>';\r\n\tvar xmldoc, FeedbackHTTP;\r\n\txmldoc='<?xml version=\"1.0\" encoding=\"utf-8\"?><SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:tns=\"http://com.stibo.net/nne/3.0/NNE\" xmlns:ns2=\"http://com.stibo.net/nne/3.0/Types/NNE\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/wsdl/soap/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:SOAP-ENC=\"http://schemas.xmlsoap.org/soap/encoding/\"><SOAP-ENV:Body>';\r\n\txmldoc = xmldoc + s;\r\n\txmldoc = xmldoc + '</SOAP-ENV:Body></SOAP-ENV:Envelope>';\r\n\r\n\tFeedbackHTTP = EXXMLHTTP();\r\n//    FeedbackHTTP.Open(\"POST\", 'http://service.nnerhverv.dk/nne-ws/2.1/NNE?op=NNE_PortType_search\">', false); \r\n\tFeedbackHTTP.open(\"POST\", 'http://service.nnerhverv.dk:80/nne-ws/3.0/NNE', false); \r\n\tFeedbackHTTP.setRequestHeader(\"Content-Type\",\"text/xml; charset=utf-8\");\r\n    //FeedbackHTTP.setRequestHeader(\"SOAPAction\", 'nms:search');\r\n\ttry {\r\n\t\tFeedbackHTTP.send(xmldoc);\r\n\t} catch (e) {alert('EXgetCompanyFromCVR ' + e.message);}\r\n\tvar oXML;\r\n\toXML = FeedbackHTTP.responseXML;\r\n\tFeedbackHTTP = null;\r\n\treturn oXML;\r\n}\r\n\r\n\r\n//alert('EXNewDocument.js loaded');\r\n"},"Xoj/":function(t,e,n){n("KF6U")(n("z5N0"))},agXo:function(t,e,n){n("KF6U")(n("755C"))},nzwu:function(t,e,n){n("KF6U")(n("Q4jN"))},z5N0:function(t,e){t.exports="var EXServerRoot = 'http://servtestsagsys'; // 12.7.2010\r\nvar EXSPSVersion = 12; // 18.9.2011\r\nvar EXECMVersion = '6.8'; // 20.9.2011\r\nvar custUseMentionsAutoComplete=true;\r\nvar bEXClearBasket = true; // Clear document basket after sending an email\r\nvar EXECMCustomFileName = false\r\n// 3.11.2009 - New functionality to ensure proper security management\r\nEXUseRoleSecurity = true; // true | false - overwrite default functionality\r\nEXECMMemberGroup = ''; // overwrite default functionality\r\n\r\nfunction EXUserLastSeen() { // 21.8.2010\r\n// 6.2.2013 - speed up performance\r\n//\tExecuteProcedureAsync('dbo.EXUserLastSeen @sAMAccountName = %DL_sAMAccountName%',null);\r\n}\r\n\r\nfunction EXSetUserRole(DLEntityNameForeign, DLEntityId) {\r\n\tif (typeof(DLEntityNameForeign) == 'undefined' || typeof(DLEntityId) == 'undefined') {\r\n\t\tDLEntityNameForeign = '';\r\n\t\tDLEntityId = '';\r\n\t}\r\n\tif (EXECMMemberGroup != '') { // Check if user if member of group\r\n\t\tvar xGroup = SearchAD('%root%','(&(objectcategory=user)(sAMAccountName=%DL_sAMAccountName%) (memberof=' + EXECMMemberGroup + '))','sAMAccountName');\r\n\t\tvar s = getsafe(xGroup, '//SearchADResult');\r\n\t\t//alert('DEBUG\\n' + s + '\\n' + xGroup.xml);\r\n\t\tif (s == '') {\r\n\t\t\t_EXUserRole = 0;\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\tif (DLEntityId == '' || DLEntityId == '0' || DLEntityNameForeign == '')\r\n\t\treturn 1; // User has access - as we don't know that they don't\r\n\tvar xAccess = ExecuteProcedure('dbo.EXGetUserAccess @DLEntityNameForeign=\\'' + DLEntityNameForeign + '\\',@DLEntityId=' + DLEntityId + ',@WUser = %WUSER%');\r\n\t//alert('DEBUG\\nEXSetUserRole(' + DLEntityNameForeign + ',' + DLEntityId + ') - ' + xAccess.xml);\r\n\tif (getsafe(xAccess,'//EXUserHasAccess') == '0')\r\n\t\t_EXUserRole = 0;\r\n\telse\r\n\t\t_EXUserRole = 1;\r\n}\r\n\r\n// oldstuff below\r\n    function loadtanarosexcel(DL_Entity, sProject, sGroupCode, strHref)\r\n    {\r\n    \tvar strXML;\r\n    \tstrXML='<DL_GenericDBParams><DL_EntityName>' + DL_Entity + '</DL_EntityName><TA_ProjectForeign>' + sProject + '</TA_ProjectForeign><TA_GroupCode>' + sGroupCode + '</TA_GroupCode>';\r\n    \tstrXML=strXML + '</DL_GenericDBParams>';\r\n    \tOpenGenericTable(0, strXML, strHref)\t\r\n    }\r\n\r\nfunction initialTester(x)\r\n{\r\n//alert('JW test');\r\n\tvar oEL = document.all.item('DL_Responsible');\r\n\tvar medArbStr = \"\";\r\nif (oEL != null){\r\n//alert(oEL.innerHTML);\r\n//alert(oEL.options.length);\r\n    for (i=0; i<oEL.options.length; i++)\r\n\t{\r\n\t\tmedArbStr = medArbStr + oEL.options(i).value + ';';\r\n\t}\r\n}\r\nelse\r\n{\r\n// alert('not found');\r\n}\r\n\tmedArbStr = medArbStr.toUpperCase();\r\n\tx = x.toUpperCase();\r\n\r\n\tvar medArbArray = x.split(';');\r\n\tvar numberOfParts = 0;\r\n\r\n\tnumberOfParts = medArbArray.length;\r\n\t\tfor (i=0; i<numberOfParts; i++)\r\n\t\t{\r\n\t\t\tif( medArbStr.search(medArbArray[i]+\";\")==-1)\r\n\t\t\t{\r\n\t\t\t\talert(medArbArray[i] + \" is not in the employee list\")\t;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n}\r\n\r\n\r\nvar oSecurityGroups = null;\r\nfunction EXValidateSecurityGroups(oEle) {\r\n\tif (oSecurityGroups == null)\r\n\t\toSecurityGroups = getEntityData('DL_SecurityGroupView','','');\r\n\tvar s, sgroup, sresult, sunknown;\r\n\tsunknown = '';\r\n\ts = oEle.value;\r\n\ts = s.replace(/,/g,';');\r\n\ts = s.replace(/;;/g,';');\r\n\t//alert('EXValidateSecurityGroups ' + s);\r\n\tsresult = '';\r\n\tfor(var i=0; i < s.split(\";\").length; i++) {\r\n\t\tsgroup = s.split(\";\")[i];\r\n\t\tif (oSecurityGroups.selectSingleNode(\"//DL_ENTITYDATA/DL_SecurityGroupView[DL_ADSecurityGroup='\" + sgroup + \"']\") == null) {\r\n\t\t\tif (sunknown != '')\r\n\t\t\t\tsunknown = sunknown + ';';\r\n\t\t\tsunknown = sunknown + sgroup;\r\n\t\t}\r\n\t\telse {\r\n\t\t\t//alert('group ok ' + sgroup);\r\n\t\t\tif (sresult != '')\r\n\t\t\t\tsresult = sresult + ';';\r\n\t\t\tsresult = sresult + sgroup;\r\n\t\t}\r\n\t}\r\n\tif (sunknown != '') {\r\n\t// 25.8.2008 - overwrite!!\r\n\t//\tif (confirm('Unknown groups found \\'' + sunknown + '\\'. Modify to \\'' + sresult + '\\'?'))\r\n\t\t\toEle.value = sresult;\r\n\t}\r\n}\r\n\r\nvar oUsers = null;\r\nfunction EXValidateUsers(oEle) {\r\n\tif (oUsers == null)\r\n\t\toUsers = getEntityData2('DL_sAMAccountName','DL_sAMAccountName','','');\r\n\tvar s, suser, sresult, sunknown;\r\n\tsunknown = '';\r\n\tsresult = '';\r\n\ts = oEle.value.replace(',',';');\r\n\t//alert('EXValidateUsers ' + oEle.id + ' ' + s);\r\n\tfor(var i=0; i < s.split(\";\").length; i++) {\r\n\t\t//suser = s.split(\";\")[i].replace('Symphogen\\\\','');\r\n\t\tsuser = s.split(\";\")[i];\r\n\t\tif (oUsers.selectSingleNode(\"//DL_ENTITYDATA/DL_sAMAccountName[DL_sAMAccountName='\" + suser + \"']\") == null) {\r\n\t\t\tif (sunknown != '')\r\n\t\t\t\tsunknown = sunknown + ';';\r\n\t\t\tsunknown = sunknown + suser;\r\n\t\t}\r\n\t\telse {\r\n\t\t\t//alert('group ok ' + suser);\r\n\t\t\tif (sresult != '')\r\n\t\t\t\tsresult = sresult + ';';\r\n\t\t\t//sresult = sresult + 'Symphogen\\\\' + suser;\r\n\t\t\tsresult = sresult + suser;\r\n\t\t}\r\n\t}\r\n\tif (sunknown != '') {\r\n\t// 25.8.2008 - overwrite!!\r\noEle.value = sresult;\r\nreturn;\r\n\t\tif (confirm('Unknown users found \\'' + sunknown + '\\'. Modify to \\'' + sresult + '\\'?'))\r\n\t\t\toEle.value = sresult;\r\n\t\telse {\r\n\t\t\toEle.value = ';' + oEle.value; // 25.8.2008\r\n\t\t\toEle.focus();\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n}\r\nfunction EXSetDocLibType() {\r\n\tvar oEle = document.getElementById('DL_SecurityDictionary');\r\n\tFillDropDown('SPS_DocLibType','DL_D810','SPS_DocLibType','SPS_DocLibType','DL_EntityNameForeign',oEle.value);\r\n\tFillDropDown('DL_FolderType','DL_D810FolderTypeView','DL_FolderType','DL_FolderTypeDecode','DL_EntityNameForeign',oEle.value);\r\n}\r\n\r\nfunction EXhandleDLCaseProtected(oEle) {\r\n\ttry {\r\n\t\tvar bOn;\r\n\t\toEle = document.getElementById('DL_CaseProtected');\r\n\t\tbOn = oEle.value != '' && oEle.value != '0';\r\n//alert('EXhandleDLCaseProtected ' + bOn + ' ' + oEle.id);\r\n\t\tPropNameRowOnOff('DL_SecurityPersons', bOn);\r\n\t\tPropNameRowOnOff('DL_ADSecurityGroups', bOn);\r\n\t\tif (bOn) {\r\n\t\t\tPropNameRowClass('DL_CaseProtected','trred');\r\n\t\t\tPropNameRowClass('DL_SecurityPersons','trred');\r\n\t\t\tPropNameRowClass('DL_ADSecurityGroups','trred');\r\n\t\t}\r\n\t\telse\r\n\t\t\tPropNameRowClass('DL_CaseProtected','');\r\n\t} catch (e) {alert('EXhandleDLCaseProtected ' + e.message);}\r\n}\r\nfunction setEXhandleDLCaseState() {\r\n\tvar oEle = document.getElementById('DL_CaseState');\r\n\toEle.onpropertychange = EXhandleDLCaseState;\r\n\t//alert('setEXhandleDLCaseState completed');\r\n}\r\nfunction EXhandleDLCaseState(oEle1) {\r\n\ttry {\r\n\t\tvar oCaseState = document.getElementById('DL_CaseState');\r\n\t\tvar oEle = document.getElementById('DL_EndDate');\r\n\t\tif (oCaseState.checked && oEle.value == '')\r\n\t\t\toEle.value = EXGetTodaysDateDK();\r\n\t//alert('EXhandleDLCaseState ' + oCaseState.checked);\r\n\t} catch (e) {alert('EXhandleDLCaseState ' + e.message);}\r\n}\r\n\r\n//25.03.2013 ITcase 1159 / 3977\r\nfunction Max150Chars(longstring) \r\n{\r\n\r\n\tif (longstring.length > 150)\r\n\t\tlongstring = longstring.substr(0,150);\r\n       \r\n}\r\n\r\nfunction FTFNySagsfrist(FKeys, FValues) {\r\n\t//var oXML = getEntityData2('*','DL_Activities','DL_Id = ' + queryString('DL_Activities'),'');\r\n\t//var sTitle = 'Sagsfrist ' + getsafe(oXML, '//DL_CaseNo') + ' på ' + getsafe(oXML,'//DL_Title');\r\n\t//if (sTitle.length > 50)\r\n\t//\tsTitle = sTitle.substr(0,50);\r\n\t//sTitle = sTitle.replace(/,/g,' ');\r\n\tnewentity('DL_Tasks', 'FTF_Sagsfrist,BPM_PctComplete,' + FKeys, '1,0,' + FValues,'view=BPM_DueDate,BPM_Responsible,BPM_Body');\r\n}\r\n\r\nfunction FTFsetActivitiesSecurity(sGroup) {\r\n\tvar oEle1 = document.getElementById('DL_CaseProtected');\r\n\toEle1.value = '1';\r\n\toEle1 = document.getElementById('DL_ADSecurityGroups');\r\n\tif (oEle1.value == '')\r\n\t\toEle1.value = sGroup;\r\n}\r\n\r\nfunction EXhandleDLCaseType() {\r\n\ttry {\r\n\t\tvar oEle = document.getElementById('DL_CaseType');\r\n\t\tif (oEle == null)\r\n\t\t\talert('EXhandleDLCaseType - error');\r\n\t\tswitch (oEle.value) {\r\n\t\t\tcase '10' : // General\r\n\t\t\t\tPropNameRowOnOff('DL_Responsible,DL_Employee,FTF_Klient,FTF_Lidelsesart,FTF_SkadeType,FTF_ANKEAfgorelse,FTF_ANKESagNr,FTF_AnmeldtAf,FTF_AnmeldtDato,FTF_ASKADEAFgorelse,FTF_ASKADESagNr,FTF_Erhvervssygdomsudvalget,FTF_Genoptaget,FTF_SagAnket', false); // Hide all rows\r\n\t\t\t\tbreak;\r\n\t\t\tcase '20' : // Personale\r\n\t\t\t\tPropNameRowOnOff('FTF_Konsulent,FTF_Sekretaer,FTF_Klient,DL_CaseProtected,LO_Fagforbund,FTF_Lidelsesart,FTF_SkadeType,FTF_ANKEAfgorelse,FTF_ANKESagNr,FTF_AnmeldtAf,FTF_AnmeldtDato,FTF_ASKADEAFgorelse,FTF_ASKADESagNr,FTF_Erhvervssygdomsudvalget,FTF_Genoptaget,FTF_SagAnket', false); // Hide all rows\r\n\t\t\t\tFTFsetActivitiesSecurity('Personale');\r\n\t\t\t\tEXhandleDLCaseProtected(oEle1);\r\n\t\t\t\tvar oEle1 = document.getElementById('DL_Process');\r\n\t\t\t\tif (oEle1.value == '')\r\n\t\t\t\t\toEle1.value = 'Intern administration og service';\r\n\t\t\t\tbreak;\r\n\t\t\tcase '30' : // Arbejdsskade\r\n\t\t\t\tPropNameRowOnOff('DL_Responsible,DL_Employee,DL_StartDate,DL_EndDate,DL_CaseProtected', false); // Hide all rows\r\n\t\t\t\tFTFsetActivitiesSecurity('ASkade');\r\n\t\t\t\tvar oEle1 = document.getElementById('DL_StartDate');\r\n\t\t\t\tif (oEle1.value == '')\r\n\t\t\t\t\toEle1.value = EXGetTodaysDateDK();\r\n\t\t\t\tbreak;\r\n\t\t\tcase '40' : // Erstatningsansvar\r\n\t\t\t\tPropNameRowOnOff('DL_CaseProtected,DL_Responsible,DL_Employee,FTF_Lidelsesart,FTF_SkadeType,FTF_ANKEAfgorelse,FTF_ANKESagNr,FTF_AnmeldtAf,FTF_AnmeldtDato,FTF_ASKADEAFgorelse,FTF_ASKADESagNr,FTF_Erhvervssygdomsudvalget,FTF_Genoptaget,FTF_SagAnket', false); // Hide all rows\r\n\t\t\t\tbreak;\r\n\t\t\tcase '50' : // Socialrådgiver\r\n\t\t\t\tPropNameRowOnOff('DL_CaseProtected,DL_Responsible,DL_Employee,FTF_Lidelsesart,FTF_SkadeType,FTF_ANKEAfgorelse,FTF_ANKESagNr,FTF_AnmeldtAf,FTF_AnmeldtDato,FTF_ASKADEAFgorelse,FTF_ASKADESagNr,FTF_Erhvervssygdomsudvalget,FTF_Genoptaget,FTF_SagAnket', false); // Hide all rows\r\n\t\t\t\tFTFsetActivitiesSecurity('Social');\r\n\t\t\t\tbreak;\r\n\t\t\tcase '60' : // Arbejdsret mv\r\n\t\t\t\tPropNameRowOnOff('DL_Responsible,DL_Employee,FTF_Klient,FTF_Lidelsesart,FTF_SkadeType,FTF_ANKEAfgorelse,FTF_ANKESagNr,FTF_AnmeldtAf,FTF_AnmeldtDato,FTF_ASKADEAFgorelse,FTF_ASKADESagNr,FTF_Erhvervssygdomsudvalget,FTF_Genoptaget,FTF_SagAnket', false); // Hide all rows\r\n\t\t\t\tbreak;\r\n\t\t\tcase '70' : // Juridisk sag, ASA\r\n\t\t\t\tPropNameRowOnOff('DL_Responsible,DL_Employee,FTF_Klient,FTF_Lidelsesart,FTF_SkadeType,FTF_ANKEAfgorelse,FTF_ANKESagNr,FTF_AnmeldtAf,FTF_AnmeldtDato,FTF_ASKADEAFgorelse,FTF_ASKADESagNr,FTF_Erhvervssygdomsudvalget,FTF_Genoptaget,FTF_SagAnket', false); // Hide all rows\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\t//alert('Que ' + oEle.value);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t//alert('EXhandleDLCaseState ' + oCaseState.checked);\r\n\t} catch (e) {alert('EXhandleDLCaseType ' + e.message);}\r\n}\r\n\r\n// Loads DynamicForm with specific fields for various case types\r\nfunction EXhandleDLCaseTypeView() {\r\n}\r\nfunction EXsethandleFTFKlient() {\r\n\tvar oEle = document.getElementById('FTF_KlientDenorm');\r\n\toEle.attachEvent('onchange', EXhandleFTFKlient);\r\n//alert('EXsethandleFTFKlient');\r\n}\r\nfunction EXhandleFTFKlient() {\r\n\tvar oKlient = document.getElementById('FTF_Klient');\r\n\tvar oEle = document.getElementById('FTF_KlientDenorm');\r\n//alert('EXhandleFTFKlient ' + oKlient.value + ' ' + oEle.value);\r\n\tif (oEle.value != '' && oEle.value.indexOf(':') == -1) { // (oKlient.value == '' || oKlient.value == '0')) {\r\n\t\tvar oXML = getEntityData('FTF_Klient','HR_CPRNR = \\'' + oEle.value + '\\'','');\r\n//alert(oXML.xml);\r\n\t\tif (getsafe(oXML, '//DL_Id') == '') {\r\n\t\t\tif (confirm('Klienten findes ikke - opret ham?')) {\r\nalert('now open new window');\r\n\t\t\t\tnewentity('FTF_Klient','HR_CPRNR',oEle.value,null,true);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nfunction FTFHentLidelsesart() {\r\n\tvar oEle = document.getElementById('FTF_Skadetype');\r\n\tFillDropDown('FTF_Lidelsesart','FTF_LidelsesartView','FTF_LidelsesartKEY','','FTF_SkadetypeKEY',oEle.value);\r\n}\r\n\r\n//15-04-2008\r\nfunction FTFSoegSag() {\r\nalert(1);\r\n\tEXDoDynamicSearch('DL_CaseNo','DL_CMAllView','','','DL_CaseNo,DL_Title,DL_Responsible','','', 'parent.DLPostboxhandleCaseNo();','DL_CaseNo');\r\n}\r\n\r\n//JW 130907\r\nfunction EXhandleDLWFCaseEntity() {\r\n\tvar oEle = document.getElementById('DL_WFCaseEntity');\r\n\tvar oEle2 = document.getElementById('DL_FolderPathForeign');\r\n//alert(oEle.value + ' ' + oEle2.value);\r\n\tFillDropDown('DL_FolderPathForeign','DL_D810View','DL_Id','DL_Title2','DL_EntityNameForeign',oEle.value,oEle2.value);\r\n}\r\n\r\nfunction EXhandleDLPhraseType() {\r\n\tvar oEle = document.getElementById('DL_PhraseType');\r\n\tif (oEle == null)\r\n\t\treturn;\r\n\tif (oEle.value == '2')\r\n\t\tPropNameRowOnOff('DL_TextBox', false);\r\n}\r\n\r\nfunction EXHandleMailTemplate() {\r\n// 15.4.2008 - FIX THIS ASAP\r\n\tvar oEle = document.getElementById('DL_HTMLText');\r\n\tif (oEle == null) {\r\n\t\treturn;\r\n\t}\r\n\tif (oEle.value != '' && oEle.value != ' ' ) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar ForeignKeys = queryString('ForeignKeys');\r\n\tvar ForeignValues = queryString('ForeignValues');\r\n\tvar aKeys = ForeignKeys.split(',');\r\n\tvar aValues = ForeignValues.split(',');\r\n\tvar ITMailTemplate;\r\n\tvar DLEntityNameForeign;\r\n\tvar DLEntityId;\r\n\tfor (var i=0; i < aKeys.length; i++) {\r\n\t\tswitch (aKeys[i]) {\r\n\t\tcase 'DL_EntityNameForeign' : DLEntityNameForeign = aValues[i]; break;\r\n\t\tcase 'DL_EntityId' : DLEntityId = aValues[i]; break;\r\n\t\tcase 'IT_MailTemplate' : ITMailTemplate = aValues[i]; break;\r\n\t\t}\r\n\t}\r\n\tif (ITMailTemplate == '')\r\n\t\treturn;\r\n\tvar o;\r\n\tvar oXML = getEntityData('IT_MailTemplate','DL_Id = ' + ITMailTemplate,'');\r\n\tvar sHTML = getsafe(oXML, '//DL_HTMLText');\r\n\r\n\tvar xSag = getEntityData(DLEntityNameForeign, 'DL_Id = ' + DLEntityId, '');\r\n\tsHTML = sHTML.replace('#Titel#',getsafe(xSag, '//DL_Title'));\r\n\tsHTML = sHTML.replace(/#Id#/g,getsafe(xSag, '//DL_Id'));\r\n\tsHTML = sHTML.replace('#Oprettet af#',GetEntityItemValue('IT_CaseView',DLEntityId,'DL_FullName'));\r\n\tsHTML = sHTML.replace('#Levnavn#',GetEntityItemValue('IT_CaseView',DLEntityId,'IT_SupplierName'));\r\n\tsHTML = sHTML.replace('#Beskrivelse#',getsafe(xSag, '//DL_TextBox'));\r\n\tsHTML = sHTML.replace('#her#','<a href=\"http://intranet/Delte dokumenter/ITSupport.aspx?IT_Case=#DL_Id#&DL_FolderParams=#DL_FolderParams#\">her</a>');\r\n\tsHTML = sHTML.replace('#Luk#','<a href=\"http://intranet/EX_CUSTOM/JS/CloseITCase.HTML?IT_Case=#Id#\" target=\"_blank\">LUK</a>');\r\n\tsHTML = sHTML.replace('#Genbehandle#','<a href=\"http://intranet/EX_CUSTOM/JS/ReopenITCase.HTML?IT_Case=#Id#\" target=\"_blank\">ÅBEN</a>');\r\n\tsHTML = sHTML.replace(/#Id#/g,getsafe(xSag, '//DL_Id'));\r\n\tsHTML = sHTML.replace(/&#198;/g,'Æ');\r\n\tsHTML = sHTML.replace(/&#216;/g,'Ø');\r\n\tsHTML = sHTML.replace(/&#197;/g,'Å');\r\n\tsHTML = sHTML.replace(/&#230;/g,'æ');\r\n\tsHTML = sHTML.replace(/&#248;/g,'ø');\r\n\tsHTML = sHTML.replace(/&#229;/g,'å');\r\n\toEle.value = sHTML;\r\n}\r\n\r\n\r\nfunction EXHandleFromMail() {\r\n\tvar oEle1 = document.getElementById('DL_FromMail');\r\n\tif (oEle1 == null)\r\n\t\treturn;\r\n\tvar bShow = false;\r\n\tif (oEle1.value != '') {\r\n\t\tbShow = true;\r\n\t}\r\n\telse\r\n\t{\r\n\t\tvar ForeignKeys = queryString('ForeignKeys');\r\n\t\tif (ForeignKeys != '') {\r\n\r\n\t\t\tif (ForeignKeys.indexOf('IT_MailTemplate') != -1)\r\n\t\t\t{\r\n\t\t\t\tbShow = true;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse \r\n\t\t{\r\n\t\t\tvar oEle2 = document.getElementById('IT_MailTemplate');\r\n\t\t\tif (oEle2 != null) {\r\n\t\t\t\tif (oEle2.value != '')\r\n\t\t\t\tbShow = true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif (bShow == true)\r\n\t{\r\n\t\tPropNameRowOnOff('DL_FromMail',true);\r\n\t\tif (oEle1.value == '')\r\n\t\t\toEle1.value = 'info@exformatics.com' \r\n\r\n\t}\r\n\telse {\r\n\t\tPropNameRowOnOff('DL_FromMail,IT_MailTemplate,IT_MailSent',false);\r\n\t}\r\n\r\n}\r\n\r\n//10-04-2008 JW kopieret fra FTF\r\n\r\nfunction FTFShowHTMLNotes(DLEntityNameForeign, DLEntityId, bPrint) {\r\n\tif (bPrint) {\r\n\t\tvar win = window.open('http://intranet/EX_SQLSVC/DynamicList.html?DLEntity=DL_HTMLDocuments&DLView=DL_HTMLNotesView&Where=DL_EntityNameForeign = \\'' + DLEntityNameForeign + '\\' and DL_EntityId = ' + DLEntityId + '&OrderBy=DL_Modified DESC&PropList=DL_Title&Action=none','Journalark');\r\n\t\tvar WebBrowser = '<OBJECT ID=\"WebBrowser1\" WIDTH=0 HEIGHT=0 CLASSID=\"CLSID:8856F961-340A-11D0-A96B-00C04FD705A2\"></OBJECT>';\r\n\tvar oEle = win.document.getElementById('EXDSResultDiv');\r\n//alert(oEle);\r\n\t\toEle.insertAdjacentHTML('beforeEnd', WebBrowser);\r\n\t\twin.document.body.WebBrowser1.ExecWB(7,2);\r\n\r\n\r\n\t\t\t\r\n\t}\r\n\tloadcontent2('http://intranet/EX_SQLSVC/DynamicList.html?DLEntity=DL_HTMLNotes&DLView=DL_HTMLNotesView&Where=DL_EntityNameForeign = \\'' + DLEntityNameForeign + '\\' and DL_EntityId = ' + DLEntityId + '&OrderBy=DL_Modified DESC&PropList=DL_Title&Action=none','Journalark');\r\n}\r\n\r\n\r\n//JW 15-04-2008 hentet fra FTF\r\n\r\nfunction DLPostboxhandleCaseNo() {\r\n\tvar oEle = document.getElementById('DL_sAMAccountNameForeign');\r\n\tif (oEle == null)\r\n\t\treturn;\r\n\t//alert(oEle.value);\r\n\tvar oEle1 = document.getElementById('DL_CaseNo');\r\n\tif (oEle1 == null)\r\n\t\treturn;\r\n\t//alert('DLPostboxhandleCaseNo ' + oEle.value + '-' + oEle1.value);\r\n\tif (oEle1.value != '' && oEle.value == '') {\r\n\t\tvar oXML = getEntityData('DL_CMAllView','DL_CaseNo = \\'' + oEle1.value + '\\'','');\r\n\t\tvar s = getsafe(oXML, '//DL_Responsible');\r\n\t\tif (s != '')\r\n\t\t\toXML = getEntityData('DL_sAMAccountName','DL_sAMAccountName = \\'' + s + '\\'','');\r\n\t\tvar sPostbox = getsafe(oXML, '//DL_Postbox');\r\n\t\toEle1 = document.getElementById('DL_Postbox');\r\n\t\tif (oEle1 != null && sPostbox != '') { // 15.4.2008 - WHAT DOES THIS CODE REALLY DO???\r\n\t\t\toEle1.value = sPostbox;\r\n\t\t\tDLPostboxSetEmployee();\r\n//alert(s + ' ' + sPostbox);\r\n\t\t}\r\n\t\toEle = document.getElementById('DL_sAMAccountNameForeign');\r\n\r\n\t\t//alert(s + ' ' + oXML.xml);\r\n\t\toEle.value = s;\r\n\t}\r\n}\r\nfunction LOGotoPostbox() { // 27.11.2014\r\n\tvar s = '/Postbakke/Pages/default.aspx?DL_PostBox=21&Initialer=' + GetEntityItemWhere('DL_sAMAccountName','DL_sAMAccountName=%DL_sAMAccountName%','DL_sAMAccountName');\r\n//alert(s);\r\n\tEXGotoUrl(s);\r\n}\r\nfunction SendITEmail(DLCaseNote)\r\n{\r\n\tvar xCaseNote = getEntityData('IT_CaseNotes', 'DL_Id = ' +DLCaseNote, '');\r\n\tvar DLBody = getsafe(xCaseNote, '//DL_HTMLText');\r\n\tvar TemplateId = getsafe(xCaseNote, '//IT_MailTemplate');\r\n\tvar ITCase = getsafe(xCaseNote, '//DL_EntityId');\r\n\tvar xSag = getEntityData('IT_Case', 'DL_Id = ' + ITCase, '');\r\n\tvar ITCaseTitle = getsafe(xSag, '//DL_Title');\r\n\tvar ITCaseUser = getsafe(xSag, '//DL_CreatedByUser');\r\n\tvar ITEmailTo = getsafe(xCaseNote, '//DL_ToMail');\r\n\r\n\tvar DLMailType = GetEntityItemValue('IT_MailTemplate',TemplateId,'IT_EmailRecipientType');\r\n\tvar DLMailFrom = ''; //'ITSupport@alka.dk';\r\n\r\n\tvar outlookApp;\r\n\toutlookApp = getOutlook();\r\n\tif (outlookApp == null) {\r\n\t\toutlookApp = null;\r\n\t}\r\n\telse {\r\n\t\ttry {\r\n\t\t\tvar oItem;\r\n\t\t\tvar sOldBody = '';\r\n\t\t\tvar oDoc;\r\n\r\n\t\t\toItem = outlookApp.CreateItem(0);\r\n\t\t\toItem.HTMLBody = DLBody;\r\n\t\t\toItem.Subject = 'IT Support: ' + ITCaseTitle;\r\n\t\t\toItem.SentOnBehalfOfName = DLMailFrom;\r\n\t\t\toItem.To = ITEmailTo;\r\n\t\t\toItem.Display();\r\n\t\t\t//alert('newjournal(' + DL_Company + ',' + name + ',' + type1 + ')');\r\n\t\t\toutlookApp = null;\r\n\t\t\toItem = null;\r\n\t\t\tvar today = new Date();\r\n\tvar sYear  = today.getFullYear();\r\n\tvar sMonth = today.getMonth() + 1;\r\n\tvar sDay  = today.getDate();\r\n\tvar sHours = today.getHours();\r\n\tvar sMinutes = today.getMinutes();\r\n\r\n\t\t\tSetEntityItemValue('IT_CaseNotes',DLCaseNote,GetEntityItemValue('IT_CaseNotes',DLCaseNote,'DL_Modified'),'IT_MailSent',sYear + '-' + sMonth + '-' + sDay + ' ' + sHours + ':'  + sMinutes);\r\n//\t\t\talert('SetEntityItemValue');\r\n\t\t}\r\n\t\tcatch (e) { alert('exception'); }\r\n\t}\r\n}\r\n//alert('Exformatics_cust.js loaded');\r\nfunction RKRGotoCase(DLCaseNo) { // 25.2.2008\r\n//alert('EXGotoCase(' + DLCaseNo + ')');\r\n\tvar oXML;\r\n\tif (DLCaseNo.indexOf('-') == -1) { // 29.9.2008\r\n\t\tvar s = EXGetTodaysDate();\r\n\t\tif (DLCaseNo.length < 4)\r\n\t\t\tDLCaseNo = '0' + DLCaseNo;\r\n\t\tif (DLCaseNo.length < 4)\r\n\t\t\tDLCaseNo = '0' + DLCaseNo;\r\n\t\tif (DLCaseNo.length < 4)\r\n\t\t\tDLCaseNo = '0' + DLCaseNo;\r\n\t\tDLCaseNo = s.substr(2,2) + '-' + DLCaseNo;\r\n\t}\r\n\tif (DLCaseNo.length >= 7)\r\n\t\toXML = getEntityData('RKR_Activities','DL_CaseNo = \\'' + DLCaseNo + '\\'', '');\r\n\telse\r\n\t\toXML = getEntityData('RKR_Activities','DL_CaseNo LIKE \\'' + DLCaseNo + '%\\'', '');\r\n\tvar sId = getsafe(oXML, '//DL_Id');\r\n\tif (sId != '')\r\n\t\tEXGotoObject('RKR_Activities', sId);\r\n\telse { // 9.9.2008\r\n\t\t//var LEXCannotFindCase = 'Cannot find case {0}';\r\n\t\tvar LEXCannotFindCase = 'Kan ikke finde sag {0}';\r\n\t\talert(LEXCannotFindCase.format(DLCaseNo));\r\n\t}\r\n}\r\nfunction EXRolloutEmployeeCases(HRID) {\r\nalert('2');\r\n\tvar oXML  = getEntityData('DL_Employee', 'DL_HRID = \\'' + HRID + '\\'', '');\r\nalert('1');\r\n\tloadcontent2(getAbsoluteURL('/EX_SQLSVC/DynamicList.html?DLEntity=DL_CaseTemplates&PropList=checkbox,DL_Title&Action=none&y=1003&ClickAction=543&ForeignKeys=DL_Name,DL_Manager&ForeignValues=' + getsafe(oXML, '//DL_Name') + ',' + HRID),'Udrul sager for ' + getsafe(oXML, '//DL_Name'));\r\n}\r\n// CN_PublishDocBasket\r\nfunction CN_PublishDocBasket(DLId)\r\n{\r\n\tExecuteProcedure('dbo.EXPublishDocBasket @DLEntityNameForeign = \\'DL_DocPublishing\\', @DLEntityId = ' + DLId + ',@WUser = \\'\\'');\r\n}\r\nfunction EXGotoOpenDepartmentTasks() {\r\nEXGotoUrl('http://servsagssystem/Pages/Aabneafdelingsopgaver.aspx');\r\n//\talert('Not implemented yet - Exformatics_cust.js');\r\n}\r\n\r\nfunction TV2EditExponering(key, date, DLId) {\r\n//alert('TV2EditBooking ' + DLId);\r\n\tvar oXML = getEntityData('DL_Exponering', 'DL_Id = ' + DLId, '');\r\n\tvar TV2Element = getsafe(oXML, '//TV2_ElementMedie');\r\n\tvar DLBookingType = getsafe(oXML, '//DL_ExponeringType');\r\n\tvar sTitle;\r\n\tif (DLBookingType == 'Ferie' || DLBookingType == 'Sygdom')\r\n\t\tsTitle = DLBookingType;\r\n\telse {\r\n\t\toXML = getEntityData('TV2_ElementView', 'DL_Id = ' + TV2Element, '');\r\n\t\tsTitle = getsafe(oXML, '//TV2_KampagneTitle');\r\n\t}\r\n\tvar url = getAbsoluteURL('/EX_SQLSVC/DynamicForm.aspx?update=true&DL_ENTITY=DL_Booking&where=DL_Id=' + DLId + '&PageTitle=' + sTitle + '&check=' + Math.random());\r\n\t\r\n\tmodalDialog.dialog('open');\t\r\n\tmodalDialog.dialog( \"option\", \"title\", 'Rediger exponering for ' + key + ' den ' + date );\r\n\tmodalDialog.html('<iframe id=\"JQInfo\" frameborder=\"0\" width=\"100%\" height=\"95%\" src=\"'+url+'\" ></iframe>');\r\n}\r\n\r\nfunction TV2EditBooking(key, date, DLId) {\r\n//alert('TV2EditBooking ' + DLId);\r\n\tvar oXML = getEntityData('DL_Booking', 'DL_Id = ' + DLId, '');\r\n\tvar TV2Element = getsafe(oXML, '//TV2_Element');\r\n\tvar DLBookingType = getsafe(oXML, '//DL_BookingType');\r\n\tvar sTitle;\r\n\tif (DLBookingType == 'Ferie' || DLBookingType == 'Sygdom')\r\n\t\tsTitle = DLBookingType;\r\n\telse {\r\n\t\toXML = getEntityData('TV2_ElementView', 'DL_Id = ' + TV2Element, '');\r\n\t\tsTitle = getsafe(oXML, '//TV2_KampagneTitle');\r\n\t}\r\n\tvar url = getAbsoluteURL('/EX_SQLSVC/DynamicForm.aspx?update=true&DL_ENTITY=DL_Booking&where=DL_Id=' + DLId + '&PageTitle=' + sTitle + '&check=' + Math.random());\r\n\t\r\n\tmodalDialog.dialog('open');\t\r\n\tmodalDialog.dialog( \"option\", \"title\", 'Rediger booking for ' + key + ' den ' + date );\r\n\tmodalDialog.html('<iframe id=\"JQInfo\" frameborder=\"0\" width=\"100%\" height=\"95%\" src=\"'+url+'\" ></iframe>');\r\n}\r\n\r\nfunction TV2CreateBooking(key, date, bookingType) {\r\n\tvar oXML = getEntityData('DL_sAMAccountName', 'DL_Name = \\'' + key + '\\'', '');\r\n\tvar sAMAccountName = getsafe(oXML, '//DL_sAMAccountName/DL_sAMAccountName');\r\n\tvar url = '';\r\n\r\n\tif (bookingType != '') {\r\n    \turl = getAbsoluteURL('/EX_SQLSVC/DynamicForm.aspx?new=true&DL_ENTITY=DL_Booking&DefaultKeys=TV2_Resource,DL_StartDate,DL_BookingType&DefaultValues=' + sAMAccountName + ',' + date + ',' + bookingType + '&PageTitle=Opret ' + bookingType.toLowerCase() + '-booking for ' + key + ' den ' + date + '&check=' + Math.random());\r\n\t} else {\r\n\t\turl = getAbsoluteURL('/EX_SQLSVC/DynamicSearch.html?DLEntity=TV2_ElementView&SearchParameters=TV2_KampagneTitle,TV2_Season,TV2_Customer,TV2_TrailerDate,TV2_ProgramDate,TV2_ProdType:Trailer&ClickAction=Create,DL_Booking,DL_Id:::,TV2_Element:DL_sAMAccountNameForeign:DL_StartDate:DL_BookingType,:' + sAMAccountName + ':' + date + ':Element,Opret booking for ' + key + ' den ' + date + '&&check=' + Math.random());\r\n\t}\r\n//\tEXCopyToClipboard(url);\r\n\t\r\n\t// Til brug for titel\r\n\tif (bookingType == '') bookingType = 'booking';\r\n\tmodalDialog.dialog('open');\t\r\n\tmodalDialog.dialog( \"option\", \"title\", 'Opret '+bookingType.toLowerCase()+' for ' + key + ' den ' + date );\r\n\tmodalDialog.html('<iframe id=\"JQInfo\" frameborder=\"0\" width=\"100%\" height=\"95%\" src=\"'+url+'\" ></iframe>');\r\n}\r\n\r\nfunction TV2CreateMilestone(date, sElement) {\r\n\t\tvar sTitle = '';\r\n\tvar url = getAbsoluteURL('/EX_SQLSVC/DynamicForm.aspx?new=true&DL_ENTITY=DL_Milestone&DefaultKeys=TV2_Element,DL_DueDate&DefaultValues=' + sElement + ',' + date + '&PageTitle=' + sTitle + '&check=' + Math.random());\r\n\t\r\n\tmodalDialog.dialog('open');\t\r\n\tmodalDialog.dialog( \"option\", \"title\", 'Opret milestone den ' + date );\r\n\tmodalDialog.html('<iframe id=\"JQInfo\" frameborder=\"0\" width=\"100%\" height=\"95%\" src=\"'+url+'\" ></iframe>');\t\r\n}\r\nfunction EXShowWFCaseType(DLEntityNameForeign, DLWFCaseType) {\r\n\tloadcontent2('/EX_Resources/EXExformation.html?DL_EntityNameForeign=DL_WFCaseType&DL_EntityId=' + DLWFCaseType,LEX_KnowledgeExchanges);\r\n\r\n\t// Load several lists\r\n\tvar oXML = getEntityData('DL_WFCaseType', 'DL_Id=' + DLWFCaseType, '');\r\n\tvar DLsAMAccountNameForeign = getsafe(oXML, '//DL_sAMAccountNameForeign');\r\n\tvar xOwner = getEntityData('DL_sAMAccountName','DL_sAMAccountName = \\'' + DLsAMAccountNameForeign + '\\'', '');\r\n\tvar DLURLImage = getsafe(xOwner, '//DL_URLImage');\r\n\tvar DLName = getsafe(xOwner, '//DL_Name');\r\n\r\n\tvar sTable;\r\n\r\n\t// Entity detail\r\n\tsTable = '<table>';\r\n\tsTable += AddTableRow('Title', '<a href=\"javascript:\" onclick=\"loadentity(\\'DL_WFCaseType\\', ' + DLWFCaseType + ')\">' + getsafe(oXML, '//DL_Title') + '</a>');\r\n\tsTable += AddTableRow('Owner', DLName + (DLURLImage==''?'':'<img border=\"0\" src=\"' + DLURLImage + '\" width=\"32px\"></img>'));\r\n\tvar sDesc = getsafe(oXML, '//DL_HTMLText');\r\n\tsDesc = sDesc.replace('PHASEDESCRIPTION', '');\r\n\tif (sDesc != '')\r\n\t\tsTable += '<tr><td class=\"ms-vb\" colspan=\"2\">' + sDesc + '</td></tr>';\r\n\tsTable += '</table>';\r\n\tvar oEle = document.getElementById('EXWFCaseTypeHeader');\r\n\toEle.innerHTML = sTable;\r\n\r\n\t// Usage\r\n\toEle = document.getElementById('EXWFCaseTypeUsage');\r\noEle.innerHTML = '2';\r\n\r\n\t// Distribution\r\n\toEle = document.getElementById('EXWFCaseTypeDistribution');\r\n/*\r\n       google.load(\"visualization\", \"1\", {packages:[\"corechart\"]});\r\n       google.setOnLoadCallback(\r\n\tfunction () {\r\n\t\tvar oPhases = getEntityData('DL_WFCaseTypePhase','DL_WFCaseType = ' + DLWFCaseType + ' AND isnull(DL_WFCaseIsComplete, 0) = 0', 'DL_SequenceNo');\r\n\t\tDoDraw(DLEntityNameForeign, oPhases);\r\n\t}\r\n);\r\n*/\r\n\r\noEle.innerHTML = '<iframe frameborder=\"0\" width=\"100% height=\"480px\" id=\"EXWFCaseTypeDistributionIFRAME\"></iframe>';\r\n\tloadcontent('http://intranet/EX_Resources/EXWFPhaseStatistics.html?DL_WFCaseType=' + DLWFCaseType, 'EXWFCaseTypeDistributionIFRAME');\r\n\r\n\t// Last modified\r\n\toEle = document.getElementById('EXWFCaseTypeLatest')\r\n\tEXshowListData('EXWFCaseTypeLatest',DLEntityNameForeign,'DL_WFCaseType=' + DLWFCaseType,'DL_Modified DESC','DL_ProjectName,DL_LastModified,DL_LastModifiedBy','javascript:EXGotoObject(\\'' + DLEntityNameForeign + '\\',%DL_Id%)','','',false,'','5');\r\n//oEle.innerHTML = '4';\r\n\r\n\t// Active users\r\n\toEle = document.getElementById('EXWFCaseTypeActiveUsers');\r\n\tvar xUsers = getEntityData2('DL_sAMAccountName,DL_Name,DL_URLImage','DL_sAMAccountName', '', '');\r\n\tvar oUsers = getEntityData3('top 5 DL_LastModifiedBy,count(*) as Count',DLEntityNameForeign,'DL_WFCaseType=' + DLWFCaseType + ' AND NOT DL_LastModifiedBy is null','2 DESC','DL_LastModifiedBy');\r\n\tvar xNodes = oUsers.selectNodes('//' + DLEntityNameForeign);\r\n\tvar content, sAMAccountName, j, xUser;\r\n\tsTable = '<table>';\r\n\tfor (var i=0;i<xNodes.length;i++) {\r\n\t\tsAMAccountName = getsafe(xNodes[i], 'DL_LastModifiedBy');\r\n\t\tj = sAMAccountName.indexOf('\\\\');\r\n\t\tif (j>0)\r\n\t\t\tsAMAccountName = sAMAccountName.substr(j+1);\r\n\t\txUser = xUsers.selectSingleNode('//DL_sAMAccountName[DL_sAMAccountName=\\'' + sAMAccountName + '\\']');\r\n//alert(sAMAccountName + ' ' + xUser);\r\n\t\tcontent = '<img width=\"32px\" border=\"0\" alt=\"' + getsafe(xUser, 'DL_Name') + '\" src=\"' + getsafe(xUser, 'DL_URLImage') + '\"></img>'  + getsafe(xNodes[i], 'Count');\r\n\t\tsTable += AddTableRow('', content);\r\n\t}\r\n\tsTable += '</table>';\r\n\toEle.innerHTML = sTable;\r\n}\r\nfunction DoDraw(DLWFCaseEntity, oPhases) {\r\n\tdata = new google.visualization.DataTable();\r\n\tdata.addColumn('string', 'Phase');\r\n\tdata.addColumn('number', 'Total');\r\n\tdata.addColumn('number', 'Overdue');\r\n\tvar xNodes = oPhases.selectNodes('//DL_WFCaseTypePhase');\r\n\tvar sWhere = 'isnull(DL_CaseState,0) = 0 AND DL_WFCaseType = ' + DLWFCaseType;\r\n\r\n\tvar xCase = getEntityData3('isnull(DL_CaseLongState,0) as DL_CaseLongState,count(*) as Count',DLWFCaseEntity,sWhere,'DL_CaseLongState','DL_CaseLongState');\r\n\tvar xOverdue;\r\n\tif (DLWFCaseEntity == 'IT_Case')\r\n\t\txOverdue = getEntityData3('DL_CaseLongState,count(*) as Count',DLWFCaseEntity,sWhere + ' AND DL_DueDate < getdate()','DL_CaseLongState','DL_CaseLongState');\r\n\telse\r\n\t\txOverdue = getEntityData3('DL_CaseLongState,count(*) as Count',DLWFCaseEntity,sWhere + ' AND EXISTS (SELECT DL_Id from DL_CaseMilestones where DL_EntityNameForeign=\\'' + DLWFCaseEntity +'\\' AND DL_EntityId = ' + DLWFCaseEntity + '.DL_Id AND DL_SequenceNo = ' + DLWFCaseEntity + '.DL_CaseLongState AND DL_DueDate < getdate())','DL_CaseLongState','DL_CaseLongState');\r\n         data.addRows(xNodes.length);\r\n\tvar DLTitle, DLCount, DLSequenceNo, DLOverdue;\r\n\tfor (var i=0; i<xNodes.length;i++) {\r\n\t\tDLTitle = getsafe(xNodes[i], 'DL_Title');\r\n\t\tDLSequenceNo = getsafe(xNodes[i], 'DL_SequenceNo');\r\n\t\tDLCount = getsafe(xCase,'//' + DLWFCaseEntity + '[DL_CaseLongState=' + DLSequenceNo + ']/Count');\r\n\t\tDLOverdue = getsafe(xOverdue,'//' + DLWFCaseEntity + '[DL_CaseLongState=' + DLSequenceNo + ']/Count');\r\n\t\tif (DLOverdue == '')\r\n\t\t\tDLOverdue = '0';\r\n\t\tdata.setValue(i, 0, DLTitle); // Phase\r\n\t\tdata.setValue(i, 1, 1 * DLCount);\r\n\t\tdata.setValue(i, 2, 1 * DLOverdue);\t\r\n\t}\r\n\tchart = new google.visualization.ColumnChart(document.getElementById('chart_div'));\r\n\tchart.draw(data, {width: 400, height: 240, title: 'Cases by phase',                           \r\nhAxis: {title: 'Phase', titleTextStyle: {color: 'red'}}                          });\r\n\r\ngoogle.visualization.events.addListener(chart,'select',ChartSelectionHandler); \r\n\r\n} \r\n\r\nfunction LONewMeeting(Entity,Id) { // 9.3.2009\r\n\tvar DLEntity = queryString('ForeignKeys');\r\n\tvar DLId = queryString('ForeignValues');\r\n\tvar aValues = DLId.split(',');\r\n\tEntity = aValues[0];\r\n\tId = aValues[1];\r\n\tif (!confirm('M\\370de oprettet - opret nyt m\\370de?')) {\r\n\t\tEXReload();\r\n\t\treturn;\r\n\t}\r\n\t//alert('LONewMeeting(' + Entity + ',' + Id + ')');\r\n\tparent.newentity('LO_SuggestMeetingDate','DL_EntityNameForeign,DL_EntityId,LO_SuggestMeetingOrigin',Entity + ',' + Id + ',LO','Action=646');\r\n}\r\nfunction LOSetPersonAddressPrimary(DLId) {\r\n  var oXML = getEntityData('DL_PersonAddress','DL_Id=' + DLId,'');\r\n  SetEntityItemValue('DL_PersonAddress',DLId,getsafe(oXML,'//DL_Modified'),'DL_IsPrimaryAddress','1');\r\n  EXReload();\r\n}\r\n\r\nfunction LOSetPersonEmailPrimary(DLId) {\r\n  var oXML = getEntityData('DL_Communication','DL_Id=' + DLId,'');\r\n  SetEntityItemValue('DL_Communication',DLId,getsafe(oXML,'//DL_Modified'),'DL_CommunicationTypePrimary','1');\r\n  EXReload();\r\n}\r\n\r\nfunction LOSetOrganisationAddressPrimary(DLId) {\r\n  var oXML = getEntityData('DL_OrganisationAddress','DL_Id=' + DLId,'');\r\n  SetEntityItemValue('DL_OrganisationAddress',DLId,getsafe(oXML,'//DL_Modified'),'DL_IsPrimaryAddress','1');\r\n  EXReload();\r\n}\r\nfunction FEAGotoPerson(DL_Id) {\r\n\t// LH+MMQ 5/10 2012 Changed to solve IT Case 1115\r\n\tEXGotoObject('DL_Person',DL_Id);\r\n}\r\nfunction LOEUCockpitLoadEntity(DLEntityNameForeign, DLEntityId) { \r\n    \r\n\tvar oDiv = parent.document.getElementById('LOEUCockpitEntityDetail');\r\n\tvar xSag = getEntityData(DLEntityNameForeign, 'DL_Id = ' + DLEntityId, '');\r\n\tvar responsible = '';\r\n\tvar responsibles = xSag.selectNodes('//DL_Responsible');\r\n\t\r\n\t// 2964: 31 jan 2012 js/maig  - responsible / responsibles\r\n\t//\r\n\t\r\n\tfor(var i = 0; i < responsibles.length; i++){\r\n\t    var node = responsibles[i];\r\n\t\t\r\n\t    if(node.firstChild.nodeValue && node.firstChild.nodeValue.length != 0) { \r\n\t\t\tresponsible += ' @' + node.firstChild.nodeValue + ' '; // 1112 LH/MAIG 14-9 2012\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\t\r\n\tvar userProfile = ExecuteProcedure(\"EXGetUserProfile @sAMAccountName = '\" + responsible + \"'\");\r\n\t//alert(userProfile.xml);\r\n    var fullName = getsafe(userProfile, '//DL_FullName');\r\n    var phone = getsafe(userProfile, '//DL_Phone');\r\n\tvar sExtra = getsafe(xSag, '//DL_Fagkonsulent');\r\n\tvar sFagkonsulent = '';\r\n\tif (sExtra != '') {\r\n\t\t\r\n\t\tvar xFagK = getEntityData('DL_sAMAccountName', 'DL_sAMAccountName = \\'' + sExtra + '\\'', '');\r\n\t\tsFagkonsulent = 'Fagkonsulent: ' + getsafe(xFagK, '//DL_Name') + '<br/>';\r\n\t\tsExtra = ' @' + sExtra + ' ';\r\n\t\t\r\n\t}\r\n\r\n\tvar sInfo = getsafe(xSag, '//DL_Info');\r\n\tif (sInfo != '') {\r\n\t\t\r\n\t\tsInfo = sInfo.replace(/;/g, ' @');\r\n\t\tif (sInfo.length-1 == sInfo.lastIndexOf('@')) {\r\n\t\t\tsInfo = sInfo.substr(0,sInfo.length-1);\r\n\t\t}\r\n\t\t\r\n\t\t // 1112 LH/MAIG 14-9 2012\r\n\t\tif (sInfo.indexOf(' @') > 0) {\r\n\t\t\tsInfo = ' @' + sInfo;\r\n\t\t}\t\t\r\n\t\tif (sInfo.indexOf('@') == -1) {\r\n\t\t\tsInfo = ' @' + sInfo;\r\n\t\t}\r\n\t\t\t\r\n\t\tsExtra += sInfo;  // ' @' Also part of 2964 See also: below str\\370mmen: ' was earlier: str\\370mmen: @'\r\n\t}\r\n\r\n\r\n \r\n\r\nvar ss=\r\n\t\t'<table width=\"90%\">\\\r\n\t\t    <tr>\\\r\n\t\t        <td width=\"50%\">\\\r\n\t\t            <table style=\"border-style: solid; border-width:1px;\" width=\"100%\">\\\r\n\t\t                <tr>\\\r\n\t\t                    <td width=\"100%\">\\\r\n\t\t                        <h3 class=\"ms-standardheader ms-WPTitle\">\\\r\n\t\t                            <span><a href=\"javascript:\" title=\"Til sag\" onclick=\"EXGotoObject(\\'' + DLEntityNameForeign + '\\',' + DLEntityId + ')\">' + getsafe(xSag, '//DL_Title') + '</a></span>\\\r\n\t\t                        </h3>\\\r\n\t\t                    </td>\\\r\n\t\t                </tr>\\\r\n\t\t                <tr>\\\r\n\t\t                    <td>\\\r\n\t\t                        Sagsansvarlig: ' + fullName + '<br/>Telefon: ' + phone + '<br/>' + sFagkonsulent + '<br/><a href=\"#\" title=\"Besked, direkte i ' + responsible + 's inbox\" onclick=\"top.frames[1].FocusExformation(\\''\r\n\t\t                            + responsible + sExtra\r\n\t\t                            + ' \\');return false;\">L\\346g en besked til sagsansvarlig i str\\370mmen: ' \r\n\t\t                            + responsible + sExtra +\r\n\t\t                        '</a>\\\r\n\t\t                    </td>\\\r\n                        </tr>\\\r\n                    </table>\\\r\n                </td>\\\r\n            </tr>\\\r\n        </table>';\r\n\r\n\toDiv.innerHTML = ss;\r\n\tparent.EXLoadActivityStream(DLEntityNameForeign,DLEntityId,false,0);\r\n//        parent.loadcontent(getAbsoluteURL('/EX_Resources/EXExformation.html?DL_EntityNameForeign=' \r\n//        + DLEntityNameForeign + '&DL_EntityId=' + DLEntityId) + '&DLType=0', '', 'Aktivitetsstr\\370m: ' + getsafe(xSag, '//DL_Title'));\r\n}\r\nfunction LONySagslog(DLEntityNameForeign, DLEntityId) { // 6.8.2008\r\n\tvar oXML = getEntityData('LO_CaseLog','DL_EntityNameForeign = \\'' + DLEntityNameForeign + '\\' AND DL_EntityId = ' + DLEntityId,'');\r\n\tif (getsafe(oXML, '//DL_Id') == '') {\r\n\t\tnewentity('LO_CaseLog','DL_EntityNameForeign,DL_EntityId',DLEntityNameForeign + ',' + DLEntityId);\r\n\t}\r\n\telse {\r\n\t\tif (window.event) { // 23.2.2009\r\n\t\t\tif (window.event.ctrlKey) {\r\n\t\t\t\tvar sUrl = getLoadEntityUrl('LO_CaseLog', getsafe(oXML, '//DL_Id'));\r\n\t\t\t\t\r\n\t\t\t\tvar ew = window.open(sUrl);\r\n\t\t\t\tew.focus();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\tloadentity('LO_CaseLog', getsafe(oXML, '//DL_Id'));\r\n\t}\r\n}\r\nfunction LONewCaseAddress(CaseAddressType, DLEntityNameForeign, DLEntityId) { // 4.1.2009\r\n\tvar sForeignKeys = 'DL_EntityNameForeign,DL_EntityId,DL_CaseAddressType';\r\n\tvar sForeignValues = '' + DLEntityNameForeign + ',' + DLEntityId + ',' + CaseAddressType;\r\n\tswitch(CaseAddressType) {\r\n\tcase 1: // Explicit\r\n\t\tnewentity('DL_CaseAddresses',sForeignKeys,sForeignValues);\r\n\t\tbreak;\r\n\tcase 77: // FEA Person\r\n\t\tvar sUrl = getAbsoluteURL('/EX_SQLSVC/DynamicSearch.html?DLEntity=DL_PersonOrganisationSearchView&ForeignKeys=' + sForeignKeys + '&ForeignValues=' + sForeignValues + '&SearchParameters=DL_Name,DL_OrganisationTitle&DisplayParameters=DL_Name,DL_OrganisationTitle&Tooltip=Choose value&ClickAction=533&SearchOnLoad=false&Pro1pName=DL_Contacts&XPat1hDLId=DLContactID&CaseType=77');\r\n\t\tloadcontent2(sUrl, 'Opret FEA person som ' + LEXCaseAddress);\r\n\t\tbreak;\r\n\tcase 99: // Medarbejder\r\n\t\tvar sUrl = getAbsoluteURL('/EX_SQLSVC/DynamicSearch.html?DLEntity=DL_sAMAccountName&ForeignKeys=' + sForeignKeys + '&ForeignValues=' + sForeignValues + '&SearchParameters=DL_FullName,DL_JobTitle&DisplayParameters=DL_FullName,DL_JobTitle&Tooltip=Choose value&ClickAction=533&SearchOnLoad=false&PropName=DL_Contacts&CaseType=99');\r\n\t\tloadcontent2(sUrl, 'Opret medarbejder som ' + LEXCaseAddress); // 16.12.2008\r\n\t\tbreak;\r\n\t}\r\n}\r\nfunction LONewCaseActor(CaseActorType, DLEntityNameForeign, DLEntityId) { // 26.12.2008\r\n//alert('LONewCaseActor(' + CaseActorType + ',' + DLEntityNameForeign + ',' + DLEntityId + ') started');\r\n\tswitch(CaseActorType) {\r\n\tcase 10: // Hovedorganisation - D760,LO_DAOrganiseretCodes\r\n\t\tloadcontent2(getAbsoluteURL('/EX_SQLSVC/DynamicSearch.html?DLEntity=DL_D760&WhereExtra=DL_PropDictionary=\\'LO_DAOrganiseretCodes\\'&SearchParameters=DL_PropCodeDecode&Rows=16&SearchOnLoad=true&ClickAction=610&ForeignKeys=DL_CaseActorType,DL_EntityNameForeign,DL_EntityId&ForeignValues=10,' + DLEntityNameForeign + ',' + DLEntityId),'Opret sagsakt\\370r - hovedorganisation');\r\n\t\tbreak;\r\n\tcase 20: // Organisation - DA m.fl. medlemsorganisationer - kan vi søge dem i FEA?\r\n\t\tloadcontent2(getAbsoluteURL('/EX_SQLSVC/DynamicSearch.html?DLEntity=DL_Organisation&WhereExtra=DL_OrganisationType=\\'ARBGIV\\' AND DL_Add=1&SearchParameters=DL_Title,DL_ParentOrganisationDenorm&Rows=16&SearchOnLoad=true&ClickAction=612&ForeignKeys=DL_CaseActorType,DL_EntityNameForeign,DL_EntityId&ForeignValues=20,' + DLEntityNameForeign + ',' + DLEntityId),'Opret sagsakt\\370r - organisation');\r\n\t\tbreak;\r\n\tcase 30: // Firma\r\n\t\tnewentity2('DL_CaseActor','DL_CaseActorType,DL_EntityNameForeign,DL_EntityId','30,' + DLEntityNameForeign + ',' + DLEntityId,'','Opret ny sagspart: firma');\r\n\t\tbreak;\r\n\tcase 40: // Advokat\r\n\t\tnewentity('DL_CaseActor','DL_CaseActorType,DL_EntityNameForeign,DL_EntityId','40,' + DLEntityNameForeign + ',' + DLEntityId,'','Opret ny sagspart: advokat');\r\n\t\tbreak;\r\n\tcase 50: // Hovedforbund - altid LO selv - meningsløst at oprette\r\n\t\talert('LO vil altid v\\346re hovedforbund p\\345 sager. Kan derfor ikke oprette.');\r\n\t\tbreak;\r\n\tcase 60: // Forbund - DL_EXCompany, DL_CompanyShort:DL_EXCompany, where DL_AddressType=100\r\n\t\tloadcontent2(getAbsoluteURL('/EX_SQLSVC/DynamicSearch.html?DLEntity=DL_EXCompany&WhereExtra=DL_AddressType=100&SearchParameters=DL_CompanyShort,DL_EXCompany&Rows=16&SearchOnLoad=true&ClickAction=611&ForeignKeys=DL_CaseActorType,DL_EntityNameForeign,DL_EntityId&ForeignValues=60,' + DLEntityNameForeign + ',' + DLEntityId),'Opret sagsakt\\370r - forbund');\r\n\t\tbreak;\r\n\tcase 70: // Advokat (fagforbund)\r\n\t\tnewentity('DL_CaseActor','DL_CaseActorType,DL_EntityNameForeign,DL_EntityId','70,' + DLEntityNameForeign + ',' + DLEntityId,'','Opret ny sagspart: advokat (fagforbund)');\r\n\t\tbreak;\r\n\tcase 80: // Andet\r\n\t\tnewentity('DL_CaseActor','DL_CaseActorType,DL_EntityNameForeign,DL_EntityId','80,' + DLEntityNameForeign + ',' + DLEntityId,'','Opret ny sagspart: andet');\r\n\t\tbreak;\r\n\t}\r\n}\r\nfunction LONewCaseActorHovedorganisation(DLId, ForeignKeys, ForeignValues) {\r\n\tvar oXML = getEntityData('DL_D760','DL_Id = ' + DLId, '');\r\n\tvar title = getsafe(oXML, '//DL_PropCodeDecode');\r\n\tvar s = '<DL_CaseActor><DL_Title>' + MakeXMLSafe(title) + '</DL_Title>';\r\n\tvar aKeys = ForeignKeys.split(',');\r\n\tvar aValues = ForeignValues.split(',');\r\n\tfor (var i=0;i<aKeys.length;i++) {\r\n\t\ts += '<' + aKeys[i] + '>' + aValues[i] + '</' + aKeys[i] + '>';\r\n\t}\r\n\ts += '<DL_EntityNameForeign2>DL_D760</DL_EntityNameForeign2>';\r\n\ts += '<DL_EntityId2>' + DLId + '</DL_EntityId2>';\r\n\ts += '</DL_CaseActor>';\r\n\tDLId = setEntityDetail('DL_CaseActor',s);\r\n\tparent.loadentity('DL_CaseActor', DLId);\r\n}\r\nfunction LONewCaseActorForbund(DLId, ForeignKeys, ForeignValues) {\r\n\tvar oXML = getEntityData('DL_EXCompany','DL_Id = ' + DLId, '');\r\n\tvar title = getsafe(oXML, '//DL_EXCompany/DL_EXCompany');\r\n\tvar s = '<DL_CaseActor><DL_Title>' +  MakeXMLSafe(title) + '</DL_Title>';\r\n\ts += '<DL_Street>' +  MakeXMLSafe(getsafe(oXML, '//DL_Street')) + '</DL_Street>';\r\n\ts += '<DL_PostalCode>' + getsafe(oXML, '//DL_PostalCode') + '</DL_PostalCode>';\r\n\ts += '<DL_City>' + getsafe(oXML, '//DL_City') + '</DL_City>';\r\n\ts += '<DL_Phone>' + getsafe(oXML, '//DL_Phone') + '</DL_Phone>';\r\n\tvar aKeys = ForeignKeys.split(',');\r\n\tvar aValues = ForeignValues.split(',');\r\n\tfor (var i=0;i<aKeys.length;i++) {\r\n\t\ts += '<' + aKeys[i] + '>' + aValues[i] + '</' + aKeys[i] + '>';\r\n\t}\r\n\ts += '<DL_EntityNameForeign2>DL_EXCompany</DL_EntityNameForeign2>';\r\n\ts += '<DL_EntityId2>' + DLId + '</DL_EntityId2>';\r\n\ts += '</DL_CaseActor>';\r\n\tDLId = setEntityDetail('DL_CaseActor',s);\r\n\tparent.loadentity('DL_CaseActor', DLId);\r\n}\r\nfunction LONewCaseActorOrganisation(DLId, ForeignKeys, ForeignValues) {\r\n//alert('start');\r\n\tvar oXML = getEntityData('DL_OrganisationAddressPrimaryView','DL_Organisation = ' + DLId, '');\r\n//alert(oXML.xml);\r\n\tvar title = getsafe(oXML, '//DL_Title');\r\n\tvar s = '<DL_CaseActor><DL_Title>' + MakeXMLSafe(title) + '</DL_Title>';\r\n\ts += '<DL_Street>' + MakeXMLSafe(getsafe(oXML, '//DL_Street')) + '</DL_Street>';\r\n\ts += '<DL_PostalCode>' + getsafe(oXML, '//DL_PostalCode') + '</DL_PostalCode>';\r\n\ts += '<DL_City>' + getsafe(oXML, '//DL_City') + '</DL_City>';\r\n\ts += '<DL_Phone>' + getsafe(oXML, '//DL_Phone') + '</DL_Phone>';\r\n\ts += '<DL_CVRNR>' + getsafe(oXML, '//DL_CVRNR') + '</DL_CVRNR>';\r\n\tvar aKeys = ForeignKeys.split(',');\r\n\tvar aValues = ForeignValues.split(',');\r\n\tfor (var i=0;i<aKeys.length;i++) {\r\n\t\ts += '<' + aKeys[i] + '>' + aValues[i] + '</' + aKeys[i] + '>';\r\n\t}\r\n\ts += '<DL_EntityNameForeign2>DL_Organisation</DL_EntityNameForeign2>';\r\n\ts += '<DL_EntityId2>' + DLId + '</DL_EntityId2>';\r\n\ts += '</DL_CaseActor>';\r\n//alert(s);\r\n\tDLId = setEntityDetail('DL_CaseActor',s);\r\n\tparent.loadentity('DL_CaseActor', DLId, 'Action=50'); // 9.3.2009 - Action=50 added\r\n}\r\nfunction LOCreateFagforbundTransmittal(DLId) { // 31.1.2011\r\n\tvar oXML = getEntityData('DL_Case','DL_Id=' + DLId, '');\r\n\tvar DLTransmittal = _EXnewTransmittal('DL_Case',DLId,'Fagforbund dokumenter: ' + getsafe(oXML, '//DL_Title'));\r\n\tEXReload();\r\n\t//loadentity('DL_Transmittal', DLTransmittal);\r\n}\r\nfunction LOShowTransmittalDocuments(DL_Transmittal,title) { // 31.1.2011\r\n\tif (typeof(title) == 'undefined')\r\n\t\ttitle = '';\r\n\tif (title == '')\r\n\t\ttitle = \"Dokumenter til/fra fagforbund...\";\r\n\tloadcontent2(\"/ex_sqlsvc/DynamicList.html?DLEntity=DL_CaseDocuments&DLView=DL_CaseDocumentsView&Where=DL_EntityNameForeign='DL_Transmittal' and DL_EntityId=\" + DL_Transmittal + \"&PropList=DL_DocumentExtension,DL_Title,DL_Modified,DL_ModifiedBy&ClickAction=703&DL_Transmittal=\" + DL_Transmittal,title);\r\n}\r\nfunction LOADDBasket2TransmittalDocuments(DL_Transmittal,bNotify) { // 31.1.2011\r\n\tif (typeof(bNotify) == 'undefined') bNotify=true;\r\n\tif (bNotify) // 2.12.2015\r\n\t\tExecuteProcedure(\"LONotifyDocBasket @DLEntityNameForeign='DL_Transmittal',@DLEntityId=\" + DL_Transmittal); // 16.8.2011\r\n\tExecuteProcedure(\"EXMoveDocBasket2Entity @DLEntityNameForeign='DL_Transmittal',@DLEntityId=\" + DL_Transmittal);\r\n\tparent.EXDocBasketRefresh();\r\n\tparent.LOShowTransmittalDocuments(DL_Transmittal,'Dokumenter flyttet fra kurven til dokumentpakken...');\r\n}\r\n\r\nfunction EXShowProtectedCase(DLCaseNo) {\r\n\tvar oXML = getEntityData('DL_CMAllProtectedView','DL_caseNo = \\'' + DLCaseNo + '\\'', '');\r\n\tvar EntityName = '_' + getsafe(oXML, '//DL_EntityNameForeign');\r\nif (EntityName == '_DL_Acctivities') EntityName = '_LO_PCase';\r\n\tvar Id = getsafe(oXML, '//DL_Id');\r\n\tloadentity(EntityName, Id);\r\n}\r\nfunction LOHentSagInit() {\r\n\tvar oEle = document.getElementById('LOType');\r\n\tvar sType = getCookie('LOType');\r\n    //alert('HentSagInit ' + sType);\r\n\tif (sType != '' && sType != null) {\r\n\t\tif (oEle != null)\r\n\t\t\toEle.value = sType;\r\n\t}\r\n}\r\nfunction LOSendMessageToForbund(DLId) { // 3.8.2011\r\n\tExecuteProcedure('LODLCaseSendBeskedderTilForbund @DLId=' + DLId);\r\n\talert('Mail sendt til forbund');\r\n}\r\nfunction LOVisFakturaXML(DLId) {\r\n\tvar xInvoice = getEntityData('DL_Invoice','DL_Id = ' + DLId, '');\r\n\tvar Id = getsafe(xInvoice, '//DL_SyncDocuments');\r\n\tvar xDoc = getEntityData('DL_SyncDocuments','DL_Id = ' + Id, '');\r\n\tvar sUrl = getsafe(xDoc, '//DL_OriginalURL').replace('.pdf','.xml');\r\n\twindow.open(sUrl)\r\n}\r\nfunction LOFakturaToggleType(DLId) { // 14.7.2009\r\n\tExecuteProcedure('dbo.LOFakturaToggleType @DLInvoice = ' + DLId);\r\n\tEXReload();\r\n}\r\nfunction LOVisFakturaGodkendelse(DLTask) {\r\n\tvar oXML = getEntityData('DL_InvoiceTask','DL_Id=' + DLTask, '');\r\n\tvar DLInvoice = getsafe(oXML, '//DL_EntityId');\r\n\t//alert(DLInvoice + ' :' + oXML.xml);\r\n\tloadentity('DL_InvoiceTask',DLTask,'Action=50');\r\n\tvar oInvoice = getEntityData('DL_Invoice','DL_Id = ' + DLInvoice, '');\r\n\tvar URL = getsafe(oInvoice, '//DL_URLDocument');\r\n\tloadcontent(URL,'DL_Information2');\r\n\tURL = getAbsoluteURL('/EX_SQLSVC/DynamicList.html?DLEntity=DL_HTMLNotesView&Where=DL_EntityNameForeign=\\'DL_Invoice\\' AND DL_EntityId = ' + DLInvoice + '&OrderBy=DL_Modified DESC&PropList=DL_Title&Action=none&ShowTitle=false');\r\n\tloadcontent(URL,'DL_Information3'); // 14.5.2009 - Show list data med noter\r\n}\r\n// 3.1.2013\r\nfunction LOSuggestMeetingAccept(DLId) {\r\n\tvar oXML = getEntityData('LO_SuggestMeetingDate','DL_Id=' + DLId,'');\r\n\tvar xDate = getsafe(oXML, '//LO_SuggestDate1');\r\n\tif (xDate.indexOf('T00:00:00')  > 0) {\r\n\t\tvar sInterval = getsafe(oXML,'//LO_SuggestTimeInterval1');\r\n\t\tvar tid = prompt('Hvilket tidspunkt skal m\\370det holder p\\345? (hh:mm) ' + sInterval,'');\r\n\t\tif (tid == '' || tid == null) // || typeof(tid) == 'undefined' || tid == null)\r\n\t\t\treturn;\r\n\t\ttid = tid.replace('.',':'); // 13.3.2009\r\n\t\tif (tid.length < 5)\r\n\t\t\ttid = '0' + tid;\r\n\t\ttid = tid + ':00';\r\n\t\txDate = xDate.replace('T00:00:00','T'+ tid);\r\n\t}\r\n//alert(xDate); // 11.3.2009\r\n//return;\r\n\tvar DLCase = getsafe(oXML,'//DL_EntityId');\r\n\tLOSendSag(DLCase, xDate, DLId);\r\n}\r\nfunction LOSuggestNewMeeting(DLId) {\r\n\tvar oXML = getEntityData('LO_SuggestMeetingDate','DL_Id = ' + DLId, '');\r\n\tsetEntityItemValue('LO_SuggestMeetingDate',DLId,getsafe(oXML, '//DL_Modified'), 'DL_CaseState','1');\r\n\tnewentity('LO_SuggestMeetingDate','DL_EntityNameForeign,DL_EntityId,LO_SuggestMeetingOrigin','DL_Case,' + DLId +',1','Action=627');\r\n}\r\nfunction LOSendSag(DLCase, LOSuggestDate, DLMeeting) { // 9.6.2010 - DLMeeting added\r\n\tif (typeof(DLMeeting) == 'undefined')\r\n\t\tDLMeeting = '';\r\n\tloadcontent2(getAbsoluteURL('/EX_Custom/LOSendSag.html?DL_Case=' + DLCase + '&Date=' + LOSuggestDate + (DLMeeting==''?'':'&DLMeeting=' + DLMeeting) + '&EXCheck=' + Math.random()),'Send accept af m\\370dedato');\r\n}\r\nvar LEX_PrintEnterTitle = 'Indtast titel';\r\n// 4.1.2013\r\nfunction DLPostboxSagsnrChange() {\r\n\tvar oEle = document.getElementById('LO_Sagsnrs'); //document.getElementById('LO_Sagsnr');\r\n\tif (oEle == null) {\r\n\t\talert('DLPostboxSagsnrChange - strange');\r\n\t\treturn;\r\n\t}\r\n\tif (oEle.value.indexOf('.') > 0) {\r\nif (true) {\r\n\tvar sS = oEle.value.replace(/,/g,';');\r\n\tvar aS = sS.split(';');\r\n\tvar sRes = '';\r\n\tfor (var i=0;i < aS.length; i++) {\r\n\t\tif (i > 0)\r\n\t\t\tsRes = sRes + ';';\r\n\t\tif (aS[i].indexOf('.') > 0) {\r\n\t\t\tvar oXML = getEntityData('DL_Case','LO_ArbejdsretsID = \\'' + aS[i] + '\\'','');\r\n\t\t\tvar sSagsnr = getsafe(oXML, '//LO_Sagsnr');\r\n\t\t\tif (sSagsnr == '')\r\n\t\t\t\talert('Ukendt arbejdsretsid ' + aS[i] + '. Vil ignorere det');\r\n\t\t\telse\r\n\t\t\t\tsRes = sRes + sSagsnr;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tsRes = sRes + aS[i];\r\n\t\t}\r\n\t}\r\n\toEle.value = sRes;\r\n}\r\nelse {\r\n\t\tvar oXML = getEntityData('DL_Case','LO_ArbejdsretsID = \\'' + oEle.value + '\\'','');\r\n\t\tvar sSagsnr = getsafe(oXML, '//LO_Sagsnr');\r\n\t\tif (sSagsnr == '')\r\n\t\t\talert('Ukendt arbejdsretsid ' + oEle.value);\r\n\t\telse\r\n\t\t\toEle.value = sSagsnr;\r\n}\r\n\t}\r\nreturn; // 3-12-2007\r\n\tif (oEle.value != '') {\r\n//alert('parent invocation');\r\n//parent.DLPosthusItemJournalise(null);\r\n//return;\r\n\t\tvar oXML = getEntityData('DL_Case','LO_Sagsnr = \\'' + oEle.value + '\\'', '');\r\n//\t\tvar oPXML = getEntityData('LO_PCase','LO_Sagsnr = \\'' + oEle.value + '\\'', '');\r\n\t\tvar oPXML = getEntityData('DL_Activities','LO_Sagsnr = \\'' + oEle.value + '\\'', '');\r\n\t\tif ((getsafe(oXML, '//DL_Id') != '') && (getsafe(oPXML, '//DL_Id') != '')) {\r\n\t\t\talert('***\\nADVARSEL\\n***\\n\\nSagsnummeret ' + oEle.value + ' findes B\\305DE som juridisk og politisk sag! Brug menuen \"journaliser brev\" for at uploade.\\n\\nKlik OPDATER for at gemme \\346ndringen f\\370r du journaliserer'); //\\n'+ oXML.xml + '\\n' + oPXML.xml);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (getsafe(oXML, '//DL_Id') == '')\r\n//\t\t\toXML = getEntityData('LO_PCase','LO_Sagsnr = \\'' + oEle.value + '\\'', '');\r\n\t\t\toXML = getEntityData('DL_Activities','LO_Sagsnr = \\'' + oEle.value + '\\'', '');\r\n\t\tif (getsafe(oXML, '//DL_Id') == '')  {\r\n\t\t\talert('Ukendt sag');\r\n\t\t\toEle.value = '';\r\n\t\t\toEle.focus();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t//var sMsg = 'Vil du journalisere brevet under sag ' + oEle.value + ' ' + getsafe(oXML, '//DL_Title') + '?';\r\n\t\t//if (confirm(sMsg)) {\r\n\t\t\t//alert('TEST - om kort tid vil brevet blive journaliseret');\r\n\t\t\tvar oSyncDoc = getEntityData('DL_SyncDocuments','DL_Id=' + parent.DLPosthusLast,'');\r\n\t\t\tvar oTitle = document.getElementById('DL_Title');\r\n\t\t\tSetEntityItemValue('DL_SyncDocuments',parent.DLPosthusLast,getsafe(oSyncDoc,'//DL_Modified'),'LO_Sagsnr',oEle.value, 'DL_Title', oTitle.value);\r\n\t\t\toTitle = document.getElementById('DL_sAMAccountNameForeign');\r\n\t\t\tif (oTitle.value != getsafe(oSyncDoc,'//DL_sAMAccountNameForeign')) {\r\n\t\t\t\toSyncDoc = getEntityData('DL_SyncDocuments','DL_Id=' + parent.DLPosthusLast,'');\r\n\t\t\t\tSetEntityItemValue('DL_SyncDocuments',parent.DLPosthusLast,getsafe(oSyncDoc,'//DL_Modified'),'DL_sAMAccountNameForeign',oTitle.value);\r\n\t\t\t}\r\n\t\t\toTitle = document.getElementById('DL_KeyWords');\r\n\t\t\tif (oTitle.value != getsafe(oSyncDoc,'//DL_KeyWords')) {\r\n\t\t\t\toSyncDoc = getEntityData('DL_SyncDocuments','DL_Id=' + parent.DLPosthusLast,'');\r\n\t\t\t\tSetEntityItemValue('DL_SyncDocuments',parent.DLPosthusLast,getsafe(oSyncDoc,'//DL_Modified'),'DL_KeyWords',oTitle.value);\r\n\t\t\t}\r\n\t\t\twindow.status = 'journaliserer brev....';\r\n\t\t\tparent.DLPosthusItemJournalise(null);\r\n\t\t\twidow.status = 'journalisering afsluttet';\r\n\t\t//}\r\n\t}\r\n}\r\nfunction DLPostboxSetEmployee() {\r\n\ttry {\r\n\t\tvar oDept = document.getElementById('DL_Postbox');\r\n\t\tvar oEle = document.getElementById('DL_sAMAccountNameForeign');\r\n\t\tif (oDept == null || oEle == null) {\r\n\t\t\talert('DLPostboxSetEmployee - strange');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tFillDropDown('DL_sAMAccountNameForeign','DL_sAMAccountName','DL_sAMAccountName','DL_Name','DL_Postbox',oDept.value, oEle.value);\r\n\t} catch (e) {alert('DLPostboxSetEmployee ' + e.message);}\r\n}\r\n\r\nfunction EXSpaceToSearch(s) {\r\n  s = s.replace(/ /g, '%');\r\n//alert('EXSpaceToSearch ' + s);\r\n  return s;\r\n}\r\nfunction EXCaseExchange2Case(DLId) {\r\n\tvar oXML = getEntityData('DL_CaseExchange', 'DL_Id = ' + DLId, '');\r\n\tvar DLEntityNameForeign = getsafe(oXML, '//DL_EntityNameForeign');\r\n\tvar DLEntityId = getsafe(oXML, '//DL_EntityId');\r\n\tif (DLEntityNameForeign == '' || DLEntityId == '') {\r\n\t\talert('Ingen sag fundet for den p\\345g\\346ldende operation');\r\n\t\tLODisplayXML('DL_CaseExchange',DLId);\r\n\t\treturn;\r\n\t}\r\n\tEXGotoObject(DLEntityNameForeign, DLEntityId);\r\n}\r\nfunction LOGotoCase(LOSagsnr,DLEntityNameForeign) { // 5.1.2013 - oprettet\r\n\tif (LOSagsnr == '')\r\n\t\treturn;\r\n\tvar sWhere;\r\n\tif (DLEntityNameForeign = 'DL_Activities' || DLEntityNameForeign == 'DL_Case')\r\n\t\tsWhere = 'LO_Sagsnr = \\'' + LOSagsnr + '\\'';\r\n\telse\r\n\t\tsWhere = 'DL_CaseNo = \\'' + LOSagsnr + '\\'';\r\n\tvar xCase = getEntityData(DLEntityNameForeign,sWhere,'');\r\n\tif (getsafe(xCase,'//DL_Id') == '')\r\n\t\talert('Ukendt sag ' + LOSagsnr);\r\n\telse\r\n\t\tEXGotoObject(DLEntityNameForeign,getsafe(xCase,'//DL_Id')); //,null,null,null,true);\r\n}\r\n// 8.1.2013\r\nfunction EXfetchCompany(tdcId) { // 9.12.2012\r\n  var s = '<mns:fetchCompany xmlns:mns=\"http://com.stibo.net/nne/3.1/NNE\" SOAP-ENV:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"><int_1 xsi:type=\"xsd:int\">' + tdcId + '</int_1><int_2 xsi:type=\"xsd:int\">0</int_2><String_3 xsi:type=\"xsd:string\"></String_3><String_4 xsi:type=\"xsd:string\">uffe</String_4></mns:fetchCompany>';\r\n    var xmldoc, FeedbackHTTP;\r\n    xmldoc='<?xml version=\"1.0\" encoding=\"utf-8\"?><SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:tns=\"http://com.stibo.net/nne/3.1/NNE\" xmlns:ns2=\"http://com.stibo.net/nne/3.1/Types/NNE\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/wsdl/soap/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:SOAP-ENC=\"http://schemas.xmlsoap.org/soap/encoding/\"><SOAP-ENV:Body>';\r\n    xmldoc = xmldoc + s;\r\n    xmldoc = xmldoc + '</SOAP-ENV:Body></SOAP-ENV:Envelope>';\r\n\r\n    FeedbackHTTP = new ActiveXObject(\"Microsoft.XMLHTTP\")\r\n    FeedbackHTTP.Open(\"POST\", 'http://service.nnerhverv.dk:80/nne-ws/3.1/NNE', false); \r\n    FeedbackHTTP.setRequestHeader(\"Content-Type\",\"text/xml; charset=utf-8\");\r\n    //FeedbackHTTP.setRequestHeader(\"SOAPAction\", 'nms:search');\r\ntry {\r\n    FeedbackHTTP.Send(xmldoc);\r\n} catch (e) {alert('EXgetCompanyFromCVR ' + e.message);}\r\n    var oXML;\r\n    oXML = FeedbackHTTP.ResponseXML;\r\n//  oXML.setProperty('SelectionNamespaces', 'xmlns:ns0=\"http://com.stibo.net/nne/3.1/Types/NNE\"');\r\n//alert(getsafe(oXML, '//legalEntity') + '\\n' + oXML.xml);\r\nreturn oXML;\r\n}\r\n\r\nfunction EXgetCompanyFromCVR(cvrnr) { // 4.12.2012 - new service version used\r\ntry {\r\n  var s = '<mns:search xmlns:mns=\"http://com.stibo.net/nne/3.1/NNE\" SOAP-ENV:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"><Question_1 xsi:type=\"ns2:Question\"><cvrNo xsi:type=\"xsd:int\">' + cvrnr + '</cvrNo><district xsi:type=\"xsd:string\"></district><houseNo xsi:type=\"xsd:string\"></houseNo><name xsi:type=\"xsd:string\"></name><nameStartsWith xsi:type=\"xsd:boolean\">1</nameStartsWith><phone xsi:type=\"xsd:string\"></phone><street xsi:type=\"xsd:string\"></street><streetStartsWith xsi:type=\"xsd:boolean\">1</streetStartsWith><tdcId xsi:type=\"xsd:int\">0</tdcId><zipCode xsi:type=\"xsd:int\">0</zipCode></Question_1><int_2 xsi:type=\"xsd:int\">2</int_2><int_3 xsi:type=\"xsd:int\">1</int_3><int_4 xsi:type=\"xsd:int\">0</int_4><String_5 xsi:type=\"xsd:string\">uffe</String_5></mns:search>';\r\n    var xmldoc, FeedbackHTTP;\r\n    xmldoc='<?xml version=\"1.0\" encoding=\"utf-8\"?><SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:tns=\"http://com.stibo.net/nne/3.1/NNE\" xmlns:ns2=\"http://com.stibo.net/nne/3.1/Types/NNE\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/wsdl/soap/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:SOAP-ENC=\"http://schemas.xmlsoap.org/soap/encoding/\"><SOAP-ENV:Body>';\r\n    xmldoc = xmldoc + s;\r\n    xmldoc = xmldoc + '</SOAP-ENV:Body></SOAP-ENV:Envelope>';\r\n\r\n    FeedbackHTTP = new ActiveXObject(\"Microsoft.XMLHTTP\")\r\n    FeedbackHTTP.Open(\"POST\", 'http://service.nnerhverv.dk:80/nne-ws/3.1/NNE', false); \r\n    FeedbackHTTP.setRequestHeader(\"Content-Type\",\"text/xml; charset=utf-8\");\r\n    //FeedbackHTTP.setRequestHeader(\"SOAPAction\", 'nms:search');\r\ntry {\r\n    FeedbackHTTP.Send(xmldoc);\r\n} catch (e) {alert('EXgetCompanyFromCVR ' + e.message);}\r\n    var oXML;\r\n    oXML = FeedbackHTTP.ResponseXML;\r\n  oXML.setProperty('SelectionNamespaces', 'xmlns:ns0=\"http://com.stibo.net/nne/3.1/Types/NNE\"');\r\n\r\nvar xNodes = oXML.selectNodes('//tdcId');\r\n//alert(xNodes.length);\r\nif (xNodes.length>1) {\r\nvar xRes = null;\r\nfor (var i=0;i<xNodes.length;i++) {\r\n xRes = EXfetchCompany(xNodes[i].text);\r\n xRes.setProperty('SelectionNamespaces', 'xmlns:ns0=\"http://com.stibo.net/nne/3.1/Types/NNE\"');\r\n if (getsafe(xRes,'//legalEntity') == '1') {\r\n//  alert('Found ' + xRes.xml);\r\nreturn xRes;\r\n }\r\n}\r\n//alert(xNodes[0].xml);\r\n//EXCopyToClipboard(oXML.xml);\r\n}\r\n//alert(xNodes);\r\n//alert(cvrnr + '\\n'+ xmldoc + '\\n' + oXML.xml);\r\nif (FeedbackHTTP.status != 200)\r\nalert('Kan ikke finde firma på CVRNR=' + cvrnr + '. Intern fejl - kontakt administrator.\\nEXgetCompanyFromCVR(...) = ' + FeedbackHTTP.status + ' ' + getsafe(oXML, '//faultstring'));\r\n    FeedbackHTTP = null;\r\n    return oXML;\r\n} catch (e) {alert('EXgetCompanyFromCVRNew ' + e.message);}\r\n}\r\n// FEA\r\nfunction FEAKnytPersonTilOrganisation(DL_Person, DL_Organisation) {\r\n  try {\r\n    var xOps;\r\n    // Add document to DL_OrganisationPerson\r\n    xOps = '<DL_OrganisationPerson><DELETE/><UPDATE/><INSERT>';\r\n    xOps = xOps + '<Row><DL_Organisation>' + DL_Organisation + '</DL_Organisation><DL_Person>' + DL_Person + '</DL_Person><DL_StartDate>getdate()</DL_StartDate>';\r\n    xOps = xOps + '</Row></INSERT></DL_OrganisationPerson>';\r\n    setEntity('DL_OrganisationPerson', xOps);\r\n    alert('Person tilknyttet til organisation');\r\n  } catch (e) {alert('FEAKnytPersonTilOrganisation ' + e.message);}\r\n}\r\nfunction FEAKnytObject2Object(DLEntity, DLEntityKey1, DLEntityKey2, DLEntityId1, DLEntityId2, message, bExtra) {\r\n  try {\r\n    var xOps;\r\n    xOps = '<' + DLEntity + '><DELETE/><UPDATE/><INSERT>';\r\n    xOps = xOps + '<Row><' +DLEntityKey1  + '>' + DLEntityId1 + '</' + DLEntityKey1 + '><' + DLEntityKey2 + '>' + DLEntityId2 + '</' + DLEntityKey2 + '>';\r\n    if (bExtra) {\r\n      var s = '';\r\n      s = prompt('År-måned - yyyymm');\r\n      if (s == null || s == '' || s == 'undefined')\r\n        return;\r\n      xOps = xOps + '<DL_YearMonth>' + s + '</DL_YearMonth>';\r\n      s = '';\r\n      s = prompt('Titel');\r\n      if (s == null || s == '' || s == 'undefined')\r\n        return;\r\n      xOps = xOps + '<DL_Title>' + s + '</DL_Title>';\r\n    }\r\n    xOps = xOps + '</Row></INSERT></' + DLEntity + '>';\r\n    setEntity(DLEntity, xOps);\r\n    if (message)\r\n      alert(message);\r\n  } catch (e) {alert('FEAKnytObject2Object ' + e.message);}\r\n}\r\n\r\nfunction FEAKnytObject2Object2(DLEntity, DLEntityKey1, DLEntityKey2, DLEntityId1, DLEntityId2, message, errmsg) {\r\n  try {\r\n    var sWhere = DLEntityKey1 + ' = ' + DLEntityId1 + ' AND ' + DLEntityKey2 + ' = ' + DLEntityId2;\r\n    //alert(sWhere);\r\n    var oXML = getEntityData2('count(*)',DLEntity,sWhere,'');\r\n    var c = getsafe(oXML, '//' + DLEntity);\r\n    if (1 * c > 0)  {\r\n      alert(errmsg + ' #=' + c + '. (FEAKnytObject2Object2)');\r\n      return;\r\n    }\r\n    var xOps;\r\n    xOps = '<' + DLEntity + '><' +DLEntityKey1  + '>' + DLEntityId1 + '</' + DLEntityKey1 + '><' + DLEntityKey2 + '>' + DLEntityId2 + '</' + DLEntityKey2 + '>';\r\n    xOps = xOps + '</' + DLEntity + '>';\r\n    var DLId = setEntityDetail(DLEntity, xOps);\r\n    if (message)\r\n      alert(message);\r\n//alert('loadentity(' + DLEntity + ',' + DLId + ') invoked now');\r\n    loadentity(DLEntity, DLId);\r\n  } catch (e) {alert('FEAKnytObject2Object ' + e.message);}\r\n}\r\n\r\n\r\nfunction FEAKnytObject2Object3(DLEntity, DLEntityKey1, DLEntityKey2, DLEntityId1, DLEntityId2, message, errmsg) {\r\n  try {\r\n    var sWhere = DLEntityKey1 + ' = ' + DLEntityId1 + ' AND ' + DLEntityKey2 + ' = ' + DLEntityId2;\r\n    //alert('DEBUG\\nFEAKnytObject2Object3\\n' + sWhere);\r\n    var oXML = getEntityData2('count(*)',DLEntity,sWhere,'');\r\n    var c = getsafe(oXML, '//' + DLEntity);\r\n    if (1 * c > 0)  {\r\n      alert(errmsg + ' #=' + c + '. (FEAKnytObject2Object3)' + sWhere);\r\n      return;\r\n    }\r\n    //if (message)\r\n    //  alert(message);\r\n    var sKeys, sValues;\r\n    sKeys = DLEntityKey1 + ',' + DLEntityKey2;\r\n    sValues = '' + DLEntityId1 + ',' + DLEntityId2;\r\n    parent.newentity2(DLEntity, sKeys, sValues, '',message); // 27.11.2008 - parent. tilføjet\r\n  } catch (e) {alert('FEAKnytObject2Object3 ' + e.message);}\r\n}\r\n// 9.1.2013\r\nfunction EXDocBasketGetTitleDL_Case(DLId) {\r\n\tvar oXML = getEntityData('DL_Case', 'DL_Id = ' + DLId, '');\r\n\tvar subject = getsafe(oXML, '//LO_Sagsnr') + ' ' + getsafe(oXML, '//LO_EXCompany') + ' ' + getsafe(oXML, '//LO_FagforbundSagsnr');\r\n\treturn subject;\r\n}\r\n/* 21.8.2010\r\nfunction EXDocBasketGetTitleDL_Activities(DLId) {\r\n\tvar oXML = getEntityData('DL_Activities', 'DL_Id = ' + DLId, '');\r\n\tvar subject = 'Sag ' + getsafe(oXML, '//DL_CaseNo') + ' ' + getsafe(oXML, '//DL_Title');\r\n\treturn subject;\r\n}\r\n*/\r\nvar bFEAGetNameListEmails;\r\nfunction FEAGetNameListEmails(DL_Id) {\r\n  try {\r\n    bFEAGetNameListEmails = true;\r\n    var oXML = ExecuteProcedure('EXExpandNameList @DLNameList = ' + DL_Id);\r\n    var res = '';\r\n    var xNodes, xNode, i;\r\n    xNodes = oXML.selectNodes(\"//DL_Email\");\r\n    for (i=0; i<xNodes.length; i++) {\r\n      xNode = xNodes[i];\r\n      if (xNode.text == '')\r\n        bFEAGetNameListEmails = false;\r\n      else {\r\n        if (res != '')\r\n          //res = res + ','; // 5/2-2007 - MMQ - ';';\r\n          res = res + ';'; // 4/1-2009 - MMQ\r\n        res = res + xNode.text;\r\n      }\r\n    }\r\n//alert('FEAGetNameListEmails ' + res);\r\n    return res;\r\n  } catch(e) {alert('FEAGetNameListEmails ' + e.message);}\r\n}\r\n\r\nfunction FEAGetPersonEmail(DL_Person) {\r\n  try {\r\n    var oXML = getEntityData2('*','DL_PersonCommunicationView','DL_Person = ' + DL_Person + ' AND DL_CommunicationType = \\'EMAIL\\'','');\r\n    var res = getsafe(oXML,'//DL_Title');\r\n    return res;\r\n  } catch(e) {alert('FEAGetPersonEmail ' + e.message);}\r\n}\r\n\r\nfunction FEAGetTransmittalEmails(DL_Id) {\r\n  try {\r\n    var oXML = getEntityData2('*', 'DL_Transmittal', 'DL_Id=' + DL_Id, '');\r\n    var res = '';\r\n    var NameList = getsafe(oXML,'//DL_NameList');\r\n    if (NameList != '') {\r\n      res = FEAGetNameListEmails(NameList);\r\n      if (!bFEAGetNameListEmails)\r\n        if (!confirm('Ikke alle personer har en email adresse - continue?'))\r\n          return '';\r\n//alert('DEBUG\\n' + NameList + '=' + res);\r\n    }\r\n    var Person = getsafe(oXML,'//DL_Person');\r\n    if (Person != '') {\r\n      if (res != '')\r\n        //res = res + ','; // 5/2-2007 - MMQ - ';';\r\n\tres += ';'; // 13.11.2008 - Outlook must be \";\"\r\n      res = res + FEAGetPersonEmail(Person);\r\n    }\r\n    var Email = getsafe(oXML,'//DL_Email');\r\n    if (Email != '') {\r\n      if (res != '')\r\n        res = res + ';';\r\n      res = res + Email;\r\n    }\r\n//alert(NameList + ' ' + Person + ' ' + Email);\r\n//alert('FEAGetTransmittalEmails =' + res);\r\n    return res;\r\n  } catch(e) {alert('FEAGetTransmittalEmails ' + e.message);}\r\n}\r\nfunction LOCreateTransmittal(DLTransmittal,sEle) {\r\n\tif (sEle == '') {\r\n\t\tvar oEle = document.getElementById('DL_NameList');\r\n\t\tif (oEle.value != '')\r\n\t\t\tsEle = 'DL_NameList';\r\n\t\telse {\r\n\t\t\toEle = document.getElementById('DL_Person');\r\n\t\t\tif (oEle.value != '')\r\n\t\t\t\tsEle = 'DL_Person';\r\n\t\t\telse\r\n\t\t\t\tsEle = 'DL_Emails';\r\n\t\t}\r\n\t}\r\n\tvar oEle = document.getElementById(sEle);\r\n\tif (oEle == null)\r\n\t\talert('LOCreateTransmittal - unknown property ' + sEle);\r\n\tvar sEleDenorm;\r\n\tif (sEle == 'DL_Emails')\r\n\t\tsEleDenorm = sEle;\r\n\telse\r\n\t\tsEleDenorm = sEle + 'Denorm';\r\n\tvar oEleDenorm = document.getElementById(sEleDenorm);\r\n\tif (oEle.value == '') {\r\n\t\talert('Venligst v\\346lg en person, navneliste eller email');\r\n\t\treturn;\r\n\t}\r\n\tSetRecentValue('DL_Transmittal', DLTransmittal);\r\n\r\n\t// Flyt dokumenter i dokumentkurven til forsendelsen\r\n\tExecuteProcedure('dbo.EXMoveDocBasketToTransmittal @DLTransmittal = ' + DLTransmittal);\r\n\tif (typeof(EXDocBasketRefresh) == 'function')\r\n\t\tparent.EXDocBasketRefresh();\r\noEle=document.getElementById('DL_Title');\r\n\tvar emails = FEAGetTransmittalEmails(DLTransmittal);\r\n\tEXBRMCreateMail('', oEle.value, 'DL_Transmittal', DLTransmittal, emails, false); // 25.5.2008 - which function should we REALLY USE\r\nreturn;\r\n\r\n\tvar oDiv = document.getElementById('EXDocPackage');\r\n\toDiv.innerHTML = '<a href=\"javascript:EXGotoObject(\\'DL_Transmittal\\',' + DLTransmittal + ')\">Ny dokumentpakke skabt (' + DL_Transmittal + ')</a> og Outlook email er klar til afsendelse.';\r\n}\r\nfunction EXDWPNewDocumentExtraReceiver(DLEntity) {\r\nreturn null;\r\n\tif (DLEntity == 'DL_Activities')\r\n\t\treturn ['Modtager','FEA',LODWPPickExtraReceiver];\r\n\treturn null;\r\n}\r\nfunction LOFEAPickPersonOrganisation(iType) { // iType=Person:0,Organisation:1\r\n\tvar oDiv = document.getElementById('LOExtraReceiverDIV');\r\n\tif (oDiv == null) {\r\n\t\toDiv = document.createElement('DIV');\r\n\t\toDiv.id = 'LOExtraReceiverDIV';\r\n\t\toDiv.style.display = 'None';\r\n//\t\toDiv.style.position = 'absolute';\r\n//\t\toDiv.style.top = '0px';\r\n\t\tvar sHTML = '<iframe frameborder=\"0\" style=\"width:510px;height:510px;\" id=\"EXSearch\"></iframe>';\r\n\t\toDiv.innerHTML = sHTML;\r\n//alert(sHTML);\r\n\t\tdocument.body.appendChild(oDiv);\r\n\t\toDiv = document.getElementById('LOExtraReceiverDIV');\r\n\t}\r\n\tvar sTitle, sUrl;\r\n\tif (iType == 0) {\r\n\t\tsTitle = 'FEA person som modtager';\r\n\t\tvar sUrl = getAbsoluteURL('/EX_SQLSVC/DynamicSearch.html?DLEntity=DL_PersonOrganisationSearchView&&SearchParameters=DL_Name,DL_OrganisationTitle&DisplayParameters=DL_Name,DL_OrganisationTitle&Tooltip=Choose value&ClickAction=533&SearchOnLoad=false&HideSave=true');\r\n\t}\r\n\telse {\r\n\t\tsTitle = 'FEA organisation som modtager';\r\n\t\tvar sUrl = getAbsoluteURL('/EX_SQLSVC/DynamicSearch.html?DLEntity=DL_OrganisationAddressPrimaryView&SearchParameters=DL_DL_OrganisationTitle&DisplayParameters=DL_Name,DL_OrganisationTitle&Tooltip=Choose value&ClickAction=533&SearchOnLoad=false');\r\n\t}\r\n\tloadcontent(sUrl,'EXSearch');\r\n\t$( \"#LOExtraReceiverDIV\" ).dialog({\r\n\t\tposition: [0,0],\r\n\t\tresizable: false,\r\n\t\theight: 520,\r\n\t\twidth: 540,\r\n\t\tmodal: true,\r\n\t\ttitle: sTitle,\r\n\t\topen: function(event, ui) {\r\n\t\t\t//$(\"input\").val([EXDWPShowCreatedModified]);\r\n\t\t},\r\n\t\tbuttons: {\r\n\t\t\t\"OK\": function() {\r\n//\t\t\t\tEXDWPShowCreatedModified = $('input:radio[name=displayType]:checked').val(); \r\n//\t\t\t\tsetCookie('EXDWPShowCreatedModified' + EXDWPFolderEntityName, EXDWPShowCreatedModified);\r\n//\t\t\t\tEXDWPRefresh();\r\n\t\t\t\t$( this ).dialog( \"close\" );\r\n\t\t\t},\r\n\t\t\tCancel: function() {\r\n\t\t\t\t$( this ).dialog( \"close\" );\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\nalert('LOFEAPickPersonOrganisation ' + iType);\r\n}\r\nfunction LODWPPickExtraReceiver() {\r\n\talert('extra receiver clicked ');\r\n\tvar oDiv = document.getElementById('LOExtraReceiverDIV');\r\n\tif (oDiv == null) {\r\n\t\toDiv = document.createElement('DIV');\r\n\t\toDiv.id = 'LOExtraReceiverDIV';\r\n\t\toDiv.style.display = 'None';\r\n//\t\toDiv.style.position = 'absolute';\r\n//\t\toDiv.style.top = '0px';\r\n\t\tvar sHTML = '<table bg1color=\"white\" width=\"100%\">';\r\n\t\tsHTML += '<tr id=\"trFEAPerson\" sty1le=\"display:none\" class=\"ms-vb\"><td><b>Person</b></td><td><input id=\"LOFEAPerson\" type=\"hidden\" onpropertychange=\"javascript:LOFEAPersonChange()\"><input style=\"width:200px\" id=\"LOFEAPersonDenorm\" type=\"text\"><a href=\"javascript:LOFEAPickPerson()\"><img src=\"/EX_Resources/img/16x16/add.gif\" border=\"0\"></a></td></tr>';\r\n\t\tsHTML += '<tr id=\"trFEAOrganisation\" styl1e=\"display:none\" class=\"dltablerow\"><td  class=\"ms-vb\"><b>Organisation</b></td><td><input id=\"LOFEAOrganisation\" type=\"hidden\" onpropertychange=\"javascript:EXOrganisationChange()\"><input style=\"width:200px\" id=\"LOFEAOrganisationDenorm\" type=\"text\"><a href=\"javascript:LOFEAPickOrganisation()\"><img src=\"/EX_Resources/img/16x16/add.gif\" border=\"0\"></a></td></tr>';\r\n\t\tsHTML += '</table>';\r\n\t\toDiv.innerHTML = sHTML;\r\n//alert(sHTML);\r\n\t\tdocument.appendChild(oDiv);\r\n\t\toDiv = document.getElementById('LOExtraReceiverDIV');\r\n\t}\r\noEXPickForm = new EXPickForm('pickform');\r\n\r\n//\tvar position = $(this).position();\r\n\t$( \"#LOExtraReceiverDIV\" ).dialog({\r\n\t\tposition: [0,0],\r\n\t\tresizable: false,\r\n\t\theight: 220,\r\n\t\twidth: 440,\r\n\t\tmodal: true,\r\n\t\ttitle: 'FEA person/organisation som modtager',\r\n\t\topen: function(event, ui) {\r\n\t\t\t//$(\"input\").val([EXDWPShowCreatedModified]);\r\n\t\t},\r\n\t\tbuttons: {\r\n\t\t\t\"OK\": function() {\r\n//\t\t\t\tEXDWPShowCreatedModified = $('input:radio[name=displayType]:checked').val(); \r\n//\t\t\t\tsetCookie('EXDWPShowCreatedModified' + EXDWPFolderEntityName, EXDWPShowCreatedModified);\r\n//\t\t\t\tEXDWPRefresh();\r\n\t\t\t\t$( this ).dialog( \"close\" );\r\n\t\t\t},\r\n\t\t\tCancel: function() {\r\n\t\t\t\t$( this ).dialog( \"close\" );\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n}\r\nfunction LOFEAPersonChange() {\r\n  var oEle = document.getElementById('LOFEAPerson');\r\n  if (oEle.value == '') // 16-11-2007\r\n    return;\r\n  var oXML = getEntityData('DL_PersonOrganisationAddressView','DL_Id=' + oEle.value,'');\r\n//alert(oXML.xml);\r\n  oEle = document.getElementById('EXProps');\r\n  //var oNode = oXML.selectSingleNode('//DL_ENTITYDATA/DL_PersonOrganisationAddressView');\r\n  oEle.value = AddNode(oXML, '//DL_OrganisationTitle','Company') + AddNode(oXML, '//DL_Name','Person') + AddNode(oXML, '//DL_Street','Street') + AddNode(oXML, '//DL_PostalCode','ZIP') + AddNode(oXML, '//DL_City','City');\r\n  _LOFEAClearOrganisation();\r\n  alert('Modtager: Person ' + getsafe(oXML, '//DL_Name') + ' fra firma ' + getsafe(oXML, '//DL_OrganisationTitle') + ' valgt.');\r\n}\r\nfunction _LOFEAClearPerson() {return;\r\n  var oEle = document.getElementById('LOFEAPersonDenorm');\r\n  oEle.value = '';\r\n}\r\nfunction _LOFEAClearOrganisation() {return;\r\n  var oEle = document.getElementById('LOFEAOrganisationDenorm');\r\n  oEle.value = '';\r\n}\r\nfunction LOFEAPickPerson() {\r\n  try {\r\n    EXDoDynamicSearch('LOFEAPerson', 'DL_PersonOrganisationSearchView', null, null, 'DL_Name,DL_JobTitle,DL_Role,DL_OrganisationTitle', '')\r\n  } catch (e) {alert('LOFEAPickPerson ' + e.message);}\r\n}\r\nfunction LOFEAPickOrganisation() {\r\n  try {\r\n    EXDoDynamicSearch('LOFEAOrganisation', 'DL_Organisation', null, null, 'DL_Title,DL_OrganisationShort', '')\r\n  } catch (e) {alert('LOFEAPickOrganisation ' + e.message);}\r\n}\r\nfunction LOFEAOrganisationChange() {\r\n  var oEle = document.getElementById('LOFEAOrganisation');\r\n  var oXML = getEntityData('DL_OrganisationAddressPrimaryView','DL_Organisation=' + oEle.value,'');\r\n//alert(oXML.xml);\r\n  oEle = document.getElementById('EXProps');\r\n  oEle.value = AddNode(oXML, '//DL_Title','Company') + AddNode(oXML, '//DL_Street','Street') + AddNode(oXML, '//DL_PostalCode','ZIP') + AddNode(oXML, '//DL_City','City');\r\n  _LOFEAClearPerson();\r\n  alert('Modtager: Firma ' + getsafe(oXML, '//DL_Title') + ' valgt.');\r\n}\r\nfunction LODisplayXML(DLEntity, DLId) {\r\n\tloadcontent(getAbsoluteURL('/EX_Custom/EXCaseExchangeXML.html?DLId=' + DLId));\r\n}\r\nfunction LOPostboxSagsnrChange() { // 26.1.2013\r\n\tvar oEle = document.getElementById('LO_Sagsnrs'); //document.getElementById('LO_Sagsnr');\r\nparent.EXLoadLetterFunctions(oEle.value);\r\nreturn;\r\n\tif (oEle == null) {\r\n\t\talert('DLPostboxSagsnrChange - strange');\r\n\t\treturn;\r\n\t}\r\nalert(oEle.value);\r\n\tif (oEle.value.indexOf('.') > 0) {\r\nif (true) {\r\n\tvar sS = oEle.value.replace(/,/g,';');\r\n\tvar aS = sS.split(';');\r\n\tvar sRes = '';\r\n\tfor (var i=0;i < aS.length; i++) {\r\n\t\tif (i > 0)\r\n\t\t\tsRes = sRes + ';';\r\n\t\tif (aS[i].indexOf('.') > 0) {\r\n\t\t\tvar oXML = getEntityData('DL_Case','LO_ArbejdsretsID = \\'' + aS[i] + '\\'','');\r\n\t\t\tvar sSagsnr = getsafe(oXML, '//LO_Sagsnr');\r\n\t\t\tif (sSagsnr == '')\r\n\t\t\t\talert('Ukendt arbejdsretsid ' + aS[i] + '. Vil ignorere det');\r\n\t\t\telse\r\n\t\t\t\tsRes = sRes + sSagsnr;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tsRes = sRes + aS[i];\r\n\t\t}\r\n\t}\r\n\toEle.value = sRes;\r\n}\r\nelse {\r\n\t\tvar oXML = getEntityData('DL_Case','LO_ArbejdsretsID = \\'' + oEle.value + '\\'','');\r\n\t\tvar sSagsnr = getsafe(oXML, '//LO_Sagsnr');\r\n\t\tif (sSagsnr == '')\r\n\t\t\talert('Ukendt arbejdsretsid ' + oEle.value);\r\n\t\telse\r\n\t\t\toEle.value = sSagsnr;\r\n}\r\n\t}\r\n}\r\nfunction LOBeskedTilFagforbund(DLId) { // 20.2.2013\r\n\tEXActionSubMenu('DL_CaseSendSagFagforbund','DL_CaseActor',DLId);\r\nreturn;\r\n\tvar oXML = getEntityData('DL_CaseActor','DL_Id=' + DLId,'');\r\n\talert(oXML.xml);\r\n}\r\n// 25.2.2013\r\nfunction LOMoveCaseDocumentToBasket(DL_Id) {\r\n var oXML = getEntityData('DL_CaseDocuments','DL_Id=' + DL_Id,'');\r\n SetEntityItemValue('DL_CaseDocuments',DL_Id,getsafe(oXML,'//DL_Modified'),'DL_EntityNameForeign','DL_sAMAccountName','DL_EntityId',0);\r\n EXReload();\r\n}\r\n\r\n// 8.3.2013\r\nfunction EXAssignHRIDToCase(DLEntityNameForeign, DLEntityId) { // 17.3.2009\r\n\tvar sUrl = getAbsoluteURL('/EX_SQLSVC/DynamicSearch.html?DLEntity=DL_Employee&SearchParameters=DL_HRID,DL_Name,DL_CaseState:0&ClickAction=648&ForeignKeys=DL_EntityNameForeign,DL_EntityId&ForeignValues=' + DLEntityNameForeign + ',' + DLEntityId);\r\n\tloadcontent2(sUrl,'S\\370g medarbejder og knyt til sagen');\r\n}\r\nfunction EXAssignHRIDToCaseDoIt(DLEntityNameForeign, DLEntityId, DLId) { // 17.3.2009\r\n\tvar oXML = getEntityData('DL_Employee','DL_Id=' + DLId, '');\r\n\tvar DLHRID = getsafe(oXML, '//DL_HRID');\r\n\tif (DLHRID == '') {\r\n\t\talert('Ukendt medarbejder\\nEXAssignHRIDToCase - contact administrator');\r\n\t\treturn;\r\n\t}\r\n\tvar xCase = getEntityData(DLEntityNameForeign,'DL_Id=' + DLEntityId, '');\r\n\tSetEntityItemValue(DLEntityNameForeign,DLEntityId,getsafe(xCase,'//DL_Modified'),'DL_HRIDForeign',DLHRID);\r\n\tEXReload();\r\n//alert('DoIt ' + DLEntityNameForeign + ':' + DLEntityId + ':' + DLId);\r\n}\r\nfunction FEAMergePerson(DL_TargetPerson, DL_Person) { // 4.4.2013 - IT sag 1160\r\n\tif (DL_TargetPerson == DL_Person) {\r\n\t\talert('Kan ikke merge personen ind i sig selv');\r\n\t\treturn;\r\n\t}\r\n\tvar oTarget, oXML;\r\n\toTarget = getEntityData('DL_Person', 'DL_Id=' + DL_TargetPerson,'');\r\n\toXML = getEntityData('DL_Person', 'DL_Id=' + DL_Person,'');\r\n\tvar s;\r\n\ts = 'Vil du merge ' + getsafe(oXML,'//DL_Name') + ' ind i personen ' + getsafe(oTarget,'//DL_Name') + '?';\r\n\tif (confirm(s)) {\r\n\t\tExecuteProcedure('dbo.FEAMergePerson @DLTargetPerson = ' + DL_TargetPerson + ', @DLPerson=' + DL_Person);\r\n\t\talert('Completed');\r\n\t\tEXReload();\r\n\t}\r\n//alert('FEAMergePerson ' + DL_TargetPerson + ' ' + DL_Person + ' ' + queryString('DL_Person'));\r\n\treturn;\r\n}\r\nfunction FEAMergeOrganisation(DL_TargetOrganisation, DL_Organisation) { // 17.6.2014 - tilfoejet\r\ntry {\r\n//alert('FEAMergeOrganisation invoked ' + DL_TargetOrganisation + ' ' + DL_Organisation);\r\n\tif (DL_TargetOrganisation == DL_Organisation) {\r\n\t\talert('Kan ikke merge organisationen ind i sig selv');\r\n\t\treturn;\r\n\t}\r\n\tvar oTarget, oXML;\r\n\toTarget = getEntityData('DL_Organisation', 'DL_Id=' + DL_TargetOrganisation,'');\r\n\toXML = getEntityData('DL_Organisation', 'DL_Id=' + DL_Organisation,'');\r\n\tvar s;\r\n\ts = 'Vil du merge ' + getsafe(oXML,'//DL_OrganisationTitle') + ' ind i organisationen ' + getsafe(oTarget,'//DL_OrganisationTitle') + '?';\r\n\tif (confirm(s)) {\r\n\t\tExecuteProcedure('dbo.FEAMergeOrganisation @DLTargetOrganisation = ' + DL_TargetOrganisation + ', @DLOrganisation=' + DL_Organisation);\r\n\t\talert('Completed');\r\n\t\tEXReload();\r\n\t}\r\n\treturn;\r\n} catch (e) {alert('FEAMergeOrganiastion ' + e.message);}\r\n}\r\n\r\n\r\nfunction LOOpenSagsnoterWord(DLId) { // 1.8.2013\r\n//alert('LOOpenSagsnoterWord(' + DLId + ')');\r\n$.getScript(\"/EX_Resources/js/EXNewDocument.js\", function(data, textStatus, jqxhr) {\r\n//   console.log(data); //data returned\r\n//   console.log(textStatus); //success\r\n//   console.log(jqxhr.status); //200\r\n//   console.log('Load was performed.');\r\n\tvar xDoc = getEntityData('DL_StandardLetterView','DL_Id=547','');\r\n//alert(xDoc.xml);\r\n\ttry {\r\n\t\tEXCreateDoc('DL_Case',DLId,getsafe(xDoc,'//DL_TemplateFile'),'','LO_CaseAllView','','','','547','',queryString('DL_FolderParams'));\r\n\t} catch(e) {alert('error ' + e.message);}\r\n});\r\n}\r\n// 6.8.2013 - IT Case 1138\r\nfunction EXCustomNewDocument(oTable, DLEntity) { \r\nif (DLEntity!= 'IT_Case' && DLEntity != 'DL_Activities')\r\nreturn;\r\n\r\n//alert('Custom ' + DLEntity);\r\n\tvar lastRow = oTable.rows.length-1;\r\n\tvar oTR;\r\n\r\n\r\n\toTR = oTable.insertRow(lastRow);\r\n\toTR.id = 'trFEAOrganisation';\r\n\tcell = oTR.insertCell(0);\r\n\tcell.className = 'ms-vb';\r\n\tcell.innerHTML = '<b>Organisation</b>';\r\n\tcell = oTR.insertCell(1);\r\n\tcell.className = 'ms-vb';\r\n\tcell.innerHTML = '<input id=\"EXOrganisation\" type=\"hidden\" style=\"width:0px\" onpropertychange=\"javascript:LOOrganisationChange()\"><input style=\"width:300px\" id=\"EXOrganisationDecode\" type=\"text\">';\r\n\r\n\toTR = oTable.insertRow(lastRow);\r\n\toTR.id = 'trFEAPerson';\r\n\tvar cell = oTR.insertCell(0);\r\n\tcell.className = 'ms-vb';\r\n\tcell.innerHTML = '<b>Person</b>';\r\n\tcell = oTR.insertCell(1);\r\n\tcell.className = 'ms-vb';\r\n\tcell.innerHTML = '<input id=\"EXPerson\" type=\"hidden\" style=\"width:0px\" onpropertychange=\"javascript:LOPersonChange()\"><input style=\"width:300px\" id=\"EXPersonDecode\" type=\"text\">';\r\nsetTimeout(function(){\r\n$.getScript(\"/EX_Resources/plugins/AutoComplete/JS/AutoComplete.js\", function(data, textStatus, jqxhr) {\r\n//alert('loaded');\r\n\tEXattachAutoComplete('EXPersonDecode','EXPerson',2,80,{ 'DL_Dictionary': 'DL_Person' ,'DL_PropCodeKey': 'DL_Id' ,'DL_PropCodeDecode1': 'DL_Name' }, '');\r\n\tEXattachAutoComplete('EXOrganisationDecode','EXOrganisation',2,80,{ 'DL_Dictionary': 'DL_Organisation' ,'DL_PropCodeKey': 'DL_Id' ,'DL_PropCodeDecode1': 'DL_Title' }, '');\r\n//alert('attached');\r\n});\r\n\r\n},7000); \r\n\r\n\r\n}\r\n\r\nfunction LOOrganisationChange() {\r\n\tvar oEle = document.getElementById('EXOrganisation');\r\n\tif (oEle.value == '' || oEle.value== '-1') return;\r\n\tvar oXML = getEntityData('DL_OrganisationAddressPrimaryView','DL_Organisation=' + oEle.value,'');\r\n\toEle = document.getElementById('EXProps');\r\n\toEle.value = AddNode(oXML, '//DL_Title','Company') + AddNode(oXML, '//DL_Street','Street') + AddNode(oXML, '//DL_PostalCode','ZIP') + AddNode(oXML, '//DL_City','City');\r\n\toEle = document.getElementById('EXPerson'); oEle.value='';\r\n\toEle = document.getElementById('EXPersonDecode'); oEle.value='';\r\n//  alert('Modtager: Firma ' + getsafe(oXML, '//DL_Title') + ' valgt.');\r\n}\r\n\r\nfunction LOPersonChange() {\r\n\tvar oEle = document.getElementById('EXPerson');\r\n\tif (oEle.value == '' || oEle.value== '-1') return;\r\n\tvar oXML = getEntityData('DL_PersonOrganisationAddressView','DL_Id=' + oEle.value,'');\r\n\toEle = document.getElementById('EXProps');\r\n  //var oNode = oXML.selectSingleNode('//DL_ENTITYDATA/DL_PersonOrganisationAddressView');\r\n\toEle.value = AddNode(oXML, '//DL_OrganisationTitle','Company') + AddNode(oXML, '//DL_Name','Person') + AddNode(oXML, '//DL_Street','Street') + AddNode(oXML, '//DL_PostalCode','ZIP') + AddNode(oXML, '//DL_City','City');\r\n\toEle = document.getElementById('EXOrganisation'); oEle.value='';\r\n\toEle = document.getElementById('EXOrganisationDecode'); oEle.value='';\r\n//  alert('Modtager: Person ' + getsafe(oXML, '//DL_Name') + ' fra firma ' + getsafe(oXML, '//DL_OrganisationTitle') + ' valgt.');\r\n}\r\n\r\nfunction EXPostboxCaseNoLooup(DLCaseNo) {\r\n\tvar xSag;\r\n\tif (DLCaseNo.indexOf('AR') == 0)\r\n\t\txSag = getEntityData2('*,\\'DL_Case\\' as DL_EntityNameForeign,DL_Id as DL_EntityId,\\'Juridisk sag\\' as DL_EntityDescription,LO_Sagsnr as DL_CaseNo','DL_Case','LO_ArbejdsretsID LIKE \\'%' + DLCaseNo.substr(3) + '\\'', '');\r\n\telse\r\n\t\txSag = getEntityData('DL_CMAllView','DL_CaseNo=\\'' + DLCaseNo + '\\'','');\r\n\treturn xSag;\r\n}\r\nfunction LOUdskrivSagsfremstilling(DLId) {\r\n//alert(DLId);\r\n\tvar xHTML = getEntityData('DL_HTMLNotes','DL_Id=' + DLId,'');\r\n//alert(xHTML.xml);\r\n\tvar html = getsafe(xHTML,'//DL_HTMLText');\r\nhtml = html.replace(/\\n\\n/g,'<p>'); // 23.6.2015\r\nhtml = html.replace(/\\n/g,'<br>'); // 23.6.2015\r\n//alert(html);\r\n\r\n\tvar DLCase = queryString('DL_Case');\r\n\tvar xCase = getEntityData('DL_Case','DL_Id=' + DLCase,'');\r\n\r\n\thtml = '<html><head><title>' + getsafe(xCase,'//LO_Sagsnr') + ' ' + getsafe(xCase, '//LO_EXCompany') + ' ' + getsafe(xHTML,'//DL_Created').substr(0,10) + '</title></head><body>' + html + '</body></html>';\r\n//alert(html);\r\n\r\n\tvar printWin = window.open(\"\",\"printSpecial\");\r\n\tif (printWin == null) {\r\n\t\talert('Kan ikke printe - pop-up blocker?');\r\n\t\treturn;\r\n\t}\r\n\tprintWin.document.open();\r\n\tprintWin.document.write(html);\r\n\tprintWin.document.close();\r\n\tprintWin.print();\r\n\tprintWin.close();\r\n}\r\n// 27.5.2014 / ups / mere glemt\r\nfunction FEAAddPersonOrgViewTD(xNode, XPath,bAddHref, XPathAlt) {\r\n  var s, value;\r\n  value = getsafe(xNode, XPath);\r\n  if (value == '' && XPathAlt != '' && XPathAlt != null)\r\n\tvalue =getsafe(xNode, XPathAlt);\r\n  if (bAddHref) {\r\n    s = '<td><a href=\"javascript:FEAGotoPerson(' + getsafe(xNode, 'DL_Id') + ')\">' + value + '</a></td>';\r\n  }\r\n  else \r\n    s = '<td>' + value + '</td>';\r\n  return s;\r\n}\r\nfunction FEAAddPersonOrgView(xNode) {\r\n  var s;\r\n  s = '<tr>';\r\n  s = s + FEAAddPersonOrgViewTD(xNode,'DL_Name',1,'DL_FullName');\r\n  s = s + FEAAddPersonOrgViewTD(xNode,'DL_OrganisationTitle');\r\n  s = s + FEAAddPersonOrgViewTD(xNode,'DL_Role');\r\n  s = s + '</tr>';\r\n  return s;\r\n}\r\n\r\n// 11.2.2014 - UPS - glemt noget - 13/6-2014 - mmq - rettet\r\nfunction FEAcheckperson() {\r\n try {\r\n   var sFirstName, sLastName;\r\n   var oEle = document.getElementById('DL_FirstName');\r\n   if (oEle == null) {\r\n\t//alert('FEAcheckperson - DL_FirstName missing');\r\n\toEle = document.getElementById('DL_FullName');\r\n\tvar s = oEle.value;\r\n\tvar i = s.lastIndexOf(' ');\r\n\tsFirstName = s.substr(0,i);\r\n\tsLastName = s.substr(i+1,s.length);\r\n   }\r\n   else {\r\n\tsFirstName = oEle.value;\r\n\toEle = document.getElementById('DL_LastName');\r\n\tsLastName = oEle.value;\r\n   }\r\n//alert('start' + sFirstName + ' ' + sLastName);\r\n   var oXML, sWhere;\r\n   sWhere = 'DL_FirstName LIKE \\'%' + sFirstName + '%\\' AND DL_LastName LIKE \\'%' + sLastName + '%\\'';\r\n   sWhere = 'DL_Name LIKE \\'%' + sFirstName + '%' + sLastName + '%\\'';\r\n   //oXML = getEntityData2('count(*)','DL_Person',sWhere,'');\r\n   oXML = getEntityData2('count(*)','DL_PersonOrganisationSearchView',sWhere,'');\r\n//alert('Antal=' + oXML.xml);\r\n//   var sAntal = getsafe(oXML, \"//DL_Person\");\r\n   var sAntal = getsafe(oXML, \"//DL_PersonOrganisationSearchView\");\r\n//alert(sAntal);\r\n   if (sAntal == \"\")\r\n     return;\r\n   var iAntal = 1 * sAntal;\r\n   if (iAntal > 0) {\r\n     if (confirm('Der findes ' + sAntal + ' personer med samme navn. Vil du se dem')) {\r\n       oXML = getEntityData2('*','DL_PersonOrganisationSearchView','DL_Name LIKE \\'%' + sFirstName + '%' + sLastName + '%\\'','');\r\n//alert('Så viser vi personerne ' + oXML.xml);\r\n       var sTable, xNodes, xNode;\r\n       xNodes = oXML.selectNodes('//DL_ENTITYDATA/DL_PersonOrganisationSearchView');\r\n       sTable = '<table class=\"dltable\" \tbgcolor=\"whitesmoke\" border=\"0\"><tr><th>Navn</th><th>Organisation</th><th>Rolle</th></tr>';\r\n       for (var i=0; i<xNodes.length; i++) {\r\n         xNode = xNodes[i];\r\n         sTable = sTable + FEAAddPersonOrgView(xNode);\r\n       }\r\n       sTable = sTable + '<tr><td align=\"center\" colspan=\"3\"><input type=\"submit\" value=\"Luk\" onclick=\"FEAcloseperson()\"></td></tr>';\r\n       sTable = sTable + '</table>';\r\n//alert('FEAcheckperson ' + sTable + ' ' + oXML.xml);\t\r\n       //oEle = document.getElementById('EXDDL2DIV');\r\n       oEle = document.getElementById('DL_LastName');\r\n\tif (oEle == null)\r\n\t\toEle = document.getElementById('DL_FullName');\r\n       var oDIV = document.getElementById('EXDDL2DIV');\r\n       if (oDIV == null)\r\n         alert('EXDDL2DIV not found');\r\n       else {\r\n         oDIV.innerHTML = sTable;\r\n         var x,y;\r\n//oEle = document.getElementById('btnGoto');\r\n         x = getElementLeft1(oEle);\r\n         y = getElementTop1(oEle);\r\n         //oDIV.style.width = oType.width;\r\n         oDIV.style.left = x;\r\n         oDIV.style.top =  y+16;\r\n         oDIV.style.visibility = \"visible\";\r\n//alert('Venter...');\r\n//         oDIV.style.visibility = \"hidden\";     \r\n       }\r\n     }\r\n   }\r\n } catch (e) {alert('FEAcheckperson ' + e.message);}\r\n return false;\r\n}\r\nfunction FEAcloseperson() {\r\n   var oDIV = document.getElementById('EXDDL2DIV');\r\n   if (oDIV != null)\r\n     oDIV.style.visibility = \"hidden\";     \r\n}\r\nfunction FEAKnytOrganisationTilOrganisation(DLOrganisation) {\r\n  try {\r\n\tvar x = ExecuteProcedure('FEAKnytOrganisationTilOrganisation ' + DLOrganisation);\r\n\tEXGotoObject('DL_Organisation',DLOrganisation);\r\n  } catch (e) {alert('FEAKnytOrganisationTilOrganisation ' + e.message);}\r\n}\r\n\r\nfunction Basket2Transmittal(DLId) {\r\n//alert(DLId);\r\n\tExecuteProcedure('EXMoveDocBasketToTransmittal @DLTransmittal='+DLId);\r\n\tEXReload();\r\n}\r\nfunction LOGotoTransmittalNamelist(DLId) { // 18.8.2014\r\n    var oXML = getEntityData2('*', 'DL_Transmittal', 'DL_Id=' + DLId, '');\r\n    var res = '';\r\n//alert(oXML.xml);\r\n    var NameList = getsafe(oXML,'//DL_NameList');\r\n    if (NameList != '') {\r\n\t\tEXGotoObject('DL_NameList',NameList);\r\n\t}\r\n}\r\nfunction LOTransmittalRecipients(DLId) {\r\n var xTr=getEntityData('DL_Transmittal','DL_Id='+DLId,'');\r\n var DLNameList = getsafe(xTr,'//DL_NameList');\r\n var DLPerson = getsafe(xTr,'//DL_Person');\r\n var sRecipients = getsafe(xTr,'//DL_Email');\r\n if (DLNameList != '') {\r\n//   var xNL = getEntityData('DL_NameList','DL_Id='+DLNameList,'');\r\n// alert(DLNameList + ' ' + xNL.xml);\r\n   var xEN = ExecuteProcedure('EXExpandNameList ' + DLNameList);\r\n//alert(xEN.xml);\r\n var xNodes = xEN.selectNodes('//DL_Email');\r\n   for (var i=0;i<xNodes.length;i++) {\r\n     if (sRecipients != '') sRecipients += ';';\r\n\t sRecipients += getsafe(xNodes[i],'../DL_Email');\r\n   }\r\n }\r\n if (DLPerson != '') {\r\n//   var xP = getEntityData('DL_Person','DL_Id='+DLPerson,'');\r\n// alert(DLPerson + ' ' + xP.xml);\r\n var xM = getEntityData('DL_Communication','DL_EntityNameForeign=\\'DL_Person\\' AND DL_EntityId='+DLPerson+' AND DL_CommunicationType=\\'EMAIL\\'','');\r\n var sM = getsafe(xM,'//DL_Title');\r\n   if (sM != '') {\r\n     if (sRecipients != '') sRecipients += ';';\r\n\t sRecipients += sM;\r\n   }\r\n }\r\nvar sTitel = getsafe(xTr,'//DL_TItle');\r\n alert('DEBUG - recipients are\\n' + sTitel + '\\n' + sRecipients);\r\n//return;\r\n//newcaseemail('DLTransmittal','DL_Transmittal',DLId,sTitel,'',getsafe(xTr,'//DL_CaseNo'),sRecipients);\r\nEXCopyToClipboard(sRecipients);\r\n}\r\nfunction FEAShowPersonAddresses(DLNameList,DLPerson,DLName) {\r\n\tloadcontent2('http://servsagssystem/EX_Custom/EXDynamicForm.html?Entity=DL_PersonAddressView&Where=DL_Person=' + DLPerson + '&D710s=DL_IsPrimaryAddress,DL_AddressXTypeDecode,DL_Street,DL_PostalCode,DL_City&ForeignKeys=DL_NameList,DL_Person&ForeignValues=' + DLNameList + ',' + DLPerson + '&Link=380','Adresser for ' + DLName);\r\n}\r\nfunction FEAShowPersonEmails(DLNameList,DLPerson,DLName) {\r\n\tloadcontent2('http://servsagssystem/EX_Custom/EXDynamicForm.html?Entity=DL_PersonEmailView&Where=DL_Person=' + DLPerson + '&D710s=DL_IsPrimaryEmail,DL_Email1&ForeignKeys=DL_NameList,DL_Person&ForeignValues=' + DLNameList + ',' + DLPerson + '&Link=409','Emails for ' + DLName);\r\n}\r\nfunction FEASetNameListEmail(DLNameList,DLPerson,DLEmailID) {\r\n//alert('FEASetNameListEmail ' + DLNameList + ' ' + DLEmailID);\r\n\tvar oXML = getEntityData('DL_NameListPersonExtra','DL_NameList=' + DLNameList + ' AND DL_Person = ' + DLPerson,'');\r\n\tvar DLId = getsafe(oXML, '//DL_Id');\r\n\tif (DLId == '') { // New record\r\n\t\tvar xOps\r\n\t\txOps = '<DL_NameListPersonExtra>';\r\n\t\txOps = xOps + '<DL_NameList>' + DLNameList + '</DL_NameList><DL_Person>' + DLPerson + '</DL_Person><DL_EntityId>' + DLEmailID + '</DL_EntityId>';\r\n\t\txOps = xOps + '</DL_NameListPersonExtra>';\r\n//alert(xOps);\r\n\t\tDLId = setEntityDetail('DL_NameListPersonExtra', xOps);\r\n\t}\r\n\telse { // Update existing record\r\n\t\tSetEntityItemValue('DL_NameListPersonExtra',DLId,getsafe(oXML,'//DL_Modified'),'DL_EntityId',DLEmailID);\r\n\t}\r\n\talert('Specifik email for personen sat p\\345 denne navneliste');\r\n}\r\nfunction FEASetNameListAddress(DLNameList,DLPerson,DLAddress) {\r\n//alert('FEASetNameListAddress ' + DLNameList + ' ' + DLAddress);\r\n\tvar oXML = getEntityData('DL_NameListPersonExtra','DL_NameList=' + DLNameList + ' AND DL_Person = ' + DLPerson,'');\r\n\tvar DLId = getsafe(oXML, '//DL_Id');\r\n\tif (DLId == '') { // New record\r\n\t\tvar xOps\r\n\t\txOps = '<DL_NameListPersonExtra>';\r\n\t\txOps = xOps + '<DL_NameList>' + DLNameList + '</DL_NameList><DL_Person>' + DLPerson + '</DL_Person><DL_Address>' + DLAddress + '</DL_Address>';\r\n\t\txOps = xOps + '</DL_NameListPersonExtra>';\r\n//alert(xOps);\r\n\t\tDLId = setEntityDetail('DL_NameListPersonExtra', xOps);\r\n\t}\r\n\telse { // Update existing record\r\n\t\tSetEntityItemValue('DL_NameListPersonExtra',DLId,getsafe(oXML,'//DL_Modified'),'DL_Address',DLAddress);\r\n\t}\r\n\talert('Specifik adresse for personen sat på denne navneliste');\r\n}\r\nfunction EXZ() {\r\ng_varSkipRefreshOnFocus = true;\r\n$.getScript( \"/EX_Resources/JS/RefreshOnFocus.js\", function( data, textStatus, jqxhr ) {\r\n  console.log( \"RefreshOnFocus was performed.\" );\r\n});\r\n}\r\nsetTimeout('EXZ()',7000); // IT Case 1411\r\n//alert('Exformatics_cust.js loaded');\r\n$(function(){$('#EXWFITCRDIV:not(:contains(\"No Object\"))').parents('.s4-wpcell-plain').first().addClass('displayBlock');});\t"}},[3]);